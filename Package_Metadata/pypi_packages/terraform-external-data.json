{"info": {"author": "Adam Burns", "author_email": "adam@operatingops.org", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3 :: Only"], "description": "About\n=====\n\nProvides a decorator that implements terraform's `external program protocol`_ for data sources.\n\n* Reads in JSON from :code:`stdin`.\n* Validates input.\n* Outputs JSON to :code:`stdout`.\n* Validates output.\n* Prints human-readable, one-line errors on :code:`stderr`.\n* Returns a non-zero status code on errors.\n\nThis saves you from fiddling with the spec and makes it easy to write several external data scripts without duplicating\ncode.\n\nThe wrapped function must expect its first positional argument to be a dictionary of the query data.\n\nSee the `contributing guide`_ for instructions on developing and running tests.\n\nExample Usage\n=============\n\n1. As always, create and activate a venv_.\n\n   .. code:: bash\n\n      python -m venv env\n      source env/bin/activate\n\n2. Install `terraform_external_data` in the env.\n\n   .. code:: bash\n\n      pip install terraform_external_data\n\n\n3. Write a script with a data collection function decorated by :code:`terraform_external_data` (the :code:`@` syntax below). Your function must take at least one argument, the query data passed in by terraform. For example, :code:`get_cool_data.py`:\n\n   .. code:: python\n\n      from terraform_external_data import terraform_external_data\n\n      @terraform_external_data\n      def get_cool_data(query):\n          \"\"\"\n          Dummy function that simulates data collection with a count.\n\n          Here you could reach out to an API, inspect local files, etc.\n          \"\"\"\n          count = 0\n          for i in range(3):\n              count += 1\n\n          # Terraform requires the values you return be strings,\n          # so terraform_external_data will error if they aren't.\n          return {query['thing_to_count']: str(count)}\n\n      if __name__ == '__main__':\n          # Always protect Python scripts from import side effects with\n          # a condition to check the __name__. Not specifically necessary\n          # for terraform_external_data, but it's a best practice in general.\n          get_cool_data()\n\n4. Add a :code:`data` resource to your terraform file. For example, :code:`terraform.tf`:\n\n   ::\n\n      data \"external\" \"cars_count\" {\n        program = [\"python\", \"${path.module}/get_cool_data.py\"]\n\n        query = {\n          # This is the query data your function will receive as an argument.\n          thing_to_count = \"cars\"\n        }\n      }\n\n      # Reference the data like any terraform var. This example uses an\n      # output so it doesn't modify infrastructure.\n      output \"cars_count\" {\n        value = data.external.cars_count.result.cars\n      }\n\n\n.. _external program protocol: https://www.terraform.io/docs/providers/external/data_source.html#external-program-protocol\n.. _contributing guide: https://github.com/operatingops/terraform_external_data/blob/master/CONTRIBUTING.md\n.. _venv: https://docs.python.org/3/library/venv.html\n.. _virtualenv: https://virtualenv.pypa.io/en/stable/\n\n\n", "description_content_type": "", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/operatingops/terraform_external_data", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "terraform-external-data", "package_url": "https://pypi.org/project/terraform-external-data/", "platform": "", "project_url": "https://pypi.org/project/terraform-external-data/", "project_urls": {"Homepage": "https://github.com/operatingops/terraform_external_data"}, "release_url": "https://pypi.org/project/terraform-external-data/1.0.1/", "requires_dist": ["tox (<3.14,>=3.13) ; extra == 'test'"], "requires_python": "", "summary": "Provides a decorator that implements terraform's external program protocol for data sources.", "version": "1.0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"about\">\n<h2>About</h2>\n<p>Provides a decorator that implements terraform\u2019s <a href=\"https://www.terraform.io/docs/providers/external/data_source.html#external-program-protocol\" rel=\"nofollow\">external program protocol</a> for data sources.</p>\n<ul>\n<li>Reads in JSON from <code>stdin</code>.</li>\n<li>Validates input.</li>\n<li>Outputs JSON to <code>stdout</code>.</li>\n<li>Validates output.</li>\n<li>Prints human-readable, one-line errors on <code>stderr</code>.</li>\n<li>Returns a non-zero status code on errors.</li>\n</ul>\n<p>This saves you from fiddling with the spec and makes it easy to write several external data scripts without duplicating\ncode.</p>\n<p>The wrapped function must expect its first positional argument to be a dictionary of the query data.</p>\n<p>See the <a href=\"https://github.com/operatingops/terraform_external_data/blob/master/CONTRIBUTING.md\" rel=\"nofollow\">contributing guide</a> for instructions on developing and running tests.</p>\n</div>\n<div id=\"example-usage\">\n<h2>Example Usage</h2>\n<ol>\n<li><p>As always, create and activate a <a href=\"https://docs.python.org/3/library/venv.html\" rel=\"nofollow\">venv</a>.</p>\n<pre>python -m venv env\n<span class=\"nb\">source</span> env/bin/activate\n</pre>\n</li>\n<li><p>Install <cite>terraform_external_data</cite> in the env.</p>\n<pre>pip install terraform_external_data\n</pre>\n</li>\n<li><p>Write a script with a data collection function decorated by <code>terraform_external_data</code> (the <code>@</code> syntax below). Your function must take at least one argument, the query data passed in by terraform. For example, <code>get_cool_data.py</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">terraform_external_data</span> <span class=\"kn\">import</span> <span class=\"n\">terraform_external_data</span>\n\n<span class=\"nd\">@terraform_external_data</span>\n<span class=\"k\">def</span> <span class=\"nf\">get_cool_data</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"\n    Dummy function that simulates data collection with a count.\n\n    Here you could reach out to an API, inspect local files, etc.\n    \"\"\"</span>\n    <span class=\"n\">count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">):</span>\n        <span class=\"n\">count</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n\n    <span class=\"c1\"># Terraform requires the values you return be strings,</span>\n    <span class=\"c1\"># so terraform_external_data will error if they aren't.</span>\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"n\">query</span><span class=\"p\">[</span><span class=\"s1\">'thing_to_count'</span><span class=\"p\">]:</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">count</span><span class=\"p\">)}</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"c1\"># Always protect Python scripts from import side effects with</span>\n    <span class=\"c1\"># a condition to check the __name__. Not specifically necessary</span>\n    <span class=\"c1\"># for terraform_external_data, but it's a best practice in general.</span>\n    <span class=\"n\">get_cool_data</span><span class=\"p\">()</span>\n</pre>\n</li>\n<li><p>Add a <code>data</code> resource to your terraform file. For example, <code>terraform.tf</code>:</p>\n<pre>data \"external\" \"cars_count\" {\n  program = [\"python\", \"${path.module}/get_cool_data.py\"]\n\n  query = {\n    # This is the query data your function will receive as an argument.\n    thing_to_count = \"cars\"\n  }\n}\n\n# Reference the data like any terraform var. This example uses an\n# output so it doesn't modify infrastructure.\noutput \"cars_count\" {\n  value = data.external.cars_count.result.cars\n}\n</pre>\n</li>\n</ol>\n</div>\n\n          </div>"}, "last_serial": 5647353, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "5d8958b4cb60969d45f5ba9d4170c950", "sha256": "e8612ccbfe4c11fe691cf85faaef0b194961864ae32b45dde65b7e06c637387b"}, "downloads": -1, "filename": "terraform_external_data-0.0.1.tar.gz", "has_sig": false, "md5_digest": "5d8958b4cb60969d45f5ba9d4170c950", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 1553, "upload_time": "2017-12-25T10:05:43", "upload_time_iso_8601": "2017-12-25T10:05:43.234782Z", "url": "https://files.pythonhosted.org/packages/3b/a1/93dbbe4669c6d10177d1741239be67df90b266efcadb2d85b27f2cc79ef0/terraform_external_data-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "a2fbb51f251781091dc9dbee57e552a1", "sha256": "6ab128bfecd78d90ca24be7e9608660f1f152d3ae9c3eaa5cd650cdbea2830a1"}, "downloads": -1, "filename": "terraform_external_data-0.0.2.tar.gz", "has_sig": false, "md5_digest": "a2fbb51f251781091dc9dbee57e552a1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 1584, "upload_time": "2018-01-07T20:47:11", "upload_time_iso_8601": "2018-01-07T20:47:11.714530Z", "url": "https://files.pythonhosted.org/packages/eb/c5/53a124f10ff04282b30023d57d0b13f150c00a591b9b1a8c843a6f86b938/terraform_external_data-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "fe127e4b20b19a528c3ae827fe1c4847", "sha256": "74f3ef667ad7e713a9d4a79403f647a5f82d6d72d641182444634f5a7615c4e5"}, "downloads": -1, "filename": "terraform_external_data-0.0.3.tar.gz", "has_sig": false, "md5_digest": "fe127e4b20b19a528c3ae827fe1c4847", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 2971, "upload_time": "2018-01-07T21:33:23", "upload_time_iso_8601": "2018-01-07T21:33:23.385032Z", "url": "https://files.pythonhosted.org/packages/86/64/ccb6c79e76f254ff01fdd02bf4729cc5e04de615e8177f55fcba8afafbd4/terraform_external_data-0.0.3.tar.gz", "yanked": false}], "0.0.5": [{"comment_text": "", "digests": {"md5": "9956794ba876b70fa06154f62f9af92a", "sha256": "4b3948b09e89b98c1e85d3cbb8e586b2a1c2e8a18968e5f385ec729b7d89cad4"}, "downloads": -1, "filename": "terraform_external_data-0.0.5-py3-none-any.whl", "has_sig": false, "md5_digest": "9956794ba876b70fa06154f62f9af92a", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4877, "upload_time": "2018-10-23T15:09:51", "upload_time_iso_8601": "2018-10-23T15:09:51.020089Z", "url": "https://files.pythonhosted.org/packages/d0/bb/57e43a0213d2ab27ba681448ea7da6cef7edb28e239dee44860e3ae0f1d8/terraform_external_data-0.0.5-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "0b156e2c61cb42f4a5637fcefdc9a14e", "sha256": "e91112be694b7b397eb78023df6edee7686eb235de93dd854ff34cec0d35bd68"}, "downloads": -1, "filename": "terraform_external_data-0.0.5.tar.gz", "has_sig": false, "md5_digest": "0b156e2c61cb42f4a5637fcefdc9a14e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3228, "upload_time": "2018-10-23T15:09:52", "upload_time_iso_8601": "2018-10-23T15:09:52.439980Z", "url": "https://files.pythonhosted.org/packages/df/dc/e41cac1677e2ca798d444b67416f303d98b2a615c526b3931aa32207d76d/terraform_external_data-0.0.5.tar.gz", "yanked": false}], "0.0.6": [{"comment_text": "", "digests": {"md5": "357c93b6b410b97f9149715c2b80374e", "sha256": "69044ae22eb9fe0ce34d9835890cc36cb12cc7c0fffcca65014510d45b5e1caa"}, "downloads": -1, "filename": "terraform_external_data-0.0.6-py3-none-any.whl", "has_sig": false, "md5_digest": "357c93b6b410b97f9149715c2b80374e", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4880, "upload_time": "2019-01-24T02:57:17", "upload_time_iso_8601": "2019-01-24T02:57:17.844299Z", "url": "https://files.pythonhosted.org/packages/85/4d/c8b11fca55a32a965743d1348dae5006064fccbac50c69182b859cbdcd7c/terraform_external_data-0.0.6-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "ab003060290bb2da8478d54640157f75", "sha256": "feec3b2f819e249c189e0dc2ce85d9e9312b3422763ad3147aef6742ea8c7e27"}, "downloads": -1, "filename": "terraform_external_data-0.0.6.tar.gz", "has_sig": false, "md5_digest": "ab003060290bb2da8478d54640157f75", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3222, "upload_time": "2019-01-24T02:57:21", "upload_time_iso_8601": "2019-01-24T02:57:21.027358Z", "url": "https://files.pythonhosted.org/packages/42/6f/44af76ce7c446e2c2e490d8d905a859c546291ce8d10a593279e750837df/terraform_external_data-0.0.6.tar.gz", "yanked": false}], "0.1.0": [{"comment_text": "", "digests": {"md5": "9e5bf4ae51d9d4b093e0280ed23e99e8", "sha256": "f77be5238521ea47eedfa0f4b244ff24f0a5f64d041adfb3a75358b359349f28"}, "downloads": -1, "filename": "terraform_external_data-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "9e5bf4ae51d9d4b093e0280ed23e99e8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4880, "upload_time": "2019-06-24T16:01:04", "upload_time_iso_8601": "2019-06-24T16:01:04.562475Z", "url": "https://files.pythonhosted.org/packages/3e/5d/d44eeacc1f3b9c10b3d3f27767a44520c1536ad18e9e2e8bc4ebe213068a/terraform_external_data-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "b16e528fee3be0669fed5914dbcea169", "sha256": "3d1c3f783cc18df5ac3cf46d7e0c231b9f65efb6b398847ffd61244c78241bd4"}, "downloads": -1, "filename": "terraform_external_data-0.1.0.tar.gz", "has_sig": false, "md5_digest": "b16e528fee3be0669fed5914dbcea169", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3234, "upload_time": "2019-06-24T16:01:06", "upload_time_iso_8601": "2019-06-24T16:01:06.118243Z", "url": "https://files.pythonhosted.org/packages/c2/e9/5cd71834da6f207922d72ad11d8566faee12087999450673c9bfeabe716f/terraform_external_data-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "f5615090ab5b1f7968d05618e25427d2", "sha256": "ffdaa64a8575bf7bcbbbd935bc4f2f5078a67248e2ba7694745d5e893c0617ae"}, "downloads": -1, "filename": "terraform_external_data-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "f5615090ab5b1f7968d05618e25427d2", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4876, "upload_time": "2019-06-25T13:39:30", "upload_time_iso_8601": "2019-06-25T13:39:30.423077Z", "url": "https://files.pythonhosted.org/packages/75/e8/c3ef6723fdc573aa6075549c62b9123c3fdf06329d7587cb7485df9baa73/terraform_external_data-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "e88d437df971efa41124ff3ade08c4af", "sha256": "7888e9b64c072a28b678b3880cd2b2c61b12f7993a23dda9805e6689898afa36"}, "downloads": -1, "filename": "terraform_external_data-0.1.1.tar.gz", "has_sig": false, "md5_digest": "e88d437df971efa41124ff3ade08c4af", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3222, "upload_time": "2019-06-25T13:39:32", "upload_time_iso_8601": "2019-06-25T13:39:32.044593Z", "url": "https://files.pythonhosted.org/packages/f0/21/6f1ede609b81450f9e05952b539a5544d0a258a3644202207064cc3af5b3/terraform_external_data-0.1.1.tar.gz", "yanked": false}], "1.0.0": [{"comment_text": "", "digests": {"md5": "3004f4ec7a58cad8827a86def52cff8d", "sha256": "2e10d9b70d11d6e97ce5dba72f21e90661335f3e3d871089c7bd009c52f56e71"}, "downloads": -1, "filename": "terraform_external_data-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "3004f4ec7a58cad8827a86def52cff8d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4805, "upload_time": "2019-08-07T01:53:15", "upload_time_iso_8601": "2019-08-07T01:53:15.218031Z", "url": "https://files.pythonhosted.org/packages/11/d7/7b4654c6a9df3557e8bd828ef9d03dca5519ea80e61a9f9ce3d5e7989497/terraform_external_data-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "bbe22e18dc01302aea04e1138f00684b", "sha256": "35673feee0d0d3a0af91d8c923ca7f9e6a5f09e392835f8886a7f208a386e55e"}, "downloads": -1, "filename": "terraform_external_data-1.0.0.tar.gz", "has_sig": false, "md5_digest": "bbe22e18dc01302aea04e1138f00684b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3139, "upload_time": "2019-08-07T01:53:16", "upload_time_iso_8601": "2019-08-07T01:53:16.531268Z", "url": "https://files.pythonhosted.org/packages/aa/cc/a5c9cd33d3733cb8724bdccb194c9cf23cd6e6b3929ec0df8d7d104cb280/terraform_external_data-1.0.0.tar.gz", "yanked": false}], "1.0.1": [{"comment_text": "", "digests": {"md5": "b3fc9e3ab58a7c2876bc57ff38632e86", "sha256": "4936cc3b9e12ab75cc19f8d53c7e98fc9a58c60fa84fbdbdd93145e7fca548a0"}, "downloads": -1, "filename": "terraform_external_data-1.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "b3fc9e3ab58a7c2876bc57ff38632e86", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4813, "upload_time": "2019-08-07T23:04:22", "upload_time_iso_8601": "2019-08-07T23:04:22.301748Z", "url": "https://files.pythonhosted.org/packages/df/0c/73919d4b368aa089f64317ad0fd9d50f1623fd67399b8dd1aaf51277a755/terraform_external_data-1.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "eaca1bdab62966aabfb3fb0ed40a3c26", "sha256": "6010c0d810b4dd5495b5de473872007772654bfe8f573b6924abca117962ed89"}, "downloads": -1, "filename": "terraform_external_data-1.0.1.tar.gz", "has_sig": false, "md5_digest": "eaca1bdab62966aabfb3fb0ed40a3c26", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3170, "upload_time": "2019-08-07T23:04:23", "upload_time_iso_8601": "2019-08-07T23:04:23.862802Z", "url": "https://files.pythonhosted.org/packages/be/11/7d676909dc099f19101990083a45d8e3a02b6836ad72b601bc7c69d62764/terraform_external_data-1.0.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "b3fc9e3ab58a7c2876bc57ff38632e86", "sha256": "4936cc3b9e12ab75cc19f8d53c7e98fc9a58c60fa84fbdbdd93145e7fca548a0"}, "downloads": -1, "filename": "terraform_external_data-1.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "b3fc9e3ab58a7c2876bc57ff38632e86", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4813, "upload_time": "2019-08-07T23:04:22", "upload_time_iso_8601": "2019-08-07T23:04:22.301748Z", "url": "https://files.pythonhosted.org/packages/df/0c/73919d4b368aa089f64317ad0fd9d50f1623fd67399b8dd1aaf51277a755/terraform_external_data-1.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "eaca1bdab62966aabfb3fb0ed40a3c26", "sha256": "6010c0d810b4dd5495b5de473872007772654bfe8f573b6924abca117962ed89"}, "downloads": -1, "filename": "terraform_external_data-1.0.1.tar.gz", "has_sig": false, "md5_digest": "eaca1bdab62966aabfb3fb0ed40a3c26", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3170, "upload_time": "2019-08-07T23:04:23", "upload_time_iso_8601": "2019-08-07T23:04:23.862802Z", "url": "https://files.pythonhosted.org/packages/be/11/7d676909dc099f19101990083a45d8e3a02b6836ad72b601bc7c69d62764/terraform_external_data-1.0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:55:49 2020"}