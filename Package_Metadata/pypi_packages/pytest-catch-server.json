{"info": {"author": "Jan Bedna\u0159\u00edk", "author_email": "jan.bednarik@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Framework :: Pytest", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Programming Language :: Python :: Implementation :: CPython", "Topic :: Software Development :: Testing"], "description": "# Pytest Catch Server\n\n[![PyPI version](https://img.shields.io/pypi/v/pytest-catch-server.svg)](https://pypi.org/project/pytest-catch-server)\n[![Python versions](https://img.shields.io/pypi/pyversions/pytest-catch-server.svg)](https://pypi.org/project/pytest-catch-server)\n[![Build status](https://travis-ci.org/kiwicom/pytest-catch-server.svg?branch=master)](https://travis-ci.org/kiwicom/pytest-catch-server)\n[![Code style: Black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/ambv/black)\n\n[Pytest](http://pytest.org) plugin with server fixture for catching HTTP requests.\nIt's handy for integration tests or for testing 3rd party packages which have\nnetwork side effects like reporting to 3rd party services (DataDog APM, Sentry, ...).\n\n## Installation\n\nYou can install \"pytest-catch-server\" via `pip`:\n\n```\npip install pytest-catch-server\n```\n\n## Usage\n\nThis plugin comes with three fixtures. The main `catch_server` is for use in your tests:\n\n```python\ndef test_something(catch_server):\n    url = f\"http://{catch_server.host}:{catch_server.port}/something\"\n    requests.get(url)\n    assert catch_server.requests == [\n        {\"method\": \"GET\", \"path\": \"/something\", \"data\": b\"\"}\n    ]\n```\n\nIn more real world examples you may need to patch global module (like some tracer).\n\nIt will flush list of catched `requests` between each test.\n\nCatching these methods: `GET`, `POST`, `PUT`, `PATCH`, `DELETE`\n\nYou may want to setup your app fixture with catch server as dependency. You can\nuse session scoped fixture `background_catch_server` for that:\n\n```python\n@pytest.fixture(scope=\"session\")\ndef app(background_catch_server):\n    tracer_dsn = f\"http://{background_catch_server.host}:{background_catch_server.port}\"\n    return create_app(tracer_dsn=tracer_dsn)\n\ndef test_tracing(app, catch_server):\n    app.do_something_that_calls_tracer()\n    assert catch_server.requests == [\n        {\"method\": \"PUT\", \"path\": \"/trace\", \"data\": b\"...\"}\n    ]\n```\n\nPort for catch server is a random free port. If you want to use specific port, you\ncan override `catch_server_port` fixture in your tests which is returning free\nport number.\n\nIf you encounter any problems, please\n[file an issue](https://github.com/kiwicom/pytest-catch-server/issues) along\nwith a detailed description.\n\n## Contributing\n\nContributions are very welcome. Tests can be run with\n[tox](https://tox.readthedocs.io/en/latest/), please ensure the coverage at\nleast stays the same before you submit a pull request.\n\n[Pre-commit](https://pre-commit.com/) hooks are set up for this project. Please\nmake sure you have [pre-commit](https://pre-commit.com/) installed and set up on\nthis repo.\n\n## License\n\nDistributed under the terms of the [MIT](http://opensource.org/licenses/MIT)\nlicense, \"pytest-catch-server\" is free and open source software.\n\n## Footnote\n\nThis [pytest](https://pytest.org) plugin was generated with [Cookiecutter](https://github.com/cookiecutter/cookiecutter)\nalong with [@hackebrot's](https://github.com/hackebrot)\n[cookiecutter-pytest-plugin](https://github.com/pytest-dev/cookiecutter-pytest-plugin) template.", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/kiwicom/pytest-catch-server", "keywords": "", "license": "MIT", "maintainer": "Jan Bedna\u0159\u00edk", "maintainer_email": "jan.bednarik@gmail.com", "name": "pytest-catch-server", "package_url": "https://pypi.org/project/pytest-catch-server/", "platform": "", "project_url": "https://pypi.org/project/pytest-catch-server/", "project_urls": {"Homepage": "https://github.com/kiwicom/pytest-catch-server"}, "release_url": "https://pypi.org/project/pytest-catch-server/1.0.0/", "requires_dist": null, "requires_python": ">=3.4", "summary": "Pytest plugin with server for catching HTTP requests.", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Pytest Catch Server</h1>\n<p><a href=\"https://pypi.org/project/pytest-catch-server\" rel=\"nofollow\"><img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c716db439014efac0140913083784d3af70efb1e/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f7079746573742d63617463682d7365727665722e737667\"></a>\n<a href=\"https://pypi.org/project/pytest-catch-server\" rel=\"nofollow\"><img alt=\"Python versions\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/5323b6ca3d20ede2313b29b03c79ed14914bc8f1/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f7079746573742d63617463682d7365727665722e737667\"></a>\n<a href=\"https://travis-ci.org/kiwicom/pytest-catch-server\" rel=\"nofollow\"><img alt=\"Build status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b4c09d5bdfd0e8569681108719aca8b0687115e8/68747470733a2f2f7472617669732d63692e6f72672f6b697769636f6d2f7079746573742d63617463682d7365727665722e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://github.com/ambv/black\" rel=\"nofollow\"><img alt=\"Code style: Black\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/fbfdc7754183ecf079bc71ddeabaf88f6cbc5c00/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c61636b2d3030303030302e737667\"></a></p>\n<p><a href=\"http://pytest.org\" rel=\"nofollow\">Pytest</a> plugin with server fixture for catching HTTP requests.\nIt's handy for integration tests or for testing 3rd party packages which have\nnetwork side effects like reporting to 3rd party services (DataDog APM, Sentry, ...).</p>\n<h2>Installation</h2>\n<p>You can install \"pytest-catch-server\" via <code>pip</code>:</p>\n<pre><code>pip install pytest-catch-server\n</code></pre>\n<h2>Usage</h2>\n<p>This plugin comes with three fixtures. The main <code>catch_server</code> is for use in your tests:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">test_something</span><span class=\"p\">(</span><span class=\"n\">catch_server</span><span class=\"p\">):</span>\n    <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">\"http://</span><span class=\"si\">{</span><span class=\"n\">catch_server</span><span class=\"o\">.</span><span class=\"n\">host</span><span class=\"si\">}</span><span class=\"s2\">:</span><span class=\"si\">{</span><span class=\"n\">catch_server</span><span class=\"o\">.</span><span class=\"n\">port</span><span class=\"si\">}</span><span class=\"s2\">/something\"</span>\n    <span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n    <span class=\"k\">assert</span> <span class=\"n\">catch_server</span><span class=\"o\">.</span><span class=\"n\">requests</span> <span class=\"o\">==</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span><span class=\"s2\">\"method\"</span><span class=\"p\">:</span> <span class=\"s2\">\"GET\"</span><span class=\"p\">,</span> <span class=\"s2\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"/something\"</span><span class=\"p\">,</span> <span class=\"s2\">\"data\"</span><span class=\"p\">:</span> <span class=\"sa\">b</span><span class=\"s2\">\"\"</span><span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n</pre>\n<p>In more real world examples you may need to patch global module (like some tracer).</p>\n<p>It will flush list of catched <code>requests</code> between each test.</p>\n<p>Catching these methods: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, <code>DELETE</code></p>\n<p>You may want to setup your app fixture with catch server as dependency. You can\nuse session scoped fixture <code>background_catch_server</code> for that:</p>\n<pre><span class=\"nd\">@pytest</span><span class=\"o\">.</span><span class=\"n\">fixture</span><span class=\"p\">(</span><span class=\"n\">scope</span><span class=\"o\">=</span><span class=\"s2\">\"session\"</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">app</span><span class=\"p\">(</span><span class=\"n\">background_catch_server</span><span class=\"p\">):</span>\n    <span class=\"n\">tracer_dsn</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">\"http://</span><span class=\"si\">{</span><span class=\"n\">background_catch_server</span><span class=\"o\">.</span><span class=\"n\">host</span><span class=\"si\">}</span><span class=\"s2\">:</span><span class=\"si\">{</span><span class=\"n\">background_catch_server</span><span class=\"o\">.</span><span class=\"n\">port</span><span class=\"si\">}</span><span class=\"s2\">\"</span>\n    <span class=\"k\">return</span> <span class=\"n\">create_app</span><span class=\"p\">(</span><span class=\"n\">tracer_dsn</span><span class=\"o\">=</span><span class=\"n\">tracer_dsn</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">test_tracing</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">catch_server</span><span class=\"p\">):</span>\n    <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">do_something_that_calls_tracer</span><span class=\"p\">()</span>\n    <span class=\"k\">assert</span> <span class=\"n\">catch_server</span><span class=\"o\">.</span><span class=\"n\">requests</span> <span class=\"o\">==</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span><span class=\"s2\">\"method\"</span><span class=\"p\">:</span> <span class=\"s2\">\"PUT\"</span><span class=\"p\">,</span> <span class=\"s2\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"/trace\"</span><span class=\"p\">,</span> <span class=\"s2\">\"data\"</span><span class=\"p\">:</span> <span class=\"sa\">b</span><span class=\"s2\">\"...\"</span><span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n</pre>\n<p>Port for catch server is a random free port. If you want to use specific port, you\ncan override <code>catch_server_port</code> fixture in your tests which is returning free\nport number.</p>\n<p>If you encounter any problems, please\n<a href=\"https://github.com/kiwicom/pytest-catch-server/issues\" rel=\"nofollow\">file an issue</a> along\nwith a detailed description.</p>\n<h2>Contributing</h2>\n<p>Contributions are very welcome. Tests can be run with\n<a href=\"https://tox.readthedocs.io/en/latest/\" rel=\"nofollow\">tox</a>, please ensure the coverage at\nleast stays the same before you submit a pull request.</p>\n<p><a href=\"https://pre-commit.com/\" rel=\"nofollow\">Pre-commit</a> hooks are set up for this project. Please\nmake sure you have <a href=\"https://pre-commit.com/\" rel=\"nofollow\">pre-commit</a> installed and set up on\nthis repo.</p>\n<h2>License</h2>\n<p>Distributed under the terms of the <a href=\"http://opensource.org/licenses/MIT\" rel=\"nofollow\">MIT</a>\nlicense, \"pytest-catch-server\" is free and open source software.</p>\n<h2>Footnote</h2>\n<p>This <a href=\"https://pytest.org\" rel=\"nofollow\">pytest</a> plugin was generated with <a href=\"https://github.com/cookiecutter/cookiecutter\" rel=\"nofollow\">Cookiecutter</a>\nalong with <a href=\"https://github.com/hackebrot\" rel=\"nofollow\">@hackebrot's</a>\n<a href=\"https://github.com/pytest-dev/cookiecutter-pytest-plugin\" rel=\"nofollow\">cookiecutter-pytest-plugin</a> template.</p>\n\n          </div>"}, "last_serial": 6459057, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "82beb40b3e94ff360263bcc12a2c79f4", "sha256": "7a4de7a4cf1efa8b92289c9ead60bd8546b97f21f083e539572f98e6ed6f2d9b"}, "downloads": -1, "filename": "pytest-catch-server-1.0.0.tar.gz", "has_sig": false, "md5_digest": "82beb40b3e94ff360263bcc12a2c79f4", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 4500, "upload_time": "2019-12-12T14:56:41", "upload_time_iso_8601": "2019-12-12T14:56:41.518779Z", "url": "https://files.pythonhosted.org/packages/64/a3/2fdef3f5ccca53b9383ade1d286c27a06a0b2251ed5b85722d6b771b88ff/pytest-catch-server-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "82beb40b3e94ff360263bcc12a2c79f4", "sha256": "7a4de7a4cf1efa8b92289c9ead60bd8546b97f21f083e539572f98e6ed6f2d9b"}, "downloads": -1, "filename": "pytest-catch-server-1.0.0.tar.gz", "has_sig": false, "md5_digest": "82beb40b3e94ff360263bcc12a2c79f4", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 4500, "upload_time": "2019-12-12T14:56:41", "upload_time_iso_8601": "2019-12-12T14:56:41.518779Z", "url": "https://files.pythonhosted.org/packages/64/a3/2fdef3f5ccca53b9383ade1d286c27a06a0b2251ed5b85722d6b771b88ff/pytest-catch-server-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:55:21 2020"}