{"info": {"author": "PaperMtn", "author_email": "papermtn@protonmail.com", "bugtrack_url": null, "classifiers": ["Intended Audience :: Information Technology", "License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Programming Language :: Python :: 2", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Topic :: Security"], "description": "# Lil Pwny\n![Python 2.7 and 3 compatible](https://img.shields.io/badge/python-2.7%2C%203.x-blue.svg)\n![PyPI version](https://img.shields.io/pypi/v/lil-pwny.svg)\n![License: MIT](https://img.shields.io/pypi/l/lil-pwny.svg)\n\nA multiprocessing approach to auditing Active Directory passwords using Python.\n\n## About Lil Pwny\n\nLil Pwny is a Python application to perform an offline audit of NTLM hashes of users' passwords, recovered from Active Directory, against known compromised passwords from Have I Been Pwned. The usernames of any accounts matching HIBP will be returned in a .txt file\n\nThere are also additional features:\n- Ability to provide a list of your own passwords to check AD users against. This allows you to check user passwords against passwords relevant to your organisation that you suspect people might be using. These are NTLM hashed, and AD hashes are then compared with this as well as the HIBP hashes.\n- Return a list of accounts using the same passwords. Useful for finding users using the same password for their administrative and standard accounts.\n\nMore information about Lil Pwny can be found [on my blog](https://papermtn.co.uk/)\n\n## Recommendations\nThis application was developed to ideally run on high resource infrastructure to make the most of Python multiprocessing. It will run on desktop level hardware, but the more cores you use, the faster the audit will run.\n\n## Installation\nInstall via pip\n```bash\npip install lil-pwny\n```\n\n## Usage\nLil-pwny will be installed as a global command, use as follows:\n\n```bash\nusage: lil-pwny [-h] -hibp HIBP [-a A] -ad AD_HASHES [-d] [-m] [-o OUTPUT]\n\noptional arguments:\n  -hibp, --hibp-path    The HIBP .txt file of NTLM hashes\n  -a, --a               .txt file containing additional passwords to check for\n  -ad, --ad-hashes      The NTLM hashes from of AD users\n  -d, --find-duplicates Output a list of duplicate password users\n  -m, --memory          Load HIBP hash list into memory (over 24GB RAM\n                        required)\n  -o, --out-path        Set output path. Uses working dir when not set\n```\n\nExample:\n```bash\nlil-pwny -hibp ~/hibp_hashes.txt -ad ~/ad_ntlm_hashes.txt -a ~/additional_passwords.txt -o ~/Desktop/Output -m -d\n```\n\nuse of the `-m` flag will load the HIBP hashes into memory, which will allow for faster searching. Note this will require at least 24GB of available memory.\n\n## Getting input files\n### Step 1: Get an IFM AD database dump\n\nOn a domain controller use `ntdsutil` to generate an IFM dump of your AD domain. Run the following in an elevated PowerShell window:\n\n```bash\nntdsutil\nactivate instance ntds\nifm\ncreate full **output path**\n```\n\n### Step 2: Recover NTLM hashes from this output\n\nTo recover the NTLM hashes from the AD IFM data, the Powershell module [DSInternals](https://github.com/MichaelGrafnetter/DSInternals) is required.\n\nOnce installed, use the SYSTEM hive in the IFM data to recover the hashes in the format `usernme:hash` and save them to the file `ad_ntlm_hashes.txt`\n\n```bash\n$bootKey = Get-BootKey -SystemHivePath '.\\registry\\SYSTEM'\nGet-ADDBAccount -All -DBPath '.\\Active Directory\\ntds.dit' -BootKey $bootKey | Format-Custom -View HashcatNT | Out-File ad_ntlm_hashes.txt -Encoding ASCII\n```\n\n### Step 3: Download the latest HIBP hash file\nThe file can be downloaded from [here](https://downloads.pwnedpasswords.com/passwords/pwned-passwords-ntlm-ordered-by-count-v5.7z)\n\nThe latest version of the hash file contains around 551 million hashes.\n\n## Resources\n- [ntdsutil & IFM](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732530(v=ws.11))\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/PaperMtn/little-pwny", "keywords": "audit active-directory have-i-been-pwned hibp lil-pwny little-pwny password password-audit", "license": "GPL-3.0", "maintainer": "", "maintainer_email": "", "name": "lil-pwny", "package_url": "https://pypi.org/project/lil-pwny/", "platform": "", "project_url": "https://pypi.org/project/lil-pwny/", "project_urls": {"Homepage": "https://github.com/PaperMtn/little-pwny"}, "release_url": "https://pypi.org/project/lil-pwny/1.0.2/", "requires_dist": null, "requires_python": "", "summary": "Auditing Active Directory Passwords", "version": "1.0.2", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Lil Pwny</h1>\n<p><img alt=\"Python 2.7 and 3 compatible\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/18aa051d1206dce9b639515be79e2324abd7e1b9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d322e37253243253230332e782d626c75652e737667\">\n<img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/88f866bd0f76c205fdf2c1e9c73c18f6e95f8ae4/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6c696c2d70776e792e737667\">\n<img alt=\"License: MIT\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/eaa2ccb4514edc8c92b788d39fca096d2b50a073/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f6c696c2d70776e792e737667\"></p>\n<p>A multiprocessing approach to auditing Active Directory passwords using Python.</p>\n<h2>About Lil Pwny</h2>\n<p>Lil Pwny is a Python application to perform an offline audit of NTLM hashes of users' passwords, recovered from Active Directory, against known compromised passwords from Have I Been Pwned. The usernames of any accounts matching HIBP will be returned in a .txt file</p>\n<p>There are also additional features:</p>\n<ul>\n<li>Ability to provide a list of your own passwords to check AD users against. This allows you to check user passwords against passwords relevant to your organisation that you suspect people might be using. These are NTLM hashed, and AD hashes are then compared with this as well as the HIBP hashes.</li>\n<li>Return a list of accounts using the same passwords. Useful for finding users using the same password for their administrative and standard accounts.</li>\n</ul>\n<p>More information about Lil Pwny can be found <a href=\"https://papermtn.co.uk/\" rel=\"nofollow\">on my blog</a></p>\n<h2>Recommendations</h2>\n<p>This application was developed to ideally run on high resource infrastructure to make the most of Python multiprocessing. It will run on desktop level hardware, but the more cores you use, the faster the audit will run.</p>\n<h2>Installation</h2>\n<p>Install via pip</p>\n<pre>pip install lil-pwny\n</pre>\n<h2>Usage</h2>\n<p>Lil-pwny will be installed as a global command, use as follows:</p>\n<pre>usage: lil-pwny <span class=\"o\">[</span>-h<span class=\"o\">]</span> -hibp HIBP <span class=\"o\">[</span>-a A<span class=\"o\">]</span> -ad AD_HASHES <span class=\"o\">[</span>-d<span class=\"o\">]</span> <span class=\"o\">[</span>-m<span class=\"o\">]</span> <span class=\"o\">[</span>-o OUTPUT<span class=\"o\">]</span>\n\noptional arguments:\n  -hibp, --hibp-path    The HIBP .txt file of NTLM hashes\n  -a, --a               .txt file containing additional passwords to check <span class=\"k\">for</span>\n  -ad, --ad-hashes      The NTLM hashes from of AD users\n  -d, --find-duplicates Output a list of duplicate password users\n  -m, --memory          Load HIBP <span class=\"nb\">hash</span> list into memory <span class=\"o\">(</span>over 24GB RAM\n                        required<span class=\"o\">)</span>\n  -o, --out-path        Set output path. Uses working dir when not <span class=\"nb\">set</span>\n</pre>\n<p>Example:</p>\n<pre>lil-pwny -hibp ~/hibp_hashes.txt -ad ~/ad_ntlm_hashes.txt -a ~/additional_passwords.txt -o ~/Desktop/Output -m -d\n</pre>\n<p>use of the <code>-m</code> flag will load the HIBP hashes into memory, which will allow for faster searching. Note this will require at least 24GB of available memory.</p>\n<h2>Getting input files</h2>\n<h3>Step 1: Get an IFM AD database dump</h3>\n<p>On a domain controller use <code>ntdsutil</code> to generate an IFM dump of your AD domain. Run the following in an elevated PowerShell window:</p>\n<pre>ntdsutil\nactivate instance ntds\nifm\ncreate full **output path**\n</pre>\n<h3>Step 2: Recover NTLM hashes from this output</h3>\n<p>To recover the NTLM hashes from the AD IFM data, the Powershell module <a href=\"https://github.com/MichaelGrafnetter/DSInternals\" rel=\"nofollow\">DSInternals</a> is required.</p>\n<p>Once installed, use the SYSTEM hive in the IFM data to recover the hashes in the format <code>usernme:hash</code> and save them to the file <code>ad_ntlm_hashes.txt</code></p>\n<pre><span class=\"nv\">$bootKey</span> <span class=\"o\">=</span> Get-BootKey -SystemHivePath <span class=\"s1\">'.\\registry\\SYSTEM'</span>\nGet-ADDBAccount -All -DBPath <span class=\"s1\">'.\\Active Directory\\ntds.dit'</span> -BootKey <span class=\"nv\">$bootKey</span> <span class=\"p\">|</span> Format-Custom -View HashcatNT <span class=\"p\">|</span> Out-File ad_ntlm_hashes.txt -Encoding ASCII\n</pre>\n<h3>Step 3: Download the latest HIBP hash file</h3>\n<p>The file can be downloaded from <a href=\"https://downloads.pwnedpasswords.com/passwords/pwned-passwords-ntlm-ordered-by-count-v5.7z\" rel=\"nofollow\">here</a></p>\n<p>The latest version of the hash file contains around 551 million hashes.</p>\n<h2>Resources</h2>\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732530(v=ws.11)\" rel=\"nofollow\">ntdsutil &amp; IFM</a></li>\n</ul>\n\n          </div>"}, "last_serial": 6860963, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "cae9e8fe08d429da2046284178515402", "sha256": "1d4d784fabe8dfb67d15954b264dd564615714f1f0f81bef5de58eff358de655"}, "downloads": -1, "filename": "lil_pwny-1.0.0-py2.7.egg", "has_sig": false, "md5_digest": "cae9e8fe08d429da2046284178515402", "packagetype": "bdist_egg", "python_version": "2.7", "requires_python": null, "size": 10768, "upload_time": "2020-01-12T20:02:47", "upload_time_iso_8601": "2020-01-12T20:02:47.505275Z", "url": "https://files.pythonhosted.org/packages/45/8a/f18b1db58ead9256199a0c029939a3496b193b50753f74ba069bb162cef8/lil_pwny-1.0.0-py2.7.egg", "yanked": false}, {"comment_text": "", "digests": {"md5": "48eaa62422e8d7ba4c436921ef16c926", "sha256": "9dda4da4c405875c78c678be5cef085c9c5c5c980f77b64c67a9c2b5c9dd604a"}, "downloads": -1, "filename": "lil_pwny-1.0.0-py2-none-any.whl", "has_sig": false, "md5_digest": "48eaa62422e8d7ba4c436921ef16c926", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 17286, "upload_time": "2020-01-12T20:02:43", "upload_time_iso_8601": "2020-01-12T20:02:43.181910Z", "url": "https://files.pythonhosted.org/packages/b4/66/ed3bc42370f3f0f877501d55ee9ef5ab9a6f0ec1620fce35f4ecc6aaee42/lil_pwny-1.0.0-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "422aa4acddb8bf82da9228d30287ce05", "sha256": "fb46fc4d2011130b16cfbb3b9ca80c57cfd92ab943ea7c4fc8a518270caa0c3f"}, "downloads": -1, "filename": "lil_pwny-1.0.0-py3.7.egg", "has_sig": false, "md5_digest": "422aa4acddb8bf82da9228d30287ce05", "packagetype": "bdist_egg", "python_version": "3.7", "requires_python": null, "size": 10857, "upload_time": "2020-01-12T20:02:48", "upload_time_iso_8601": "2020-01-12T20:02:48.984548Z", "url": "https://files.pythonhosted.org/packages/3b/ec/44656bab38e4f6b4446b845e49177d6476cb6b3265dde7c6e7927e22e95e/lil_pwny-1.0.0-py3.7.egg", "yanked": false}, {"comment_text": "", "digests": {"md5": "cbdb013f1f30465de0db2d62e415630e", "sha256": "55d1e1f36ba84becdeb2e09ae67e42e1b45588f2ccab9cbbcc31ffb7564ee1ed"}, "downloads": -1, "filename": "lil-pwny-1.0.0.tar.gz", "has_sig": false, "md5_digest": "cbdb013f1f30465de0db2d62e415630e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5285, "upload_time": "2020-01-12T20:02:45", "upload_time_iso_8601": "2020-01-12T20:02:45.861091Z", "url": "https://files.pythonhosted.org/packages/2b/d1/eeb4b524d4ce2249e9363245de97ac2d827786c2e676b2ccdac3df675780/lil-pwny-1.0.0.tar.gz", "yanked": false}], "1.0.1": [{"comment_text": "", "digests": {"md5": "f6050c83d4e4610c109098cf5bf08c7e", "sha256": "adced62ebb049c5a391caf4410066838fda1a773527f9126441e6f93ff77eae1"}, "downloads": -1, "filename": "lil_pwny-1.0.1-py2-none-any.whl", "has_sig": false, "md5_digest": "f6050c83d4e4610c109098cf5bf08c7e", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 18930, "upload_time": "2020-01-12T20:52:02", "upload_time_iso_8601": "2020-01-12T20:52:02.329364Z", "url": "https://files.pythonhosted.org/packages/e9/0c/398baaa600d1122e636fcbf7a72eee93dc0aacf1a2dc9932a96a09483172/lil_pwny-1.0.1-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "2d84e39911f655d2d9170275a935ca15", "sha256": "19e99f7a1d7b4dbbcbde5992afa7635f686b8473f603b74394c00e967ec3c665"}, "downloads": -1, "filename": "lil-pwny-1.0.1.tar.gz", "has_sig": false, "md5_digest": "2d84e39911f655d2d9170275a935ca15", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5715, "upload_time": "2020-01-12T20:52:03", "upload_time_iso_8601": "2020-01-12T20:52:03.641219Z", "url": "https://files.pythonhosted.org/packages/70/cd/4bf67f95acfb237e42cee016c90d305e00c0956cf8a4f2f3bf863f5bda7b/lil-pwny-1.0.1.tar.gz", "yanked": false}], "1.0.2": [{"comment_text": "", "digests": {"md5": "e63e9be8641d69094990fe32a721c6b9", "sha256": "2673916a91540455874345093804117966cd2007a5b60adbbc4c9fd9660a4e8b"}, "downloads": -1, "filename": "lil_pwny-1.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "e63e9be8641d69094990fe32a721c6b9", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 18992, "upload_time": "2020-03-22T17:20:18", "upload_time_iso_8601": "2020-03-22T17:20:18.485574Z", "url": "https://files.pythonhosted.org/packages/81/9d/21bba4e7337b4760ca9259ff2f808e00547a2beaa8fa87cb20cde03e9d55/lil_pwny-1.0.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "0b3a7d5475e7e0e60dfba1315dfaacd1", "sha256": "29cb48213f83ba0fd9e51678d53d8091f4caf2eff5c9ee6803fb00c344224e42"}, "downloads": -1, "filename": "lil-pwny-1.0.2.tar.gz", "has_sig": false, "md5_digest": "0b3a7d5475e7e0e60dfba1315dfaacd1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5781, "upload_time": "2020-03-22T17:20:20", "upload_time_iso_8601": "2020-03-22T17:20:20.200310Z", "url": "https://files.pythonhosted.org/packages/16/a2/4b1789db90f1a9dd5e0801286b19be6a8a2347689482a75f62a39fe77e66/lil-pwny-1.0.2.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "e63e9be8641d69094990fe32a721c6b9", "sha256": "2673916a91540455874345093804117966cd2007a5b60adbbc4c9fd9660a4e8b"}, "downloads": -1, "filename": "lil_pwny-1.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "e63e9be8641d69094990fe32a721c6b9", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 18992, "upload_time": "2020-03-22T17:20:18", "upload_time_iso_8601": "2020-03-22T17:20:18.485574Z", "url": "https://files.pythonhosted.org/packages/81/9d/21bba4e7337b4760ca9259ff2f808e00547a2beaa8fa87cb20cde03e9d55/lil_pwny-1.0.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "0b3a7d5475e7e0e60dfba1315dfaacd1", "sha256": "29cb48213f83ba0fd9e51678d53d8091f4caf2eff5c9ee6803fb00c344224e42"}, "downloads": -1, "filename": "lil-pwny-1.0.2.tar.gz", "has_sig": false, "md5_digest": "0b3a7d5475e7e0e60dfba1315dfaacd1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5781, "upload_time": "2020-03-22T17:20:20", "upload_time_iso_8601": "2020-03-22T17:20:20.200310Z", "url": "https://files.pythonhosted.org/packages/16/a2/4b1789db90f1a9dd5e0801286b19be6a8a2347689482a75f62a39fe77e66/lil-pwny-1.0.2.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:45:55 2020"}