{"info": {"author": "Oleg Avdeev", "author_email": "feedback@instaguide.io", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Topic :: Utilities"], "description": "# GetBox\n\n#### \"playground\" instance manager\n\nIn a nutshell:\n* One-click launch ec2 spot instances and attach EBS volumes to them\n\n* Instances and volumes will be properly tagged with your team and **your** name.\n\n## Installation:\n\n### From pypi\n\n```bash\npip3 install getbox\n```\n\n### Manual\n\nThe only dependency is `boto3`, you probably already have it. If not you can install it using `pip install boto3` . After that do:\n\n```bash\npython3 getbox install\n```\n\nThat will install the binary to `/usr/local/bin` and will try to install bash completions as well.\n\n### Authentication\n\nIt assumes you have ssh key pair used to access EC2 instances in your ssh agent.\n\nYou'll need AWS creds. If you have used awscli on your machine before, you should be good. If not, install awscli and run `aws configure`.\n\n### Permissions\n\n`getbox` requires a few permissions to launch and terminate instances.\n\nExample IAM policy:\n\n```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n       {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:AttachVolume\",\n                \"ec2:CancelSpotInstanceRequests\",\n                \"ec2:CreateTags\",\n                \"ec2:DeleteVolume\",\n                \"ec2:DescribeInstances\",\n                \"ec2:DescribeKeyPairs\",\n                \"ec2:DescribeSpotInstanceRequests\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeVolumes\",\n                \"ec2:ModifyInstanceAttribute\",\n                \"ec2:RequestSpotInstances\",\n                \"ec2:RunInstances\",\n                \"ec2:TerminateInstances\"\n            ],\n            \"Resource\": [\n                \"*\"\n            ]\n        }\n    ]\n}\n```\n\n## Magic\n\nLaziest way ever to get an instance in one command:\n\n```console\n$ getbox get\n<..a minute later..>\n[ubuntu@ip-172-18-142-171 ~]$\n```\n\nYou get an ubuntu 17.04 linux box in `us-west-2`. It will have a 100GB EBS drive mounted at `/mnt`.\n\nBy default, EBS drive will be deleted when instance is terminated. You can change that behavior using `getbox keep` command or you can combine that `getbox get r3.4xlarge keep`. Remember that your spot instance can be terminated by Amazon at any time.\n\n## Usage:\n\nSince it will tag instances will your unix user name, don't run it as root or in a container.\n\n```\n                      Usage: getbox <cmd> [parameters]\nget          Get an ec2 instance and ssh into it.                          getbox get r3.8xlarge\n             ...optionally, pass EBS volume id to attach.                  getbox get vol-321\n             ...or both                                                    getbox get r3.8xlarge vol-321\n             ...you can also name it                                       getbox get r3.8xlarge --name mytestbox\n             ...or specify EBS volume size                                 getbox get r3.8xlarge 200GB\nlist         List your instances and volumes                               getbox list\nkill         Kill an instance or (unattached) volume                       getbox kill 123\n                                                                           getbox kill vol-456\nssh          Log into the instance (uses utility1 key)                     getbox ssh 123\nkeep         Disable delete-on-termination on an attached EBS volume       getbox keep vol-123\nunkeep       Enable delete-on-termination on an attached EBS volume        getbox unkeep vol-123\ninstall      Install getbox to /usr/local/bin and add bash autocomplete    getbox install\n```\n\n\n\n`getbox ssh <instance-id>` is a bit magic; if used from interactive console, it will just log you in. But if it detects that its output was redirected, it will return user@host string. That allows you to use custom ssh flags or rsync/scp like this: `rsync -av . $(getbox ssh):`\n\nAlso, when starting an instance with an existing EBS drive using `getbox get vol-123141` if you don't specify instance type explicitly, `getbox` will automatically choose the instance type that was last used with that EBS volume.\n\n\n## Instances with ephemeral drives\n\nEphemeral drives often provide much better performance in terms of iops and latency than EBS. With `getbox`, you have two options: either mount ephemeral drives as a separate \"scratch\" volume, or automatically mirror data both to EBS and ephemeral drives, so it survives instance termination.\n\n##### 1. Use ephemeral drives as a scratch store\n![Ephemeral drives as scratch](getbox_scratch.png)\n\nEBS will be mounted at `/mnt` and ephemeral drives will be mounted as one RAID-0 lvm voume under `/scratch`.  You will lose everything under `/scratch` when instance gets terminated.\n\n##### 2. Use ephemeral drives as a mirror\n![Ephemeral drives as mirror](getbox_mirror.png)\n\nIn this mode, toggled by `--mirror` flag, `getbox` creates a RAID volume so that all writes go **both** to ephemeral drives as well as EBS volume. It is set up so that reads only go to the ephemeral drive when possible, so you get random read performance closest to that of the ephemeral drive and write performance of the slowest of two, and you don't lose the data when instance terminates.\n\nYou get both the (read) performance and persistence!\n\nThere are a couple caveats:\n\n* You cannot choose EBS volume size in this mode; it will be automatically choosen to match ephemeral storage, that depends on the instance type.\n* Currently you can only reuse mirrored EBS volume with the same instance type (since ephemeral drives size has to match EBS size).  `getbox` remembers what instance type was used, so you can just run `getbox get <volume-id>` and it will start an instance of the same type and will reassemble RAID array.\n* When first launching the instance in this mode, it will require 10-50 minutes to resync the RAID array; you can use the instance during resync, but read performance will be that of EBS. You can check status of resync by using `mdadm --detail /dev/md0`.\n* Remember that you still need to do `getbox keep` to keep the EBS drive around when instance terminates.\n\n\n## Configuration\n\nYou can customize some of `getbox` default parameters using JSON config file in your home dir named `.getbox`.\n\n| Name          | Description   | Default |\n| ------------- |---------------|--------|\n| `extra_tags`    | Tags to assign to ec2 instance and EBS drive | |\n| `owner_tag_name` | `getbox` also tags your instances with your username, this is the name of the tag | `\"owner\"` |\n| `ssh_user` | Linux username used to ssh into instances      |    `\"ubuntu\"` |\n| `ssh_key_name` | Name of ssh keypair to use when creating an instance      |    `\"utility1\"` |\n| `ssh_wait_timeout_seconds` | Timeout when trying to connect to a newly created instance      |    `600` |\n| `ssh_flags` | Flags to use with ssh command for `getbox ssh`      |    `\"-A\"` |\n| `root_size_gb` | Default size of the root EBS drive (GiB)      |    `30` |\n| `ami_id` | EC2 AMI id to use      |    `\"ami-790ec601\"` |\n| `cuda_ami_id` | EC2 AMI id to use with GPU-enabled instances (can be null, then `ami_id` is used)      |    `\"ami-a1e534d9\"` |\n| `iam_role_arn` | EC2 IAM role arn to use for instance profile      |     |\n| `security_groups` | A list of security group ids to use      |    |\n| `subnets` | A list of subnets to use      |   |\n| `spot_price` | Spot price | `\"3.00\"`\n| `extra_init_commands` | A list of additional commands to execute on instance initialization |  |", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/oavdeev/getbox", "keywords": "ec2 aws spot ssh", "license": "MIT license", "maintainer": "", "maintainer_email": "", "name": "getbox", "package_url": "https://pypi.org/project/getbox/", "platform": "", "project_url": "https://pypi.org/project/getbox/", "project_urls": {"Homepage": "https://github.com/oavdeev/getbox"}, "release_url": "https://pypi.org/project/getbox/0.8.0/", "requires_dist": null, "requires_python": "", "summary": "Spot instance managing tool for AWS EC2", "version": "0.8.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>GetBox</h1>\n<h4>\"playground\" instance manager</h4>\n<p>In a nutshell:</p>\n<ul>\n<li>\n<p>One-click launch ec2 spot instances and attach EBS volumes to them</p>\n</li>\n<li>\n<p>Instances and volumes will be properly tagged with your team and <strong>your</strong> name.</p>\n</li>\n</ul>\n<h2>Installation:</h2>\n<h3>From pypi</h3>\n<pre>pip3 install getbox\n</pre>\n<h3>Manual</h3>\n<p>The only dependency is <code>boto3</code>, you probably already have it. If not you can install it using <code>pip install boto3</code> . After that do:</p>\n<pre>python3 getbox install\n</pre>\n<p>That will install the binary to <code>/usr/local/bin</code> and will try to install bash completions as well.</p>\n<h3>Authentication</h3>\n<p>It assumes you have ssh key pair used to access EC2 instances in your ssh agent.</p>\n<p>You'll need AWS creds. If you have used awscli on your machine before, you should be good. If not, install awscli and run <code>aws configure</code>.</p>\n<h3>Permissions</h3>\n<p><code>getbox</code> requires a few permissions to launch and terminate instances.</p>\n<p>Example IAM policy:</p>\n<pre><span class=\"p\">{</span>\n    <span class=\"nt\">\"Version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2012-10-17\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"Statement\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n       <span class=\"p\">{</span>\n            <span class=\"nt\">\"Effect\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Allow\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"Action\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"s2\">\"ec2:AttachVolume\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:CancelSpotInstanceRequests\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:CreateTags\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DeleteVolume\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DescribeInstances\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DescribeKeyPairs\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DescribeSpotInstanceRequests\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DescribeSubnets\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:DescribeVolumes\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:ModifyInstanceAttribute\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:RequestSpotInstances\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:RunInstances\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"ec2:TerminateInstances\"</span>\n            <span class=\"p\">],</span>\n            <span class=\"nt\">\"Resource\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"s2\">\"*\"</span>\n            <span class=\"p\">]</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre>\n<h2>Magic</h2>\n<p>Laziest way ever to get an instance in one command:</p>\n<pre><span class=\"gp\">$</span> getbox get\n<span class=\"go\">&lt;..a minute later..&gt;</span>\n<span class=\"gp\">[ubuntu@ip-172-18-142-171 ~]$</span>\n</pre>\n<p>You get an ubuntu 17.04 linux box in <code>us-west-2</code>. It will have a 100GB EBS drive mounted at <code>/mnt</code>.</p>\n<p>By default, EBS drive will be deleted when instance is terminated. You can change that behavior using <code>getbox keep</code> command or you can combine that <code>getbox get r3.4xlarge keep</code>. Remember that your spot instance can be terminated by Amazon at any time.</p>\n<h2>Usage:</h2>\n<p>Since it will tag instances will your unix user name, don't run it as root or in a container.</p>\n<pre><code>                      Usage: getbox &lt;cmd&gt; [parameters]\nget          Get an ec2 instance and ssh into it.                          getbox get r3.8xlarge\n             ...optionally, pass EBS volume id to attach.                  getbox get vol-321\n             ...or both                                                    getbox get r3.8xlarge vol-321\n             ...you can also name it                                       getbox get r3.8xlarge --name mytestbox\n             ...or specify EBS volume size                                 getbox get r3.8xlarge 200GB\nlist         List your instances and volumes                               getbox list\nkill         Kill an instance or (unattached) volume                       getbox kill 123\n                                                                           getbox kill vol-456\nssh          Log into the instance (uses utility1 key)                     getbox ssh 123\nkeep         Disable delete-on-termination on an attached EBS volume       getbox keep vol-123\nunkeep       Enable delete-on-termination on an attached EBS volume        getbox unkeep vol-123\ninstall      Install getbox to /usr/local/bin and add bash autocomplete    getbox install\n</code></pre>\n<p><code>getbox ssh &lt;instance-id&gt;</code> is a bit magic; if used from interactive console, it will just log you in. But if it detects that its output was redirected, it will return user@host string. That allows you to use custom ssh flags or rsync/scp like this: <code>rsync -av . $(getbox ssh):</code></p>\n<p>Also, when starting an instance with an existing EBS drive using <code>getbox get vol-123141</code> if you don't specify instance type explicitly, <code>getbox</code> will automatically choose the instance type that was last used with that EBS volume.</p>\n<h2>Instances with ephemeral drives</h2>\n<p>Ephemeral drives often provide much better performance in terms of iops and latency than EBS. With <code>getbox</code>, you have two options: either mount ephemeral drives as a separate \"scratch\" volume, or automatically mirror data both to EBS and ephemeral drives, so it survives instance termination.</p>\n<h5>1. Use ephemeral drives as a scratch store</h5>\n<p><img alt=\"Ephemeral drives as scratch\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/1d5f7f5fcb96da5f3fc6567c69609247d028438f/676574626f785f736372617463682e706e67\"></p>\n<p>EBS will be mounted at <code>/mnt</code> and ephemeral drives will be mounted as one RAID-0 lvm voume under <code>/scratch</code>.  You will lose everything under <code>/scratch</code> when instance gets terminated.</p>\n<h5>2. Use ephemeral drives as a mirror</h5>\n<p><img alt=\"Ephemeral drives as mirror\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ed50fd194cdc332ace1f9c1b77bcb5c5ee589beb/676574626f785f6d6972726f722e706e67\"></p>\n<p>In this mode, toggled by <code>--mirror</code> flag, <code>getbox</code> creates a RAID volume so that all writes go <strong>both</strong> to ephemeral drives as well as EBS volume. It is set up so that reads only go to the ephemeral drive when possible, so you get random read performance closest to that of the ephemeral drive and write performance of the slowest of two, and you don't lose the data when instance terminates.</p>\n<p>You get both the (read) performance and persistence!</p>\n<p>There are a couple caveats:</p>\n<ul>\n<li>You cannot choose EBS volume size in this mode; it will be automatically choosen to match ephemeral storage, that depends on the instance type.</li>\n<li>Currently you can only reuse mirrored EBS volume with the same instance type (since ephemeral drives size has to match EBS size).  <code>getbox</code> remembers what instance type was used, so you can just run <code>getbox get &lt;volume-id&gt;</code> and it will start an instance of the same type and will reassemble RAID array.</li>\n<li>When first launching the instance in this mode, it will require 10-50 minutes to resync the RAID array; you can use the instance during resync, but read performance will be that of EBS. You can check status of resync by using <code>mdadm --detail /dev/md0</code>.</li>\n<li>Remember that you still need to do <code>getbox keep</code> to keep the EBS drive around when instance terminates.</li>\n</ul>\n<h2>Configuration</h2>\n<p>You can customize some of <code>getbox</code> default parameters using JSON config file in your home dir named <code>.getbox</code>.</p>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Description</th>\n<th>Default</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>extra_tags</code></td>\n<td>Tags to assign to ec2 instance and EBS drive</td>\n<td></td>\n</tr>\n<tr>\n<td><code>owner_tag_name</code></td>\n<td><code>getbox</code> also tags your instances with your username, this is the name of the tag</td>\n<td><code>\"owner\"</code></td>\n</tr>\n<tr>\n<td><code>ssh_user</code></td>\n<td>Linux username used to ssh into instances</td>\n<td><code>\"ubuntu\"</code></td>\n</tr>\n<tr>\n<td><code>ssh_key_name</code></td>\n<td>Name of ssh keypair to use when creating an instance</td>\n<td><code>\"utility1\"</code></td>\n</tr>\n<tr>\n<td><code>ssh_wait_timeout_seconds</code></td>\n<td>Timeout when trying to connect to a newly created instance</td>\n<td><code>600</code></td>\n</tr>\n<tr>\n<td><code>ssh_flags</code></td>\n<td>Flags to use with ssh command for <code>getbox ssh</code></td>\n<td><code>\"-A\"</code></td>\n</tr>\n<tr>\n<td><code>root_size_gb</code></td>\n<td>Default size of the root EBS drive (GiB)</td>\n<td><code>30</code></td>\n</tr>\n<tr>\n<td><code>ami_id</code></td>\n<td>EC2 AMI id to use</td>\n<td><code>\"ami-790ec601\"</code></td>\n</tr>\n<tr>\n<td><code>cuda_ami_id</code></td>\n<td>EC2 AMI id to use with GPU-enabled instances (can be null, then <code>ami_id</code> is used)</td>\n<td><code>\"ami-a1e534d9\"</code></td>\n</tr>\n<tr>\n<td><code>iam_role_arn</code></td>\n<td>EC2 IAM role arn to use for instance profile</td>\n<td></td>\n</tr>\n<tr>\n<td><code>security_groups</code></td>\n<td>A list of security group ids to use</td>\n<td></td>\n</tr>\n<tr>\n<td><code>subnets</code></td>\n<td>A list of subnets to use</td>\n<td></td>\n</tr>\n<tr>\n<td><code>spot_price</code></td>\n<td>Spot price</td>\n<td><code>\"3.00\"</code></td>\n</tr>\n<tr>\n<td><code>extra_init_commands</code></td>\n<td>A list of additional commands to execute on instance initialization</td>\n<td></td>\n</tr></tbody></table>\n\n          </div>"}, "last_serial": 4937485, "releases": {"0.7.4": [{"comment_text": "", "digests": {"md5": "cb473c12066a4053d8438e6768cab97a", "sha256": "d2d782f1bf2b34071d817227e48bb56d780296888f4d049700969b4fa80543b5"}, "downloads": -1, "filename": "getbox-0.7.4.tar.gz", "has_sig": false, "md5_digest": "cb473c12066a4053d8438e6768cab97a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 16814, "upload_time": "2018-08-03T02:28:01", "upload_time_iso_8601": "2018-08-03T02:28:01.985941Z", "url": "https://files.pythonhosted.org/packages/2a/3a/59199e934656cc0f1ad78a16e367cb2c30b1605d1bcdd3f6d2384d331227/getbox-0.7.4.tar.gz", "yanked": false}], "0.7.5": [{"comment_text": "", "digests": {"md5": "0a957ae42756c8dfc68e10382019909c", "sha256": "02fc76ad302ffe6ede995ef5d6b6362011b336f281fee37246cafa145dfc588f"}, "downloads": -1, "filename": "getbox-0.7.5.tar.gz", "has_sig": false, "md5_digest": "0a957ae42756c8dfc68e10382019909c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 16893, "upload_time": "2018-08-03T02:29:52", "upload_time_iso_8601": "2018-08-03T02:29:52.769710Z", "url": "https://files.pythonhosted.org/packages/f2/bd/778a0445c9c0d84ef1e2e4e547d364988690d1eec16d6516916a1e753355/getbox-0.7.5.tar.gz", "yanked": false}], "0.7.6": [{"comment_text": "", "digests": {"md5": "bacbd8140d21d296641567febac50b3f", "sha256": "af80c69ebf0f65fd3aa8f70d32c82c227ddd591a77a29ecf04e80e28a5eeaa31"}, "downloads": -1, "filename": "getbox-0.7.6.tar.gz", "has_sig": false, "md5_digest": "bacbd8140d21d296641567febac50b3f", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 16924, "upload_time": "2018-08-03T03:00:38", "upload_time_iso_8601": "2018-08-03T03:00:38.579087Z", "url": "https://files.pythonhosted.org/packages/d2/a6/4aa0b3867a256c30c6b340a63fe7d624a1e9df7f262246c8dc381dde5874/getbox-0.7.6.tar.gz", "yanked": false}], "0.7.7": [{"comment_text": "", "digests": {"md5": "360e829b0388e57f982f96f2dadf9929", "sha256": "5a26c9d130a458cca41415796ed0963c464d4adde8f0475b83d06ff33a70a2b5"}, "downloads": -1, "filename": "getbox-0.7.7.tar.gz", "has_sig": false, "md5_digest": "360e829b0388e57f982f96f2dadf9929", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 17591, "upload_time": "2019-01-13T23:03:00", "upload_time_iso_8601": "2019-01-13T23:03:00.958794Z", "url": "https://files.pythonhosted.org/packages/de/fc/4d4e69403eae5641217a4f0dd48b5b4c67e200b834f596ae0e87a1517533/getbox-0.7.7.tar.gz", "yanked": false}], "0.8.0": [{"comment_text": "", "digests": {"md5": "82cd071354b78325adf05d88a862dcb7", "sha256": "3a81bd6a9d5ce1ae3698026519bca9f6fca70460a7bd6687a0975043bdefd4b2"}, "downloads": -1, "filename": "getbox-0.8.0.tar.gz", "has_sig": false, "md5_digest": "82cd071354b78325adf05d88a862dcb7", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18110, "upload_time": "2019-03-14T03:02:31", "upload_time_iso_8601": "2019-03-14T03:02:31.520256Z", "url": "https://files.pythonhosted.org/packages/cd/a1/a31991143b2e6494d259062becf2065b7973922b56b307a0631c5ad20b0a/getbox-0.8.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "82cd071354b78325adf05d88a862dcb7", "sha256": "3a81bd6a9d5ce1ae3698026519bca9f6fca70460a7bd6687a0975043bdefd4b2"}, "downloads": -1, "filename": "getbox-0.8.0.tar.gz", "has_sig": false, "md5_digest": "82cd071354b78325adf05d88a862dcb7", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18110, "upload_time": "2019-03-14T03:02:31", "upload_time_iso_8601": "2019-03-14T03:02:31.520256Z", "url": "https://files.pythonhosted.org/packages/cd/a1/a31991143b2e6494d259062becf2065b7973922b56b307a0631c5ad20b0a/getbox-0.8.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:57:50 2020"}