{"info": {"author": "Jordan Lab", "author_email": "pypi@atc.io", "bugtrack_url": null, "classifiers": ["Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3.5"], "description": "# stringMLST\n\nFast k-mer based tool for multi locus sequence typing (MLST)\nstringMLST is a tool for detecting the MLST of an isolate directly from the genome sequencing reads. stringMLST predicts the ST of an isolate in a completely assembly and alignment free manner. The tool is designed in a light-weight, platform-independent fashion with minimum dependencies.\n\nSome portions of the allele selection algorithm in stringMLST are patent\npending.  Please refer to the PATENTS file for additional inforamation\nregarding licencing and use.\n\n\nReference  \n*http://jordan.biology.gatech.edu/page/software/stringmlst/*\n\nAbstract  \n*http://bioinformatics.oxfordjournals.org/content/early/2016/09/06/bioinformatics.btw586.short?rss=1*\n\nApplication Note  \n*http://bioinformatics.oxfordjournals.org/content/early/2016/09/06/bioinformatics.btw586.full.pdf+html*\n\n[![install with bioconda](https://img.shields.io/badge/install%20with-bioconda-brightgreen.svg?style=flat-square)](http://bioconda.github.io/recipes/stringmlst/README.html)  [![PyPI version](https://badge.fury.io/py/stringMLST.svg)](https://badge.fury.io/py/stringMLST)  ![downloads](https://img.shields.io/conda/dn/bioconda/stringmlst.svg?style=flat) [![container ready](https://quay.io/repository/biocontainers/stringmlst/status)](https://quay.io/repository/biocontainers/stringmlst)\n\n\n\n**stringMLST is a *tool* not a *database*, always use the most up-to-date database files as possible.** To facilitate\nkeeping your databases updated, stringMLST can download and build databases from pubMLST using the most recent allele\nand profile definitions. Please see the \"Included databases and automated retrieval of databases from pubMLST\" section\nbelow for instructions. *The databases bundled here are for convenience only, do not rely on them being up-to-date*.\n\nstringMLST is licensed and distributed under [CC Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0)  \nand is free for academic users and requires permission before any commercial use for any version of this code/algorithm.  \nIf you are a commercial user, please contact king.jordan@biology.gatech.edu for permissions\n\n## Recommended installation method\n\n```\npip install stringMLST\n\n```\n\n#### Installation via git (Not recommended for most users)\n\n```\ngit clone https://github.com/jordanlab/stringMLST\n# Optional, download prebuilt databases  \n# We don't recommend this method, instead build the databases locally\ncd stringMLST\ngit submodule init\ngit submodule update\n```\n\n## Quickstart guide\n\n```bash  \npip install stringMLST  \nmkdir -p stringMLST_analysis; cd stringMLST_analysis  \nstringMLST.py --getMLST -P neisseria/nmb --species neisseria  \n# Download all available databases with:  \n# stringMLST.py --getMLST -P mlst_dbs --species all    \nwget  ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR026/ERR026529/ERR026529_1.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR026/ERR026529/ERR026529_2.fastq.gz  \nstringMLST.py --predict -P neisseria/nmb -1 ERR026529_1.fastq.gz -2 ERR026529_2.fastq.gz\nSample  abcZ    adk     aroE    fumC    gdh     pdhC    pgm     ST\nERR026529       231     180     306     612     269     277     260     10174\n\n```\n\n## Python dependencies and external programs\n\nstringMLST does not require any python dependencies for basic usage (Building databases and predicting STs). \n\nFor advanced used (genome coverage), stringMLST depends on the `pyfaidx` python module and `bamtools`, `bwa`, and `samtools`.  \nSee the coverage section for more information\n\nstringMLST has been tested with:\n```\npyfaidx: 0.4.8.1\nsamtools: 1.3 (Using htslib 1.3.1)  [Requires the 1.x branch of samtools]\nbedtools: v2.24.0\nbwa: 0.7.13-r1126\n```\n\n### To install the dependencies\n\n```bash\n# pyfaidx\npip install --user pyfaidx\n# samtools\nwget https://github.com/samtools/samtools/releases/download/1.3.1/samtools-1.3.1.tar.bz2 -o samtools-1.3.1.tar.bz2\ntar xf samtools-1.3.1.tar.bz2\ncd samtools-1.3.1.tar\nmake\nmake prefix=$HOME install\n# bedtools\nwget https://github.com/arq5x/bedtools2/releases/download/v2.25.0/bedtools-2.25.0.tar.gz\ntar -zxvf bedtools-2.25.0.tar.gz\ncd bedtools2; make\ncp ./bin/* ~/bin\n# bwa\ngit clone https://github.com/lh3/bwa.git\ncd bwa; make\ncp bwa ~/bin/bwa\nexport PATH=$PATH:$HOME/bin\n```\n\n\n## Usage for Example Read Files (Neisseria meningitidis)\n\n* Download stringMLST.py, example read files (ERR026529, ERR027250, ERR036104) and the dataset for Neisseria meningitidis (Neisseria_spp.zip).\n### Build database:\n\n```\n# Add dir to path\nexport PATH=$PATH:$PWD\n# Will connect to EBI's SRA servers\ndownload_example_reads.sh\n````\n\n* Extract the MLST loci dataset.\n\n```\nunzip datasets/Neisseria_spp.zip -d datasets\n```\n\n* Create or use a config file specifying the location of all the locus and profile files.\nExample config file (Neisseria_spp/config.txt):\n\n```\n[loci]\nabcZ  datasets/Neisseria_spp/abcZ.fa\nadk datasets/Neisseria_spp/adk.fa\naroE  datasets/Neisseria_spp/aroE.fa\nfumC  datasets/Neisseria_spp/fumC.fa\ngdh datasets/Neisseria_spp/gdh.fa\npdhC  datasets/Neisseria_spp/pdhC.fa\npgm datasets/Neisseria_spp/pgm.fa\n[profile]\nprofile datasets/Neisseria_spp/neisseria.txt\n```\n\n* Run stringMLST.py --buildDB to create DB. Choose a k value and prefix (optional).\n\n```\nstringMLST.py --buildDB -c databases/Neisseria_spp/config.txt -k 35 -P NM \n```\n\n### Predict:\n\n#### Single sample :\n```\nstringMLST.py --predict -1 tests/fastqs/ERR026529_1.fastq -2 tests/fastqs/ERR026529_2.fastq -k 35 -P NM   \n```\n#### Batch mode (all the samples together):\n```\nstringMLST.py --predict -d ./tests/fastqs/ -k 35 -P NM  \n```\n#### List mode:\nCreate a list file (list_paired.txt) as :\n```\ntests/fastqs/ERR026529_1.fastq  tests/fastqs/ERR026529_2.fastq\ntests/fastqs/ERR027250_1.fastq  tests/fastqs/ERR027250_2.fastq\ntests/fastqs/ERR036104_1.fastq  tests/fastqs/ERR036104_2.fastq\n```\nRun the tool as:\n```\nstringMLST.py --predict -l list_paired.txt -k 35 -P NM\n```\n#### Working with gziped files\n```\nstringMLST.py --predict -1 tests/fastqs/ERR026529_1.fq.gz -2 tests/fastqs/ERR026529_2.fq.gz -p -P NM -k 35 -o ST_NM.txt\n```\n## Usage Documentation\n\nstringMLST's workflow is divided into two routines:\n* Database building and\n* ST discovery\n\n*Database building:* Builds the stringMLST database which is used for assigning STs to input sample files. This step is required once for each organism. Please note that stringMLST is capable of working on a custom user defined typing scheme but its efficiency has not been tested on other typing scheme.\n\n*ST discovery:* This routine takes the database created in the last step and predicts the ST of the input sample(s). Please note that the database building is required prior to this routine. stringMLST is capable of processing single-end and paired-end files. It can run in three modes:\n* Single sample mode - for running stringMLST on a single sample\n* Batch mode - for running stringMLST on all the FASTQ files present in a directory\n* List mode - for running stringMLST on all the FASTQ files provided in a list file\n\n\n```\nReadme for stringMLST\n=============================================================================================\nUsage\n./stringMLST.py \n[--buildDB]\n[--predict]\n[-1 filename_fastq1][--fastq1 filename_fastq1]\n[-2 filename_fastq2][--fastq2 filename_fastq2]\n[-d directory][--dir directory][--directory directory]\n[-l list_file][--list list_file]\n[-p][--paired]\n[-s][--single]\n[-c][--config]\n[-P][--prefix]\n[-z][--fuzzy]\n[-a]\n[-C][--coverage]\n[-k]\n[-o output_filename][--output output_filename]\n[-x][--overwrite]\n[-t]\n[-r]\n[-v]\n[-h][--help]\n==============================================================================================\n\nThere are two steps to predicting ST using stringMLST.\n1. Create DB : stringMLST.py --buildDB\n2. Predict : stringMLST --predict\n\n1. stringMLST.py --buildDB\n\nSynopsis:\nstringMLST.py --buildDB -c <config file> -k <kmer length(optional)> -P <DB prefix(optional)>\n  config file : is a tab delimited file which has the information for typing scheme ie loci, its multifasta file and profile definition file.\n    Format : \n      [loci]\n      locus1    locusFile1\n      locus2    locusFile2\n      [profile]\n      profile   profileFile\n  kmer length : is the kmer length for the db. Note, while processing this should be smaller than the read length.\n    We suggest kmer lengths of 35, 66 depending on the read length.\n  DB prefix(optional) : holds the information for DB files to be created and their location. This module creates 3 files with this prefix.\n    You can use a folder structure with prefix to store your db at particular location.\n\nRequired arguments\n--buildDB\n  Identifier for build db module\n-c,--config = <configuration file>\n  Config file in the format described above. \n  All the files follow the structure followed by pubmlst. Refer extended document for details. \n\nOptional arguments  \n-k = <kmer length>\n  Kmer size for which the db has to be formed(Default k = 35). Note the tool works best with kmer length in between 35 and 66\n  for read lengths of 55 to 150 bp. Kmer size can be increased accordingly. It is advised to keep lower kmer sizes \n  if the quality of reads is not very good.\n-P,--prefix = <prefix>\n  Prefix for db and log files to be created(Default = kmer). Also you can specify folder where you want the dbb to be created.\n-a\n        File location to write build log\n-h,--help\n  Prints the help manual for this application\n\n --------------------------------------------------------------------------------------------\n \n2. stringMLST.py --predict\n  \nstringMLST --predict : can run in three modes\n  1) single sample (default mode)\n  2) batch mode : run stringMLST for all the samples in a folder (for a particular specie)\n  3) list mode : run stringMLST on samples specified in a file\nstringMLST can process both single and paired end files. By default program expects paired end files.\n\nSynopsis\nstringMLST.py --predict -1 <fastq file> -2 <fastq file> -d <directory location> -l <list file> -p -s -P <DB prefix(optional)> -k <kmer length(optional)> -o <output file> -x\n\nRequired arguments\n--predict\n  Identifier for predict miodule\n  \nOptional arguments\n-1,--fastq1 = <fastq1_filename>\n  Path to first fastq file for paired end sample and path to the fastq file for single end file.\n  Should have extension fastq or fq.\n-2,--fastq2 = <fastq2_filename>\n  Path to second fastq file for paired end sample.\n  Should have extension fastq or fq.\n-d,--dir,--directory = <directory>\n  BATCH MODE : Location of all the samples for batch mode.\n-C,--coverage\n  Calculate seqence coverage for each allele. Turns on read generation (-r) and turns off fuzzy (-z 1)\n  Requires bwa, bamtools and samtools be in your path\n-k = <kmer_length>\n  Kmer length for which the db was created(Default k = 35). Could be verified by looking at the name of the db file. \n  Could be used if the reads are of very bad quality or have a lot of N's.\n-l,--list = <list_file>\n  LIST MODE : Location of list file and flag for list mode.\n  list file should have full file paths for all the samples/files.\n  Each sample takes one line. For paired end samples the 2 files should be tab separated on single line.\n-o,--output = <output_filename>\n  Prints the output to a file instead of stdio.\n-p,--paired\n  Flag for specifying paired end files. Default option so would work the same if you do not specify for all modes.\n  For batch mode the paired end samples should be differentiated by 1/2.fastq or 1/2.fq\n-P,--prefix = <prefix>\n  Prefix using which the db was created(Defaults = kmer). The location of the db could also be provided.\n-r\n  A seperate reads file is created which has all the reads covering all the locus.\n-s,--single\n  Flag for specifying single end files.\n-t\n  Time for each analysis will also be reported.\n-v\n  Prints the version of the software.\n-x,--overwrite\n  By default stringMLST appends the results to the output_filename if same name is used.\n  This argument overwrites the previously specified output file.\n-z,--fuzzy = <fuzzy threshold int>\n  Threshold for reporting a fuzzy match (Default=300). For higher coverage reads this threshold should be set higher to avoid\n  indicating fuzzy match when exact match was more likely. For lower coverage reads, threshold of <100 is recommended\n-h,--help\n  Prints the help manual for this application\n\n --------------------------------------------------------------------------------------------\n\n3. stringMLST.py --getMLST\n\nSynopsis:  \nstringMLST.py --getMLST --species= <species> [-k kmer length] [-P DB prefix]\n\nRequired arguments\n--getMLST\n    Identifier for getMLST module\n--species= <species name>\n    Species name from the pubMLST schemes (use --schemes to get list of available schemes)\n    \"all\" will download and build all \n\nOptional arguments\n-k = <kmer length>\n    Kmer size for which the db has to be formed(Default k = 35). Note the tool works best with kmer length in between 35 and 66\n    for read lengths of 55 to 150 bp. Kmer size can be increased accordingly. It is advised to keep lower kmer sizes\n    if the quality of reads is not very good.\n-P,--prefix = <prefix>\n    Prefix for db and log files to be created(Default = kmer). Also you can specify folder where you want the db to be created.\n    We recommend that prefix and config point to the same folder for cleanliness but this is not required\n--schemes\n    Display the list of available schemes\n-h,--help\n  Prints the help manual for this application\n\n```\n\n\n**stringMLST expects paired end reads to be in [Illumina naming convention](http://support.illumina.com/help/SequencingAnalysisWorkflow/Content/Vault/Informatics/Sequencing_Analysis/CASAVA/swSEQ_mCA_FASTQFiles.htm), minimally ending with _1.fq and _2.fq to delineate read1 and read2:**\n\n*Periods (.) are disallowed delimiters except for file extensions*\n\n```\nIllumina FASTQ files use the following naming scheme:\n\n<sample name>_<barcode sequence>_L<lane (0-padded to 3 digits)>_R<read number>_<set number (0-padded to 3 digits>.fastq.gz\n\nFor example, the following is a valid FASTQ file name:\n\nNA10831_ATCACG_L002_R1_001.fastq.gz\n```\n\n## Running stringMLST\n\n#### Included databases and automated retrieval of databases from pubMLST\n\nstringMLST includes all the pubMLST databases as of **February 15, 2017**, built with the default kmer (*35*). They can be found in the `datasets/` folder.  \nSimply unzip the databases you need and begin using stringMSLT as described below.\n\nAll the databases from pubMLST can be downloaded and prepared with your kmer choice\n\n*Getting all pubMLST schemes*  \n```\nstringMLST.py --getMLST -P datasets/ --species all\n```\n\n\nIndividual databases from pubMLST can also be downloaded as needed, using the scheme identifiers\n\n*Downloading a scheme*  \n```\n# List available schemes\nstringMLST.py --getMLST --schemes\n\n# Download the Neisseria spp. scheme\n\nstringMLST.py --getMLST -P datasets/nmb --species neisseria\n\n```\n\n\n\n#### Database Preparation\nIn order to create the database, files can be downloaded from the database page.\n\nIf the organism of interest is not present in the provided link, the required files can be downloaded from PubMLST as follows:\n* On your browser, navigate to http://pubmlst.org/\n* Navigate to \"Download MLST definitions\" link or go to http://pubmlst.org/data/\n* Scroll to the species of interest. For each species, user may find the file for typing definitions and multi-FASTA files for each locus. Download these files.\n\nE.g.:\n\nSpecies of interest: Neisseria spp.\nCorresponding definition file: http://pubmlst.org/data/profiles/neisseria.txt\nCorresponding multi fasta locus files: \nhttp://pubmlst.org/data/alleles/neisseria/abcZ.tfa\nhttp://pubmlst.org/data/alleles/neisseria/adk.tfa\nhttp://pubmlst.org/data/alleles/neisseria/aroE.tfa\nhttp://pubmlst.org/data/alleles/neisseria/fumC.tfa\nhttp://pubmlst.org/data/alleles/neisseria/gdh.tfa\nhttp://pubmlst.org/data/alleles/neisseria/pdhC.tfa\nhttp://pubmlst.org/data/alleles/neisseria/pgm.tfa\n\nDownload these files at a desired location.\n\n\nCustom user files can also be used for building database. The database building routine requires the profile definition file and allele sequence file. The profile definition file is a tab separated file that contains the ST and the allele profile corresponding to the ST. An example of the profile definition file is shown below:\n```\nST  abcZ  adk aroE  fumC  gdh pdhC  pgm clonal_complex\n1 1 3 1 1 1 1 3 ST-1 complex/subgroup I/II\n2 1 3 4 7 1 1 3 ST-1 complex/subgroup I/II\n3 1 3 1 1 1 23  13  ST-1 complex/subgroup I/II\n4 1 3 3 1 4 2 3 ST-4 complex/subgroup IV\n```\nThe allele sequence file is a standard multi-FASTA with the description being the loci name with the allele number. An example abcZ allele sequence is shown below:\n```\n>abcZ_1\nTTTGATACTGTTGCCGA...\n>abcZ_2\nTTTGATACCGTTGCCGA...\n>abcZ_3\nTTTGATACCGTTGCGAA...\n>abcZ_4\nTTTGATACCGTTGCCAA...\n```\n\nThese files can be obtained from PubMLST/BIGSdb or can be create by the user themselves. \n\nIn either case, an accompanying configuration file is also required to describe the profile definition and allele sequence files. An example configuration file is shown below:\n```\n[loci]\nabcZ  /data/home/stringMLST/pubmlst/Neisseria_sp/abcZ.fa\nadk /data/home/stringMLST/pubmlst/Neisseria_sp/adk.fa\naroE  /data/home/stringMLST/pubmlst/Neisseria_sp/aroE.fa\nfumC  /data/home/stringMLST/pubmlst/Neisseria_sp/fumC.fa\ngdh /data/home/stringMLST/pubmlst/Neisseria_sp/gdh.fa\npdhC  /data/home/stringMLST/pubmlst/Neisseria_sp/pdhC.fa\npgm /data/home/stringMLST/pubmlst/Neisseria_sp/pgm.fa\n\n[profile]\nprofile /data/home/stringMLST/pubmlst/Neisseria_sp/neisseria.txt\n```\n\nThis file is pre-packed on stringMLSTs website and can easily be created by the user for custom database.\n\n#### Database Building \nThe next step is for database building is running the buildDB module to create the database files. buildDB module requires the user to specify the config file. The default k-mer size is 35 but can be changed using the -k option. Specifying the prefix for the created database files is optional but is recommended.\n\nThe choice of k-mer depends on the size of the sequencing read. In general, the value of k can never be greater than the read length. The application has been tested on a number of read lengths ranging from 55 to 150 bps using k-mer sizes of 21 to 66. In our testing, the k-mer size does not affect the accuracy of the read length. A smaller k-mer size will increase the runtime and a larger k-mer size will increase the file size. The user should ideally pick a k-mer with a length around half of the average read length. For lower quality data, it also advised to choose smaller k-mer values to reduce false hits.\n```\nstringMLST.py --buildDB --config <config file> -k  <k-mer length> -P <prefix>\n```\nExample:\n```\nstringMLST.py --buildDB --config config.txt -k 35 -P NM\n```\nThis command will produce 3 database files and a log file. The log file is used for debugging purposes in the event an error is encountered. The 3 database files created are:\n* <prefix>_<k-mer>.txt : The main database file for the application. This is a tab delimited file describing k-mer to locus relationship.\n* <prefix>_weight.txt : Contains the weight factors for alleles which differ in lengths by more than 5%. Will be empty otherwise.\n* <prefix>_profile.txt : Profile definition file used for finding the ST from the predicted allelic profile.\n\nFor the example above, the following files will be created:\nNM_35.txt, NM_weight.txt and NM_profile.txt\n\nPlease note that in the prediction routine the database is identified with the prefix. \n\nST discovery routine\nAs discussed earlier, StringMLST has 3 running modes \n* Single sample mode - for running stringMLST on a single sample\n* Batch mode - for running stringMLST on all the FASTQ files present in a directory\n* List mode - for running stringMLST on all the FASTQ files provided in a list file\n\n####  Single sample mode: \nThis is the default mode for stringMLST and takes in one sample at a time. The sample can be single-end or paired-end. The sample has to be in FASTQ format. In order to run, the user should know the prefix of the database created and the k-mer size. \n\nBy default, the tool expects paired-end samples.\n```\nstringMLST.py --predict -1 <paired-end file 1> -2 <paired-end file 2> -p --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n*For single-end samples:*\n```\nstringMLST.py --predict -1 <single-end file> -s --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n####  Batch Mode: \nThis mode can be used for processing multiple files with one command. All the samples will be queried against the same database. Also all samples should be in the same directory. All the samples will be treated either as single-end or paired-end. The paired-end samples should be differentiated with the character _1 and _2 at the end (E.g.: sampleX_1.fastq and sampleX_2.fastq).\n\n*Paired-end samples:*\n```\nstringMLST.py --predict -d <directory for samples> -p --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n\n*Single-end samples:*\n```\nstringMLST.py --predict -d <directory for samples> -s --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n#### List Mode: \nThis mode could be used if user has samples at different locations or if the paired-end samples are not stored in traditional way. All the samples will be queried against the same database. All the samples will be treated either as single-end or paired-end. This mode requires the user to provide a list file which has the list of all samples along with the location. Each line in the list file represents a new sample.\nA sample list file for single-end sample looks like the following.\n```\n<full path of sample 1 fastq file>\n<full path of sample 2 fastq file>\n<full path of sample 3 fastq file>\n.\n.\n<full path of sample n fastq file>\n```\nA sample list file for paired-end sample looks like the following.\n\n```\n<full path of sample 1 fastq file 1>  <full path of sample 1 fastq file 2>\n<full path of sample 2 fastq file 1>  <full path of sample 2 fastq file 2>\n<full path of sample 3 fastq file 1>  <full path of sample 3 fastq file 2>\n.\n.\n<full path of sample n fastq file 1>  <full path of sample n fastq file 2>\n```\n\nOnce the user has the list file, he can directly use the tool.\n\n*Paired-end samples:*\n```\nstringMLST.py --predict -l <full path to list file> -p --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n*Single-end samples:*\n```\nstringMLST.py --predict -l <full path to list file > -s --prefix <prefix for the database> -k <k-mer size> -o <output file name>\n```\n\n#### Gene coverage and match confidence\n\nstringMLST provides two, complimentary methods for determining confidence in an inferred ST. There's the `-C|--coverage` flag and `-z|--fuzzy` threshold option.\n\nstringMLST determines an allele based on its kmer support; the more kmers seen for allele 1, the more likely that allele 1 is the allele present in the genome. Unlike SRST2 and other mapping/BLAST based tools, stringMLST always infers an ST, using the maximimally supported allele (allele with most kmer hits). The difference between the maximum support (the reported allele) and the second support (next closest allele) can be informative for low coverage reads. The `-z|--fuzzy` threshold (Default = 300), assigns significance to the difference between supports. Much like SRST2 and Torsten Seemann's popular [pubMLST script](https://github.com/tseemann/mlst), stringMLST reports potentially new or closely supported alleles in allele* syntax. For high coverage reads, we suggest a fuzzy threshold >500. For low coverage reads, a fuzzy threshold of <50.\n\nCoverage mode requires `bedtools`, `bwa`, and `samtools` in your PATH and an additional python module, `pyfaidx` (See the dependencies section for installion information).  Coverage mode by default disables display of fuzzy alleles in favor of sequence coverage information made by mapping potential reads to the putative allele sequence. In our testing, coverage mode slightly increases prediction time (<1 sec increase per sample). \n\n**Please note:** stringMLST *always* infers the ST from the reads, fuzzy matches and/or <100% coverage do not necessarily mean a new allele has been found.\n\n*Getting gene coverage from reads*\n```\nstringMLST.py --predict -1 <paired-end file 1> -2 <paired-end file 2> -p --prefix <prefix for the database> -k <k-mer size> -r -o <output file name>- -c <path to config> -C\n```\n*Changing the fuzziness of the search for low coverage reads*\n```\nstringMLST.py --predict -1 <paired-end file 1> -2 <paired-end file 2> -p --prefix <prefix for the database> -k <k-mer size> -r -o <output file name>- -f 50\n```\n\n#### Other Examples : \n\n*Reporting time along with the output.*\n```\nstringMLST.py --predict -1 <paired-end file 1> -2 <paired-end file 2> -p --prefix <prefix for the database> -k <k-mer size> -t -o <output file name>\n```\n*Getting reads file relevant to typing scheme.*\n```\nstringMLST.py --predict -1 <paired-end file 1> -2 <paired-end file 2> -p --prefix <prefix for the database> -k <k-mer size> -r -o <output file name>\n```\n", "description_content_type": "", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/jordanlab/stringMLST", "keywords": "MLST", "license": "", "maintainer": "", "maintainer_email": "", "name": "stringMLST", "package_url": "https://pypi.org/project/stringMLST/", "platform": "", "project_url": "https://pypi.org/project/stringMLST/", "project_urls": {"Homepage": "https://github.com/jordanlab/stringMLST"}, "release_url": "https://pypi.org/project/stringMLST/0.6.2/", "requires_dist": null, "requires_python": "", "summary": "Fast k-mer based tool for alignment and assembly-free multi locus sequence typing (MLST) directly from genome sequencing reads.", "version": "0.6.2", "yanked": false, "html_description": "<div class=\"project-description\">\n            # stringMLST<br><br>Fast k-mer based tool for multi locus sequence typing (MLST)<br>stringMLST is a tool for detecting the MLST of an isolate directly from the genome sequencing reads. stringMLST predicts the ST of an isolate in a completely assembly and alignment free manner. The tool is designed in a light-weight, platform-independent fashion with minimum dependencies.<br><br>Some portions of the allele selection algorithm in stringMLST are patent<br>pending.  Please refer to the PATENTS file for additional inforamation<br>regarding licencing and use.<br><br><br>Reference  <br>*http://jordan.biology.gatech.edu/page/software/stringmlst/*<br><br>Abstract  <br>*http://bioinformatics.oxfordjournals.org/content/early/2016/09/06/bioinformatics.btw586.short?rss=1*<br><br>Application Note  <br>*http://bioinformatics.oxfordjournals.org/content/early/2016/09/06/bioinformatics.btw586.full.pdf+html*<br><br>[![install with bioconda](https://img.shields.io/badge/install%20with-bioconda-brightgreen.svg?style=flat-square)](http://bioconda.github.io/recipes/stringmlst/README.html)  [![PyPI version](https://badge.fury.io/py/stringMLST.svg)](https://badge.fury.io/py/stringMLST)  ![downloads](https://img.shields.io/conda/dn/bioconda/stringmlst.svg?style=flat) [![container ready](https://quay.io/repository/biocontainers/stringmlst/status)](https://quay.io/repository/biocontainers/stringmlst)<br><br><br><br>**stringMLST is a *tool* not a *database*, always use the most up-to-date database files as possible.** To facilitate<br>keeping your databases updated, stringMLST can download and build databases from pubMLST using the most recent allele<br>and profile definitions. Please see the \"Included databases and automated retrieval of databases from pubMLST\" section<br>below for instructions. *The databases bundled here are for convenience only, do not rely on them being up-to-date*.<br><br>stringMLST is licensed and distributed under [CC Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0)  <br>and is free for academic users and requires permission before any commercial use for any version of this code/algorithm.  <br>If you are a commercial user, please contact king.jordan@biology.gatech.edu for permissions<br><br>## Recommended installation method<br><br>```<br>pip install stringMLST<br><br>```<br><br>#### Installation via git (Not recommended for most users)<br><br>```<br>git clone https://github.com/jordanlab/stringMLST<br># Optional, download prebuilt databases  <br># We don't recommend this method, instead build the databases locally<br>cd stringMLST<br>git submodule init<br>git submodule update<br>```<br><br>## Quickstart guide<br><br>```bash  <br>pip install stringMLST  <br>mkdir -p stringMLST_analysis; cd stringMLST_analysis  <br>stringMLST.py --getMLST -P neisseria/nmb --species neisseria  <br># Download all available databases with:  <br># stringMLST.py --getMLST -P mlst_dbs --species all    <br>wget  ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR026/ERR026529/ERR026529_1.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR026/ERR026529/ERR026529_2.fastq.gz  <br>stringMLST.py --predict -P neisseria/nmb -1 ERR026529_1.fastq.gz -2 ERR026529_2.fastq.gz<br>Sample  abcZ    adk     aroE    fumC    gdh     pdhC    pgm     ST<br>ERR026529       231     180     306     612     269     277     260     10174<br><br>```<br><br>## Python dependencies and external programs<br><br>stringMLST does not require any python dependencies for basic usage (Building databases and predicting STs). <br><br>For advanced used (genome coverage), stringMLST depends on the `pyfaidx` python module and `bamtools`, `bwa`, and `samtools`.  <br>See the coverage section for more information<br><br>stringMLST has been tested with:<br>```<br>pyfaidx: 0.4.8.1<br>samtools: 1.3 (Using htslib 1.3.1)  [Requires the 1.x branch of samtools]<br>bedtools: v2.24.0<br>bwa: 0.7.13-r1126<br>```<br><br>### To install the dependencies<br><br>```bash<br># pyfaidx<br>pip install --user pyfaidx<br># samtools<br>wget https://github.com/samtools/samtools/releases/download/1.3.1/samtools-1.3.1.tar.bz2 -o samtools-1.3.1.tar.bz2<br>tar xf samtools-1.3.1.tar.bz2<br>cd samtools-1.3.1.tar<br>make<br>make prefix=$HOME install<br># bedtools<br>wget https://github.com/arq5x/bedtools2/releases/download/v2.25.0/bedtools-2.25.0.tar.gz<br>tar -zxvf bedtools-2.25.0.tar.gz<br>cd bedtools2; make<br>cp ./bin/* ~/bin<br># bwa<br>git clone https://github.com/lh3/bwa.git<br>cd bwa; make<br>cp bwa ~/bin/bwa<br>export PATH=$PATH:$HOME/bin<br>```<br><br><br>## Usage for Example Read Files (Neisseria meningitidis)<br><br>* Download stringMLST.py, example read files (ERR026529, ERR027250, ERR036104) and the dataset for Neisseria meningitidis (Neisseria_spp.zip).<br>### Build database:<br><br>```<br># Add dir to path<br>export PATH=$PATH:$PWD<br># Will connect to EBI's SRA servers<br>download_example_reads.sh<br>````<br><br>* Extract the MLST loci dataset.<br><br>```<br>unzip datasets/Neisseria_spp.zip -d datasets<br>```<br><br>* Create or use a config file specifying the location of all the locus and profile files.<br>Example config file (Neisseria_spp/config.txt):<br><br>```<br>[loci]<br>abcZ  datasets/Neisseria_spp/abcZ.fa<br>adk datasets/Neisseria_spp/adk.fa<br>aroE  datasets/Neisseria_spp/aroE.fa<br>fumC  datasets/Neisseria_spp/fumC.fa<br>gdh datasets/Neisseria_spp/gdh.fa<br>pdhC  datasets/Neisseria_spp/pdhC.fa<br>pgm datasets/Neisseria_spp/pgm.fa<br>[profile]<br>profile datasets/Neisseria_spp/neisseria.txt<br>```<br><br>* Run stringMLST.py --buildDB to create DB. Choose a k value and prefix (optional).<br><br>```<br>stringMLST.py --buildDB -c databases/Neisseria_spp/config.txt -k 35 -P NM <br>```<br><br>### Predict:<br><br>#### Single sample :<br>```<br>stringMLST.py --predict -1 tests/fastqs/ERR026529_1.fastq -2 tests/fastqs/ERR026529_2.fastq -k 35 -P NM   <br>```<br>#### Batch mode (all the samples together):<br>```<br>stringMLST.py --predict -d ./tests/fastqs/ -k 35 -P NM  <br>```<br>#### List mode:<br>Create a list file (list_paired.txt) as :<br>```<br>tests/fastqs/ERR026529_1.fastq  tests/fastqs/ERR026529_2.fastq<br>tests/fastqs/ERR027250_1.fastq  tests/fastqs/ERR027250_2.fastq<br>tests/fastqs/ERR036104_1.fastq  tests/fastqs/ERR036104_2.fastq<br>```<br>Run the tool as:<br>```<br>stringMLST.py --predict -l list_paired.txt -k 35 -P NM<br>```<br>#### Working with gziped files<br>```<br>stringMLST.py --predict -1 tests/fastqs/ERR026529_1.fq.gz -2 tests/fastqs/ERR026529_2.fq.gz -p -P NM -k 35 -o ST_NM.txt<br>```<br>## Usage Documentation<br><br>stringMLST's workflow is divided into two routines:<br>* Database building and<br>* ST discovery<br><br>*Database building:* Builds the stringMLST database which is used for assigning STs to input sample files. This step is required once for each organism. Please note that stringMLST is capable of working on a custom user defined typing scheme but its efficiency has not been tested on other typing scheme.<br><br>*ST discovery:* This routine takes the database created in the last step and predicts the ST of the input sample(s). Please note that the database building is required prior to this routine. stringMLST is capable of processing single-end and paired-end files. It can run in three modes:<br>* Single sample mode - for running stringMLST on a single sample<br>* Batch mode - for running stringMLST on all the FASTQ files present in a directory<br>* List mode - for running stringMLST on all the FASTQ files provided in a list file<br><br><br>```<br>Readme for stringMLST<br>=============================================================================================<br>Usage<br>./stringMLST.py <br>[--buildDB]<br>[--predict]<br>[-1 filename_fastq1][--fastq1 filename_fastq1]<br>[-2 filename_fastq2][--fastq2 filename_fastq2]<br>[-d directory][--dir directory][--directory directory]<br>[-l list_file][--list list_file]<br>[-p][--paired]<br>[-s][--single]<br>[-c][--config]<br>[-P][--prefix]<br>[-z][--fuzzy]<br>[-a]<br>[-C][--coverage]<br>[-k]<br>[-o output_filename][--output output_filename]<br>[-x][--overwrite]<br>[-t]<br>[-r]<br>[-v]<br>[-h][--help]<br>==============================================================================================<br><br>There are two steps to predicting ST using stringMLST.<br>1. Create DB : stringMLST.py --buildDB<br>2. Predict : stringMLST --predict<br><br>1. stringMLST.py --buildDB<br><br>Synopsis:<br>stringMLST.py --buildDB -c &lt;config file&gt; -k &lt;kmer length(optional)&gt; -P &lt;DB prefix(optional)&gt;<br>  config file : is a tab delimited file which has the information for typing scheme ie loci, its multifasta file and profile definition file.<br>    Format : <br>      [loci]<br>      locus1    locusFile1<br>      locus2    locusFile2<br>      [profile]<br>      profile   profileFile<br>  kmer length : is the kmer length for the db. Note, while processing this should be smaller than the read length.<br>    We suggest kmer lengths of 35, 66 depending on the read length.<br>  DB prefix(optional) : holds the information for DB files to be created and their location. This module creates 3 files with this prefix.<br>    You can use a folder structure with prefix to store your db at particular location.<br><br>Required arguments<br>--buildDB<br>  Identifier for build db module<br>-c,--config = &lt;configuration file&gt;<br>  Config file in the format described above. <br>  All the files follow the structure followed by pubmlst. Refer extended document for details. <br><br>Optional arguments  <br>-k = &lt;kmer length&gt;<br>  Kmer size for which the db has to be formed(Default k = 35). Note the tool works best with kmer length in between 35 and 66<br>  for read lengths of 55 to 150 bp. Kmer size can be increased accordingly. It is advised to keep lower kmer sizes <br>  if the quality of reads is not very good.<br>-P,--prefix = &lt;prefix&gt;<br>  Prefix for db and log files to be created(Default = kmer). Also you can specify folder where you want the dbb to be created.<br>-a<br>        File location to write build log<br>-h,--help<br>  Prints the help manual for this application<br><br> --------------------------------------------------------------------------------------------<br> <br>2. stringMLST.py --predict<br>  <br>stringMLST --predict : can run in three modes<br>  1) single sample (default mode)<br>  2) batch mode : run stringMLST for all the samples in a folder (for a particular specie)<br>  3) list mode : run stringMLST on samples specified in a file<br>stringMLST can process both single and paired end files. By default program expects paired end files.<br><br>Synopsis<br>stringMLST.py --predict -1 &lt;fastq file&gt; -2 &lt;fastq file&gt; -d &lt;directory location&gt; -l &lt;list file&gt; -p -s -P &lt;DB prefix(optional)&gt; -k &lt;kmer length(optional)&gt; -o &lt;output file&gt; -x<br><br>Required arguments<br>--predict<br>  Identifier for predict miodule<br>  <br>Optional arguments<br>-1,--fastq1 = &lt;fastq1_filename&gt;<br>  Path to first fastq file for paired end sample and path to the fastq file for single end file.<br>  Should have extension fastq or fq.<br>-2,--fastq2 = &lt;fastq2_filename&gt;<br>  Path to second fastq file for paired end sample.<br>  Should have extension fastq or fq.<br>-d,--dir,--directory = &lt;directory&gt;<br>  BATCH MODE : Location of all the samples for batch mode.<br>-C,--coverage<br>  Calculate seqence coverage for each allele. Turns on read generation (-r) and turns off fuzzy (-z 1)<br>  Requires bwa, bamtools and samtools be in your path<br>-k = &lt;kmer_length&gt;<br>  Kmer length for which the db was created(Default k = 35). Could be verified by looking at the name of the db file. <br>  Could be used if the reads are of very bad quality or have a lot of N's.<br>-l,--list = &lt;list_file&gt;<br>  LIST MODE : Location of list file and flag for list mode.<br>  list file should have full file paths for all the samples/files.<br>  Each sample takes one line. For paired end samples the 2 files should be tab separated on single line.<br>-o,--output = &lt;output_filename&gt;<br>  Prints the output to a file instead of stdio.<br>-p,--paired<br>  Flag for specifying paired end files. Default option so would work the same if you do not specify for all modes.<br>  For batch mode the paired end samples should be differentiated by 1/2.fastq or 1/2.fq<br>-P,--prefix = &lt;prefix&gt;<br>  Prefix using which the db was created(Defaults = kmer). The location of the db could also be provided.<br>-r<br>  A seperate reads file is created which has all the reads covering all the locus.<br>-s,--single<br>  Flag for specifying single end files.<br>-t<br>  Time for each analysis will also be reported.<br>-v<br>  Prints the version of the software.<br>-x,--overwrite<br>  By default stringMLST appends the results to the output_filename if same name is used.<br>  This argument overwrites the previously specified output file.<br>-z,--fuzzy = &lt;fuzzy threshold int&gt;<br>  Threshold for reporting a fuzzy match (Default=300). For higher coverage reads this threshold should be set higher to avoid<br>  indicating fuzzy match when exact match was more likely. For lower coverage reads, threshold of &lt;100 is recommended<br>-h,--help<br>  Prints the help manual for this application<br><br> --------------------------------------------------------------------------------------------<br><br>3. stringMLST.py --getMLST<br><br>Synopsis:  <br>stringMLST.py --getMLST --species= &lt;species&gt; [-k kmer length] [-P DB prefix]<br><br>Required arguments<br>--getMLST<br>    Identifier for getMLST module<br>--species= &lt;species name&gt;<br>    Species name from the pubMLST schemes (use --schemes to get list of available schemes)<br>    \"all\" will download and build all <br><br>Optional arguments<br>-k = &lt;kmer length&gt;<br>    Kmer size for which the db has to be formed(Default k = 35). Note the tool works best with kmer length in between 35 and 66<br>    for read lengths of 55 to 150 bp. Kmer size can be increased accordingly. It is advised to keep lower kmer sizes<br>    if the quality of reads is not very good.<br>-P,--prefix = &lt;prefix&gt;<br>    Prefix for db and log files to be created(Default = kmer). Also you can specify folder where you want the db to be created.<br>    We recommend that prefix and config point to the same folder for cleanliness but this is not required<br>--schemes<br>    Display the list of available schemes<br>-h,--help<br>  Prints the help manual for this application<br><br>```<br><br><br>**stringMLST expects paired end reads to be in [Illumina naming convention](http://support.illumina.com/help/SequencingAnalysisWorkflow/Content/Vault/Informatics/Sequencing_Analysis/CASAVA/swSEQ_mCA_FASTQFiles.htm), minimally ending with _1.fq and _2.fq to delineate read1 and read2:**<br><br>*Periods (.) are disallowed delimiters except for file extensions*<br><br>```<br>Illumina FASTQ files use the following naming scheme:<br><br>&lt;sample name&gt;_&lt;barcode sequence&gt;_L&lt;lane (0-padded to 3 digits)&gt;_R&lt;read number&gt;_&lt;set number (0-padded to 3 digits&gt;.fastq.gz<br><br>For example, the following is a valid FASTQ file name:<br><br>NA10831_ATCACG_L002_R1_001.fastq.gz<br>```<br><br>## Running stringMLST<br><br>#### Included databases and automated retrieval of databases from pubMLST<br><br>stringMLST includes all the pubMLST databases as of **February 15, 2017**, built with the default kmer (*35*). They can be found in the `datasets/` folder.  <br>Simply unzip the databases you need and begin using stringMSLT as described below.<br><br>All the databases from pubMLST can be downloaded and prepared with your kmer choice<br><br>*Getting all pubMLST schemes*  <br>```<br>stringMLST.py --getMLST -P datasets/ --species all<br>```<br><br><br>Individual databases from pubMLST can also be downloaded as needed, using the scheme identifiers<br><br>*Downloading a scheme*  <br>```<br># List available schemes<br>stringMLST.py --getMLST --schemes<br><br># Download the Neisseria spp. scheme<br><br>stringMLST.py --getMLST -P datasets/nmb --species neisseria<br><br>```<br><br><br><br>#### Database Preparation<br>In order to create the database, files can be downloaded from the database page.<br><br>If the organism of interest is not present in the provided link, the required files can be downloaded from PubMLST as follows:<br>* On your browser, navigate to http://pubmlst.org/<br>* Navigate to \"Download MLST definitions\" link or go to http://pubmlst.org/data/<br>* Scroll to the species of interest. For each species, user may find the file for typing definitions and multi-FASTA files for each locus. Download these files.<br><br>E.g.:<br><br>Species of interest: Neisseria spp.<br>Corresponding definition file: http://pubmlst.org/data/profiles/neisseria.txt<br>Corresponding multi fasta locus files: <br>http://pubmlst.org/data/alleles/neisseria/abcZ.tfa<br>http://pubmlst.org/data/alleles/neisseria/adk.tfa<br>http://pubmlst.org/data/alleles/neisseria/aroE.tfa<br>http://pubmlst.org/data/alleles/neisseria/fumC.tfa<br>http://pubmlst.org/data/alleles/neisseria/gdh.tfa<br>http://pubmlst.org/data/alleles/neisseria/pdhC.tfa<br>http://pubmlst.org/data/alleles/neisseria/pgm.tfa<br><br>Download these files at a desired location.<br><br><br>Custom user files can also be used for building database. The database building routine requires the profile definition file and allele sequence file. The profile definition file is a tab separated file that contains the ST and the allele profile corresponding to the ST. An example of the profile definition file is shown below:<br>```<br>ST  abcZ  adk aroE  fumC  gdh pdhC  pgm clonal_complex<br>1 1 3 1 1 1 1 3 ST-1 complex/subgroup I/II<br>2 1 3 4 7 1 1 3 ST-1 complex/subgroup I/II<br>3 1 3 1 1 1 23  13  ST-1 complex/subgroup I/II<br>4 1 3 3 1 4 2 3 ST-4 complex/subgroup IV<br>```<br>The allele sequence file is a standard multi-FASTA with the description being the loci name with the allele number. An example abcZ allele sequence is shown below:<br>```<br>&gt;abcZ_1<br>TTTGATACTGTTGCCGA...<br>&gt;abcZ_2<br>TTTGATACCGTTGCCGA...<br>&gt;abcZ_3<br>TTTGATACCGTTGCGAA...<br>&gt;abcZ_4<br>TTTGATACCGTTGCCAA...<br>```<br><br>These files can be obtained from PubMLST/BIGSdb or can be create by the user themselves. <br><br>In either case, an accompanying configuration file is also required to describe the profile definition and allele sequence files. An example configuration file is shown below:<br>```<br>[loci]<br>abcZ  /data/home/stringMLST/pubmlst/Neisseria_sp/abcZ.fa<br>adk /data/home/stringMLST/pubmlst/Neisseria_sp/adk.fa<br>aroE  /data/home/stringMLST/pubmlst/Neisseria_sp/aroE.fa<br>fumC  /data/home/stringMLST/pubmlst/Neisseria_sp/fumC.fa<br>gdh /data/home/stringMLST/pubmlst/Neisseria_sp/gdh.fa<br>pdhC  /data/home/stringMLST/pubmlst/Neisseria_sp/pdhC.fa<br>pgm /data/home/stringMLST/pubmlst/Neisseria_sp/pgm.fa<br><br>[profile]<br>profile /data/home/stringMLST/pubmlst/Neisseria_sp/neisseria.txt<br>```<br><br>This file is pre-packed on stringMLSTs website and can easily be created by the user for custom database.<br><br>#### Database Building <br>The next step is for database building is running the buildDB module to create the database files. buildDB module requires the user to specify the config file. The default k-mer size is 35 but can be changed using the -k option. Specifying the prefix for the created database files is optional but is recommended.<br><br>The choice of k-mer depends on the size of the sequencing read. In general, the value of k can never be greater than the read length. The application has been tested on a number of read lengths ranging from 55 to 150 bps using k-mer sizes of 21 to 66. In our testing, the k-mer size does not affect the accuracy of the read length. A smaller k-mer size will increase the runtime and a larger k-mer size will increase the file size. The user should ideally pick a k-mer with a length around half of the average read length. For lower quality data, it also advised to choose smaller k-mer values to reduce false hits.<br>```<br>stringMLST.py --buildDB --config &lt;config file&gt; -k  &lt;k-mer length&gt; -P &lt;prefix&gt;<br>```<br>Example:<br>```<br>stringMLST.py --buildDB --config config.txt -k 35 -P NM<br>```<br>This command will produce 3 database files and a log file. The log file is used for debugging purposes in the event an error is encountered. The 3 database files created are:<br>* &lt;prefix&gt;_&lt;k-mer&gt;.txt : The main database file for the application. This is a tab delimited file describing k-mer to locus relationship.<br>* &lt;prefix&gt;_weight.txt : Contains the weight factors for alleles which differ in lengths by more than 5%. Will be empty otherwise.<br>* &lt;prefix&gt;_profile.txt : Profile definition file used for finding the ST from the predicted allelic profile.<br><br>For the example above, the following files will be created:<br>NM_35.txt, NM_weight.txt and NM_profile.txt<br><br>Please note that in the prediction routine the database is identified with the prefix. <br><br>ST discovery routine<br>As discussed earlier, StringMLST has 3 running modes <br>* Single sample mode - for running stringMLST on a single sample<br>* Batch mode - for running stringMLST on all the FASTQ files present in a directory<br>* List mode - for running stringMLST on all the FASTQ files provided in a list file<br><br>####  Single sample mode: <br>This is the default mode for stringMLST and takes in one sample at a time. The sample can be single-end or paired-end. The sample has to be in FASTQ format. In order to run, the user should know the prefix of the database created and the k-mer size. <br><br>By default, the tool expects paired-end samples.<br>```<br>stringMLST.py --predict -1 &lt;paired-end file 1&gt; -2 &lt;paired-end file 2&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br>*For single-end samples:*<br>```<br>stringMLST.py --predict -1 &lt;single-end file&gt; -s --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br>####  Batch Mode: <br>This mode can be used for processing multiple files with one command. All the samples will be queried against the same database. Also all samples should be in the same directory. All the samples will be treated either as single-end or paired-end. The paired-end samples should be differentiated with the character _1 and _2 at the end (E.g.: sampleX_1.fastq and sampleX_2.fastq).<br><br>*Paired-end samples:*<br>```<br>stringMLST.py --predict -d &lt;directory for samples&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br><br>*Single-end samples:*<br>```<br>stringMLST.py --predict -d &lt;directory for samples&gt; -s --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br>#### List Mode: <br>This mode could be used if user has samples at different locations or if the paired-end samples are not stored in traditional way. All the samples will be queried against the same database. All the samples will be treated either as single-end or paired-end. This mode requires the user to provide a list file which has the list of all samples along with the location. Each line in the list file represents a new sample.<br>A sample list file for single-end sample looks like the following.<br>```<br>&lt;full path of sample 1 fastq file&gt;<br>&lt;full path of sample 2 fastq file&gt;<br>&lt;full path of sample 3 fastq file&gt;<br>.<br>.<br>&lt;full path of sample n fastq file&gt;<br>```<br>A sample list file for paired-end sample looks like the following.<br><br>```<br>&lt;full path of sample 1 fastq file 1&gt;  &lt;full path of sample 1 fastq file 2&gt;<br>&lt;full path of sample 2 fastq file 1&gt;  &lt;full path of sample 2 fastq file 2&gt;<br>&lt;full path of sample 3 fastq file 1&gt;  &lt;full path of sample 3 fastq file 2&gt;<br>.<br>.<br>&lt;full path of sample n fastq file 1&gt;  &lt;full path of sample n fastq file 2&gt;<br>```<br><br>Once the user has the list file, he can directly use the tool.<br><br>*Paired-end samples:*<br>```<br>stringMLST.py --predict -l &lt;full path to list file&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br>*Single-end samples:*<br>```<br>stringMLST.py --predict -l &lt;full path to list file &gt; -s --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -o &lt;output file name&gt;<br>```<br><br>#### Gene coverage and match confidence<br><br>stringMLST provides two, complimentary methods for determining confidence in an inferred ST. There's the `-C|--coverage` flag and `-z|--fuzzy` threshold option.<br><br>stringMLST determines an allele based on its kmer support; the more kmers seen for allele 1, the more likely that allele 1 is the allele present in the genome. Unlike SRST2 and other mapping/BLAST based tools, stringMLST always infers an ST, using the maximimally supported allele (allele with most kmer hits). The difference between the maximum support (the reported allele) and the second support (next closest allele) can be informative for low coverage reads. The `-z|--fuzzy` threshold (Default = 300), assigns significance to the difference between supports. Much like SRST2 and Torsten Seemann's popular [pubMLST script](https://github.com/tseemann/mlst), stringMLST reports potentially new or closely supported alleles in allele* syntax. For high coverage reads, we suggest a fuzzy threshold &gt;500. For low coverage reads, a fuzzy threshold of &lt;50.<br><br>Coverage mode requires `bedtools`, `bwa`, and `samtools` in your PATH and an additional python module, `pyfaidx` (See the dependencies section for installion information).  Coverage mode by default disables display of fuzzy alleles in favor of sequence coverage information made by mapping potential reads to the putative allele sequence. In our testing, coverage mode slightly increases prediction time (&lt;1 sec increase per sample). <br><br>**Please note:** stringMLST *always* infers the ST from the reads, fuzzy matches and/or &lt;100% coverage do not necessarily mean a new allele has been found.<br><br>*Getting gene coverage from reads*<br>```<br>stringMLST.py --predict -1 &lt;paired-end file 1&gt; -2 &lt;paired-end file 2&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -r -o &lt;output file name&gt;- -c &lt;path to config&gt; -C<br>```<br>*Changing the fuzziness of the search for low coverage reads*<br>```<br>stringMLST.py --predict -1 &lt;paired-end file 1&gt; -2 &lt;paired-end file 2&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -r -o &lt;output file name&gt;- -f 50<br>```<br><br>#### Other Examples : <br><br>*Reporting time along with the output.*<br>```<br>stringMLST.py --predict -1 &lt;paired-end file 1&gt; -2 &lt;paired-end file 2&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -t -o &lt;output file name&gt;<br>```<br>*Getting reads file relevant to typing scheme.*<br>```<br>stringMLST.py --predict -1 &lt;paired-end file 1&gt; -2 &lt;paired-end file 2&gt; -p --prefix &lt;prefix for the database&gt; -k &lt;k-mer size&gt; -r -o &lt;output file name&gt;<br>```<br>\n          </div>"}, "last_serial": 5100629, "releases": {"0.3.5": [{"comment_text": "", "digests": {"md5": "9eedf40431f04b6e4d0ef5c342b0d0da", "sha256": "7596b9f63af103e35a5b481fbb3bbc0e56b4661a33ad87a27c1b42e50eb34db8"}, "downloads": -1, "filename": "stringMLST-0.3.5.tar.gz", "has_sig": false, "md5_digest": "9eedf40431f04b6e4d0ef5c342b0d0da", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21927, "upload_time": "2017-02-16T13:40:41", "upload_time_iso_8601": "2017-02-16T13:40:41.622309Z", "url": "https://files.pythonhosted.org/packages/d5/9b/14a4cc80ef46e9aa518ca6647798427dc0d2ff2f33771d06d35410946dfa/stringMLST-0.3.5.tar.gz", "yanked": false}], "0.3.6": [{"comment_text": "", "digests": {"md5": "d1389eec1879571167cb6bf6fb689617", "sha256": "2ee78ca88e1cea996ced6500940a65f9938557316c86adf616c8be167ceeac6c"}, "downloads": -1, "filename": "stringMLST-0.3.6.tar.gz", "has_sig": false, "md5_digest": "d1389eec1879571167cb6bf6fb689617", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21977, "upload_time": "2017-02-17T16:12:07", "upload_time_iso_8601": "2017-02-17T16:12:07.731454Z", "url": "https://files.pythonhosted.org/packages/d9/93/1c7715a155ec763c790331ceea018af994eddf8975baac05fe4049c03648/stringMLST-0.3.6.tar.gz", "yanked": false}], "0.3.6.1": [{"comment_text": "", "digests": {"md5": "0a8582190a018a39e7c4f67c57b99727", "sha256": "31f82faeda709e1cf0a1874dbeb07f47aa8617b691e0ef8973031c671ede913b"}, "downloads": -1, "filename": "stringMLST-0.3.6.1.tar.gz", "has_sig": false, "md5_digest": "0a8582190a018a39e7c4f67c57b99727", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21971, "upload_time": "2017-02-27T17:17:39", "upload_time_iso_8601": "2017-02-27T17:17:39.759900Z", "url": "https://files.pythonhosted.org/packages/89/58/b7626a1e8746ab28e465a2aed490b76a055ab1dbd9e62c6fc528323a7003/stringMLST-0.3.6.1.tar.gz", "yanked": false}], "0.3.6.2": [{"comment_text": "", "digests": {"md5": "b9048f354ee12dd3629969648b5d9c3b", "sha256": "eb315230d6824256f88b865e9d8558c0373431a8bce9d230dea93294219436f0"}, "downloads": -1, "filename": "stringMLST-0.3.6.2.tar.gz", "has_sig": false, "md5_digest": "b9048f354ee12dd3629969648b5d9c3b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21974, "upload_time": "2017-03-18T17:23:12", "upload_time_iso_8601": "2017-03-18T17:23:12.773969Z", "url": "https://files.pythonhosted.org/packages/e7/7e/bdd0b7bc6277656a88d004538f1d36fd176abddaf1d484c32dbf934605cf/stringMLST-0.3.6.2.tar.gz", "yanked": false}], "0.3.6.3": [], "0.3.7": [{"comment_text": "", "digests": {"md5": "fe20ea1c585519857573950042e57ee4", "sha256": "9697485ecbd596bf834c564d63ca8347b4705e8f78d91397e9ec0a03272c2620"}, "downloads": -1, "filename": "stringMLST-0.3.7.tar.gz", "has_sig": false, "md5_digest": "fe20ea1c585519857573950042e57ee4", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 36996, "upload_time": "2017-04-22T03:05:20", "upload_time_iso_8601": "2017-04-22T03:05:20.678865Z", "url": "https://files.pythonhosted.org/packages/c2/a0/4f12c5a4343293fb1d81db5da9c0acb78ebd178a46ed58de8af6737f149a/stringMLST-0.3.7.tar.gz", "yanked": false}], "0.4": [{"comment_text": "", "digests": {"md5": "b21f0e7b1eb712a6340d84a2c55453f8", "sha256": "40d22c28d0650a4055190ef47a4b05cfca2dc019a74cd10f8d2d5f996a5c9f0b"}, "downloads": -1, "filename": "stringMLST-0.4.tar.gz", "has_sig": false, "md5_digest": "b21f0e7b1eb712a6340d84a2c55453f8", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 37154, "upload_time": "2017-05-17T12:34:21", "upload_time_iso_8601": "2017-05-17T12:34:21.117887Z", "url": "https://files.pythonhosted.org/packages/a3/8a/ff14c59d19a2a69e50d6ca736f89241249625be9b3e4349b36e7247c1aa4/stringMLST-0.4.tar.gz", "yanked": false}], "0.4.1": [{"comment_text": "", "digests": {"md5": "18ca02c4ce5a2a013fe5bbca5e16d395", "sha256": "9ebf942428e99c32694d2c3d0140a6115bd276f634bd608e3758b4098bbea799"}, "downloads": -1, "filename": "stringMLST-0.4.1.tar.gz", "has_sig": false, "md5_digest": "18ca02c4ce5a2a013fe5bbca5e16d395", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 37132, "upload_time": "2017-05-21T20:32:37", "upload_time_iso_8601": "2017-05-21T20:32:37.721407Z", "url": "https://files.pythonhosted.org/packages/8d/a2/18c0efbfab4181aedc5b7aedd8692e8fc6246169285d8dbc9b645d5e8f29/stringMLST-0.4.1.tar.gz", "yanked": false}], "0.4.2.0": [{"comment_text": "", "digests": {"md5": "a56227ffe4cf7f699aade89b062b8330", "sha256": "3104e9eca7ff37f6b0825ca533e9b501f64ca94a41f49c92d244546d09bedf5a"}, "downloads": -1, "filename": "stringMLST-0.4.2.0.tar.gz", "has_sig": false, "md5_digest": "a56227ffe4cf7f699aade89b062b8330", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 37093, "upload_time": "2017-09-13T13:51:57", "upload_time_iso_8601": "2017-09-13T13:51:57.315295Z", "url": "https://files.pythonhosted.org/packages/ec/bf/f4083f5ea043f31da172e1d8ddc6faccbeceb0841834d45a946f58469a4d/stringMLST-0.4.2.0.tar.gz", "yanked": false}], "0.5.1.2": [{"comment_text": "", "digests": {"md5": "af2a58628c1c37fe76e535c57301dd36", "sha256": "04b2cae8b46f127b3940ffb0a9746eaf831b0254c7858ac60477bdab868b647a"}, "downloads": -1, "filename": "stringMLST-0.5.1.2.tar.gz", "has_sig": false, "md5_digest": "af2a58628c1c37fe76e535c57301dd36", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 27036, "upload_time": "2018-01-05T18:29:34", "upload_time_iso_8601": "2018-01-05T18:29:34.908571Z", "url": "https://files.pythonhosted.org/packages/27/ce/e426697e17ad6c15ed11fb0f5b42e648b38586e11794b4d6de1a71f037f6/stringMLST-0.5.1.2.tar.gz", "yanked": false}], "0.5.1.2.1": [{"comment_text": "", "digests": {"md5": "ce5cce03cce0b58b78c9e350c2e3787b", "sha256": "18c70f17f37510076cd6936f48b9056d3114afbff1e344fa2ce0a26d45f9c481"}, "downloads": -1, "filename": "stringMLST-0.5.1.2.1.tar.gz", "has_sig": false, "md5_digest": "ce5cce03cce0b58b78c9e350c2e3787b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 27042, "upload_time": "2018-07-26T13:45:33", "upload_time_iso_8601": "2018-07-26T13:45:33.983739Z", "url": "https://files.pythonhosted.org/packages/b0/b1/10f8b36f7a5becc93aab6cbd2cc0041d24b980da4ad3dbae982a59e6c460/stringMLST-0.5.1.2.1.tar.gz", "yanked": false}], "0.5.2": [{"comment_text": "", "digests": {"md5": "4a505869407e646bc31058c32e0fdc83", "sha256": "0b361996193f42a84825c08feae9d1a2a31f92573edc6219c0b1f2e2b87381cb"}, "downloads": -1, "filename": "stringMLST-0.5.2.tar.gz", "has_sig": false, "md5_digest": "4a505869407e646bc31058c32e0fdc83", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 40045, "upload_time": "2019-01-07T13:18:55", "upload_time_iso_8601": "2019-01-07T13:18:55.447201Z", "url": "https://files.pythonhosted.org/packages/c0/15/beb76e4fcbc196862812c4ad08f86ca1ace2d67424eeb02d257309deaa37/stringMLST-0.5.2.tar.gz", "yanked": false}], "0.6.1": [{"comment_text": "", "digests": {"md5": "e051fcc86c4693043274fbd73f60c80b", "sha256": "bc10987d709a2c4de17066d2799b3bcdfe9b4e7fdbc0ca4940a458d396770d61"}, "downloads": -1, "filename": "stringMLST-0.6.1.tar.gz", "has_sig": false, "md5_digest": "e051fcc86c4693043274fbd73f60c80b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 35482, "upload_time": "2019-03-05T14:00:47", "upload_time_iso_8601": "2019-03-05T14:00:47.981195Z", "url": "https://files.pythonhosted.org/packages/6d/9c/6765c14b7f2bae14053b4bc81884a979113f4580394dee10f0deb1da07e9/stringMLST-0.6.1.tar.gz", "yanked": false}], "0.6.2": [{"comment_text": "", "digests": {"md5": "ab962d1785e746df975804f6535acf15", "sha256": "41260407f5efb315815067aa04f955825bba2fc46bf63e3f323c3f8486d09040"}, "downloads": -1, "filename": "stringMLST-0.6.2.tar.gz", "has_sig": false, "md5_digest": "ab962d1785e746df975804f6535acf15", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 35688, "upload_time": "2019-04-04T19:51:14", "upload_time_iso_8601": "2019-04-04T19:51:14.373852Z", "url": "https://files.pythonhosted.org/packages/62/ba/7f637ca4f3e759a20a0e00a97ad81544fbb3d48f4079e992e2d96d9e4b49/stringMLST-0.6.2.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "ab962d1785e746df975804f6535acf15", "sha256": "41260407f5efb315815067aa04f955825bba2fc46bf63e3f323c3f8486d09040"}, "downloads": -1, "filename": "stringMLST-0.6.2.tar.gz", "has_sig": false, "md5_digest": "ab962d1785e746df975804f6535acf15", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 35688, "upload_time": "2019-04-04T19:51:14", "upload_time_iso_8601": "2019-04-04T19:51:14.373852Z", "url": "https://files.pythonhosted.org/packages/62/ba/7f637ca4f3e759a20a0e00a97ad81544fbb3d48f4079e992e2d96d9e4b49/stringMLST-0.6.2.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:01:11 2020"}