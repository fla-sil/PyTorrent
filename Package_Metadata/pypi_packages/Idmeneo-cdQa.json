{"info": {"author": "Gabor Jonas", "author_email": "", "bugtrack_url": null, "classifiers": [], "description": "# cdQA: Closed Domain Question Answering\n\n[![Build Status](https://travis-ci.com/cdqa-suite/cdQA.svg?branch=master)](https://travis-ci.com/cdqa-suite/cdQA)\n[![codecov](https://codecov.io/gh/cdqa-suite/cdQA/branch/master/graph/badge.svg)](https://codecov.io/gh/cdqa-suite/cdQA)\n[![PyPI Version](https://img.shields.io/pypi/v/cdqa.svg)](https://pypi.org/project/cdqa/)\n[![PyPI Downloads](https://img.shields.io/pypi/dm/cdqa.svg)](https://pypi.org/project/cdqa/)\n[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-first-steps-cdqa.ipynb)\n[![Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-first-steps-cdqa.ipynb)\n[![Contributor Covenant](https://img.shields.io/badge/Contributor%20Covenant-v1.4%20adopted-ff69b4.svg)](.github/CODE_OF_CONDUCT.md)\n[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](http://makeapullrequest.com)\n![GitHub](https://img.shields.io/github/license/cdqa-suite/cdQA.svg)\n\nAn End-To-End Closed Domain Question Answering System. Built on top of the HuggingFace [transformers](https://github.com/huggingface/transformers) library.\n\n## cdQA in details\n\nIf you are interested in understanding how the system works and its implementation, we wrote an [article on Medium](https://towardsdatascience.com/how-to-create-your-own-question-answering-system-easily-with-python-2ef8abc8eb5) with a high-level explanation.\n\nWe also made a presentation during the \\#9 NLP Breakfast organised by [Feedly](feedly.com). You can check it out [here](https://blog.feedly.com/nlp-breakfast-9-closed-domain-question-answering/).\n\n## Table of Contents <!-- omit in toc -->\n\n- [Installation](#Installation)\n  - [With pip](#With-pip)\n  - [From source](#From-source)\n  - [Hardware Requirements](#Hardware-Requirements)\n- [Getting started](#Getting-started)\n  - [Preparing your data](#Preparing-your-data)\n    - [Manual](#Manual)\n    - [With converters](#With-converters)\n  - [Downloading pre-trained models](#Downloading-pre-trained-models)\n  - [Training models](#Training-models)\n  - [Making predictions](#Making-predictions)\n  - [Evaluating models](#Evaluating-models)\n- [Notebook Examples](#Notebook-Examples)\n- [Deployment](#Deployment)\n  - [Manual](#Manual-1)\n- [Contributing](#Contributing)\n- [References](#References)\n- [LICENSE](#LICENSE)\n\n## Installation\n\n### With pip\n\n```shell\npip install cdqa\n```\n\n### From source\n\n```shell\ngit clone https://github.com/cdqa-suite/cdQA.git\ncd cdQA\npip install -e .\n```\n\n### Hardware Requirements\n\nExperiments have been done with:\n\n- **CPU** \u0111\u017a\u2018\u2030 AWS EC2 `t2.medium` Deep Learning AMI (Ubuntu) Version 22.0\n- **GPU** \u0111\u017a\u2018\u2030 AWS EC2 `p3.2xlarge` Deep Learning AMI (Ubuntu) Version 22.0 + a single Tesla V100 16GB.\n\n## Getting started\n\n### Preparing your data\n\n#### Manual\n\nTo use `cdQA` you need to create a pandas dataframe with the following columns:\n\n| title             | paragraphs                                             |\n| ----------------- | ------------------------------------------------------ |\n| The Article Title | [Paragraph 1 of Article, ... , Paragraph N of Article] |\n\n#### With converters\n\nThe objective of `cdqa` converters is to make it easy to create this dataframe from your raw documents database. For instance the `pdf_converter` can create a `cdqa` dataframe from a directory containing `.pdf` files:\n\n```python\nfrom cdqa.utils.converters import pdf_converter\n\ndf = pdf_converter(directory_path='path_to_pdf_folder')\n```\n\nYou will need to install [Java OpenJDK](https://openjdk.java.net/install/) to use this converter. We currently have converters for:\n\n- pdf\n- markdown\n\nWe plan to improve and add more converters in the future. Stay tuned!\n\n### Downloading pre-trained models and data\n\nYou can download the models and data manually from the GitHub [releases](https://github.com/cdqa-suite/cdQA/releases) or use our download functions:\n\n```python\nfrom cdqa.utils.download import download_squad, download_model, download_bnpp_data\n\ndirectory = 'path-to-directory'\n\n# Downloading data\ndownload_squad(dir=directory)\ndownload_bnpp_data(dir=directory)\n\n# Downloading pre-trained BERT fine-tuned on SQuAD 1.1\ndownload_model('bert-squad_1.1', dir=directory)\n\n# Downloading pre-trained DistilBERT fine-tuned on SQuAD 1.1\ndownload_model('distilbert-squad_1.1', dir=directory)\n```\n\n### Training models\n\nFit the pipeline on your corpus using the pre-trained reader:\n\n```python\nimport pandas as pd\nfrom ast import literal_eval\nfrom cdqa.pipeline import QAPipeline\n\ndf = pd.read_csv('your-custom-corpus-here.csv', converters={'paragraphs': literal_eval})\n\ncdqa_pipeline = QAPipeline(reader='bert_qa.joblib') # use 'distilbert_qa.joblib' for DistilBERT instead of BERT\ncdqa_pipeline.fit_retriever(df=df)\n```\n\nIf you want to fine-tune the reader on your custom SQuAD-like annotated dataset:\n\n```python\ncdqa_pipeline = QAPipeline(reader='bert_qa.joblib') # use 'distilbert_qa.joblib' for DistilBERT instead of BERT\ncdqa_pipeline.fit_reader('path-to-custom-squad-like-dataset.json')\n```\n\nSave the reader model after fine-tuning:\n```python\ncdqa_pipeline.dump_reader('path-to-save-bert-reader.joblib')\n```\n### Making predictions\n\nTo get the best prediction given an input query:\n\n```python\ncdqa_pipeline.predict(query='your question')\n```\n\nTo get the N best predictions:\n```python\ncdqa_pipeline.predict(query='your question', n_predictions=N)\n```\n\nThere is also the possibility to change the weight of the retriever score\nversus the reader score in the computation of final ranking score (the default is 0.35, which is shown to be the best weight on the development set of SQuAD 1.1-open)\n\n```python\ncdqa_pipeline.predict(query='your question', retriever_score_weight=0.35)\n```\n\n### Evaluating models\n\nIn order to evaluate models on your custom dataset you will need to annotate it. The annotation process can be done in 3 steps:\n\n1. Convert your pandas DataFrame into a json file with SQuAD format:\n\n    ```python\n    from cdqa.utils.converters import df2squad\n\n    json_data = df2squad(df=df, squad_version='v1.1', output_dir='.', filename='dataset-name')\n    ```\n\n2. Use an annotator to add ground truth question-answer pairs:\n\n    Please refer to our [`cdQA-annotator`](https://github.com/cdqa-suite/cdQA-annotator), a web-based annotator for closed-domain question answering datasets with SQuAD format.\n\n3. Evaluate the pipeline object:\n\n    ```python\n    from cdqa.utils.evaluation import evaluate_pipeline\n\n    evaluate_pipeline(cdqa_pipeline, 'path-to-annotated-dataset.json')\n\n    ```\n\n4. Evaluate the reader:\n\n    ```python\n    from cdqa.utils.evaluation import evaluate_reader\n\n    evaluate_reader(cdqa_pipeline, 'path-to-annotated-dataset.json')\n    ```\n\n## Notebook Examples\n\nWe prepared some notebook examples under the [examples](examples) directory.\n\nYou can also play directly with these notebook examples using [Binder](https://gke.mybinder.org/) or [Google Colaboratory](https://colab.research.google.com/notebooks/welcome.ipynb):\n\n| Notebook                         | Hardware     | Platform                                                                                                                                                                                                                                                                                                                                      |\n| -------------------------------- | ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| [1] First steps with cdQA        | CPU or GPU | [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-first-steps-cdqa.ipynb) [![Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-first-steps-cdqa.ipynb)   |\n| [2] Using the PDF converter      | CPU or GPU | [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-use-pdf-converter.ipynb) [![Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-use-pdf-converter.ipynb) |\n| [3] Training the reader on SQuAD | GPU        | [![Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-train-reader-squad.ipynb)                                                                                                                                                         |\n\nBinder and Google Colaboratory provide temporary environments and may be slow to start but we recommend them if you want to get started with `cdQA` easily.\n\n## Deployment\n\n### Manual\n\nYou can deploy a `cdQA` REST API by executing:\n\n```shell\nexport dataset_path=path-to-dataset.csv\nexport reader_path=path-to-reader-model\n\nFLASK_APP=api.py flask run -h 0.0.0.0\n```\n\nYou can now make requests to test your API (here using [HTTPie](https://httpie.org/)):\n\n```shell\nhttp localhost:5000/api query=='your question here'\n```\n\nIf you wish to serve a user interface on top of your `cdQA` system, follow the instructions of [cdQA-ui](https://github.com/cdqa-suite/cdQA-ui), a web interface developed for `cdQA`.\n\n## Contributing\n\nRead our [Contributing Guidelines](.github/CONTRIBUTING.md).\n\n## References\n\n| Type                 | Title                                                                                                                                        | Author                                                                                 | Year |\n| -------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | ---- |\n| :video_camera: Video | [Stanford CS224N: NLP with Deep Learning Lecture 10 \u00e2\u20ac\u201c Question Answering](https://youtube.com/watch?v=yIdF-17HwSk)                           | Christopher Manning                                                                    | 2019 |\n| :newspaper: Paper    | [Reading Wikipedia to Answer Open-Domain Questions](https://arxiv.org/abs/1704.00051)                                                        | Danqi Chen, Adam Fisch, Jason Weston, Antoine Bordes                                   | 2017 |\n| :newspaper: Paper    | [Neural Reading Comprehension and Beyond](https://cs.stanford.edu/people/danqi/papers/thesis.pdf)                                            | Danqi Chen                                                                             | 2018 |\n| :newspaper: Paper    | [BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding](https://arxiv.org/abs/1810.04805)                         | Jacob Devlin, Ming-Wei Chang, Kenton Lee, Kristina Toutanova                           | 2018 |\n| :newspaper: Paper    | [Contextual Word Representations: A Contextual Introduction](https://arxiv.org/abs/1902.06006)                                               | Noah A. Smith                                                                          | 2019 |\n| :newspaper: Paper    | [End-to-End Open-Domain Question Answering with BERTserini](https://arxiv.org/abs/1902.01718)                                                | Wei Yang, Yuqing Xie, Aileen Lin, Xingyu Li, Luchen Tan, Kun Xiong, Ming Li, Jimmy Lin | 2019 |\n| :newspaper: Paper    | [Data Augmentation for BERT Fine-Tuning in Open-Domain Question Answering](https://arxiv.org/abs/1904.06652)                                 | Wei Yang, Yuqing Xie, Luchen Tan, Kun Xiong, Ming Li, Jimmy Lin                        | 2019 |\n| :newspaper: Paper    | [Passage Re-ranking with BERT](https://arxiv.org/abs/1901.04085)                                                                             | Rodrigo Nogueira, Kyunghyun Cho                                                        | 2019 |\n| :newspaper: Paper    | [MRQA: Machine Reading for Question Answering](https://mrqa.github.io/)                                                                      | Jonathan Berant, Percy Liang, Luke Zettlemoyer                                         | 2019 |\n| :newspaper: Paper    | [Unsupervised Question Answering by Cloze Translation](https://arxiv.org/abs/1906.04980)                                                     | Patrick Lewis, Ludovic Denoyer, Sebastian Riedel                                       | 2019 |\n| :computer: Framework | [Scikit-learn: Machine Learning in Python](http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html)                                           | Pedregosa et al.                                                                       | 2011 |\n| :computer: Framework | [PyTorch](https://arxiv.org/abs/1906.04980)                                                                                                  | Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan                               | 2016 |\n| :computer: Framework | [Transformers: State-of-the-art Natural Language Processing for TensorFlow 2.0 and PyTorch.](https://github.com/huggingface/transformers) | Hugging Face                                                                           | 2018 |\n\n## LICENSE\n\n[Apache-2.0](LICENSE)", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/VincentVega002/Idomeneo_cdQa", "keywords": "reading comprehension question answering deep learning natural language processing information retrieval bert", "license": "Apache-2.0", "maintainer": "", "maintainer_email": "", "name": "Idmeneo-cdQa", "package_url": "https://pypi.org/project/Idmeneo-cdQa/", "platform": "", "project_url": "https://pypi.org/project/Idmeneo-cdQa/", "project_urls": {"Homepage": "https://github.com/VincentVega002/Idomeneo_cdQa"}, "release_url": "https://pypi.org/project/Idmeneo-cdQa/0.0/", "requires_dist": null, "requires_python": "", "summary": "An End-To-End Closed Domain Question Answering System with sciBert", "version": "0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>cdQA: Closed Domain Question Answering</h1>\n<p><a href=\"https://travis-ci.com/cdqa-suite/cdQA\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/630ef7e2de938a115dbd4dad527c8a510225e750/68747470733a2f2f7472617669732d63692e636f6d2f636471612d73756974652f636451412e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://codecov.io/gh/cdqa-suite/cdQA\" rel=\"nofollow\"><img alt=\"codecov\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c32985c47aa31ab5c015c24fb6f20e44f3cc317c/68747470733a2f2f636f6465636f762e696f2f67682f636471612d73756974652f636451412f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a>\n<a href=\"https://pypi.org/project/cdqa/\" rel=\"nofollow\"><img alt=\"PyPI Version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/e4933e61dff88dc45470ef4c911da6f9a8abdf23/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f636471612e737667\"></a>\n<a href=\"https://pypi.org/project/cdqa/\" rel=\"nofollow\"><img alt=\"PyPI Downloads\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/0d9987b47afa8aacc425d85c8604ea018a68d6af/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f636471612e737667\"></a>\n<a href=\"https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-first-steps-cdqa.ipynb\" rel=\"nofollow\"><img alt=\"Binder\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/85e91bbb928104e4ce317951541520c6b9c170e1/68747470733a2f2f6d7962696e6465722e6f72672f62616467655f6c6f676f2e737667\"></a>\n<a href=\"https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-first-steps-cdqa.ipynb\" rel=\"nofollow\"><img alt=\"Colab\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/74d996556a82b2f1dd5252d2fd8bead60f9e9d21/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667\"></a>\n<a href=\".github/CODE_OF_CONDUCT.md\" rel=\"nofollow\"><img alt=\"Contributor Covenant\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/d94e24cdb0cbbbc49a69f8a244753ed1fe002b2c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f436f6e7472696275746f72253230436f76656e616e742d76312e3425323061646f707465642d6666363962342e737667\"></a>\n<a href=\"http://makeapullrequest.com\" rel=\"nofollow\"><img alt=\"PRs Welcome\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6482ead086859c79e80e1d7af03e30a98f345bf0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5052732d77656c636f6d652d627269676874677265656e2e737667\"></a>\n<img alt=\"GitHub\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ba2c54b0db954806f6288185aea8343397744563/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f636471612d73756974652f636451412e737667\"></p>\n<p>An End-To-End Closed Domain Question Answering System. Built on top of the HuggingFace <a href=\"https://github.com/huggingface/transformers\" rel=\"nofollow\">transformers</a> library.</p>\n<h2>cdQA in details</h2>\n<p>If you are interested in understanding how the system works and its implementation, we wrote an <a href=\"https://towardsdatascience.com/how-to-create-your-own-question-answering-system-easily-with-python-2ef8abc8eb5\" rel=\"nofollow\">article on Medium</a> with a high-level explanation.</p>\n<p>We also made a presentation during the #9 NLP Breakfast organised by <a href=\"feedly.com\" rel=\"nofollow\">Feedly</a>. You can check it out <a href=\"https://blog.feedly.com/nlp-breakfast-9-closed-domain-question-answering/\" rel=\"nofollow\">here</a>.</p>\n<h2>Table of Contents </h2>\n<ul>\n<li><a href=\"#Installation\" rel=\"nofollow\">Installation</a>\n<ul>\n<li><a href=\"#With-pip\" rel=\"nofollow\">With pip</a></li>\n<li><a href=\"#From-source\" rel=\"nofollow\">From source</a></li>\n<li><a href=\"#Hardware-Requirements\" rel=\"nofollow\">Hardware Requirements</a></li>\n</ul>\n</li>\n<li><a href=\"#Getting-started\" rel=\"nofollow\">Getting started</a>\n<ul>\n<li><a href=\"#Preparing-your-data\" rel=\"nofollow\">Preparing your data</a>\n<ul>\n<li><a href=\"#Manual\" rel=\"nofollow\">Manual</a></li>\n<li><a href=\"#With-converters\" rel=\"nofollow\">With converters</a></li>\n</ul>\n</li>\n<li><a href=\"#Downloading-pre-trained-models\" rel=\"nofollow\">Downloading pre-trained models</a></li>\n<li><a href=\"#Training-models\" rel=\"nofollow\">Training models</a></li>\n<li><a href=\"#Making-predictions\" rel=\"nofollow\">Making predictions</a></li>\n<li><a href=\"#Evaluating-models\" rel=\"nofollow\">Evaluating models</a></li>\n</ul>\n</li>\n<li><a href=\"#Notebook-Examples\" rel=\"nofollow\">Notebook Examples</a></li>\n<li><a href=\"#Deployment\" rel=\"nofollow\">Deployment</a>\n<ul>\n<li><a href=\"#Manual-1\" rel=\"nofollow\">Manual</a></li>\n</ul>\n</li>\n<li><a href=\"#Contributing\" rel=\"nofollow\">Contributing</a></li>\n<li><a href=\"#References\" rel=\"nofollow\">References</a></li>\n<li><a href=\"#LICENSE\" rel=\"nofollow\">LICENSE</a></li>\n</ul>\n<h2>Installation</h2>\n<h3>With pip</h3>\n<pre>pip install cdqa\n</pre>\n<h3>From source</h3>\n<pre>git clone https://github.com/cdqa-suite/cdQA.git\n<span class=\"nb\">cd</span> cdQA\npip install -e .\n</pre>\n<h3>Hardware Requirements</h3>\n<p>Experiments have been done with:</p>\n<ul>\n<li><strong>CPU</strong> \u0111\u017a\u2018\u2030 AWS EC2 <code>t2.medium</code> Deep Learning AMI (Ubuntu) Version 22.0</li>\n<li><strong>GPU</strong> \u0111\u017a\u2018\u2030 AWS EC2 <code>p3.2xlarge</code> Deep Learning AMI (Ubuntu) Version 22.0 + a single Tesla V100 16GB.</li>\n</ul>\n<h2>Getting started</h2>\n<h3>Preparing your data</h3>\n<h4>Manual</h4>\n<p>To use <code>cdQA</code> you need to create a pandas dataframe with the following columns:</p>\n<table>\n<thead>\n<tr>\n<th>title</th>\n<th>paragraphs</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>The Article Title</td>\n<td>[Paragraph 1 of Article, ... , Paragraph N of Article]</td>\n</tr></tbody></table>\n<h4>With converters</h4>\n<p>The objective of <code>cdqa</code> converters is to make it easy to create this dataframe from your raw documents database. For instance the <code>pdf_converter</code> can create a <code>cdqa</code> dataframe from a directory containing <code>.pdf</code> files:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cdqa.utils.converters</span> <span class=\"kn\">import</span> <span class=\"n\">pdf_converter</span>\n\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pdf_converter</span><span class=\"p\">(</span><span class=\"n\">directory_path</span><span class=\"o\">=</span><span class=\"s1\">'path_to_pdf_folder'</span><span class=\"p\">)</span>\n</pre>\n<p>You will need to install <a href=\"https://openjdk.java.net/install/\" rel=\"nofollow\">Java OpenJDK</a> to use this converter. We currently have converters for:</p>\n<ul>\n<li>pdf</li>\n<li>markdown</li>\n</ul>\n<p>We plan to improve and add more converters in the future. Stay tuned!</p>\n<h3>Downloading pre-trained models and data</h3>\n<p>You can download the models and data manually from the GitHub <a href=\"https://github.com/cdqa-suite/cdQA/releases\" rel=\"nofollow\">releases</a> or use our download functions:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cdqa.utils.download</span> <span class=\"kn\">import</span> <span class=\"n\">download_squad</span><span class=\"p\">,</span> <span class=\"n\">download_model</span><span class=\"p\">,</span> <span class=\"n\">download_bnpp_data</span>\n\n<span class=\"n\">directory</span> <span class=\"o\">=</span> <span class=\"s1\">'path-to-directory'</span>\n\n<span class=\"c1\"># Downloading data</span>\n<span class=\"n\">download_squad</span><span class=\"p\">(</span><span class=\"nb\">dir</span><span class=\"o\">=</span><span class=\"n\">directory</span><span class=\"p\">)</span>\n<span class=\"n\">download_bnpp_data</span><span class=\"p\">(</span><span class=\"nb\">dir</span><span class=\"o\">=</span><span class=\"n\">directory</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Downloading pre-trained BERT fine-tuned on SQuAD 1.1</span>\n<span class=\"n\">download_model</span><span class=\"p\">(</span><span class=\"s1\">'bert-squad_1.1'</span><span class=\"p\">,</span> <span class=\"nb\">dir</span><span class=\"o\">=</span><span class=\"n\">directory</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Downloading pre-trained DistilBERT fine-tuned on SQuAD 1.1</span>\n<span class=\"n\">download_model</span><span class=\"p\">(</span><span class=\"s1\">'distilbert-squad_1.1'</span><span class=\"p\">,</span> <span class=\"nb\">dir</span><span class=\"o\">=</span><span class=\"n\">directory</span><span class=\"p\">)</span>\n</pre>\n<h3>Training models</h3>\n<p>Fit the pipeline on your corpus using the pre-trained reader:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">pandas</span> <span class=\"k\">as</span> <span class=\"nn\">pd</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ast</span> <span class=\"kn\">import</span> <span class=\"n\">literal_eval</span>\n<span class=\"kn\">from</span> <span class=\"nn\">cdqa.pipeline</span> <span class=\"kn\">import</span> <span class=\"n\">QAPipeline</span>\n\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">read_csv</span><span class=\"p\">(</span><span class=\"s1\">'your-custom-corpus-here.csv'</span><span class=\"p\">,</span> <span class=\"n\">converters</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">'paragraphs'</span><span class=\"p\">:</span> <span class=\"n\">literal_eval</span><span class=\"p\">})</span>\n\n<span class=\"n\">cdqa_pipeline</span> <span class=\"o\">=</span> <span class=\"n\">QAPipeline</span><span class=\"p\">(</span><span class=\"n\">reader</span><span class=\"o\">=</span><span class=\"s1\">'bert_qa.joblib'</span><span class=\"p\">)</span> <span class=\"c1\"># use 'distilbert_qa.joblib' for DistilBERT instead of BERT</span>\n<span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">fit_retriever</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"o\">=</span><span class=\"n\">df</span><span class=\"p\">)</span>\n</pre>\n<p>If you want to fine-tune the reader on your custom SQuAD-like annotated dataset:</p>\n<pre><span class=\"n\">cdqa_pipeline</span> <span class=\"o\">=</span> <span class=\"n\">QAPipeline</span><span class=\"p\">(</span><span class=\"n\">reader</span><span class=\"o\">=</span><span class=\"s1\">'bert_qa.joblib'</span><span class=\"p\">)</span> <span class=\"c1\"># use 'distilbert_qa.joblib' for DistilBERT instead of BERT</span>\n<span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">fit_reader</span><span class=\"p\">(</span><span class=\"s1\">'path-to-custom-squad-like-dataset.json'</span><span class=\"p\">)</span>\n</pre>\n<p>Save the reader model after fine-tuning:</p>\n<pre><span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">dump_reader</span><span class=\"p\">(</span><span class=\"s1\">'path-to-save-bert-reader.joblib'</span><span class=\"p\">)</span>\n</pre>\n<h3>Making predictions</h3>\n<p>To get the best prediction given an input query:</p>\n<pre><span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"s1\">'your question'</span><span class=\"p\">)</span>\n</pre>\n<p>To get the N best predictions:</p>\n<pre><span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"s1\">'your question'</span><span class=\"p\">,</span> <span class=\"n\">n_predictions</span><span class=\"o\">=</span><span class=\"n\">N</span><span class=\"p\">)</span>\n</pre>\n<p>There is also the possibility to change the weight of the retriever score\nversus the reader score in the computation of final ranking score (the default is 0.35, which is shown to be the best weight on the development set of SQuAD 1.1-open)</p>\n<pre><span class=\"n\">cdqa_pipeline</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"s1\">'your question'</span><span class=\"p\">,</span> <span class=\"n\">retriever_score_weight</span><span class=\"o\">=</span><span class=\"mf\">0.35</span><span class=\"p\">)</span>\n</pre>\n<h3>Evaluating models</h3>\n<p>In order to evaluate models on your custom dataset you will need to annotate it. The annotation process can be done in 3 steps:</p>\n<ol>\n<li>\n<p>Convert your pandas DataFrame into a json file with SQuAD format:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cdqa.utils.converters</span> <span class=\"kn\">import</span> <span class=\"n\">df2squad</span>\n\n<span class=\"n\">json_data</span> <span class=\"o\">=</span> <span class=\"n\">df2squad</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"o\">=</span><span class=\"n\">df</span><span class=\"p\">,</span> <span class=\"n\">squad_version</span><span class=\"o\">=</span><span class=\"s1\">'v1.1'</span><span class=\"p\">,</span> <span class=\"n\">output_dir</span><span class=\"o\">=</span><span class=\"s1\">'.'</span><span class=\"p\">,</span> <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">'dataset-name'</span><span class=\"p\">)</span>\n</pre>\n</li>\n<li>\n<p>Use an annotator to add ground truth question-answer pairs:</p>\n<p>Please refer to our <a href=\"https://github.com/cdqa-suite/cdQA-annotator\" rel=\"nofollow\"><code>cdQA-annotator</code></a>, a web-based annotator for closed-domain question answering datasets with SQuAD format.</p>\n</li>\n<li>\n<p>Evaluate the pipeline object:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cdqa.utils.evaluation</span> <span class=\"kn\">import</span> <span class=\"n\">evaluate_pipeline</span>\n\n<span class=\"n\">evaluate_pipeline</span><span class=\"p\">(</span><span class=\"n\">cdqa_pipeline</span><span class=\"p\">,</span> <span class=\"s1\">'path-to-annotated-dataset.json'</span><span class=\"p\">)</span>\n</pre>\n</li>\n<li>\n<p>Evaluate the reader:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cdqa.utils.evaluation</span> <span class=\"kn\">import</span> <span class=\"n\">evaluate_reader</span>\n\n<span class=\"n\">evaluate_reader</span><span class=\"p\">(</span><span class=\"n\">cdqa_pipeline</span><span class=\"p\">,</span> <span class=\"s1\">'path-to-annotated-dataset.json'</span><span class=\"p\">)</span>\n</pre>\n</li>\n</ol>\n<h2>Notebook Examples</h2>\n<p>We prepared some notebook examples under the <a href=\"examples\" rel=\"nofollow\">examples</a> directory.</p>\n<p>You can also play directly with these notebook examples using <a href=\"https://gke.mybinder.org/\" rel=\"nofollow\">Binder</a> or <a href=\"https://colab.research.google.com/notebooks/welcome.ipynb\" rel=\"nofollow\">Google Colaboratory</a>:</p>\n<table>\n<thead>\n<tr>\n<th>Notebook</th>\n<th>Hardware</th>\n<th>Platform</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[1] First steps with cdQA</td>\n<td>CPU or GPU</td>\n<td><a href=\"https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-first-steps-cdqa.ipynb\" rel=\"nofollow\"><img alt=\"Binder\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/85e91bbb928104e4ce317951541520c6b9c170e1/68747470733a2f2f6d7962696e6465722e6f72672f62616467655f6c6f676f2e737667\"></a> <a href=\"https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-first-steps-cdqa.ipynb\" rel=\"nofollow\"><img alt=\"Colab\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/74d996556a82b2f1dd5252d2fd8bead60f9e9d21/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667\"></a></td>\n</tr>\n<tr>\n<td>[2] Using the PDF converter</td>\n<td>CPU or GPU</td>\n<td><a href=\"https://mybinder.org/v2/gh/cdqa-suite/cdQA/master?filepath=examples%2Ftutorial-use-pdf-converter.ipynb\" rel=\"nofollow\"><img alt=\"Binder\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/85e91bbb928104e4ce317951541520c6b9c170e1/68747470733a2f2f6d7962696e6465722e6f72672f62616467655f6c6f676f2e737667\"></a> <a href=\"https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-use-pdf-converter.ipynb\" rel=\"nofollow\"><img alt=\"Colab\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/74d996556a82b2f1dd5252d2fd8bead60f9e9d21/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667\"></a></td>\n</tr>\n<tr>\n<td>[3] Training the reader on SQuAD</td>\n<td>GPU</td>\n<td><a href=\"https://colab.research.google.com/github/cdqa-suite/cdQA/blob/master/examples/tutorial-train-reader-squad.ipynb\" rel=\"nofollow\"><img alt=\"Colab\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/74d996556a82b2f1dd5252d2fd8bead60f9e9d21/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667\"></a></td>\n</tr></tbody></table>\n<p>Binder and Google Colaboratory provide temporary environments and may be slow to start but we recommend them if you want to get started with <code>cdQA</code> easily.</p>\n<h2>Deployment</h2>\n<h3>Manual</h3>\n<p>You can deploy a <code>cdQA</code> REST API by executing:</p>\n<pre><span class=\"nb\">export</span> <span class=\"nv\">dataset_path</span><span class=\"o\">=</span>path-to-dataset.csv\n<span class=\"nb\">export</span> <span class=\"nv\">reader_path</span><span class=\"o\">=</span>path-to-reader-model\n\n<span class=\"nv\">FLASK_APP</span><span class=\"o\">=</span>api.py flask run -h <span class=\"m\">0</span>.0.0.0\n</pre>\n<p>You can now make requests to test your API (here using <a href=\"https://httpie.org/\" rel=\"nofollow\">HTTPie</a>):</p>\n<pre>http localhost:5000/api <span class=\"nv\">query</span><span class=\"o\">==</span><span class=\"s1\">'your question here'</span>\n</pre>\n<p>If you wish to serve a user interface on top of your <code>cdQA</code> system, follow the instructions of <a href=\"https://github.com/cdqa-suite/cdQA-ui\" rel=\"nofollow\">cdQA-ui</a>, a web interface developed for <code>cdQA</code>.</p>\n<h2>Contributing</h2>\n<p>Read our <a href=\".github/CONTRIBUTING.md\" rel=\"nofollow\">Contributing Guidelines</a>.</p>\n<h2>References</h2>\n<table>\n<thead>\n<tr>\n<th>Type</th>\n<th>Title</th>\n<th>Author</th>\n<th>Year</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>:video_camera: Video</td>\n<td><a href=\"https://youtube.com/watch?v=yIdF-17HwSk\" rel=\"nofollow\">Stanford CS224N: NLP with Deep Learning Lecture 10 \u00e2\u20ac\u201c Question Answering</a></td>\n<td>Christopher Manning</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1704.00051\" rel=\"nofollow\">Reading Wikipedia to Answer Open-Domain Questions</a></td>\n<td>Danqi Chen, Adam Fisch, Jason Weston, Antoine Bordes</td>\n<td>2017</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://cs.stanford.edu/people/danqi/papers/thesis.pdf\" rel=\"nofollow\">Neural Reading Comprehension and Beyond</a></td>\n<td>Danqi Chen</td>\n<td>2018</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1810.04805\" rel=\"nofollow\">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</a></td>\n<td>Jacob Devlin, Ming-Wei Chang, Kenton Lee, Kristina Toutanova</td>\n<td>2018</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1902.06006\" rel=\"nofollow\">Contextual Word Representations: A Contextual Introduction</a></td>\n<td>Noah A. Smith</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1902.01718\" rel=\"nofollow\">End-to-End Open-Domain Question Answering with BERTserini</a></td>\n<td>Wei Yang, Yuqing Xie, Aileen Lin, Xingyu Li, Luchen Tan, Kun Xiong, Ming Li, Jimmy Lin</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1904.06652\" rel=\"nofollow\">Data Augmentation for BERT Fine-Tuning in Open-Domain Question Answering</a></td>\n<td>Wei Yang, Yuqing Xie, Luchen Tan, Kun Xiong, Ming Li, Jimmy Lin</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1901.04085\" rel=\"nofollow\">Passage Re-ranking with BERT</a></td>\n<td>Rodrigo Nogueira, Kyunghyun Cho</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://mrqa.github.io/\" rel=\"nofollow\">MRQA: Machine Reading for Question Answering</a></td>\n<td>Jonathan Berant, Percy Liang, Luke Zettlemoyer</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:newspaper: Paper</td>\n<td><a href=\"https://arxiv.org/abs/1906.04980\" rel=\"nofollow\">Unsupervised Question Answering by Cloze Translation</a></td>\n<td>Patrick Lewis, Ludovic Denoyer, Sebastian Riedel</td>\n<td>2019</td>\n</tr>\n<tr>\n<td>:computer: Framework</td>\n<td><a href=\"http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html\" rel=\"nofollow\">Scikit-learn: Machine Learning in Python</a></td>\n<td>Pedregosa et al.</td>\n<td>2011</td>\n</tr>\n<tr>\n<td>:computer: Framework</td>\n<td><a href=\"https://arxiv.org/abs/1906.04980\" rel=\"nofollow\">PyTorch</a></td>\n<td>Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan</td>\n<td>2016</td>\n</tr>\n<tr>\n<td>:computer: Framework</td>\n<td><a href=\"https://github.com/huggingface/transformers\" rel=\"nofollow\">Transformers: State-of-the-art Natural Language Processing for TensorFlow 2.0 and PyTorch.</a></td>\n<td>Hugging Face</td>\n<td>2018</td>\n</tr></tbody></table>\n<h2>LICENSE</h2>\n<p><a href=\"LICENSE\" rel=\"nofollow\">Apache-2.0</a></p>\n\n          </div>"}, "last_serial": 6921908, "releases": {"0.0": [{"comment_text": "", "digests": {"md5": "e97988e9c27005887b3dbcd27f2b2556", "sha256": "95f39b5ab145c134e5b3b6b445683be559cbf0fcb6ab50c35b8ace265b5a47c2"}, "downloads": -1, "filename": "Idmeneo_cdQa-0.0.tar.gz", "has_sig": false, "md5_digest": "e97988e9c27005887b3dbcd27f2b2556", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 35389, "upload_time": "2020-03-31T18:08:50", "upload_time_iso_8601": "2020-03-31T18:08:50.190686Z", "url": "https://files.pythonhosted.org/packages/7c/ed/36ecd2a2e7456a27e1348211f4011022d22d2f8a3e3d37fc2b27ab78e485/Idmeneo_cdQa-0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "e97988e9c27005887b3dbcd27f2b2556", "sha256": "95f39b5ab145c134e5b3b6b445683be559cbf0fcb6ab50c35b8ace265b5a47c2"}, "downloads": -1, "filename": "Idmeneo_cdQa-0.0.tar.gz", "has_sig": false, "md5_digest": "e97988e9c27005887b3dbcd27f2b2556", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 35389, "upload_time": "2020-03-31T18:08:50", "upload_time_iso_8601": "2020-03-31T18:08:50.190686Z", "url": "https://files.pythonhosted.org/packages/7c/ed/36ecd2a2e7456a27e1348211f4011022d22d2f8a3e3d37fc2b27ab78e485/Idmeneo_cdQa-0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:48:52 2020"}