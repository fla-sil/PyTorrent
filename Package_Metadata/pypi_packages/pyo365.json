{"info": {"author": "Janscas", "author_email": "janscas@users.noreply.github.com", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: Developers", "License :: OSI Approved :: Apache Software License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Programming Language :: Python :: 3 :: Only", "Topic :: Office/Business :: Office Suites", "Topic :: Software Development :: Libraries"], "description": "# pyo365 - Microsoft Graph and Office 365 API made easy\n\nThis project aims is to make it easy to interact with Microsoft Graph and Office 365 Email, Contacts, Calendar, OneDrive, etc.\n\nThis project is inspired on the super work done by [Toben Archer](https://github.com/Narcolapser) [Python-O365](https://github.com/Narcolapser/python-o365).\nThe oauth part is based on the work done by [Royce Melborn](https://github.com/roycem90) which is now integrated with the original project.\n\nI just want to make this project different in almost every sense, and make it also more pythonic.\nSo I ended up rewriting the whole project from scratch.\n\nThe result is a package that provides a lot of the Microsoft Graph and Office 365 API capabilities.\n\nThis is for example how you send a message:\n\n```python\nfrom pyo365 import Account\n\ncredentials = ('client_id', 'client_secret')\n\naccount = Account(credentials)\nm = account.new_message()\nm.to.add('to_example@example.com')\nm.subject = 'Testing!'\nm.body = \"George Best quote: I've stopped drinking, but only while I'm asleep.\"\nm.send()\n```\n\n\n**Python 3.4 is the minimum required**... I was very tempted to just go for 3.6 and use f-strings. Those are fantastic!\n\nThis project was also a learning resource for me. This is a list of not so common python characteristics used in this project:\n- New unpacking technics: `def method(argument, *, with_name=None, **other_params):`\n- Enums: `from enum import Enum`\n- Factory paradigm\n- Package organization\n- Timezone conversion and timezone aware datetimes\n- Etc. (see the code!)\n\n> **This project is in early development.** Changes that can break your code may be commited. If you want to help please feel free to fork and make pull requests.\n\n\nWhat follows is kind of a wiki... but you will get more insights by looking at the code.\n\n## Table of contents\n\n- [Install](#install)\n- [Protocols](#protocols)\n- [Authentication](#authentication)\n- [Account Class and Modularity](#account)\n- [MailBox](#mailbox)\n- [AddressBook](#addressbook)\n- [Calendar](#calendar)\n- [OneDrive](#onedrive)\n- [Sharepoint](#sharepoint)\n- [Utils](#utils)\n\n\n## Install\npyo365 is available on pypi.org. Simply run `pip install pyo365` to install it.\n\nProject dependencies installed by pip:\n - requests\n - requests-oauthlib\n - beatifulsoup4\n - stringcase\n - python-dateutil\n - tzlocal\n - pytz\n\nThe first step to be able to work with this library is to register an application and retrieve the auth token. See [Authentication](#authentication).\n\n## Protocols\nProtocols handles the aspects of comunications between different APIs.\nThis project uses by default either the Office 365 APIs or Microsoft Graph APIs.\nBut, you can use many other Microsoft APIs as long as you implement the protocol needed.\n\nYou can use one or the other:\n\n- `MSGraphProtocol` to use the [Microsoft Graph API](https://developer.microsoft.com/en-us/graph/docs/concepts/overview)\n- `MSOffice365Protocol` to use the [Office 365 API](https://msdn.microsoft.com/en-us/office/office365/api/api-catalog)\n\nBoth protocols are similar but the Graph one has access to more resources (for example OneDrive). It also depends on the api version used.\n\nThe default protocol used by the `Account` Class is `MSGraphProtocol`.\n\nYou can implement your own protocols by inheriting from `Protocol` to communicate with other Microsoft APIs.\n\nYou can instantiate protocols like this:\n```python\nfrom pyo365 import MSGraphProtocol\n\n# try the api version beta of the Microsoft Graph endpoint.\nprotocol = MSGraphProtocol(api_version='beta')  # MSGraphProtocol defaults to v1.0 api version\n```\n\n##### Resources:\nEach API endpoint requires a resource. This usually defines the owner of the data.\nEvery protocol defaults to resource 'ME'. 'ME' is the user which has given consent, but you can change this behaviour by providing a different default resource to the protocol constructor.\n\nFor example when accesing a shared mailbox:\n\n\n```python\n# ...\naccount = Account(credentials=my_credentials, main_resource='shared_mailbox@example.com')\n# Any instance created using account will inherit the resource defined for account.\n```\n\nThis can be done however at any point. For example at the protocol level:\n```python\n# ...\nmy_protocol = MSGraphProtocol(default_resource='shared_mailbox@example.com')\n\naccount = Account(credentials=my_credentials, protocol=my_protocol)\n\n# now account is accesing the shared_mailbox@example.com in every api call.\nshared_mailbox_messages = account.mailbox().get_messages()\n```\n\n\n\nInstead of defining the resource used at the account or protocol level, you can provide it per use case as follows:\n```python\n# ...\naccount = Account(credentials=my_credentials)  # account defaults to 'ME' resource\n\nmailbox = account.mailbox('shared_mailbox@example.com')  # mailbox is using 'shared_mailbox@example.com' resource instead of 'ME'\n\n# or:\n\nmessage = Message(parent=account, main_resource='shared_mailbox@example.com')  # message is using 'shared_mailbox@example.com' resource\n```\n\nUsually you will work with the default 'ME' resuorce, but you can also use one of the following:\n\n- **'me'**: the user which has given consent. the default for every protocol.\n- **'user:user@domain.com'**: a shared mailbox or a user account for which you have permissions. If you don't provide 'user:' will be infered anyways.\n- **'sharepoint:sharepoint-site-id'**: a sharepoint site id.\n- **'group:group-site-id'**: a office365 group id.  \n\n## Authentication\nYou can only authenticate using oauth athentication as Microsoft deprecated basic oauth on November 1st 2018.\n\n- Oauth authentication: using an authentication token provided after user consent.\n\nThe `Connection` Class handles the authentication.\n\n#### Oauth Authentication\nThis section is explained using Microsoft Graph Protocol, almost the same applies to the Office 365 REST API.\n\n\n##### Permissions and Scopes:\nWhen using oauth you create an application and allow some resources to be accesed and used by it's users.\nThen the user can request access to one or more of this resources by providing scopes to the oauth provider.\n\nFor example your application can have Calendar.Read, Mail.ReadWrite and Mail.Send permissions, but the application can request access only to the Mail.ReadWrite and Mail.Send permission.\nThis is done by providing scopes to the connection object like so:\n```python\nfrom pyo365 import Connection\n\ncredentials = ('client_id', 'client_secret')\n\nscopes = ['https://graph.microsoft.com/Mail.ReadWrite', 'https://graph.microsoft.com/Mail.Send']\n\ncon = Connection(credentials, scopes=scopes)\n```\n\nScope implementation depends on the protocol used. So by using protocol data you can automatically set the scopes needed:\n\nYou can get the same scopes as before using protocols like this:\n\n```python\nprotocol_graph = MSGraphProtocol()\n\nscopes_graph = protocol.get_scopes_for('message all')\n# scopes here are: ['https://graph.microsoft.com/Mail.ReadWrite', 'https://graph.microsoft.com/Mail.Send']\n\nprotocol_office = MSOffice365Protocol()\n\nscopes_office = protocol.get_scopes_for('message all')\n# scopes here are: ['https://outlook.office.com/Mail.ReadWrite', 'https://outlook.office.com/Mail.Send']\n\ncon = Connection(credentials, scopes=scopes_graph)\n```\n\n\n##### Authentication Flow\n1. To work with oauth you first need to register your application at [Microsoft Application Registration Portal](https://apps.dev.microsoft.com/).\n\n    1. Login at [Microsoft Application Registration Portal](https://apps.dev.microsoft.com/)\n    2. Create an app, note your app id (client_id)\n    3. Generate a new password (client_secret) under \"Application Secrets\" section\n    4. Under the \"Platform\" section, add a new Web platform and set \"https://outlook.office365.com/owa/\" as the redirect URL\n    5. Under \"Microsoft Graph Permissions\" section, add the delegated permissions you want (see scopes), as an example, to read and send emails use:\n        1. Mail.ReadWrite\n        2. Mail.Send\n        3. User.Read\n\n2. Then you need to login for the first time to get the access token by consenting the application to access the resources it needs.\n    1. First get the authorization url.\n        ```python\n        url = account.connection.get_authorization_url()\n        ```\n    2. The user must visit this url and give consent to the application. When consent is given, the page will rediret to: \"https://outlook.office365.com/owa/\".\n\n       Then the user must copy the resulting page url and give it to the connection object:\n\n        ```python\n        result_url = input('Paste the result url here...')\n\n        account.connection.request_token(result_url)  # This, if succesful, will store the token in a txt file on the user project folder.\n        ```\n\n        <span style=\"color:red\">Take care, the access token must remain protected from unauthorized users.</span>\n\n    3. At this point you will have an access token that will provide valid credentials when using the api. If you change the scope requested, then the current token won't work, and you will need the user to give consent again on the application to gain access to the new scopes requested.\n\n    The access token only lasts 60 minutes, but the app will automatically request new tokens through the refresh tokens, but note that a refresh token only lasts for 90 days. So you must use it before or you will need to request a new access token again (no new consent needed by the user, just a login).\n\n    If your application needs to work for more than 90 days without user interaction and without interacting with the API, then you must implement a periodic call to `Connection.refresh_token` before the 90 days have passed.\n\n\n##### Using pyo365 to authenticate\n\nYou can manually authenticate by using a single `Connection` instance as described before or use the helper methods provided by the library.\n\n1. `account.authenticate`:\n\n    This is the preferred way for performing authentication.\n\n    Create an `Account` instance and authenticate using the `authenticate` method:\n    ```python\n    from pyo365 import Account\n\n    account = Account(credentials=('client_id', 'client_secret'))\n    result = account.authenticate(scopes=['basic', 'message_all'])  # request a token for this scopes\n\n    # this will ask to visit the app consent screen where the user will be asked to give consent on the requested scopes.\n    # then the user will have to provide the result url afeter consent. \n    # if all goes as expected, result will be True and a token will be stored in the default location.\n    ```\n\n2. `oauth_authentication_flow`:\n\n    ```python\n    from pyo365 import oauth_authentication_flow\n\n    result = oauth_authentication_flow('client_id', 'client_secret', ['scopes_required'])\n    ```\n\n## Account Class and Modularity <a name=\"account\"></a>\nUsually you will only need to work with the `Account` Class. This is a wrapper around all functionality.\n\nBut you can also work only with the pieces you want.\n\nFor example, instead of:\n```python\nfrom pyo365 import Account\n\naccount = Account(('client_id', 'client_secret'))\nmessage = account.new_message()\n# ...\nmailbox = account.mailbox()\n# ...\n```\n\nYou can work only with the required pieces:\n\n```python\nfrom pyo365 import Connection, MSGraphProtocol, Message, MailBox\n\nmy_protocol = MSGraphProtocol()\ncon = Connection(('client_id', 'client_secret'))\n\nmessage = Message(con=con, protocol=my_protocol)\n# ...\nmailbox = MailBox(con=con, protocol=my_protocol)\nmessage2 = Message(parent=mailbox)  # message will inherit the connection and protocol from mailbox when using parent.\n# ...\n```\n\nIt's also easy to implement a custom Class.\n\nJust Inherit from `ApiComponent`, define the endpoints, and use the connection to make requests. If needed also inherit from Protocol to handle different comunications aspects with the API server.\n\n```python\nfrom pyo365.utils import ApiComponent \n\nclass CustomClass(ApiComponent):\n    _endpoints = {'my_url_key': '/customendpoint'}\n\n    def __init__(self, *, parent=None, con=None, **kwargs):\n        super().__init__(parent=parent, con=con, **kwargs)\n        # ...\n\n    def do_some_stuff(self):\n\n        # self.build_url just merges the protocol service_url with the enpoint passed as a parameter\n        # to change the service_url implement your own protocol inherinting from Protocol Class\n        url = self.build_url(self._endpoints.get('my_url_key'))  \n\n        my_params = {'param1': 'param1'}\n\n        response = self.con.get(url, params=my_params)  # note the use of the connection here.\n\n        # handle response and return to the user...\n```\n\n## MailBox\nMailbox groups the funcionality of both the messages and the email folders.\n\n```python\nmailbox = account.mailbox()\n\ninbox = mailbox.inbox_folder()\n\nfor message in inbox.get_messages():\n    print(message)\n\nsent_folder = mailbox.sent_folder()\n\nfor message in sent_folder.get_messages():\n    print(message)\n\nm = mailbox.new_message()\n\nm.to.add('to_example@example.com')\nm.body = 'George Best quote: In 1969 I gave up women and alcohol - it was the worst 20 minutes of my life.'\nm.save_draft()\n```\n\n#### Email Folder\nRepresents a `Folder` within your email mailbox.\n\nYou can get any folder in your mailbox by requesting child folders or filtering by name.\n\n```python\nmailbox = account.mailbox()\n\narchive = mailbox.get_folder(folder_name='archive')  # get a folder with 'archive' name\n\nchild_folders = archive.get_folders(25) # get at most 25 child folders of 'archive' folder\n\nfor folder in child_folders:\n    print(folder.name, folder.parent_id)\n\nnew_folder = archive.create_child_folder('George Best Quotes')\n```\n\n#### Message\nAn email object with all it's data and methods.\n\nCreating a draft message is as easy as this:\n```python\nmessage = mailbox.new_message()\nmessage.to.add(['example1@example.com', 'example2@example.com'])\nmessage.sender.address = 'my_shared_account@example.com'  # changing the from address\nmessage.body = 'George Best quote: I might go to Alcoholics Anonymous, but I think it would be difficult for me to remain anonymous'\nmessage.attachments.add('george_best_quotes.txt')\nmessage.save_draft()  # save the message on the cloud as a draft in the drafts folder\n```\n\nWorking with saved emails is also easy:\n```python\nquery = mailbox.new_query().on_attribute('subject').contains('george best')  # see Query object in Utils\nmessages = mailbox.get_messages(limit=25, query=query)\n\nmessage = messages[0]  # get the first one\n\nmessage.mark_as_read()\nreply_msg = message.reply()\n\nif 'example@example.com' in reply_msg.to:  # magic methods implemented\n    reply_msg.body = 'George Best quote: I spent a lot of money on booze, birds and fast cars. The rest I just squandered.'\nelse:\n    reply_msg.body = 'George Best quote: I used to go missing a lot... Miss Canada, Miss United Kingdom, Miss World.'\n\nreply_msg.send()\n```\n\n## AddressBook\nAddressBook groups the funcionality of both the Contact Folders and Contacts. Outlook Distribution Groups are not supported (By the Microsoft API's).\n\n#### Contact Folders\nRepresents a Folder within your Contacts Section in Office 365.\nAddressBook class represents the parent folder (it's a folder itself).\n\nYou can get any folder in your address book by requesting child folders or filtering by name.\n\n```python\naddress_book = account.address_book()\n\ncontacts = address_book.get_contacts(limit=None)  # get all the contacts in the Personal Contacts root folder\n\nwork_contacts_folder = address_book.get_folder(folder_name='Work Contacts')  # get a folder with 'Work Contacts' name\n\nmessage_to_all_contats_in_folder = work_contacts_folder.new_message()  # creates a draft message with all the contacts as recipients\n\nmessage_to_all_contats_in_folder.subject = 'Hallo!'\nmessage_to_all_contats_in_folder.body = \"\"\"\nGeorge Best quote:\n\nIf you'd given me the choice of going out and beating four men and smashing a goal in\nfrom thirty yards against Liverpool or going to bed with Miss World,\nit would have been a difficult choice. Luckily, I had both.\n\"\"\"\nmessage_to_all_contats_in_folder.send()\n\n# querying folders is easy:\nchild_folders = address_book.get_folders(25) # get at most 25 child folders\n\nfor folder in child_folders:\n    print(folder.name, folder.parent_id)\n\n# creating a contact folder:\naddress_book.create_child_folder('new folder')\n```\n\n#### The Global Address List\nOffice 365 API (Nor MS Graph API) has no concept such as the Outlook Global Address List.\nHowever you can use the [Users API](https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/resources/users) to access all the users within your organization.\n\nWithout admin consent you can only access a few properties of each user such as name and email and litte more.\nYou can search by name or retrieve a contact specifying the complete email.\n\n- Basic Permision needed is Users.ReadBasic.All (limit info)\n- Full Permision is Users.Read.All but needs admin consent.\n\nTo search the Global Address List (Users API):\n\n```python\nglobal_address_list = account.address_book(address_book='gal')\n\n# start a new query:\nq = global_address_list.new_query('display_name')\nq.startswith('George Best')\n\nprint(global_address_list.get_contacts(query=q))\n```\n\n\nTo retrieve a contact by it's email:\n\n```python\ncontact = global_address_list.get_contact_by_email('example@example.com')\n```\n\n#### Contacts\nEverything returned from an `AddressBook` instance is a `Contact` instance.\nContacts have all the information stored as attributes\n\nCreating a contact from an `AddressBook`:\n\n```python\nnew_contact = address_book.new_contact()\n\nnew_contact.name = 'George Best'\nnew_contact.job_title = 'football player'\nnew_contact.emails.add('george@best.com')\n\nnew_contact.save()  # saved on the cloud\n\nmessage = new_contact.new_message()  #  Bonus: send a message to this contact\n\n# ...\n\nnew_contact.delete()  # Bonus: deteled from the cloud\n```\n\n\n## Calendar\nThe calendar and events functionality is group in a `Schedule` object.\n\nA `Schedule` instance can list and create calendars. It can also list or create events on the default user calendar.\nTo use other calendars use a `Calendar` instance.  \n\nWorking with the `Schedule` instance:\n```python\nimport datetime as dt\n\n# ...\nschedule = account.schedule()\n\nnew_event = schedule.new_event()  # creates a new event in the user default calendar\nnew_event.subject = 'Recruit George Best!'\nnew_event.location = 'England'\n\n# naive datetimes will automatically be converted to timezone aware datetime\n#  objects using the local timezone detected or the protocol provided timezone\n\nnew_event.start = dt.datetime(2018, 9, 5, 19, 45) \n# so new_event.start becomes: datetime.datetime(2018, 9, 5, 19, 45, tzinfo=<DstTzInfo 'Europe/Paris' CEST+2:00:00 DST>)\n\nnew_event.recurrence.set_daily(1, end=dt.datetime(2018, 9, 10))\nnew_event.remind_before_minutes = 45\n\nnew_event.save()\n```\n\nWorking with `Calendar` instances:\n```python\ncalendar = schedule.get_calendar(calendar_name='Birthdays')\n\ncalendar.name = 'Football players birthdays'\ncalendar.update()\n\nq = calendar.new_query('start').ge(dt.datetime(2018, 5, 20)).chain('and').on_attribute('end').le(dt.datetime(2018, 5, 24))\n\nbirthdays = calendar.get_events(query=q)\n\nfor event in birthdays:\n    if event.subject == 'George Best Birthday':\n        # He died in 2005... but we celebrate anyway!\n        event.accept(\"I'll attend!\")  # send a response accepting\n    else:\n        event.decline(\"No way I'm comming, I'll be in Spain\", send_response=False)  # decline the event but don't send a reponse to the organizer\n```\n\n## OneDrive\nThe `Storage` class handles all functionality around One Drive and Document Library Storage in Sharepoint.\n\nThe `Storage` instance allows to retrieve `Drive` instances which handles all the Files and Folders from within the selected `Storage`.\nUsually you will only need to work with the default drive. But the `Storage` instances can handle multiple drives.\n\n\nA `Drive` will allow you to work with Folders and Files.\n\n```python\naccount = Account(credentials=my_credentials)\n\nstorage = account.storage()  # here we get the storage instance that handles all the storage options.\n\n# list all the drives:\ndrives = storage.get_drives()\n\n# get the default drive\nmy_drive = storage.get_default_drive()  # or get_drive('drive-id')\n\n# get some folders:\nroot_folder = my_drive.get_root_folder()\nattachments_folder = my_drive.get_special_folder('attachments')\n\n# iterate over the first 25 items on the root folder\nfor item in root_folder.get_items(limit=25):\n    if item.is_folder:\n        print(item.get_items(2))  # print the first to element on this folder.\n    elif item.is_file:\n        if item.is_photo:\n            print(item.camera_model)  # print some metadata of this photo\n        elif item.is_image:\n            print(item.dimensione)  # print the image dimensions\n        else:\n            # regular file:\n            print(item.mime_type)  # print the mime type\n```\n\nBoth Files and Folders are DriveItems. Both Image and Photo are Files, but Photo is also an Image. All have some different methods and properties. \nTake care when using 'is_xxxx'.\n\nWhen coping a DriveItem the api can return a direct copy of the item or a pointer to a resource that will inform on the progress of the copy operation.\n\n```python\n# copy a file to the documents special folder\n\ndocuments_folder = drive.get_special_folder('documents')\n\nfiles = drive.search('george best quotes', limit=1)\n\nif files:\n    george_best_quotes = files[0]\n    operation = george_best_quotes.copy(target=documents_folder)  # operation here is an instance of CopyOperation\n\n    # to check for the result just loop over check_status.\n    # check_status is a generator that will yield a new status and progress until the file is finally copied\n    for status, progress in operation.check_status():  # if it's an async operations, this will request to the api for the status in every loop\n        print('{} - {}'.format(status, progress))  # prints 'in progress - 77.3' until finally completed: 'completed - 100.0'\n    copied_item = operation.get_item()  # the copy operation is completed so you can get the item.\n    if copied_item:\n        copied_item.delete()  # ... oops!\n```\n\nYou can also work with share permissions:\n\n```python\ncurrent_permisions = file.get_permissions()  # get all the current permissions on this drive_item (some may be inherited)\n\n# share with link\npermission = file.share_with_link(share_type='edit')\nif permission:\n    print(permission.share_link)  # the link you can use to share this drive item\n# share with invite\npermission = file.share_with_invite(recipients='george_best@best.com', send_email=True, message='Greetings!!', share_type='edit')\nif permission:\n    print(permission.granted_to)  # the person you share this item with\n```\n\nYou can also:\n```python\n# download files:\nfile.download(to_path='/quotes/')\n\n# upload files:\n\n# if the uploaded file is bigger than 4MB the file will be uploaded in chunks of 5 MB until completed.\n# this can take several requests and can be time consuming.\nuploaded_file = folder.upload_file(item='path_to_my_local_file')\n\n# restore versions:\nversiones = file.get_versions()\nfor version in versions:\n    if version.name == '2.0':\n        version.restore()  # restore the version 2.0 of this file\n\n# ... and much more ...\n```\n\n\n## Sharepoint\nWork in progress\n\n\n## Utils\n\n#### Pagination\n\nWhen using certain methods, it is possible that you request more items than the api can return in a single api call.\nIn this case the Api, returns a \"next link\" url where you can pull more data.\n\nWhen this is the case, the methods in this library will return a `Pagination` object which abstracts all this into a single iterator.\nThe pagination object will request \"next links\" as soon as they are needed.\n\nFor example:\n\n```python\nmaibox = account.mailbox()\n\nmessages = mailbox.get_messages(limit=1500)  # the Office 365 and MS Graph API have a 999 items limit returned per api call.\n\n# Here messages is a Pagination instance. It's an Iterator so you can iterate over.\n\n# The first 999 iterations will be normal list iterations, returning one item at a time.\n# When the iterator reaches the 1000 item, the Pagination instance will call the api again requesting exactly 500 items\n# or the items specified in the batch parameter (see later).\n\nfor message in messages:\n    print(message.subject)\n```\n\nWhen using certain methods you will have the option to specify not only a limit option (the number of items to be returned) but a batch option.\nThis option will indicate the method to request data to the api in batches until the limit is reached or the data consumed.\nThis is usefull when you want to optimize memory or network latency.\n\nFor example:\n\n```python\nmessages = mailbox.get_messages(limit=100, batch=25)\n\n# messages here is a Pagination instance\n# when iterating over it will call the api 4 times (each requesting 25 items).\n\nfor message in messages:  # 100 loops with 4 requests to the api server\n    print(message.subject)\n```\n\n#### The Query helper\n\nWhen using the Office 365 API you can filter some fields.\nThis filtering is tedious as is using [Open Data Protocol (OData)](http://docs.oasis-open.org/odata/odata/v4.0/errata03/os/complete/part2-url-conventions/odata-v4.0-errata03-os-part2-url-conventions-complete.html).\n\nEvery `ApiComponent` (such as `MailBox`) implements a new_query method that will return a `Query` instance.\nThis `Query` instance can handle the filtering (and sorting and selecting) very easily.\n\nFor example:\n\n```python\nquery = mailbox.new_query()\n\nquery = query.on_attribute('subject').contains('george best').chain('or').startswith('quotes')\n\n# 'created_date_time' will automatically be converted to the protocol casing.\n# For example when using MS Graph this will become 'createdDateTime'.\n\nquery = query.chain('and').on_attribute('created_date_time').greater(datetime(2018, 3, 21))\n\nprint(query)\n\n# contains(subject, 'george best') or startswith(subject, 'quotes') and createdDateTime gt '2018-03-21T00:00:00Z'\n# note you can pass naive datetimes and those will be converted to you local timezone and then send to the api as UTC in iso8601 format\n\n# To use Query objetcs just pass it to the query parameter:\nfiltered_messages = mailbox.get_messages(query=query)\n```\n\nYou can also specify specific data to be retrieved with \"select\":\n\n```python\n# select only some properties for the retrieved messages:\nquery = mailbox.new_query().select('subject', 'to_recipients', 'created_date_time')\n\nmessages_with_selected_properties = mailbox.get_messages(query=query)\n```\n\n#### Request Error Handling and Custom Errors\n\nWhenever a Request error raises, the connection object will raise an exception.\nThen the exception will be captured and logged it to the stdout with it's message, an return Falsy (None, False, [], etc...)\n\nHttpErrors 4xx (Bad Request) and 5xx (Internal Server Error) are considered exceptions and raised also by the connection (you can configure this on the connection).\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/janscas/pyo365", "keywords": "", "license": "Apache License 2.0", "maintainer": "Janscas", "maintainer_email": "janscas@users.noreply.github.com", "name": "pyo365", "package_url": "https://pypi.org/project/pyo365/", "platform": "", "project_url": "https://pypi.org/project/pyo365/", "project_urls": {"Homepage": "https://github.com/janscas/pyo365"}, "release_url": "https://pypi.org/project/pyo365/0.1.3/", "requires_dist": ["requests (>=2.0.0)", "requests-oauthlib (>=1.0.0)", "python-dateutil (>=2.7)", "pytz (>=2018.5)", "tzlocal (>=1.5.0)", "beautifulsoup4 (>=4.0.0)", "stringcase (>=1.2.0)"], "requires_python": ">=3.4", "summary": "A simple python library to interact with Microsoft Graph and Office 365 API", "version": "0.1.3", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>pyo365 - Microsoft Graph and Office 365 API made easy</h1>\n<p>This project aims is to make it easy to interact with Microsoft Graph and Office 365 Email, Contacts, Calendar, OneDrive, etc.</p>\n<p>This project is inspired on the super work done by <a href=\"https://github.com/Narcolapser\" rel=\"nofollow\">Toben Archer</a> <a href=\"https://github.com/Narcolapser/python-o365\" rel=\"nofollow\">Python-O365</a>.\nThe oauth part is based on the work done by <a href=\"https://github.com/roycem90\" rel=\"nofollow\">Royce Melborn</a> which is now integrated with the original project.</p>\n<p>I just want to make this project different in almost every sense, and make it also more pythonic.\nSo I ended up rewriting the whole project from scratch.</p>\n<p>The result is a package that provides a lot of the Microsoft Graph and Office 365 API capabilities.</p>\n<p>This is for example how you send a message:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">Account</span>\n\n<span class=\"n\">credentials</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">)</span>\n\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">)</span>\n<span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s1\">'to_example@example.com'</span><span class=\"p\">)</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">subject</span> <span class=\"o\">=</span> <span class=\"s1\">'Testing!'</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s2\">\"George Best quote: I've stopped drinking, but only while I'm asleep.\"</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">send</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Python 3.4 is the minimum required</strong>... I was very tempted to just go for 3.6 and use f-strings. Those are fantastic!</p>\n<p>This project was also a learning resource for me. This is a list of not so common python characteristics used in this project:</p>\n<ul>\n<li>New unpacking technics: <code>def method(argument, *, with_name=None, **other_params):</code></li>\n<li>Enums: <code>from enum import Enum</code></li>\n<li>Factory paradigm</li>\n<li>Package organization</li>\n<li>Timezone conversion and timezone aware datetimes</li>\n<li>Etc. (see the code!)</li>\n</ul>\n<blockquote>\n<p><strong>This project is in early development.</strong> Changes that can break your code may be commited. If you want to help please feel free to fork and make pull requests.</p>\n</blockquote>\n<p>What follows is kind of a wiki... but you will get more insights by looking at the code.</p>\n<h2>Table of contents</h2>\n<ul>\n<li><a href=\"#install\" rel=\"nofollow\">Install</a></li>\n<li><a href=\"#protocols\" rel=\"nofollow\">Protocols</a></li>\n<li><a href=\"#authentication\" rel=\"nofollow\">Authentication</a></li>\n<li><a href=\"#account\" rel=\"nofollow\">Account Class and Modularity</a></li>\n<li><a href=\"#mailbox\" rel=\"nofollow\">MailBox</a></li>\n<li><a href=\"#addressbook\" rel=\"nofollow\">AddressBook</a></li>\n<li><a href=\"#calendar\" rel=\"nofollow\">Calendar</a></li>\n<li><a href=\"#onedrive\" rel=\"nofollow\">OneDrive</a></li>\n<li><a href=\"#sharepoint\" rel=\"nofollow\">Sharepoint</a></li>\n<li><a href=\"#utils\" rel=\"nofollow\">Utils</a></li>\n</ul>\n<h2>Install</h2>\n<p>pyo365 is available on pypi.org. Simply run <code>pip install pyo365</code> to install it.</p>\n<p>Project dependencies installed by pip:</p>\n<ul>\n<li>requests</li>\n<li>requests-oauthlib</li>\n<li>beatifulsoup4</li>\n<li>stringcase</li>\n<li>python-dateutil</li>\n<li>tzlocal</li>\n<li>pytz</li>\n</ul>\n<p>The first step to be able to work with this library is to register an application and retrieve the auth token. See <a href=\"#authentication\" rel=\"nofollow\">Authentication</a>.</p>\n<h2>Protocols</h2>\n<p>Protocols handles the aspects of comunications between different APIs.\nThis project uses by default either the Office 365 APIs or Microsoft Graph APIs.\nBut, you can use many other Microsoft APIs as long as you implement the protocol needed.</p>\n<p>You can use one or the other:</p>\n<ul>\n<li><code>MSGraphProtocol</code> to use the <a href=\"https://developer.microsoft.com/en-us/graph/docs/concepts/overview\" rel=\"nofollow\">Microsoft Graph API</a></li>\n<li><code>MSOffice365Protocol</code> to use the <a href=\"https://msdn.microsoft.com/en-us/office/office365/api/api-catalog\" rel=\"nofollow\">Office 365 API</a></li>\n</ul>\n<p>Both protocols are similar but the Graph one has access to more resources (for example OneDrive). It also depends on the api version used.</p>\n<p>The default protocol used by the <code>Account</code> Class is <code>MSGraphProtocol</code>.</p>\n<p>You can implement your own protocols by inheriting from <code>Protocol</code> to communicate with other Microsoft APIs.</p>\n<p>You can instantiate protocols like this:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">MSGraphProtocol</span>\n\n<span class=\"c1\"># try the api version beta of the Microsoft Graph endpoint.</span>\n<span class=\"n\">protocol</span> <span class=\"o\">=</span> <span class=\"n\">MSGraphProtocol</span><span class=\"p\">(</span><span class=\"n\">api_version</span><span class=\"o\">=</span><span class=\"s1\">'beta'</span><span class=\"p\">)</span>  <span class=\"c1\"># MSGraphProtocol defaults to v1.0 api version</span>\n</pre>\n<h5>Resources:</h5>\n<p>Each API endpoint requires a resource. This usually defines the owner of the data.\nEvery protocol defaults to resource 'ME'. 'ME' is the user which has given consent, but you can change this behaviour by providing a different default resource to the protocol constructor.</p>\n<p>For example when accesing a shared mailbox:</p>\n<pre><span class=\"c1\"># ...</span>\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"o\">=</span><span class=\"n\">my_credentials</span><span class=\"p\">,</span> <span class=\"n\">main_resource</span><span class=\"o\">=</span><span class=\"s1\">'shared_mailbox@example.com'</span><span class=\"p\">)</span>\n<span class=\"c1\"># Any instance created using account will inherit the resource defined for account.</span>\n</pre>\n<p>This can be done however at any point. For example at the protocol level:</p>\n<pre><span class=\"c1\"># ...</span>\n<span class=\"n\">my_protocol</span> <span class=\"o\">=</span> <span class=\"n\">MSGraphProtocol</span><span class=\"p\">(</span><span class=\"n\">default_resource</span><span class=\"o\">=</span><span class=\"s1\">'shared_mailbox@example.com'</span><span class=\"p\">)</span>\n\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"o\">=</span><span class=\"n\">my_credentials</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"o\">=</span><span class=\"n\">my_protocol</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># now account is accesing the shared_mailbox@example.com in every api call.</span>\n<span class=\"n\">shared_mailbox_messages</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">()</span>\n</pre>\n<p>Instead of defining the resource used at the account or protocol level, you can provide it per use case as follows:</p>\n<pre><span class=\"c1\"># ...</span>\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"o\">=</span><span class=\"n\">my_credentials</span><span class=\"p\">)</span>  <span class=\"c1\"># account defaults to 'ME' resource</span>\n\n<span class=\"n\">mailbox</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">(</span><span class=\"s1\">'shared_mailbox@example.com'</span><span class=\"p\">)</span>  <span class=\"c1\"># mailbox is using 'shared_mailbox@example.com' resource instead of 'ME'</span>\n\n<span class=\"c1\"># or:</span>\n\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">account</span><span class=\"p\">,</span> <span class=\"n\">main_resource</span><span class=\"o\">=</span><span class=\"s1\">'shared_mailbox@example.com'</span><span class=\"p\">)</span>  <span class=\"c1\"># message is using 'shared_mailbox@example.com' resource</span>\n</pre>\n<p>Usually you will work with the default 'ME' resuorce, but you can also use one of the following:</p>\n<ul>\n<li><strong>'me'</strong>: the user which has given consent. the default for every protocol.</li>\n<li><strong>'user:<a href=\"mailto:user@domain.com\">user@domain.com</a>'</strong>: a shared mailbox or a user account for which you have permissions. If you don't provide 'user:' will be infered anyways.</li>\n<li><strong>'sharepoint:sharepoint-site-id'</strong>: a sharepoint site id.</li>\n<li><strong>'group:group-site-id'</strong>: a office365 group id.</li>\n</ul>\n<h2>Authentication</h2>\n<p>You can only authenticate using oauth athentication as Microsoft deprecated basic oauth on November 1st 2018.</p>\n<ul>\n<li>Oauth authentication: using an authentication token provided after user consent.</li>\n</ul>\n<p>The <code>Connection</code> Class handles the authentication.</p>\n<h4>Oauth Authentication</h4>\n<p>This section is explained using Microsoft Graph Protocol, almost the same applies to the Office 365 REST API.</p>\n<h5>Permissions and Scopes:</h5>\n<p>When using oauth you create an application and allow some resources to be accesed and used by it's users.\nThen the user can request access to one or more of this resources by providing scopes to the oauth provider.</p>\n<p>For example your application can have Calendar.Read, Mail.ReadWrite and Mail.Send permissions, but the application can request access only to the Mail.ReadWrite and Mail.Send permission.\nThis is done by providing scopes to the connection object like so:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">Connection</span>\n\n<span class=\"n\">credentials</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">)</span>\n\n<span class=\"n\">scopes</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">'https://graph.microsoft.com/Mail.ReadWrite'</span><span class=\"p\">,</span> <span class=\"s1\">'https://graph.microsoft.com/Mail.Send'</span><span class=\"p\">]</span>\n\n<span class=\"n\">con</span> <span class=\"o\">=</span> <span class=\"n\">Connection</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">,</span> <span class=\"n\">scopes</span><span class=\"o\">=</span><span class=\"n\">scopes</span><span class=\"p\">)</span>\n</pre>\n<p>Scope implementation depends on the protocol used. So by using protocol data you can automatically set the scopes needed:</p>\n<p>You can get the same scopes as before using protocols like this:</p>\n<pre><span class=\"n\">protocol_graph</span> <span class=\"o\">=</span> <span class=\"n\">MSGraphProtocol</span><span class=\"p\">()</span>\n\n<span class=\"n\">scopes_graph</span> <span class=\"o\">=</span> <span class=\"n\">protocol</span><span class=\"o\">.</span><span class=\"n\">get_scopes_for</span><span class=\"p\">(</span><span class=\"s1\">'message all'</span><span class=\"p\">)</span>\n<span class=\"c1\"># scopes here are: ['https://graph.microsoft.com/Mail.ReadWrite', 'https://graph.microsoft.com/Mail.Send']</span>\n\n<span class=\"n\">protocol_office</span> <span class=\"o\">=</span> <span class=\"n\">MSOffice365Protocol</span><span class=\"p\">()</span>\n\n<span class=\"n\">scopes_office</span> <span class=\"o\">=</span> <span class=\"n\">protocol</span><span class=\"o\">.</span><span class=\"n\">get_scopes_for</span><span class=\"p\">(</span><span class=\"s1\">'message all'</span><span class=\"p\">)</span>\n<span class=\"c1\"># scopes here are: ['https://outlook.office.com/Mail.ReadWrite', 'https://outlook.office.com/Mail.Send']</span>\n\n<span class=\"n\">con</span> <span class=\"o\">=</span> <span class=\"n\">Connection</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">,</span> <span class=\"n\">scopes</span><span class=\"o\">=</span><span class=\"n\">scopes_graph</span><span class=\"p\">)</span>\n</pre>\n<h5>Authentication Flow</h5>\n<ol>\n<li>\n<p>To work with oauth you first need to register your application at <a href=\"https://apps.dev.microsoft.com/\" rel=\"nofollow\">Microsoft Application Registration Portal</a>.</p>\n<ol>\n<li>Login at <a href=\"https://apps.dev.microsoft.com/\" rel=\"nofollow\">Microsoft Application Registration Portal</a></li>\n<li>Create an app, note your app id (client_id)</li>\n<li>Generate a new password (client_secret) under \"Application Secrets\" section</li>\n<li>Under the \"Platform\" section, add a new Web platform and set \"<a href=\"https://outlook.office365.com/owa/\" rel=\"nofollow\">https://outlook.office365.com/owa/</a>\" as the redirect URL</li>\n<li>Under \"Microsoft Graph Permissions\" section, add the delegated permissions you want (see scopes), as an example, to read and send emails use:\n<ol>\n<li>Mail.ReadWrite</li>\n<li>Mail.Send</li>\n<li>User.Read</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>\n<p>Then you need to login for the first time to get the access token by consenting the application to access the resources it needs.</p>\n<ol>\n<li>\n<p>First get the authorization url.</p>\n<pre><span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">connection</span><span class=\"o\">.</span><span class=\"n\">get_authorization_url</span><span class=\"p\">()</span>\n</pre>\n</li>\n<li>\n<p>The user must visit this url and give consent to the application. When consent is given, the page will rediret to: \"<a href=\"https://outlook.office365.com/owa/\" rel=\"nofollow\">https://outlook.office365.com/owa/</a>\".</p>\n<p>Then the user must copy the resulting page url and give it to the connection object:</p>\n<pre><span class=\"n\">result_url</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'Paste the result url here...'</span><span class=\"p\">)</span>\n\n<span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">connection</span><span class=\"o\">.</span><span class=\"n\">request_token</span><span class=\"p\">(</span><span class=\"n\">result_url</span><span class=\"p\">)</span>  <span class=\"c1\"># This, if succesful, will store the token in a txt file on the user project folder.</span>\n</pre>\n<p><span>Take care, the access token must remain protected from unauthorized users.</span></p>\n</li>\n<li>\n<p>At this point you will have an access token that will provide valid credentials when using the api. If you change the scope requested, then the current token won't work, and you will need the user to give consent again on the application to gain access to the new scopes requested.</p>\n</li>\n</ol>\n<p>The access token only lasts 60 minutes, but the app will automatically request new tokens through the refresh tokens, but note that a refresh token only lasts for 90 days. So you must use it before or you will need to request a new access token again (no new consent needed by the user, just a login).</p>\n<p>If your application needs to work for more than 90 days without user interaction and without interacting with the API, then you must implement a periodic call to <code>Connection.refresh_token</code> before the 90 days have passed.</p>\n</li>\n</ol>\n<h5>Using pyo365 to authenticate</h5>\n<p>You can manually authenticate by using a single <code>Connection</code> instance as described before or use the helper methods provided by the library.</p>\n<ol>\n<li>\n<p><code>account.authenticate</code>:</p>\n<p>This is the preferred way for performing authentication.</p>\n<p>Create an <code>Account</code> instance and authenticate using the <code>authenticate</code> method:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">Account</span>\n\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">))</span>\n<span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">authenticate</span><span class=\"p\">(</span><span class=\"n\">scopes</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'basic'</span><span class=\"p\">,</span> <span class=\"s1\">'message_all'</span><span class=\"p\">])</span>  <span class=\"c1\"># request a token for this scopes</span>\n\n<span class=\"c1\"># this will ask to visit the app consent screen where the user will be asked to give consent on the requested scopes.</span>\n<span class=\"c1\"># then the user will have to provide the result url afeter consent. </span>\n<span class=\"c1\"># if all goes as expected, result will be True and a token will be stored in the default location.</span>\n</pre>\n</li>\n<li>\n<p><code>oauth_authentication_flow</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">oauth_authentication_flow</span>\n\n<span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">oauth_authentication_flow</span><span class=\"p\">(</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s1\">'scopes_required'</span><span class=\"p\">])</span>\n</pre>\n</li>\n</ol>\n<h2>Account Class and Modularity <a></a></h2>\n<p>Usually you will only need to work with the <code>Account</code> Class. This is a wrapper around all functionality.</p>\n<p>But you can also work only with the pieces you want.</p>\n<p>For example, instead of:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">Account</span>\n\n<span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">((</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">))</span>\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>\n<span class=\"c1\"># ...</span>\n<span class=\"n\">mailbox</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">()</span>\n<span class=\"c1\"># ...</span>\n</pre>\n<p>You can work only with the required pieces:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365</span> <span class=\"kn\">import</span> <span class=\"n\">Connection</span><span class=\"p\">,</span> <span class=\"n\">MSGraphProtocol</span><span class=\"p\">,</span> <span class=\"n\">Message</span><span class=\"p\">,</span> <span class=\"n\">MailBox</span>\n\n<span class=\"n\">my_protocol</span> <span class=\"o\">=</span> <span class=\"n\">MSGraphProtocol</span><span class=\"p\">()</span>\n<span class=\"n\">con</span> <span class=\"o\">=</span> <span class=\"n\">Connection</span><span class=\"p\">((</span><span class=\"s1\">'client_id'</span><span class=\"p\">,</span> <span class=\"s1\">'client_secret'</span><span class=\"p\">))</span>\n\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">con</span><span class=\"o\">=</span><span class=\"n\">con</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"o\">=</span><span class=\"n\">my_protocol</span><span class=\"p\">)</span>\n<span class=\"c1\"># ...</span>\n<span class=\"n\">mailbox</span> <span class=\"o\">=</span> <span class=\"n\">MailBox</span><span class=\"p\">(</span><span class=\"n\">con</span><span class=\"o\">=</span><span class=\"n\">con</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"o\">=</span><span class=\"n\">my_protocol</span><span class=\"p\">)</span>\n<span class=\"n\">message2</span> <span class=\"o\">=</span> <span class=\"n\">Message</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">mailbox</span><span class=\"p\">)</span>  <span class=\"c1\"># message will inherit the connection and protocol from mailbox when using parent.</span>\n<span class=\"c1\"># ...</span>\n</pre>\n<p>It's also easy to implement a custom Class.</p>\n<p>Just Inherit from <code>ApiComponent</code>, define the endpoints, and use the connection to make requests. If needed also inherit from Protocol to handle different comunications aspects with the API server.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">pyo365.utils</span> <span class=\"kn\">import</span> <span class=\"n\">ApiComponent</span> \n\n<span class=\"k\">class</span> <span class=\"nc\">CustomClass</span><span class=\"p\">(</span><span class=\"n\">ApiComponent</span><span class=\"p\">):</span>\n    <span class=\"n\">_endpoints</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'my_url_key'</span><span class=\"p\">:</span> <span class=\"s1\">'/customendpoint'</span><span class=\"p\">}</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">con</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"n\">parent</span><span class=\"p\">,</span> <span class=\"n\">con</span><span class=\"o\">=</span><span class=\"n\">con</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n        <span class=\"c1\"># ...</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">do_some_stuff</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n\n        <span class=\"c1\"># self.build_url just merges the protocol service_url with the enpoint passed as a parameter</span>\n        <span class=\"c1\"># to change the service_url implement your own protocol inherinting from Protocol Class</span>\n        <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">build_url</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_endpoints</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\">'my_url_key'</span><span class=\"p\">))</span>  \n\n        <span class=\"n\">my_params</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'param1'</span><span class=\"p\">:</span> <span class=\"s1\">'param1'</span><span class=\"p\">}</span>\n\n        <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">con</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"n\">my_params</span><span class=\"p\">)</span>  <span class=\"c1\"># note the use of the connection here.</span>\n\n        <span class=\"c1\"># handle response and return to the user...</span>\n</pre>\n<h2>MailBox</h2>\n<p>Mailbox groups the funcionality of both the messages and the email folders.</p>\n<pre><span class=\"n\">mailbox</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">()</span>\n\n<span class=\"n\">inbox</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">inbox_folder</span><span class=\"p\">()</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"ow\">in</span> <span class=\"n\">inbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">():</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n<span class=\"n\">sent_folder</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">sent_folder</span><span class=\"p\">()</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"ow\">in</span> <span class=\"n\">sent_folder</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">():</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n<span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>\n\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s1\">'to_example@example.com'</span><span class=\"p\">)</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s1\">'George Best quote: In 1969 I gave up women and alcohol - it was the worst 20 minutes of my life.'</span>\n<span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">save_draft</span><span class=\"p\">()</span>\n</pre>\n<h4>Email Folder</h4>\n<p>Represents a <code>Folder</code> within your email mailbox.</p>\n<p>You can get any folder in your mailbox by requesting child folders or filtering by name.</p>\n<pre><span class=\"n\">mailbox</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">()</span>\n\n<span class=\"n\">archive</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_folder</span><span class=\"p\">(</span><span class=\"n\">folder_name</span><span class=\"o\">=</span><span class=\"s1\">'archive'</span><span class=\"p\">)</span>  <span class=\"c1\"># get a folder with 'archive' name</span>\n\n<span class=\"n\">child_folders</span> <span class=\"o\">=</span> <span class=\"n\">archive</span><span class=\"o\">.</span><span class=\"n\">get_folders</span><span class=\"p\">(</span><span class=\"mi\">25</span><span class=\"p\">)</span> <span class=\"c1\"># get at most 25 child folders of 'archive' folder</span>\n\n<span class=\"k\">for</span> <span class=\"n\">folder</span> <span class=\"ow\">in</span> <span class=\"n\">child_folders</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">parent_id</span><span class=\"p\">)</span>\n\n<span class=\"n\">new_folder</span> <span class=\"o\">=</span> <span class=\"n\">archive</span><span class=\"o\">.</span><span class=\"n\">create_child_folder</span><span class=\"p\">(</span><span class=\"s1\">'George Best Quotes'</span><span class=\"p\">)</span>\n</pre>\n<h4>Message</h4>\n<p>An email object with all it's data and methods.</p>\n<p>Creating a draft message is as easy as this:</p>\n<pre><span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">([</span><span class=\"s1\">'example1@example.com'</span><span class=\"p\">,</span> <span class=\"s1\">'example2@example.com'</span><span class=\"p\">])</span>\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">sender</span><span class=\"o\">.</span><span class=\"n\">address</span> <span class=\"o\">=</span> <span class=\"s1\">'my_shared_account@example.com'</span>  <span class=\"c1\"># changing the from address</span>\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s1\">'George Best quote: I might go to Alcoholics Anonymous, but I think it would be difficult for me to remain anonymous'</span>\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">attachments</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s1\">'george_best_quotes.txt'</span><span class=\"p\">)</span>\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">save_draft</span><span class=\"p\">()</span>  <span class=\"c1\"># save the message on the cloud as a draft in the drafts folder</span>\n</pre>\n<p>Working with saved emails is also easy:</p>\n<pre><span class=\"n\">query</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">new_query</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">on_attribute</span><span class=\"p\">(</span><span class=\"s1\">'subject'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">contains</span><span class=\"p\">(</span><span class=\"s1\">'george best'</span><span class=\"p\">)</span>  <span class=\"c1\"># see Query object in Utils</span>\n<span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">25</span><span class=\"p\">,</span> <span class=\"n\">query</span><span class=\"o\">=</span><span class=\"n\">query</span><span class=\"p\">)</span>\n\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">messages</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>  <span class=\"c1\"># get the first one</span>\n\n<span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">mark_as_read</span><span class=\"p\">()</span>\n<span class=\"n\">reply_msg</span> <span class=\"o\">=</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">reply</span><span class=\"p\">()</span>\n\n<span class=\"k\">if</span> <span class=\"s1\">'example@example.com'</span> <span class=\"ow\">in</span> <span class=\"n\">reply_msg</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">:</span>  <span class=\"c1\"># magic methods implemented</span>\n    <span class=\"n\">reply_msg</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s1\">'George Best quote: I spent a lot of money on booze, birds and fast cars. The rest I just squandered.'</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">reply_msg</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s1\">'George Best quote: I used to go missing a lot... Miss Canada, Miss United Kingdom, Miss World.'</span>\n\n<span class=\"n\">reply_msg</span><span class=\"o\">.</span><span class=\"n\">send</span><span class=\"p\">()</span>\n</pre>\n<h2>AddressBook</h2>\n<p>AddressBook groups the funcionality of both the Contact Folders and Contacts. Outlook Distribution Groups are not supported (By the Microsoft API's).</p>\n<h4>Contact Folders</h4>\n<p>Represents a Folder within your Contacts Section in Office 365.\nAddressBook class represents the parent folder (it's a folder itself).</p>\n<p>You can get any folder in your address book by requesting child folders or filtering by name.</p>\n<pre><span class=\"n\">address_book</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">address_book</span><span class=\"p\">()</span>\n\n<span class=\"n\">contacts</span> <span class=\"o\">=</span> <span class=\"n\">address_book</span><span class=\"o\">.</span><span class=\"n\">get_contacts</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">)</span>  <span class=\"c1\"># get all the contacts in the Personal Contacts root folder</span>\n\n<span class=\"n\">work_contacts_folder</span> <span class=\"o\">=</span> <span class=\"n\">address_book</span><span class=\"o\">.</span><span class=\"n\">get_folder</span><span class=\"p\">(</span><span class=\"n\">folder_name</span><span class=\"o\">=</span><span class=\"s1\">'Work Contacts'</span><span class=\"p\">)</span>  <span class=\"c1\"># get a folder with 'Work Contacts' name</span>\n\n<span class=\"n\">message_to_all_contats_in_folder</span> <span class=\"o\">=</span> <span class=\"n\">work_contacts_folder</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>  <span class=\"c1\"># creates a draft message with all the contacts as recipients</span>\n\n<span class=\"n\">message_to_all_contats_in_folder</span><span class=\"o\">.</span><span class=\"n\">subject</span> <span class=\"o\">=</span> <span class=\"s1\">'Hallo!'</span>\n<span class=\"n\">message_to_all_contats_in_folder</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"o\">=</span> <span class=\"s2\">\"\"\"</span>\n<span class=\"s2\">George Best quote:</span>\n\n<span class=\"s2\">If you'd given me the choice of going out and beating four men and smashing a goal in</span>\n<span class=\"s2\">from thirty yards against Liverpool or going to bed with Miss World,</span>\n<span class=\"s2\">it would have been a difficult choice. Luckily, I had both.</span>\n<span class=\"s2\">\"\"\"</span>\n<span class=\"n\">message_to_all_contats_in_folder</span><span class=\"o\">.</span><span class=\"n\">send</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># querying folders is easy:</span>\n<span class=\"n\">child_folders</span> <span class=\"o\">=</span> <span class=\"n\">address_book</span><span class=\"o\">.</span><span class=\"n\">get_folders</span><span class=\"p\">(</span><span class=\"mi\">25</span><span class=\"p\">)</span> <span class=\"c1\"># get at most 25 child folders</span>\n\n<span class=\"k\">for</span> <span class=\"n\">folder</span> <span class=\"ow\">in</span> <span class=\"n\">child_folders</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">parent_id</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># creating a contact folder:</span>\n<span class=\"n\">address_book</span><span class=\"o\">.</span><span class=\"n\">create_child_folder</span><span class=\"p\">(</span><span class=\"s1\">'new folder'</span><span class=\"p\">)</span>\n</pre>\n<h4>The Global Address List</h4>\n<p>Office 365 API (Nor MS Graph API) has no concept such as the Outlook Global Address List.\nHowever you can use the <a href=\"https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/resources/users\" rel=\"nofollow\">Users API</a> to access all the users within your organization.</p>\n<p>Without admin consent you can only access a few properties of each user such as name and email and litte more.\nYou can search by name or retrieve a contact specifying the complete email.</p>\n<ul>\n<li>Basic Permision needed is Users.ReadBasic.All (limit info)</li>\n<li>Full Permision is Users.Read.All but needs admin consent.</li>\n</ul>\n<p>To search the Global Address List (Users API):</p>\n<pre><span class=\"n\">global_address_list</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">address_book</span><span class=\"p\">(</span><span class=\"n\">address_book</span><span class=\"o\">=</span><span class=\"s1\">'gal'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># start a new query:</span>\n<span class=\"n\">q</span> <span class=\"o\">=</span> <span class=\"n\">global_address_list</span><span class=\"o\">.</span><span class=\"n\">new_query</span><span class=\"p\">(</span><span class=\"s1\">'display_name'</span><span class=\"p\">)</span>\n<span class=\"n\">q</span><span class=\"o\">.</span><span class=\"n\">startswith</span><span class=\"p\">(</span><span class=\"s1\">'George Best'</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">global_address_list</span><span class=\"o\">.</span><span class=\"n\">get_contacts</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"n\">q</span><span class=\"p\">))</span>\n</pre>\n<p>To retrieve a contact by it's email:</p>\n<pre><span class=\"n\">contact</span> <span class=\"o\">=</span> <span class=\"n\">global_address_list</span><span class=\"o\">.</span><span class=\"n\">get_contact_by_email</span><span class=\"p\">(</span><span class=\"s1\">'example@example.com'</span><span class=\"p\">)</span>\n</pre>\n<h4>Contacts</h4>\n<p>Everything returned from an <code>AddressBook</code> instance is a <code>Contact</code> instance.\nContacts have all the information stored as attributes</p>\n<p>Creating a contact from an <code>AddressBook</code>:</p>\n<pre><span class=\"n\">new_contact</span> <span class=\"o\">=</span> <span class=\"n\">address_book</span><span class=\"o\">.</span><span class=\"n\">new_contact</span><span class=\"p\">()</span>\n\n<span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s1\">'George Best'</span>\n<span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">job_title</span> <span class=\"o\">=</span> <span class=\"s1\">'football player'</span>\n<span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">emails</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s1\">'george@best.com'</span><span class=\"p\">)</span>\n\n<span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>  <span class=\"c1\"># saved on the cloud</span>\n\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">new_message</span><span class=\"p\">()</span>  <span class=\"c1\">#  Bonus: send a message to this contact</span>\n\n<span class=\"c1\"># ...</span>\n\n<span class=\"n\">new_contact</span><span class=\"o\">.</span><span class=\"n\">delete</span><span class=\"p\">()</span>  <span class=\"c1\"># Bonus: deteled from the cloud</span>\n</pre>\n<h2>Calendar</h2>\n<p>The calendar and events functionality is group in a <code>Schedule</code> object.</p>\n<p>A <code>Schedule</code> instance can list and create calendars. It can also list or create events on the default user calendar.\nTo use other calendars use a <code>Calendar</code> instance.</p>\n<p>Working with the <code>Schedule</code> instance:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">datetime</span> <span class=\"k\">as</span> <span class=\"nn\">dt</span>\n\n<span class=\"c1\"># ...</span>\n<span class=\"n\">schedule</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">schedule</span><span class=\"p\">()</span>\n\n<span class=\"n\">new_event</span> <span class=\"o\">=</span> <span class=\"n\">schedule</span><span class=\"o\">.</span><span class=\"n\">new_event</span><span class=\"p\">()</span>  <span class=\"c1\"># creates a new event in the user default calendar</span>\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">subject</span> <span class=\"o\">=</span> <span class=\"s1\">'Recruit George Best!'</span>\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">location</span> <span class=\"o\">=</span> <span class=\"s1\">'England'</span>\n\n<span class=\"c1\"># naive datetimes will automatically be converted to timezone aware datetime</span>\n<span class=\"c1\">#  objects using the local timezone detected or the protocol provided timezone</span>\n\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"n\">dt</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2018</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">,</span> <span class=\"mi\">45</span><span class=\"p\">)</span> \n<span class=\"c1\"># so new_event.start becomes: datetime.datetime(2018, 9, 5, 19, 45, tzinfo=&lt;DstTzInfo 'Europe/Paris' CEST+2:00:00 DST&gt;)</span>\n\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">recurrence</span><span class=\"o\">.</span><span class=\"n\">set_daily</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">end</span><span class=\"o\">=</span><span class=\"n\">dt</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2018</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">remind_before_minutes</span> <span class=\"o\">=</span> <span class=\"mi\">45</span>\n\n<span class=\"n\">new_event</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n</pre>\n<p>Working with <code>Calendar</code> instances:</p>\n<pre><span class=\"n\">calendar</span> <span class=\"o\">=</span> <span class=\"n\">schedule</span><span class=\"o\">.</span><span class=\"n\">get_calendar</span><span class=\"p\">(</span><span class=\"n\">calendar_name</span><span class=\"o\">=</span><span class=\"s1\">'Birthdays'</span><span class=\"p\">)</span>\n\n<span class=\"n\">calendar</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s1\">'Football players birthdays'</span>\n<span class=\"n\">calendar</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">()</span>\n\n<span class=\"n\">q</span> <span class=\"o\">=</span> <span class=\"n\">calendar</span><span class=\"o\">.</span><span class=\"n\">new_query</span><span class=\"p\">(</span><span class=\"s1\">'start'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">ge</span><span class=\"p\">(</span><span class=\"n\">dt</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2018</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">20</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">chain</span><span class=\"p\">(</span><span class=\"s1\">'and'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">on_attribute</span><span class=\"p\">(</span><span class=\"s1\">'end'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">le</span><span class=\"p\">(</span><span class=\"n\">dt</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2018</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n\n<span class=\"n\">birthdays</span> <span class=\"o\">=</span> <span class=\"n\">calendar</span><span class=\"o\">.</span><span class=\"n\">get_events</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"n\">q</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">event</span> <span class=\"ow\">in</span> <span class=\"n\">birthdays</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">subject</span> <span class=\"o\">==</span> <span class=\"s1\">'George Best Birthday'</span><span class=\"p\">:</span>\n        <span class=\"c1\"># He died in 2005... but we celebrate anyway!</span>\n        <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">(</span><span class=\"s2\">\"I'll attend!\"</span><span class=\"p\">)</span>  <span class=\"c1\"># send a response accepting</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">decline</span><span class=\"p\">(</span><span class=\"s2\">\"No way I'm comming, I'll be in Spain\"</span><span class=\"p\">,</span> <span class=\"n\">send_response</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>  <span class=\"c1\"># decline the event but don't send a reponse to the organizer</span>\n</pre>\n<h2>OneDrive</h2>\n<p>The <code>Storage</code> class handles all functionality around One Drive and Document Library Storage in Sharepoint.</p>\n<p>The <code>Storage</code> instance allows to retrieve <code>Drive</code> instances which handles all the Files and Folders from within the selected <code>Storage</code>.\nUsually you will only need to work with the default drive. But the <code>Storage</code> instances can handle multiple drives.</p>\n<p>A <code>Drive</code> will allow you to work with Folders and Files.</p>\n<pre><span class=\"n\">account</span> <span class=\"o\">=</span> <span class=\"n\">Account</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"o\">=</span><span class=\"n\">my_credentials</span><span class=\"p\">)</span>\n\n<span class=\"n\">storage</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">()</span>  <span class=\"c1\"># here we get the storage instance that handles all the storage options.</span>\n\n<span class=\"c1\"># list all the drives:</span>\n<span class=\"n\">drives</span> <span class=\"o\">=</span> <span class=\"n\">storage</span><span class=\"o\">.</span><span class=\"n\">get_drives</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># get the default drive</span>\n<span class=\"n\">my_drive</span> <span class=\"o\">=</span> <span class=\"n\">storage</span><span class=\"o\">.</span><span class=\"n\">get_default_drive</span><span class=\"p\">()</span>  <span class=\"c1\"># or get_drive('drive-id')</span>\n\n<span class=\"c1\"># get some folders:</span>\n<span class=\"n\">root_folder</span> <span class=\"o\">=</span> <span class=\"n\">my_drive</span><span class=\"o\">.</span><span class=\"n\">get_root_folder</span><span class=\"p\">()</span>\n<span class=\"n\">attachments_folder</span> <span class=\"o\">=</span> <span class=\"n\">my_drive</span><span class=\"o\">.</span><span class=\"n\">get_special_folder</span><span class=\"p\">(</span><span class=\"s1\">'attachments'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># iterate over the first 25 items on the root folder</span>\n<span class=\"k\">for</span> <span class=\"n\">item</span> <span class=\"ow\">in</span> <span class=\"n\">root_folder</span><span class=\"o\">.</span><span class=\"n\">get_items</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">25</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">is_folder</span><span class=\"p\">:</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">get_items</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">))</span>  <span class=\"c1\"># print the first to element on this folder.</span>\n    <span class=\"k\">elif</span> <span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">is_file</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">is_photo</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">camera_model</span><span class=\"p\">)</span>  <span class=\"c1\"># print some metadata of this photo</span>\n        <span class=\"k\">elif</span> <span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">is_image</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">dimensione</span><span class=\"p\">)</span>  <span class=\"c1\"># print the image dimensions</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># regular file:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"o\">.</span><span class=\"n\">mime_type</span><span class=\"p\">)</span>  <span class=\"c1\"># print the mime type</span>\n</pre>\n<p>Both Files and Folders are DriveItems. Both Image and Photo are Files, but Photo is also an Image. All have some different methods and properties.\nTake care when using 'is_xxxx'.</p>\n<p>When coping a DriveItem the api can return a direct copy of the item or a pointer to a resource that will inform on the progress of the copy operation.</p>\n<pre><span class=\"c1\"># copy a file to the documents special folder</span>\n\n<span class=\"n\">documents_folder</span> <span class=\"o\">=</span> <span class=\"n\">drive</span><span class=\"o\">.</span><span class=\"n\">get_special_folder</span><span class=\"p\">(</span><span class=\"s1\">'documents'</span><span class=\"p\">)</span>\n\n<span class=\"n\">files</span> <span class=\"o\">=</span> <span class=\"n\">drive</span><span class=\"o\">.</span><span class=\"n\">search</span><span class=\"p\">(</span><span class=\"s1\">'george best quotes'</span><span class=\"p\">,</span> <span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">files</span><span class=\"p\">:</span>\n    <span class=\"n\">george_best_quotes</span> <span class=\"o\">=</span> <span class=\"n\">files</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"n\">operation</span> <span class=\"o\">=</span> <span class=\"n\">george_best_quotes</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">documents_folder</span><span class=\"p\">)</span>  <span class=\"c1\"># operation here is an instance of CopyOperation</span>\n\n    <span class=\"c1\"># to check for the result just loop over check_status.</span>\n    <span class=\"c1\"># check_status is a generator that will yield a new status and progress until the file is finally copied</span>\n    <span class=\"k\">for</span> <span class=\"n\">status</span><span class=\"p\">,</span> <span class=\"n\">progress</span> <span class=\"ow\">in</span> <span class=\"n\">operation</span><span class=\"o\">.</span><span class=\"n\">check_status</span><span class=\"p\">():</span>  <span class=\"c1\"># if it's an async operations, this will request to the api for the status in every loop</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">{}</span><span class=\"s1\"> - </span><span class=\"si\">{}</span><span class=\"s1\">'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">status</span><span class=\"p\">,</span> <span class=\"n\">progress</span><span class=\"p\">))</span>  <span class=\"c1\"># prints 'in progress - 77.3' until finally completed: 'completed - 100.0'</span>\n    <span class=\"n\">copied_item</span> <span class=\"o\">=</span> <span class=\"n\">operation</span><span class=\"o\">.</span><span class=\"n\">get_item</span><span class=\"p\">()</span>  <span class=\"c1\"># the copy operation is completed so you can get the item.</span>\n    <span class=\"k\">if</span> <span class=\"n\">copied_item</span><span class=\"p\">:</span>\n        <span class=\"n\">copied_item</span><span class=\"o\">.</span><span class=\"n\">delete</span><span class=\"p\">()</span>  <span class=\"c1\"># ... oops!</span>\n</pre>\n<p>You can also work with share permissions:</p>\n<pre><span class=\"n\">current_permisions</span> <span class=\"o\">=</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">get_permissions</span><span class=\"p\">()</span>  <span class=\"c1\"># get all the current permissions on this drive_item (some may be inherited)</span>\n\n<span class=\"c1\"># share with link</span>\n<span class=\"n\">permission</span> <span class=\"o\">=</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">share_with_link</span><span class=\"p\">(</span><span class=\"n\">share_type</span><span class=\"o\">=</span><span class=\"s1\">'edit'</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"n\">permission</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">permission</span><span class=\"o\">.</span><span class=\"n\">share_link</span><span class=\"p\">)</span>  <span class=\"c1\"># the link you can use to share this drive item</span>\n<span class=\"c1\"># share with invite</span>\n<span class=\"n\">permission</span> <span class=\"o\">=</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">share_with_invite</span><span class=\"p\">(</span><span class=\"n\">recipients</span><span class=\"o\">=</span><span class=\"s1\">'george_best@best.com'</span><span class=\"p\">,</span> <span class=\"n\">send_email</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">'Greetings!!'</span><span class=\"p\">,</span> <span class=\"n\">share_type</span><span class=\"o\">=</span><span class=\"s1\">'edit'</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"n\">permission</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">permission</span><span class=\"o\">.</span><span class=\"n\">granted_to</span><span class=\"p\">)</span>  <span class=\"c1\"># the person you share this item with</span>\n</pre>\n<p>You can also:</p>\n<pre><span class=\"c1\"># download files:</span>\n<span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">download</span><span class=\"p\">(</span><span class=\"n\">to_path</span><span class=\"o\">=</span><span class=\"s1\">'/quotes/'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># upload files:</span>\n\n<span class=\"c1\"># if the uploaded file is bigger than 4MB the file will be uploaded in chunks of 5 MB until completed.</span>\n<span class=\"c1\"># this can take several requests and can be time consuming.</span>\n<span class=\"n\">uploaded_file</span> <span class=\"o\">=</span> <span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">upload_file</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"o\">=</span><span class=\"s1\">'path_to_my_local_file'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># restore versions:</span>\n<span class=\"n\">versiones</span> <span class=\"o\">=</span> <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">get_versions</span><span class=\"p\">()</span>\n<span class=\"k\">for</span> <span class=\"n\">version</span> <span class=\"ow\">in</span> <span class=\"n\">versions</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">version</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"s1\">'2.0'</span><span class=\"p\">:</span>\n        <span class=\"n\">version</span><span class=\"o\">.</span><span class=\"n\">restore</span><span class=\"p\">()</span>  <span class=\"c1\"># restore the version 2.0 of this file</span>\n\n<span class=\"c1\"># ... and much more ...</span>\n</pre>\n<h2>Sharepoint</h2>\n<p>Work in progress</p>\n<h2>Utils</h2>\n<h4>Pagination</h4>\n<p>When using certain methods, it is possible that you request more items than the api can return in a single api call.\nIn this case the Api, returns a \"next link\" url where you can pull more data.</p>\n<p>When this is the case, the methods in this library will return a <code>Pagination</code> object which abstracts all this into a single iterator.\nThe pagination object will request \"next links\" as soon as they are needed.</p>\n<p>For example:</p>\n<pre><span class=\"n\">maibox</span> <span class=\"o\">=</span> <span class=\"n\">account</span><span class=\"o\">.</span><span class=\"n\">mailbox</span><span class=\"p\">()</span>\n\n<span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">1500</span><span class=\"p\">)</span>  <span class=\"c1\"># the Office 365 and MS Graph API have a 999 items limit returned per api call.</span>\n\n<span class=\"c1\"># Here messages is a Pagination instance. It's an Iterator so you can iterate over.</span>\n\n<span class=\"c1\"># The first 999 iterations will be normal list iterations, returning one item at a time.</span>\n<span class=\"c1\"># When the iterator reaches the 1000 item, the Pagination instance will call the api again requesting exactly 500 items</span>\n<span class=\"c1\"># or the items specified in the batch parameter (see later).</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"ow\">in</span> <span class=\"n\">messages</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">subject</span><span class=\"p\">)</span>\n</pre>\n<p>When using certain methods you will have the option to specify not only a limit option (the number of items to be returned) but a batch option.\nThis option will indicate the method to request data to the api in batches until the limit is reached or the data consumed.\nThis is usefull when you want to optimize memory or network latency.</p>\n<p>For example:</p>\n<pre><span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">batch</span><span class=\"o\">=</span><span class=\"mi\">25</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># messages here is a Pagination instance</span>\n<span class=\"c1\"># when iterating over it will call the api 4 times (each requesting 25 items).</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"ow\">in</span> <span class=\"n\">messages</span><span class=\"p\">:</span>  <span class=\"c1\"># 100 loops with 4 requests to the api server</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">subject</span><span class=\"p\">)</span>\n</pre>\n<h4>The Query helper</h4>\n<p>When using the Office 365 API you can filter some fields.\nThis filtering is tedious as is using <a href=\"http://docs.oasis-open.org/odata/odata/v4.0/errata03/os/complete/part2-url-conventions/odata-v4.0-errata03-os-part2-url-conventions-complete.html\" rel=\"nofollow\">Open Data Protocol (OData)</a>.</p>\n<p>Every <code>ApiComponent</code> (such as <code>MailBox</code>) implements a new_query method that will return a <code>Query</code> instance.\nThis <code>Query</code> instance can handle the filtering (and sorting and selecting) very easily.</p>\n<p>For example:</p>\n<pre><span class=\"n\">query</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">new_query</span><span class=\"p\">()</span>\n\n<span class=\"n\">query</span> <span class=\"o\">=</span> <span class=\"n\">query</span><span class=\"o\">.</span><span class=\"n\">on_attribute</span><span class=\"p\">(</span><span class=\"s1\">'subject'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">contains</span><span class=\"p\">(</span><span class=\"s1\">'george best'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">chain</span><span class=\"p\">(</span><span class=\"s1\">'or'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">startswith</span><span class=\"p\">(</span><span class=\"s1\">'quotes'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># 'created_date_time' will automatically be converted to the protocol casing.</span>\n<span class=\"c1\"># For example when using MS Graph this will become 'createdDateTime'.</span>\n\n<span class=\"n\">query</span> <span class=\"o\">=</span> <span class=\"n\">query</span><span class=\"o\">.</span><span class=\"n\">chain</span><span class=\"p\">(</span><span class=\"s1\">'and'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">on_attribute</span><span class=\"p\">(</span><span class=\"s1\">'created_date_time'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">greater</span><span class=\"p\">(</span><span class=\"n\">datetime</span><span class=\"p\">(</span><span class=\"mi\">2018</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">21</span><span class=\"p\">))</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># contains(subject, 'george best') or startswith(subject, 'quotes') and createdDateTime gt '2018-03-21T00:00:00Z'</span>\n<span class=\"c1\"># note you can pass naive datetimes and those will be converted to you local timezone and then send to the api as UTC in iso8601 format</span>\n\n<span class=\"c1\"># To use Query objetcs just pass it to the query parameter:</span>\n<span class=\"n\">filtered_messages</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"n\">query</span><span class=\"p\">)</span>\n</pre>\n<p>You can also specify specific data to be retrieved with \"select\":</p>\n<pre><span class=\"c1\"># select only some properties for the retrieved messages:</span>\n<span class=\"n\">query</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">new_query</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"s1\">'subject'</span><span class=\"p\">,</span> <span class=\"s1\">'to_recipients'</span><span class=\"p\">,</span> <span class=\"s1\">'created_date_time'</span><span class=\"p\">)</span>\n\n<span class=\"n\">messages_with_selected_properties</span> <span class=\"o\">=</span> <span class=\"n\">mailbox</span><span class=\"o\">.</span><span class=\"n\">get_messages</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"o\">=</span><span class=\"n\">query</span><span class=\"p\">)</span>\n</pre>\n<h4>Request Error Handling and Custom Errors</h4>\n<p>Whenever a Request error raises, the connection object will raise an exception.\nThen the exception will be captured and logged it to the stdout with it's message, an return Falsy (None, False, [], etc...)</p>\n<p>HttpErrors 4xx (Bad Request) and 5xx (Internal Server Error) are considered exceptions and raised also by the connection (you can configure this on the connection).</p>\n\n          </div>"}, "last_serial": 4433544, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "9a33281a0a860bc5fabf2aa2d3b79023", "sha256": "6c5c0a7732bd3e5166b4098555e6050d31e46d4bed2e29cff715429c532ced5e"}, "downloads": -1, "filename": "pyo365-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "9a33281a0a860bc5fabf2aa2d3b79023", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 68763, "upload_time": "2018-10-19T13:13:53", "upload_time_iso_8601": "2018-10-19T13:13:53.204587Z", "url": "https://files.pythonhosted.org/packages/52/e7/e688d79141b9760870b4e6478bb471c4618eb231eced9b88212c370a1954/pyo365-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "13f8d565718ad7513ae2e7d982abe87e", "sha256": "3512cc75994bb39c8d344b45a8188edd90cf52c297bc7dabbeb580332f241314"}, "downloads": -1, "filename": "pyo365-0.1.0.tar.gz", "has_sig": false, "md5_digest": "13f8d565718ad7513ae2e7d982abe87e", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 73931, "upload_time": "2018-10-19T13:13:54", "upload_time_iso_8601": "2018-10-19T13:13:54.561450Z", "url": "https://files.pythonhosted.org/packages/bd/d5/fbd76f65dc9687bec660a46e2d98ab8b5dee69f899788d1870d77dfd2e38/pyo365-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "698580271cb6c7dd10973bf4076350ab", "sha256": "2d5651abe80bac24c609dbf9d6fb62d1416742b141f0486812bb8db1adf64e59"}, "downloads": -1, "filename": "pyo365-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "698580271cb6c7dd10973bf4076350ab", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 69686, "upload_time": "2018-10-22T16:55:23", "upload_time_iso_8601": "2018-10-22T16:55:23.450310Z", "url": "https://files.pythonhosted.org/packages/33/f0/4f3b8a9580752766f63e33e6b27ed4ff4cbe2a0b7e670deb7748606ecad4/pyo365-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "9a8fd8e21eea523d7b3f28f06da82a1d", "sha256": "831b1e01419c789fe24a974b2091408cefe211d88a09c449f57afdca5ccb9dfd"}, "downloads": -1, "filename": "pyo365-0.1.1.tar.gz", "has_sig": false, "md5_digest": "9a8fd8e21eea523d7b3f28f06da82a1d", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 74770, "upload_time": "2018-10-22T16:55:24", "upload_time_iso_8601": "2018-10-22T16:55:24.894180Z", "url": "https://files.pythonhosted.org/packages/30/2e/9c3267db0de9ee861515f464eff91b4357a69980e2f13668d0717bf1071a/pyo365-0.1.1.tar.gz", "yanked": false}], "0.1.2": [{"comment_text": "", "digests": {"md5": "8fa8dde5baa7207593fc0c569d72ab94", "sha256": "71b2faef79eb93a947158312a1320d408f6deda460ad5cf7104ae818b004ca52"}, "downloads": -1, "filename": "pyo365-0.1.2-py3-none-any.whl", "has_sig": false, "md5_digest": "8fa8dde5baa7207593fc0c569d72ab94", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 67483, "upload_time": "2018-10-26T15:43:31", "upload_time_iso_8601": "2018-10-26T15:43:31.396086Z", "url": "https://files.pythonhosted.org/packages/63/c7/516607eea724324a69cf9a07cb3799bb1dd036b32d450cb889d82650be73/pyo365-0.1.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "c68569d9fb57b2dd369780fb2561b6f6", "sha256": "1e56f9b472556a0e31aee3183cc09483e9510301c1b10f08403b1b27565bd072"}, "downloads": -1, "filename": "pyo365-0.1.2.tar.gz", "has_sig": false, "md5_digest": "c68569d9fb57b2dd369780fb2561b6f6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 73759, "upload_time": "2018-10-26T15:43:33", "upload_time_iso_8601": "2018-10-26T15:43:33.045707Z", "url": "https://files.pythonhosted.org/packages/14/71/f20bc8d81bedda4bf3d6f3f3d673267c4411c63685f219dcf77da484e081/pyo365-0.1.2.tar.gz", "yanked": false}], "0.1.3": [{"comment_text": "", "digests": {"md5": "530ec39113c9b3bf62bac9701e9f39ce", "sha256": "6f2f3cf568551d589ca328db6d45235b381f0ee9d305aa057c1a986aa355097a"}, "downloads": -1, "filename": "pyo365-0.1.3-py3-none-any.whl", "has_sig": false, "md5_digest": "530ec39113c9b3bf62bac9701e9f39ce", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 68188, "upload_time": "2018-10-30T22:32:22", "upload_time_iso_8601": "2018-10-30T22:32:22.202059Z", "url": "https://files.pythonhosted.org/packages/5c/0d/d4514292f5838cdc9eb373a05801e3110d09f92944dde2434934269807e1/pyo365-0.1.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f43bd84160b6ff6979f8bd7ef1197392", "sha256": "a13e8a99a710061edf736a18b3934b699455d1447dd2883c5cd28e0a1f307c11"}, "downloads": -1, "filename": "pyo365-0.1.3.tar.gz", "has_sig": false, "md5_digest": "f43bd84160b6ff6979f8bd7ef1197392", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 72570, "upload_time": "2018-10-30T22:32:23", "upload_time_iso_8601": "2018-10-30T22:32:23.822543Z", "url": "https://files.pythonhosted.org/packages/0d/6e/ef5bb6e7e85ac9698c04c6ee7904ba8e06787a2e1834014141aff57d55e4/pyo365-0.1.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "530ec39113c9b3bf62bac9701e9f39ce", "sha256": "6f2f3cf568551d589ca328db6d45235b381f0ee9d305aa057c1a986aa355097a"}, "downloads": -1, "filename": "pyo365-0.1.3-py3-none-any.whl", "has_sig": false, "md5_digest": "530ec39113c9b3bf62bac9701e9f39ce", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 68188, "upload_time": "2018-10-30T22:32:22", "upload_time_iso_8601": "2018-10-30T22:32:22.202059Z", "url": "https://files.pythonhosted.org/packages/5c/0d/d4514292f5838cdc9eb373a05801e3110d09f92944dde2434934269807e1/pyo365-0.1.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f43bd84160b6ff6979f8bd7ef1197392", "sha256": "a13e8a99a710061edf736a18b3934b699455d1447dd2883c5cd28e0a1f307c11"}, "downloads": -1, "filename": "pyo365-0.1.3.tar.gz", "has_sig": false, "md5_digest": "f43bd84160b6ff6979f8bd7ef1197392", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 72570, "upload_time": "2018-10-30T22:32:23", "upload_time_iso_8601": "2018-10-30T22:32:23.822543Z", "url": "https://files.pythonhosted.org/packages/0d/6e/ef5bb6e7e85ac9698c04c6ee7904ba8e06787a2e1834014141aff57d55e4/pyo365-0.1.3.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:00:54 2020"}