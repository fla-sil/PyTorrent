{"info": {"author": "cytopia", "author_email": "cytopia@everythingcli.org", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 2", "Programming Language :: Python :: 3", "Topic :: Software Development :: Build Tools"], "description": "# vhost-gen\n\n[![](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)\n[![PyPI](https://img.shields.io/pypi/v/vhost-gen)](https://pypi.org/project/vhost-gen/)\n[![PyPI - Status](https://img.shields.io/pypi/status/vhost-gen)](https://pypi.org/project/vhost-gen/)\n[![PyPI - Python Version](https://img.shields.io/pypi/pyversions/vhost-gen)](https://pypi.org/project/vhost-gen/)\n[![PyPI - Format](https://img.shields.io/pypi/format/vhost-gen)](https://pypi.org/project/vhost-gen/)\n[![PyPI - Implementation](https://img.shields.io/pypi/implementation/vhost-gen)](https://pypi.org/project/vhost-gen/)\n[![PyPI - License](https://img.shields.io/pypi/l/vhost-gen)](https://pypi.org/project/vhost-gen/)\n\n[![Build Status](https://github.com/devilbox/vhost-gen/workflows/linting/badge.svg)](https://github.com/devilbox/vhost-gen/actions?workflow=linting)\n[![Build Status](https://github.com/devilbox/vhost-gen/workflows/testing/badge.svg)](https://github.com/devilbox/vhost-gen/actions?workflow=testing)\n[![Build Status](https://travis-ci.org/devilbox/vhost-gen.svg?branch=master)](https://travis-ci.org/devilbox/vhost-gen)\n\n**[vhost-gen](bin/vhost-gen)** will dynamically generate **vhost** or **reverse proxy** configuration files for Apache 2.2, Apache 2.4 and Nginx depending on what you have set in [conf.yml](etc/conf.yml). This makes it easy to switch between different web servers while keeping the exact same functionality.\n\n---\n\n## Installation\n\n#### Via pip\n```bash\npip install vhost-gen\n```\n\n#### From git\n```bash\ngit clone https://github.com/devilbox/vhost-gen\ncd vhost-gen\nsudo make install\n```\n\n\n## What is all the fuzz?\n\nImagine you have to create virtual hosts for your web server over and over again. The only things that might change are document root, log files and server names and possibly some other minor changes. Instead of having to copy and adjust the server's vhost config file each time, you can use `vhost-gen` to generate them for you. By supporting different web server versions, it makes it also easy for you to switch back and forth between Apache 2.2, Apache 2.4 and Nginx.\n\n```bash\n# vHost\n$ vhost-gen -p /shared/httpd/www.example.com -n www.example.com\n# Reverse Proxy\n$ vhost-gen -r http://127.0.0.1:8080 -l / -n api.example.com\n```\n\n**`vhost-gen`** alone simply creates a new virtual host every time you execute it. The goal however is to also automate the execution of the vhost generator itself.\n\n#### 1. Reverse Proxy automation: [watcherp](https://github.com/devilbox/watcherp)\n\nHere enters **[watcherp](https://github.com/devilbox/watcherp)** the game. **[watcherp](https://github.com/devilbox/watcherp)** listens for changes of port bindings and triggers a command whenever a new port has been bound or a binding has been removed. By combining these two tools, you could automate the creating of reverse proxies with one command:\n\n```bash\n# %n will be replaced by watcherp with the address a port has binded\n# %p will be replaced by watcherp with the the actual port number that started binding\n# -p argument from watcherp specifies ports to ignore for changes\n$ watcherp -v \\\n  -p 80,443 \\\n  -a \"vhost-gen -r 'http://%n:%p' -l '/' -n '%n.example.com' -s\" \\\n  -d \"rm /etc/nginx/conf.d/%n.example.com.conf\" \\\n  -t \"nginx -s reload\"\n```\n\n#### 2. Virtual Host automation: [watcherd](https://github.com/devilbox/watcherd)\n\nHere enters **[watcherd](https://github.com/devilbox/watcherd)** the game. **[watcherd](https://github.com/devilbox/watcherd)** listens for directory changes and triggers a command whenever a directory has been created or deleted. By combining these two tools, you could automate mass virtual hosting with one command:\n\n```bash\n# %n will be replaced by watcherd with the new directory name\n# %p will be replaced by watcherd with the new directory path\n$ watcherd -v \\\n  -p /shared/httpd \\\n  -a \"vhost-gen -p %p -n %n -s\" \\\n  -d \"rm /etc/nginx/conf.d/%n.conf\" \\\n  -t \"nginx -s reload\"\n```\n\n##### More customization\n\nNow it might look much more interesting. With the above command every vhost will have the exact same definition (except server name, document root and log file names). It is however also possible that every vhost could be customized depending on their needs. **`vhost-gen`** allows for additional overwriting its template. So inside each newly created folder you could have a sub-directory (e.g. `templates/`) with folder specific defines. Those custom templates would only be sourced if they exist:\n\n```bash\n# Note: Adding -o %p/templates\n$ watcherd -v \\\n  -p /shared/httpd \\\n  -a \"vhost-gen -p %p -n %n -o %p/templates -s\" \\\n  -d \"rm /etc/nginx/conf.d/%n.conf\" \\\n  -t \"nginx -s reload\"\n```\n\n##### Making it robust\n\nIf you don't trust the stability of **[watcherd](https://github.com/devilbox/watcherd)** or want other means of controlling this daemon, you can utilize **[supervisord](http://supervisord.org/)**:\n```ini\n[program:watcherd]\ncommand=watcherd -v -p /shared/httpd -a \"vhost-gen -p %%p -n %%n -s\" -d \"rm /etc/nginx/custom.d/%%n.conf\" -t \"nginx -s reload\"\nstartsecs = 0\nautorestart = true\nstdout_logfile=/dev/stdout\nstdout_logfile_maxbytes=0\nstderr_logfile=/dev/stderr\nstderr_logfile_maxbytes=0\nstdout_events_enabled=true\nstderr_events_enabled=true\n```\n\n#### 3. Dockerizing\n\nIf you don't want to implement it yourself, there are already four fully functional dockerized containers available that offer automated mass virtual hosting based on `vhost-gen` and `watcherd`:\n\n| Base Image | Web server | Repository |\n|------------|------------|------------|\n| Nginx stable (official) | nginx | https://github.com/devilbox/docker-nginx-stable |\n| Nginx mainline (official) | nginx | https://github.com/devilbox/docker-nginx-mainline |\n| Apache 2.2 (official) | Apache 2.2 | https://github.com/devilbox/docker-apache-2.2 |\n| Apache 2.4 (official) | Apache 2.4 | https://github.com/devilbox/docker-apache-2.4 |\n\n\n## Insights\n\n#### Supported Webserver\n\nIf you are not satisfied with the default definitions for the webserver configuration files, feel free to open an issue or a pull request.\n\n| Name       | Template with default definitions          |\n|------------|--------------------------------------------|\n| Nginx      | [nginx.yml](etc/templates/nginx.yml)       |\n| Apache 2.2 | [apache22.yml](etc/templates/apache22.yml) |\n| Apache 2.4 | [apache24.yml](etc/templates/apache24.yml) |\n\n#### Supported Features\n\n* Document serving vHost or Reverse Proxy\n* Custom server name\n* Custom document root\n* Custom access log name\n* Custom error log name\n* Enable cross domain requests with regex support for origins\n* Enable PHP-FPM\n* Add Aliases with regex support\n* Add Deny locations with regex support\n* Enable webserver status page\n* Add custom directives from the configuration file\n\n#### How does it work?\n\n**General information:**\n\n* vHost name is specified as a command line argument\n* vHost templates for major webservers are defined in etc/templates\n* vHost templates contain variables that must be replaced\n* Webserver type/version is defined in /etc/vhost-gen/conf.yml\n* Variable replacer are defined in /etc/vhost-gen/conf.yml\n* Additional variable replacer can also be defined (`-o`)\n\n**The following describes the program flow:**\n\n1. [vhost-gen](bin/vhost-gen) will read /etc/vhost-gen/conf.yml to get defines and webserver type/version\n2. Base on the webserver version/type, it will read etc/templates/<HTTPD_VERSION>.yml template\n3. Variables in the chosen template are replaced\n4. The vHost name (`-n`) is also placed into the template\n5. Template is written to webserver's config location (defined in /etc/vhost-gen/conf.yml)\n\n\n## Usage\n\n#### Using different configurations\n\nThe [configuration file](etc/conf.yml) should give you a lot of flexibility to generate a customized virtual host that fits your needs. Go and check out the [example](examples/) section to see different configuration files for different web servers. If however the customization available in the configuration file is not sufficient, you can also adjust the [templates](etc/template) itself. Read on to find out more in the next section.\n\n#### Adding custom directives\n\nThe [configuration file](etc/conf.yml) also contains a `custom:` directive. This is to add customized directives into your vhost definition that are not yet included in the feature sections. An example for Nginx would be:\n\n`conf.yml`:\n```yml\ncustom: |\n  if (-f $request_filename) {\n      break;\n  }\n```\nThis would then be added to your generated vhost:\n```nginx\nserver {\n    ...\n    if (-f $request_filename) {\n        break;\n    }\n}\n```\n\nIf the current vHost definition does not suit your needs, you could also disable all available features in the configuration file and only use the `custom:` directive to specify your required definitions.\n\n#### Using different templates\n\nEach [template](etc/templates) consists of two sections:\n\n1. `vhost`\n2. `features`\n\nThe `vhost` section is the actual vhost that is being built. All placeholders (In the form of: `__*__`) will be substituted from either the configuration file or the feature section of the template.\n\nThe `features` section contains definitions of features that can be enabled or disabled (via the config file). If those features do not seem suitable, you can adjust them to better fit your needs. You can also re-arrange their position in the `vhost` section.\n\nWhenever you edit the template, make sure not to misspell any placeholders. They will not get replaced when spellt wrong.\n\n\nLet's take for example the `features.server_status` section from Apache 2.2:\n```yml\n  server_status: |\n    # Status Page\n    <Location __REGEX__>\n        SetHandler server-status\n        Order allow,deny\n        Allow from all\n    </Location>\n```\n\nIf you are not satisfied with the `Allow from all` permissions, simply rewrite this template to your needs:\n```yml\n  server_status: |\n    # Status Page\n    <Location __REGEX__>\n        SetHandler server-status\n        Order allow,deny\n        Allow from 160.120.25.65\n    </Location>\n```\n\n#### Available command line options\n\n```bash\nUsage: vhost-gen -p|r <str> -n <str> [-l <str> -m <str> -c <str> -t <str> -o <str> -d -s -v]\n       vhost-gen --help\n       vhost-gen --version\n\nvhost-gen will dynamically generate vhost configuration files\nfor Nginx, Apache 2.2 or Apache 2.4 depending on what you have set\nin /etc/vhot-gen/conf.yml\n\nRequired arguments:\n  -p|r <str>  You need to choose one of the mutually exclusive arguments.\n              -p: Path to document root/\n              -r: http(s)://Host:Port for reverse proxy.\n              Depening on the choice, it will either generate a document serving\n              vhost or a reverse proxy vhost.\n              Note, when using -p, this can also have a suffix directory to be set\n              in conf.yml\n  -l <str>    Location path when using reverse proxy.\n              Note, this is not required for normal document root server (-p)\n  -n <str>    Name of vhost\n              Note, this can also have a prefix and/or suffix to be set in conf.yml\n\nOptional arguments:\n  -m <str>    Vhost generation mode. Possible values are:\n              -m plain: Only generate http version (default)\n              -m ssl:   Only generate https version\n              -m both:  Generate http and https version\n              -m redir: Generate https version and make http redirect to https\n  -c <str>    Path to global configuration file.\n              If not set, the default location is /etc/vhost-gen/conf.yml\n              If no config is found, a default is used with all features turned off.\n  -t <str>    Path to global vhost template directory.\n              If not set, the default location is /etc/vhost-gen/templates/\n              If vhost template files are not found in this directory, the program will\n              abort.\n  -o <str>    Path to local vhost template directory.\n              This is used as a secondary template directory and definitions found here\n              will be merged with the ones found in the global template directory.\n              Note, definitions in local vhost teplate directory take precedence over\n              the ones found in the global template directory.\n  -d          Make this vhost the default virtual host.\n              Note, this will also change the server_name directive of nginx to '_'\n              as well as discarding any prefix or suffix specified for the name.\n              Apache does not have any specialities, the first vhost takes precedence.\n  -s          If specified, the generated vhost will be saved in the location found in\n              conf.yml. If not specified, vhost will be printed to stdout.\n  -v          Be verbose.\n\nMisc arguments:\n  --help      Show this help.\n  --version   Show version.\n```\n\n\n## Contributing\n\nThis is an open source project and done in spare time. If you want to help out you are warmly welcome. You could do one or more of the following things:\n\n* Validate web server templates\n* Submit template examples\n* Create templates for other web servers\n* Whatever else you can imagine of\n\n\n## License\n\n**[MIT License](LICENSE.md)**\n\nCopyright (c) 2017 [cytopia](https://github.com/cytopia)\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/devilbox/vhost-gen", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "vhost-gen", "package_url": "https://pypi.org/project/vhost-gen/", "platform": "", "project_url": "https://pypi.org/project/vhost-gen/", "project_urls": {"Homepage": "https://github.com/devilbox/vhost-gen"}, "release_url": "https://pypi.org/project/vhost-gen/1.0.0/", "requires_dist": ["pyyaml", "future"], "requires_python": "", "summary": "Configurable vHost generator for Apache 2.2, Apache 2.4 and Nginx.", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>vhost-gen</h1>\n<p><a href=\"https://github.com/psf/black\" rel=\"nofollow\"><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/fbfdc7754183ecf079bc71ddeabaf88f6cbc5c00/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c61636b2d3030303030302e737667\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/53cde05eac87f350cf0c55afff00ec0cb24b899f/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f76686f73742d67656e\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI - Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/93dd5acdba5c45d55f0b0de429b628abea20b15f/68747470733a2f2f696d672e736869656c64732e696f2f707970692f7374617475732f76686f73742d67656e\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI - Python Version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/7d835edee109dd497412a8e2917285117425af66/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f76686f73742d67656e\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI - Format\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c02d34e3f1e4521c550b1662e8811716a2a8070c/68747470733a2f2f696d672e736869656c64732e696f2f707970692f666f726d61742f76686f73742d67656e\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI - Implementation\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/227b41681731323f88543a7fc72ffbe967174819/68747470733a2f2f696d672e736869656c64732e696f2f707970692f696d706c656d656e746174696f6e2f76686f73742d67656e\"></a>\n<a href=\"https://pypi.org/project/vhost-gen/\" rel=\"nofollow\"><img alt=\"PyPI - License\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/54ef66986f801ca0fe3201c260e57d7136b3435d/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f76686f73742d67656e\"></a></p>\n<p><a href=\"https://github.com/devilbox/vhost-gen/actions?workflow=linting\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/a2a73db6e5f83c91e0c8ce4a79b862cf66c12135/68747470733a2f2f6769746875622e636f6d2f646576696c626f782f76686f73742d67656e2f776f726b666c6f77732f6c696e74696e672f62616467652e737667\"></a>\n<a href=\"https://github.com/devilbox/vhost-gen/actions?workflow=testing\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/420f2e2b4735fc4bc76c41e3b0ec79117472ba10/68747470733a2f2f6769746875622e636f6d2f646576696c626f782f76686f73742d67656e2f776f726b666c6f77732f74657374696e672f62616467652e737667\"></a>\n<a href=\"https://travis-ci.org/devilbox/vhost-gen\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/0b4cc97f4f5ed1be37af749b9ab92a525f2e17f1/68747470733a2f2f7472617669732d63692e6f72672f646576696c626f782f76686f73742d67656e2e7376673f6272616e63683d6d6173746572\"></a></p>\n<p><strong><a href=\"bin/vhost-gen\" rel=\"nofollow\">vhost-gen</a></strong> will dynamically generate <strong>vhost</strong> or <strong>reverse proxy</strong> configuration files for Apache 2.2, Apache 2.4 and Nginx depending on what you have set in <a href=\"etc/conf.yml\" rel=\"nofollow\">conf.yml</a>. This makes it easy to switch between different web servers while keeping the exact same functionality.</p>\n<hr>\n<h2>Installation</h2>\n<h4>Via pip</h4>\n<pre>pip install vhost-gen\n</pre>\n<h4>From git</h4>\n<pre>git clone https://github.com/devilbox/vhost-gen\n<span class=\"nb\">cd</span> vhost-gen\nsudo make install\n</pre>\n<h2>What is all the fuzz?</h2>\n<p>Imagine you have to create virtual hosts for your web server over and over again. The only things that might change are document root, log files and server names and possibly some other minor changes. Instead of having to copy and adjust the server's vhost config file each time, you can use <code>vhost-gen</code> to generate them for you. By supporting different web server versions, it makes it also easy for you to switch back and forth between Apache 2.2, Apache 2.4 and Nginx.</p>\n<pre><span class=\"c1\"># vHost</span>\n$ vhost-gen -p /shared/httpd/www.example.com -n www.example.com\n<span class=\"c1\"># Reverse Proxy</span>\n$ vhost-gen -r http://127.0.0.1:8080 -l / -n api.example.com\n</pre>\n<p><strong><code>vhost-gen</code></strong> alone simply creates a new virtual host every time you execute it. The goal however is to also automate the execution of the vhost generator itself.</p>\n<h4>1. Reverse Proxy automation: <a href=\"https://github.com/devilbox/watcherp\" rel=\"nofollow\">watcherp</a></h4>\n<p>Here enters <strong><a href=\"https://github.com/devilbox/watcherp\" rel=\"nofollow\">watcherp</a></strong> the game. <strong><a href=\"https://github.com/devilbox/watcherp\" rel=\"nofollow\">watcherp</a></strong> listens for changes of port bindings and triggers a command whenever a new port has been bound or a binding has been removed. By combining these two tools, you could automate the creating of reverse proxies with one command:</p>\n<pre><span class=\"c1\"># %n will be replaced by watcherp with the address a port has binded</span>\n<span class=\"c1\"># %p will be replaced by watcherp with the the actual port number that started binding</span>\n<span class=\"c1\"># -p argument from watcherp specifies ports to ignore for changes</span>\n$ watcherp -v <span class=\"se\">\\</span>\n  -p <span class=\"m\">80</span>,443 <span class=\"se\">\\</span>\n  -a <span class=\"s2\">\"vhost-gen -r 'http://%n:%p' -l '/' -n '%n.example.com' -s\"</span> <span class=\"se\">\\</span>\n  -d <span class=\"s2\">\"rm /etc/nginx/conf.d/%n.example.com.conf\"</span> <span class=\"se\">\\</span>\n  -t <span class=\"s2\">\"nginx -s reload\"</span>\n</pre>\n<h4>2. Virtual Host automation: <a href=\"https://github.com/devilbox/watcherd\" rel=\"nofollow\">watcherd</a></h4>\n<p>Here enters <strong><a href=\"https://github.com/devilbox/watcherd\" rel=\"nofollow\">watcherd</a></strong> the game. <strong><a href=\"https://github.com/devilbox/watcherd\" rel=\"nofollow\">watcherd</a></strong> listens for directory changes and triggers a command whenever a directory has been created or deleted. By combining these two tools, you could automate mass virtual hosting with one command:</p>\n<pre><span class=\"c1\"># %n will be replaced by watcherd with the new directory name</span>\n<span class=\"c1\"># %p will be replaced by watcherd with the new directory path</span>\n$ watcherd -v <span class=\"se\">\\</span>\n  -p /shared/httpd <span class=\"se\">\\</span>\n  -a <span class=\"s2\">\"vhost-gen -p %p -n %n -s\"</span> <span class=\"se\">\\</span>\n  -d <span class=\"s2\">\"rm /etc/nginx/conf.d/%n.conf\"</span> <span class=\"se\">\\</span>\n  -t <span class=\"s2\">\"nginx -s reload\"</span>\n</pre>\n<h5>More customization</h5>\n<p>Now it might look much more interesting. With the above command every vhost will have the exact same definition (except server name, document root and log file names). It is however also possible that every vhost could be customized depending on their needs. <strong><code>vhost-gen</code></strong> allows for additional overwriting its template. So inside each newly created folder you could have a sub-directory (e.g. <code>templates/</code>) with folder specific defines. Those custom templates would only be sourced if they exist:</p>\n<pre><span class=\"c1\"># Note: Adding -o %p/templates</span>\n$ watcherd -v <span class=\"se\">\\</span>\n  -p /shared/httpd <span class=\"se\">\\</span>\n  -a <span class=\"s2\">\"vhost-gen -p %p -n %n -o %p/templates -s\"</span> <span class=\"se\">\\</span>\n  -d <span class=\"s2\">\"rm /etc/nginx/conf.d/%n.conf\"</span> <span class=\"se\">\\</span>\n  -t <span class=\"s2\">\"nginx -s reload\"</span>\n</pre>\n<h5>Making it robust</h5>\n<p>If you don't trust the stability of <strong><a href=\"https://github.com/devilbox/watcherd\" rel=\"nofollow\">watcherd</a></strong> or want other means of controlling this daemon, you can utilize <strong><a href=\"http://supervisord.org/\" rel=\"nofollow\">supervisord</a></strong>:</p>\n<pre><span class=\"k\">[program:watcherd]</span>\n<span class=\"na\">command</span><span class=\"o\">=</span><span class=\"s\">watcherd -v -p /shared/httpd -a \"vhost-gen -p %%p -n %%n -s\" -d \"rm /etc/nginx/custom.d/%%n.conf\" -t \"nginx -s reload\"</span>\n<span class=\"na\">startsecs</span> <span class=\"o\">=</span> <span class=\"s\">0</span>\n<span class=\"na\">autorestart</span> <span class=\"o\">=</span> <span class=\"s\">true</span>\n<span class=\"na\">stdout_logfile</span><span class=\"o\">=</span><span class=\"s\">/dev/stdout</span>\n<span class=\"na\">stdout_logfile_maxbytes</span><span class=\"o\">=</span><span class=\"s\">0</span>\n<span class=\"na\">stderr_logfile</span><span class=\"o\">=</span><span class=\"s\">/dev/stderr</span>\n<span class=\"na\">stderr_logfile_maxbytes</span><span class=\"o\">=</span><span class=\"s\">0</span>\n<span class=\"na\">stdout_events_enabled</span><span class=\"o\">=</span><span class=\"s\">true</span>\n<span class=\"na\">stderr_events_enabled</span><span class=\"o\">=</span><span class=\"s\">true</span>\n</pre>\n<h4>3. Dockerizing</h4>\n<p>If you don't want to implement it yourself, there are already four fully functional dockerized containers available that offer automated mass virtual hosting based on <code>vhost-gen</code> and <code>watcherd</code>:</p>\n<table>\n<thead>\n<tr>\n<th>Base Image</th>\n<th>Web server</th>\n<th>Repository</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Nginx stable (official)</td>\n<td>nginx</td>\n<td><a href=\"https://github.com/devilbox/docker-nginx-stable\" rel=\"nofollow\">https://github.com/devilbox/docker-nginx-stable</a></td>\n</tr>\n<tr>\n<td>Nginx mainline (official)</td>\n<td>nginx</td>\n<td><a href=\"https://github.com/devilbox/docker-nginx-mainline\" rel=\"nofollow\">https://github.com/devilbox/docker-nginx-mainline</a></td>\n</tr>\n<tr>\n<td>Apache 2.2 (official)</td>\n<td>Apache 2.2</td>\n<td><a href=\"https://github.com/devilbox/docker-apache-2.2\" rel=\"nofollow\">https://github.com/devilbox/docker-apache-2.2</a></td>\n</tr>\n<tr>\n<td>Apache 2.4 (official)</td>\n<td>Apache 2.4</td>\n<td><a href=\"https://github.com/devilbox/docker-apache-2.4\" rel=\"nofollow\">https://github.com/devilbox/docker-apache-2.4</a></td>\n</tr></tbody></table>\n<h2>Insights</h2>\n<h4>Supported Webserver</h4>\n<p>If you are not satisfied with the default definitions for the webserver configuration files, feel free to open an issue or a pull request.</p>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Template with default definitions</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Nginx</td>\n<td><a href=\"etc/templates/nginx.yml\" rel=\"nofollow\">nginx.yml</a></td>\n</tr>\n<tr>\n<td>Apache 2.2</td>\n<td><a href=\"etc/templates/apache22.yml\" rel=\"nofollow\">apache22.yml</a></td>\n</tr>\n<tr>\n<td>Apache 2.4</td>\n<td><a href=\"etc/templates/apache24.yml\" rel=\"nofollow\">apache24.yml</a></td>\n</tr></tbody></table>\n<h4>Supported Features</h4>\n<ul>\n<li>Document serving vHost or Reverse Proxy</li>\n<li>Custom server name</li>\n<li>Custom document root</li>\n<li>Custom access log name</li>\n<li>Custom error log name</li>\n<li>Enable cross domain requests with regex support for origins</li>\n<li>Enable PHP-FPM</li>\n<li>Add Aliases with regex support</li>\n<li>Add Deny locations with regex support</li>\n<li>Enable webserver status page</li>\n<li>Add custom directives from the configuration file</li>\n</ul>\n<h4>How does it work?</h4>\n<p><strong>General information:</strong></p>\n<ul>\n<li>vHost name is specified as a command line argument</li>\n<li>vHost templates for major webservers are defined in etc/templates</li>\n<li>vHost templates contain variables that must be replaced</li>\n<li>Webserver type/version is defined in /etc/vhost-gen/conf.yml</li>\n<li>Variable replacer are defined in /etc/vhost-gen/conf.yml</li>\n<li>Additional variable replacer can also be defined (<code>-o</code>)</li>\n</ul>\n<p><strong>The following describes the program flow:</strong></p>\n<ol>\n<li><a href=\"bin/vhost-gen\" rel=\"nofollow\">vhost-gen</a> will read /etc/vhost-gen/conf.yml to get defines and webserver type/version</li>\n<li>Base on the webserver version/type, it will read etc/templates/&lt;HTTPD_VERSION&gt;.yml template</li>\n<li>Variables in the chosen template are replaced</li>\n<li>The vHost name (<code>-n</code>) is also placed into the template</li>\n<li>Template is written to webserver's config location (defined in /etc/vhost-gen/conf.yml)</li>\n</ol>\n<h2>Usage</h2>\n<h4>Using different configurations</h4>\n<p>The <a href=\"etc/conf.yml\" rel=\"nofollow\">configuration file</a> should give you a lot of flexibility to generate a customized virtual host that fits your needs. Go and check out the <a href=\"examples/\" rel=\"nofollow\">example</a> section to see different configuration files for different web servers. If however the customization available in the configuration file is not sufficient, you can also adjust the <a href=\"etc/template\" rel=\"nofollow\">templates</a> itself. Read on to find out more in the next section.</p>\n<h4>Adding custom directives</h4>\n<p>The <a href=\"etc/conf.yml\" rel=\"nofollow\">configuration file</a> also contains a <code>custom:</code> directive. This is to add customized directives into your vhost definition that are not yet included in the feature sections. An example for Nginx would be:</p>\n<p><code>conf.yml</code>:</p>\n<pre>custom: |\n  if (-f $request_filename) {\n      break;\n  }\n</pre>\n<p>This would then be added to your generated vhost:</p>\n<pre><span class=\"k\">server</span> <span class=\"p\">{</span>\n    <span class=\"kn\">...</span>\n    <span class=\"s\">if</span> <span class=\"s\">(-f</span> <span class=\"nv\">$request_filename</span><span class=\"s\">)</span> <span class=\"p\">{</span>\n        <span class=\"kn\">break</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre>\n<p>If the current vHost definition does not suit your needs, you could also disable all available features in the configuration file and only use the <code>custom:</code> directive to specify your required definitions.</p>\n<h4>Using different templates</h4>\n<p>Each <a href=\"etc/templates\" rel=\"nofollow\">template</a> consists of two sections:</p>\n<ol>\n<li><code>vhost</code></li>\n<li><code>features</code></li>\n</ol>\n<p>The <code>vhost</code> section is the actual vhost that is being built. All placeholders (In the form of: <code>__*__</code>) will be substituted from either the configuration file or the feature section of the template.</p>\n<p>The <code>features</code> section contains definitions of features that can be enabled or disabled (via the config file). If those features do not seem suitable, you can adjust them to better fit your needs. You can also re-arrange their position in the <code>vhost</code> section.</p>\n<p>Whenever you edit the template, make sure not to misspell any placeholders. They will not get replaced when spellt wrong.</p>\n<p>Let's take for example the <code>features.server_status</code> section from Apache 2.2:</p>\n<pre>  server_status: |\n    # Status Page\n    &lt;Location __REGEX__&gt;\n        SetHandler server-status\n        Order allow,deny\n        Allow from all\n    &lt;/Location&gt;\n</pre>\n<p>If you are not satisfied with the <code>Allow from all</code> permissions, simply rewrite this template to your needs:</p>\n<pre>  server_status: |\n    # Status Page\n    &lt;Location __REGEX__&gt;\n        SetHandler server-status\n        Order allow,deny\n        Allow from 160.120.25.65\n    &lt;/Location&gt;\n</pre>\n<h4>Available command line options</h4>\n<pre>Usage: vhost-gen -p<span class=\"p\">|</span>r &lt;str&gt; -n &lt;str&gt; <span class=\"o\">[</span>-l &lt;str&gt; -m &lt;str&gt; -c &lt;str&gt; -t &lt;str&gt; -o &lt;str&gt; -d -s -v<span class=\"o\">]</span>\n       vhost-gen --help\n       vhost-gen --version\n\nvhost-gen will dynamically generate vhost configuration files\n<span class=\"k\">for</span> Nginx, Apache <span class=\"m\">2</span>.2 or Apache <span class=\"m\">2</span>.4 depending on what you have <span class=\"nb\">set</span>\nin /etc/vhot-gen/conf.yml\n\nRequired arguments:\n  -p<span class=\"p\">|</span>r &lt;str&gt;  You need to choose one of the mutually exclusive arguments.\n              -p: Path to document root/\n              -r: http<span class=\"o\">(</span>s<span class=\"o\">)</span>://Host:Port <span class=\"k\">for</span> reverse proxy.\n              Depening on the choice, it will either generate a document serving\n              vhost or a reverse proxy vhost.\n              Note, when using -p, this can also have a suffix directory to be <span class=\"nb\">set</span>\n              in conf.yml\n  -l &lt;str&gt;    Location path when using reverse proxy.\n              Note, this is not required <span class=\"k\">for</span> normal document root server <span class=\"o\">(</span>-p<span class=\"o\">)</span>\n  -n &lt;str&gt;    Name of vhost\n              Note, this can also have a prefix and/or suffix to be <span class=\"nb\">set</span> in conf.yml\n\nOptional arguments:\n  -m &lt;str&gt;    Vhost generation mode. Possible values are:\n              -m plain: Only generate http version <span class=\"o\">(</span>default<span class=\"o\">)</span>\n              -m ssl:   Only generate https version\n              -m both:  Generate http and https version\n              -m redir: Generate https version and make http redirect to https\n  -c &lt;str&gt;    Path to global configuration file.\n              If not set, the default location is /etc/vhost-gen/conf.yml\n              If no config is found, a default is used with all features turned off.\n  -t &lt;str&gt;    Path to global vhost template directory.\n              If not set, the default location is /etc/vhost-gen/templates/\n              If vhost template files are not found in this directory, the program will\n              abort.\n  -o &lt;str&gt;    Path to <span class=\"nb\">local</span> vhost template directory.\n              This is used as a secondary template directory and definitions found here\n              will be merged with the ones found in the global template directory.\n              Note, definitions in <span class=\"nb\">local</span> vhost teplate directory take precedence over\n              the ones found in the global template directory.\n  -d          Make this vhost the default virtual host.\n              Note, this will also change the server_name directive of nginx to <span class=\"s1\">'_'</span>\n              as well as discarding any prefix or suffix specified <span class=\"k\">for</span> the name.\n              Apache does not have any specialities, the first vhost takes precedence.\n  -s          If specified, the generated vhost will be saved in the location found in\n              conf.yml. If not specified, vhost will be printed to stdout.\n  -v          Be verbose.\n\nMisc arguments:\n  --help      Show this help.\n  --version   Show version.\n</pre>\n<h2>Contributing</h2>\n<p>This is an open source project and done in spare time. If you want to help out you are warmly welcome. You could do one or more of the following things:</p>\n<ul>\n<li>Validate web server templates</li>\n<li>Submit template examples</li>\n<li>Create templates for other web servers</li>\n<li>Whatever else you can imagine of</li>\n</ul>\n<h2>License</h2>\n<p><strong><a href=\"LICENSE.md\" rel=\"nofollow\">MIT License</a></strong></p>\n<p>Copyright (c) 2017 <a href=\"https://github.com/cytopia\" rel=\"nofollow\">cytopia</a></p>\n\n          </div>"}, "last_serial": 6507384, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "718fae031fac5fc5f8f168c847fb88a8", "sha256": "b17cdf7fb4ed379ee9689b7a83394e2cb4184e75423e891bcfd140c174864c83"}, "downloads": -1, "filename": "vhost_gen-1.0.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "718fae031fac5fc5f8f168c847fb88a8", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 13717, "upload_time": "2020-01-23T15:52:08", "upload_time_iso_8601": "2020-01-23T15:52:08.262026Z", "url": "https://files.pythonhosted.org/packages/ae/10/ec6dc4724ded5e5def20dc4614057d1189168972b940f9b6e31c0e7b521a/vhost_gen-1.0.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "e6e6c3cb9d8fb91e387860f4587f3cae", "sha256": "683a5468c7b5690ddea5234a42d3a7fe58ff56571c9da735c0d9ea0c8e49c0d0"}, "downloads": -1, "filename": "vhost-gen-1.0.0.tar.gz", "has_sig": false, "md5_digest": "e6e6c3cb9d8fb91e387860f4587f3cae", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13703, "upload_time": "2020-01-23T15:52:10", "upload_time_iso_8601": "2020-01-23T15:52:10.484546Z", "url": "https://files.pythonhosted.org/packages/49/de/55e819a4608c14c7c8b83d0742b81ef759d87e4963ea626e5dacf60006b3/vhost-gen-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "718fae031fac5fc5f8f168c847fb88a8", "sha256": "b17cdf7fb4ed379ee9689b7a83394e2cb4184e75423e891bcfd140c174864c83"}, "downloads": -1, "filename": "vhost_gen-1.0.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "718fae031fac5fc5f8f168c847fb88a8", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 13717, "upload_time": "2020-01-23T15:52:08", "upload_time_iso_8601": "2020-01-23T15:52:08.262026Z", "url": "https://files.pythonhosted.org/packages/ae/10/ec6dc4724ded5e5def20dc4614057d1189168972b940f9b6e31c0e7b521a/vhost_gen-1.0.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "e6e6c3cb9d8fb91e387860f4587f3cae", "sha256": "683a5468c7b5690ddea5234a42d3a7fe58ff56571c9da735c0d9ea0c8e49c0d0"}, "downloads": -1, "filename": "vhost-gen-1.0.0.tar.gz", "has_sig": false, "md5_digest": "e6e6c3cb9d8fb91e387860f4587f3cae", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13703, "upload_time": "2020-01-23T15:52:10", "upload_time_iso_8601": "2020-01-23T15:52:10.484546Z", "url": "https://files.pythonhosted.org/packages/49/de/55e819a4608c14c7c8b83d0742b81ef759d87e4963ea626e5dacf60006b3/vhost-gen-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:36:22 2020"}