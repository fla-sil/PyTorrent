{"info": {"author": "Lev Orekhov", "author_email": "lev.orekhov@gmail.com", "bugtrack_url": null, "classifiers": ["Intended Audience :: Developers", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2", "Programming Language :: Python :: 3", "Topic :: Software Development :: Libraries", "Topic :: Software Development :: Libraries :: Python Modules"], "description": "# Usage\n\n    from mongolock import MongoLock\n\n    lock = MongoLock()\n\n    # you can use it as context:\n    # (if lock is already taken by another worker, MongoLockLocked will be raised)\n    with lock('key', 'my_worker_name', expire=60, timeout=10):\n       # some work here\n\n    # or simply by calling methods:\n    if lock.lock('key', 'my_worker_name'):\n        try:\n            # some useful work\n        finally:\n            lock.release('key', 'my_worker_name')\n\n    # you can also renew lock by touching it:\n    with lock('key', 'my_worker_name', expire=60, timeout=10):\n       # some looong looong work here\n       lock.touch('key', 'my_worker_name')\n\nParameters in `lock` method:\n\n  * `key` - name of task to lock\n  * `owner` - name of worker which takes a lock\n  * `expire` (optional) - duration in seconds after which lock can be stealed\n  * `timeout` (optional) - how long we can wait for a lock (in seconds)\n\n# Configuration nuances\n\nYou can configure connection either by specifying connection string,\n\n    lock = MongoLock('localhost:27017')\n\nor by passing configured instance of MongoClient/MongoReplicaSetClient in MongoLock constructor:\n\n    client = MongoClient('localhost:27017')\n    lock = MongoLock(client=client)\n\nThe second is preferred, as in such a way you can perform more fine grained configuration:\n\n  * use MongoReplicaSetClient\n  * specify write concern\n  * specify tags\n  * etc\n\n# Important things to think about\n\n#### Lock stealing and releasing\n\nYou should use unique names for all your workers, if you don't - some strange things may happen.\nConsider following sequence:\n\n  * worker1 and worker2 has the same names: worker\n  * worker1 achieves lock with expire +30s\n  * worker2 tries to get lock after 30s (worker1 is still working)\n  * as lock expires, worker2 steals it\n  * now worker1 ends his work and releases lock, as they has same names - lock is released\n  * worker3 takes a lock, while worker2 is still working ...\n\n#### Lock simply doesn't work\n\nIf you use cron (or some analogue) to launch tasks on different machines, take in account time drift between machines as well\n  as duration of critical section of your tasks.\n\n  * machine1 and machine2 have a time drift 5s\n  * worker on machine1 takes a lock on TaskA\n  * worker on machine1 done a TaskA in 1s\n  * now worker on machine2 comes in play\n  * it doesn't know that worker on machine1 have already completed TaskA\n  * it takes a lock on TaskA (without problem as lock was released 4s before) and do it\n\nTo prevent such a weird situation, you can simply add some part of time (for example YmdHM) to a key with task name.", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/lorehov/mongolock", "keywords": "lock mongodb", "license": "BSD", "maintainer": null, "maintainer_email": null, "name": "mongolock", "package_url": "https://pypi.org/project/mongolock/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/mongolock/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/lorehov/mongolock"}, "release_url": "https://pypi.org/project/mongolock/1.3.4/", "requires_dist": null, "requires_python": null, "summary": "Python Mongodb based Distributed Lock", "version": "1.3.4", "yanked": false, "html_description": "<div class=\"project-description\">\n            # Usage<br><br>    from mongolock import MongoLock<br><br>    lock = MongoLock()<br><br>    # you can use it as context:<br>    # (if lock is already taken by another worker, MongoLockLocked will be raised)<br>    with lock('key', 'my_worker_name', expire=60, timeout=10):<br>       # some work here<br><br>    # or simply by calling methods:<br>    if lock.lock('key', 'my_worker_name'):<br>        try:<br>            # some useful work<br>        finally:<br>            lock.release('key', 'my_worker_name')<br><br>    # you can also renew lock by touching it:<br>    with lock('key', 'my_worker_name', expire=60, timeout=10):<br>       # some looong looong work here<br>       lock.touch('key', 'my_worker_name')<br><br>Parameters in `lock` method:<br><br>  * `key` - name of task to lock<br>  * `owner` - name of worker which takes a lock<br>  * `expire` (optional) - duration in seconds after which lock can be stealed<br>  * `timeout` (optional) - how long we can wait for a lock (in seconds)<br><br># Configuration nuances<br><br>You can configure connection either by specifying connection string,<br><br>    lock = MongoLock('localhost:27017')<br><br>or by passing configured instance of MongoClient/MongoReplicaSetClient in MongoLock constructor:<br><br>    client = MongoClient('localhost:27017')<br>    lock = MongoLock(client=client)<br><br>The second is preferred, as in such a way you can perform more fine grained configuration:<br><br>  * use MongoReplicaSetClient<br>  * specify write concern<br>  * specify tags<br>  * etc<br><br># Important things to think about<br><br>#### Lock stealing and releasing<br><br>You should use unique names for all your workers, if you don't - some strange things may happen.<br>Consider following sequence:<br><br>  * worker1 and worker2 has the same names: worker<br>  * worker1 achieves lock with expire +30s<br>  * worker2 tries to get lock after 30s (worker1 is still working)<br>  * as lock expires, worker2 steals it<br>  * now worker1 ends his work and releases lock, as they has same names - lock is released<br>  * worker3 takes a lock, while worker2 is still working ...<br><br>#### Lock simply doesn't work<br><br>If you use cron (or some analogue) to launch tasks on different machines, take in account time drift between machines as well<br>  as duration of critical section of your tasks.<br><br>  * machine1 and machine2 have a time drift 5s<br>  * worker on machine1 takes a lock on TaskA<br>  * worker on machine1 done a TaskA in 1s<br>  * now worker on machine2 comes in play<br>  * it doesn't know that worker on machine1 have already completed TaskA<br>  * it takes a lock on TaskA (without problem as lock was released 4s before) and do it<br><br>To prevent such a weird situation, you can simply add some part of time (for example YmdHM) to a key with task name.\n          </div>"}, "last_serial": 1544203, "releases": {"1.0": [{"comment_text": "", "digests": {"md5": "281a6e1a1e5e37cac0785c17102d4632", "sha256": "65e5cafd2fcad7fc71c2710e55ecb888a16066ed571618bfe747b9d2072820f7"}, "downloads": -1, "filename": "mongolock-1.0.tar.gz", "has_sig": false, "md5_digest": "281a6e1a1e5e37cac0785c17102d4632", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4881, "upload_time": "2014-07-25T04:21:15", "upload_time_iso_8601": "2014-07-25T04:21:15.401973Z", "url": "https://files.pythonhosted.org/packages/f8/24/d446d8f19f7ce3eb253f021902f0d66bb5f8c7e93289745a17309a326768/mongolock-1.0.tar.gz", "yanked": false}], "1.0.1": [{"comment_text": "", "digests": {"md5": "86f6cde0fe8fb319cf98c8fc3e67d7ca", "sha256": "bd7ae6be9fd896c3b94f486b4ad5c7baf0742e8bc3ec2efcd1dc20e0f2d10a35"}, "downloads": -1, "filename": "mongolock-1.0.1.tar.gz", "has_sig": false, "md5_digest": "86f6cde0fe8fb319cf98c8fc3e67d7ca", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4878, "upload_time": "2014-07-25T04:21:58", "upload_time_iso_8601": "2014-07-25T04:21:58.646159Z", "url": "https://files.pythonhosted.org/packages/8a/b4/043a8dfa45da252c62e7b54a5052bc2965b61e88942f4d431e1ad944c6aa/mongolock-1.0.1.tar.gz", "yanked": false}], "1.0.2": [{"comment_text": "", "digests": {"md5": "174c233f19d4279d4bb5cfe84767b623", "sha256": "4eb3d1ca7b2e7ab2c5cdf85c7c9fec4e4e36a5463bf8267b113bee4ab8a7ee91"}, "downloads": -1, "filename": "mongolock-1.0.2.tar.gz", "has_sig": false, "md5_digest": "174c233f19d4279d4bb5cfe84767b623", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4918, "upload_time": "2014-07-25T04:27:10", "upload_time_iso_8601": "2014-07-25T04:27:10.148769Z", "url": "https://files.pythonhosted.org/packages/8e/f1/1a73f999480289fde2710025f56f79e90fd2fbe4b9a303cbf8ea3fc1bb81/mongolock-1.0.2.tar.gz", "yanked": false}], "1.0.3": [{"comment_text": "", "digests": {"md5": "8cc88543af68c652a285f4baf288542b", "sha256": "50b019189988ac6934ddf9d7d36c915d09ff4e3cb47035e8f6538e988d0b6f21"}, "downloads": -1, "filename": "mongolock-1.0.3.tar.gz", "has_sig": false, "md5_digest": "8cc88543af68c652a285f4baf288542b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4870, "upload_time": "2014-07-25T04:29:22", "upload_time_iso_8601": "2014-07-25T04:29:22.968466Z", "url": "https://files.pythonhosted.org/packages/f3/f4/c46c1206da945a87690431a83c1b268f8998d4749def70c3157b180dd0f4/mongolock-1.0.3.tar.gz", "yanked": false}], "1.1.0": [{"comment_text": "", "digests": {"md5": "b687464e02928fda9b51a70165402395", "sha256": "4b0089753e1ca19566e6ae85a6812b51d3e7e788009a98ec9e3c45b6ac16adab"}, "downloads": -1, "filename": "mongolock-1.1.0.tar.gz", "has_sig": false, "md5_digest": "b687464e02928fda9b51a70165402395", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4865, "upload_time": "2014-07-26T03:54:26", "upload_time_iso_8601": "2014-07-26T03:54:26.370578Z", "url": "https://files.pythonhosted.org/packages/56/d6/df01268981029a45618b048400df78f9a619f82637dbf70c1687f0a4bb76/mongolock-1.1.0.tar.gz", "yanked": false}], "1.2.0": [{"comment_text": "", "digests": {"md5": "1ac9929c4bddc0426036f3b72c2ee97e", "sha256": "51096a6d4a40c927c2073e2e59d95129a2003ec6677df6da0e7d4da7c05cb5c3"}, "downloads": -1, "filename": "mongolock-1.2.0.tar.gz", "has_sig": false, "md5_digest": "1ac9929c4bddc0426036f3b72c2ee97e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4880, "upload_time": "2014-10-06T12:12:18", "upload_time_iso_8601": "2014-10-06T12:12:18.942751Z", "url": "https://files.pythonhosted.org/packages/be/46/e332394a8f6a411242fb9bdd0fe25c9c6b3b11984c25fca34a846d317579/mongolock-1.2.0.tar.gz", "yanked": false}], "1.2.1": [{"comment_text": "", "digests": {"md5": "a882f16a5058f32e7428eb9500e97a52", "sha256": "16f309a3177eea78b802417b1ac7f06ea6eff993166deaa908a67967d37d6549"}, "downloads": -1, "filename": "mongolock-1.2.1.tar.gz", "has_sig": false, "md5_digest": "a882f16a5058f32e7428eb9500e97a52", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4940, "upload_time": "2014-10-08T08:58:29", "upload_time_iso_8601": "2014-10-08T08:58:29.302886Z", "url": "https://files.pythonhosted.org/packages/76/8b/4b3079e3c33e0266b8ac103ff029673161a6ff385df6a24a06b8997514e8/mongolock-1.2.1.tar.gz", "yanked": false}], "1.3.1": [{"comment_text": "", "digests": {"md5": "2d9d9fef43a7d0acbd537ce42792e131", "sha256": "ce5f4a4ff719a77f62fa0592cf5c0710ce636de6dd6b471082259bdda51ea121"}, "downloads": -1, "filename": "mongolock-1.3.1.tar.gz", "has_sig": false, "md5_digest": "2d9d9fef43a7d0acbd537ce42792e131", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4999, "upload_time": "2014-10-24T18:45:07", "upload_time_iso_8601": "2014-10-24T18:45:07.320184Z", "url": "https://files.pythonhosted.org/packages/fd/e6/309ab3bc93ea152f0c6166330e157f1222b8bd71c62127af5f0d74cc39ba/mongolock-1.3.1.tar.gz", "yanked": false}], "1.3.2": [{"comment_text": "", "digests": {"md5": "a44a95e51671810de167575f63e7bc3e", "sha256": "f658a2b49145d3c56d945989722ccbee9b1263836cf2d645dda8b091b4b3682e"}, "downloads": -1, "filename": "mongolock-1.3.2.tar.gz", "has_sig": false, "md5_digest": "a44a95e51671810de167575f63e7bc3e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5004, "upload_time": "2014-11-27T10:30:04", "upload_time_iso_8601": "2014-11-27T10:30:04.015090Z", "url": "https://files.pythonhosted.org/packages/62/c7/4f2978844190f60dcf15b931ec66629e9d37b9c18a43bcc01b56e04296f1/mongolock-1.3.2.tar.gz", "yanked": false}], "1.3.3": [{"comment_text": "", "digests": {"md5": "82fe87775d84ab0f9de0b06676ef12f6", "sha256": "256056d95bff965ce64ad9f54ee0c137c5f3a1c97aa42fb1367824f081dca5b0"}, "downloads": -1, "filename": "mongolock-1.3.3.tar.gz", "has_sig": false, "md5_digest": "82fe87775d84ab0f9de0b06676ef12f6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5028, "upload_time": "2014-12-17T12:25:30", "upload_time_iso_8601": "2014-12-17T12:25:30.734443Z", "url": "https://files.pythonhosted.org/packages/b1/8d/9499fef6252416080fed7bfc09a4b65f630b134e8988be36b2a6a835f464/mongolock-1.3.3.tar.gz", "yanked": false}], "1.3.4": [{"comment_text": "", "digests": {"md5": "69a09be87a1d3b9493023116ea6eec96", "sha256": "f261dc41ee6acd80e79ae75acc9fdd8c4f018b363041e1d33ec145d2250c26bd"}, "downloads": -1, "filename": "mongolock-1.3.4.tar.gz", "has_sig": false, "md5_digest": "69a09be87a1d3b9493023116ea6eec96", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5035, "upload_time": "2015-05-12T19:09:55", "upload_time_iso_8601": "2015-05-12T19:09:55.892378Z", "url": "https://files.pythonhosted.org/packages/7b/41/07ce80317f0d4a9ac14900002246b432584e428ad507825714df37460973/mongolock-1.3.4.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "69a09be87a1d3b9493023116ea6eec96", "sha256": "f261dc41ee6acd80e79ae75acc9fdd8c4f018b363041e1d33ec145d2250c26bd"}, "downloads": -1, "filename": "mongolock-1.3.4.tar.gz", "has_sig": false, "md5_digest": "69a09be87a1d3b9493023116ea6eec96", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5035, "upload_time": "2015-05-12T19:09:55", "upload_time_iso_8601": "2015-05-12T19:09:55.892378Z", "url": "https://files.pythonhosted.org/packages/7b/41/07ce80317f0d4a9ac14900002246b432584e428ad507825714df37460973/mongolock-1.3.4.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:52:16 2020"}