{"info": {"author": "drozdowsky", "author_email": "hdrozdow+github@pm.me", "bugtrack_url": null, "classifiers": [], "description": "# Django Tracking Model \ud83c\udfc1\nTrack changes made to your model's instance.  \nChanges are cleared on save.  \nThis package is intented to be used mainly with [signals](https://seddonym.me/2018/05/04/django-signals/).  \nMutable fields (e.g. JSONField) are not handled with deepcopy to keep it fast and simple.  \nMeant to be model_utils's FieldTracker fast alternative.\n\n*Available on [PyPi](https://pypi.org/project/django-tracking-model/)*  \n\n\n## Usage\n```python\nfrom django.db import models\nfrom tracking_model import TrackingModelMixin\n\n# order matters\nclass Example(TrackingModelMixin, models.Model)\n    text = models.TextField(null=True)\n    myself = models.ForeignKey(\"self\", null=True)\n    array = models.ArrayField(TextField())\n```\n```python\nIn [1]: e = Example.objects.create(id=1, text=\"Sample Text\")\nIn [2]: e.tracker.changed, e.tracker.newly_created\nOut[1]: ({}, True)\n\nIn [3]: e.text = \"Different Text\"\nIn [4]: e.tracker.changed\nOut[2]: {\"text\": \"Sample Text\"}\n\nIn [5]: e.save()\nIn [6]: e.tracker.changed, e.tracker.newly_created\nOut[3]: ({}, False)\n```\nDTM will also detect changes made to ForeignKey/OneToOne fields.\n```python\nIn [1]: Example.objects.create(myself=e)\nIn [2]: e.myself = None\nIn [3]: e.tracker.changed\nOut[1]: {\"myself_id\": 1}\n```\nBecause DTM does not handle mutable fields well, you handle them with copy/deepcopy.\n```python\nIn [1]: e = Example.objects.create(array=['I', 'am', 'your'])\nIn [2]: copied = copy(e.array)\nIn [3]: copied.append('father')\nIn [4]: e.array = copied\nIn [5]: e.tracker.changed\nOut[1]: {'array': ['I', 'am', 'your']}\n\nIn [6]: e.array = ['Testing', 'is', 'the', 'future']  # in this case copy not needed\n```\nDTM works best with \\*\\_save signals.\n```python\ndef pre_save_example(instance, *args, **kwargs):\n    # .create() does not populate .changed, we use newly_created\n    if 'text' in instance.tracker.changed or instance.tracker.newly_created:\n      if instance.text\n          instance.array = instance.text.split()\n\npre_save.connect(pre_save_example, sender=Example)\n```\n```python\nIn [1]: e = Example.objects.create(text='I am your father')\nIn [2]: e.refresh_from_db() # not needed\nIn [3]: e.array\nOut[1]: ['I', 'am', 'your', 'father']\n```\nDTM handles deferred fields well.\n```python\nIn [1]: e = Example.objects.only('array').first()\nIn [2]: e.text = 'I am not your father' \nIn [3]: e.tracker.changed\nOut[4]: {'text': DeferredAttribute}\n```\nYou can narrow choice of tracked fields. By default everything is tracked.\n```python\nclass Example(models.Model):\n    TRACKED_FIELDS = ['first']\n    first = models.TextField()\n    second = models.TextField()\n```\n\n## Requirements\n * Python >= 2.7, <= 3.8\n * Django >= 1.11, <= 3.0\n\n## Todo\n- [ ] Tests could be more readable\n- [ ] Signals decorators", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/drozdowsky/django-tracking-model/", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "django-tracking-model", "package_url": "https://pypi.org/project/django-tracking-model/", "platform": "", "project_url": "https://pypi.org/project/django-tracking-model/", "project_urls": {"Homepage": "https://github.com/drozdowsky/django-tracking-model/"}, "release_url": "https://pypi.org/project/django-tracking-model/0.1.2/", "requires_dist": null, "requires_python": "", "summary": "Track changes made to django model instance.", "version": "0.1.2", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Django Tracking Model \ud83c\udfc1</h1>\n<p>Track changes made to your model's instance.<br>\nChanges are cleared on save.<br>\nThis package is intented to be used mainly with <a href=\"https://seddonym.me/2018/05/04/django-signals/\" rel=\"nofollow\">signals</a>.<br>\nMutable fields (e.g. JSONField) are not handled with deepcopy to keep it fast and simple.<br>\nMeant to be model_utils's FieldTracker fast alternative.</p>\n<p><em>Available on <a href=\"https://pypi.org/project/django-tracking-model/\" rel=\"nofollow\">PyPi</a></em></p>\n<h2>Usage</h2>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django.db</span> <span class=\"kn\">import</span> <span class=\"n\">models</span>\n<span class=\"kn\">from</span> <span class=\"nn\">tracking_model</span> <span class=\"kn\">import</span> <span class=\"n\">TrackingModelMixin</span>\n\n<span class=\"c1\"># order matters</span>\n<span class=\"k\">class</span> <span class=\"nc\">Example</span><span class=\"p\">(</span><span class=\"n\">TrackingModelMixin</span><span class=\"p\">,</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">)</span>\n    <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">TextField</span><span class=\"p\">(</span><span class=\"n\">null</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">myself</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">ForeignKey</span><span class=\"p\">(</span><span class=\"s2\">\"self\"</span><span class=\"p\">,</span> <span class=\"n\">null</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">array</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">ArrayField</span><span class=\"p\">(</span><span class=\"n\">TextField</span><span class=\"p\">())</span>\n</pre>\n<pre><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"n\">e</span> <span class=\"o\">=</span> <span class=\"n\">Example</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">(</span><span class=\"nb\">id</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">\"Sample Text\"</span><span class=\"p\">)</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span><span class=\"p\">,</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">newly_created</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"p\">({},</span> <span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s2\">\"Different Text\"</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"p\">{</span><span class=\"s2\">\"text\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Sample Text\"</span><span class=\"p\">}</span>\n\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span><span class=\"p\">,</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">newly_created</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"p\">({},</span> <span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre>\n<p>DTM will also detect changes made to ForeignKey/OneToOne fields.</p>\n<pre><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"n\">Example</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">(</span><span class=\"n\">myself</span><span class=\"o\">=</span><span class=\"n\">e</span><span class=\"p\">)</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">myself</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"p\">{</span><span class=\"s2\">\"myself_id\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">}</span>\n</pre>\n<p>Because DTM does not handle mutable fields well, you handle them with copy/deepcopy.</p>\n<pre><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"n\">e</span> <span class=\"o\">=</span> <span class=\"n\">Example</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">(</span><span class=\"n\">array</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'I'</span><span class=\"p\">,</span> <span class=\"s1\">'am'</span><span class=\"p\">,</span> <span class=\"s1\">'your'</span><span class=\"p\">])</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"n\">copied</span> <span class=\"o\">=</span> <span class=\"n\">copy</span><span class=\"p\">(</span><span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">)</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">copied</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">'father'</span><span class=\"p\">)</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">array</span> <span class=\"o\">=</span> <span class=\"n\">copied</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"p\">{</span><span class=\"s1\">'array'</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">'I'</span><span class=\"p\">,</span> <span class=\"s1\">'am'</span><span class=\"p\">,</span> <span class=\"s1\">'your'</span><span class=\"p\">]}</span>\n\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">array</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">'Testing'</span><span class=\"p\">,</span> <span class=\"s1\">'is'</span><span class=\"p\">,</span> <span class=\"s1\">'the'</span><span class=\"p\">,</span> <span class=\"s1\">'future'</span><span class=\"p\">]</span>  <span class=\"c1\"># in this case copy not needed</span>\n</pre>\n<p>DTM works best with *_save signals.</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">pre_save_example</span><span class=\"p\">(</span><span class=\"n\">instance</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n    <span class=\"c1\"># .create() does not populate .changed, we use newly_created</span>\n    <span class=\"k\">if</span> <span class=\"s1\">'text'</span> <span class=\"ow\">in</span> <span class=\"n\">instance</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span> <span class=\"ow\">or</span> <span class=\"n\">instance</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">newly_created</span><span class=\"p\">:</span>\n      <span class=\"k\">if</span> <span class=\"n\">instance</span><span class=\"o\">.</span><span class=\"n\">text</span>\n          <span class=\"n\">instance</span><span class=\"o\">.</span><span class=\"n\">array</span> <span class=\"o\">=</span> <span class=\"n\">instance</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">()</span>\n\n<span class=\"n\">pre_save</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">pre_save_example</span><span class=\"p\">,</span> <span class=\"n\">sender</span><span class=\"o\">=</span><span class=\"n\">Example</span><span class=\"p\">)</span>\n</pre>\n<pre><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"n\">e</span> <span class=\"o\">=</span> <span class=\"n\">Example</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">'I am your father'</span><span class=\"p\">)</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">refresh_from_db</span><span class=\"p\">()</span> <span class=\"c1\"># not needed</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">array</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"p\">[</span><span class=\"s1\">'I'</span><span class=\"p\">,</span> <span class=\"s1\">'am'</span><span class=\"p\">,</span> <span class=\"s1\">'your'</span><span class=\"p\">,</span> <span class=\"s1\">'father'</span><span class=\"p\">]</span>\n</pre>\n<p>DTM handles deferred fields well.</p>\n<pre><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]:</span> <span class=\"n\">e</span> <span class=\"o\">=</span> <span class=\"n\">Example</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">only</span><span class=\"p\">(</span><span class=\"s1\">'array'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">first</span><span class=\"p\">()</span>\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s1\">'I am not your father'</span> \n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">tracker</span><span class=\"o\">.</span><span class=\"n\">changed</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]:</span> <span class=\"p\">{</span><span class=\"s1\">'text'</span><span class=\"p\">:</span> <span class=\"n\">DeferredAttribute</span><span class=\"p\">}</span>\n</pre>\n<p>You can narrow choice of tracked fields. By default everything is tracked.</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">Example</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">TRACKED_FIELDS</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">'first'</span><span class=\"p\">]</span>\n    <span class=\"n\">first</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">TextField</span><span class=\"p\">()</span>\n    <span class=\"n\">second</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">TextField</span><span class=\"p\">()</span>\n</pre>\n<h2>Requirements</h2>\n<ul>\n<li>Python &gt;= 2.7, &lt;= 3.8</li>\n<li>Django &gt;= 1.11, &lt;= 3.0</li>\n</ul>\n<h2>Todo</h2>\n<ul>\n<li>[ ] Tests could be more readable</li>\n<li>[ ] Signals decorators</li>\n</ul>\n\n          </div>"}, "last_serial": 6278707, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "e7a962f7cb78925a491952008b280a80", "sha256": "ac06d6623be1a7d8e9fe63af29cbecfe0b626b4af01cd113c2dff8c0c75202e9"}, "downloads": -1, "filename": "django_tracking_model-0.1.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "e7a962f7cb78925a491952008b280a80", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 3943, "upload_time": "2019-06-19T10:21:46", "upload_time_iso_8601": "2019-06-19T10:21:46.210654Z", "url": "https://files.pythonhosted.org/packages/fe/50/3059b9ab3ccfa63fe7e5fd4cbe8f3d36f07650e0213c72f0be9df3616c53/django_tracking_model-0.1.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "31fc1015f3e73981003783ebc76567c3", "sha256": "d6f1e05d36d51269cec394b6e00466a5795ba1da9a388982551f66c1fa1a9e48"}, "downloads": -1, "filename": "django-tracking-model-0.1.0.tar.gz", "has_sig": false, "md5_digest": "31fc1015f3e73981003783ebc76567c3", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5178, "upload_time": "2019-06-19T10:21:48", "upload_time_iso_8601": "2019-06-19T10:21:48.761066Z", "url": "https://files.pythonhosted.org/packages/65/c9/2dd3c1e0cf3bae64ab6fa2b176cedad3d6e6719b4a745b34a5383af9c2cc/django-tracking-model-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "196ae6bf6efbc7ade923c20d85ca80a4", "sha256": "4614be5494fc45485c0b445524eeae716a1b878a53bf44e9b83c976efdfd79f4"}, "downloads": -1, "filename": "django-tracking-model-0.1.1.tar.gz", "has_sig": false, "md5_digest": "196ae6bf6efbc7ade923c20d85ca80a4", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5686, "upload_time": "2019-06-24T12:52:05", "upload_time_iso_8601": "2019-06-24T12:52:05.780231Z", "url": "https://files.pythonhosted.org/packages/c8/11/537e7c6d0571f81608f09538f24e3274bdae17f4488d695bdaaf07f0f8a8/django-tracking-model-0.1.1.tar.gz", "yanked": false}], "0.1.2": [{"comment_text": "", "digests": {"md5": "eb188230589671c1a360deed1d303243", "sha256": "9743c4e8af1ee0333a0ba73eb918e370521257a7abf1d5e56e514f74c6a3b256"}, "downloads": -1, "filename": "django-tracking-model-0.1.2.tar.gz", "has_sig": false, "md5_digest": "eb188230589671c1a360deed1d303243", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6139, "upload_time": "2019-12-11T12:16:57", "upload_time_iso_8601": "2019-12-11T12:16:57.712000Z", "url": "https://files.pythonhosted.org/packages/ce/9a/6a92445476e7bdb234d70549e8fafd826cdfeeb5498ae6d82a4042e0d3d2/django-tracking-model-0.1.2.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "eb188230589671c1a360deed1d303243", "sha256": "9743c4e8af1ee0333a0ba73eb918e370521257a7abf1d5e56e514f74c6a3b256"}, "downloads": -1, "filename": "django-tracking-model-0.1.2.tar.gz", "has_sig": false, "md5_digest": "eb188230589671c1a360deed1d303243", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6139, "upload_time": "2019-12-11T12:16:57", "upload_time_iso_8601": "2019-12-11T12:16:57.712000Z", "url": "https://files.pythonhosted.org/packages/ce/9a/6a92445476e7bdb234d70549e8fafd826cdfeeb5498ae6d82a4042e0d3d2/django-tracking-model-0.1.2.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:52:22 2020"}