{"info": {"author": "Franc[e]sco", "author_email": "lolisamurai@tfwno.gf", "bugtrack_url": null, "classifiers": ["Intended Audience :: Developers", "License :: Public Domain", "Programming Language :: Python :: 2", "Programming Language :: Python :: 3", "Topic :: Software Development :: Libraries"], "description": "subscribe to GCM/FCM and receive notifications\n\npython implementation of https://github.com/MatthieuLemoine/push-receiver\n\ntested on python 2.7.16, 3.4.10 and 3.7.5\n\nI put this together in a day or so, it's still rough around the edges,\nespecially the listen part, which I don't really use myself and have just\nimplemented for fun and only briefly tested\n\nnote that for the listening part I had to pull in http-ece which depends\non a full blown native crypto library rather than just oscrypto. it is\nan optional dependency so you'll have to install it explicitly by depending\non push_receiver[listen]\n\nusage\n============\n\n.. code-block:: sh\n\n    pip install push_receiver[listen,example]\n\n\nbasic usage example that stores and loads credentials and persistent ids\nand prints new notifications\n\nyou can also run this example with this command (change the sender id)\n\n.. code-block:: sh\n\n    python -m \"push_receiver\" --sender-id=722915550290\n\n\n.. code-block:: python\n\n    from push_receiver import register, listen\n    import json\n\n\n    def on_notification(obj, notification, data_message):\n      idstr = data_message.persistent_id + \"\\n\"\n\n      # check if we already received the notification\n      with open(\"persistent_ids.txt\", \"r\") as f:\n        if idstr in f:\n          return\n\n      # new notification, store id so we don't read it again\n      with open(\"persistent_ids.txt\", \"a\") as f:\n        f.write(idstr)\n\n      # print notification\n      n = notification[\"notification\"]\n      text = n[\"title\"]\n      if n[\"body\"]:\n        text += \": \" + n[\"body\"]\n      print(text)\n\n\n    if __name__ == \"__main__\":\n      SENDER_ID = 722915550290  # change this to your sender id\n\n      try:\n        # already registered, load previous credentials\n        with open(\"credentials.json\", \"r\") as f:\n          credentials = json.load(f)\n\n      except FileNotFoundError:\n        # first time, register and store credentials\n        credentials = register(sender_id=SENDER_ID)\n        with open(\"credentials.json\", \"w\") as f:\n          json.dump(credentials, f)\n\n      print(\"send notifications to {}\".format(credentials[\"fcm\"][\"token\"]))\n\n      with open(\"persistent_ids.txt\", \"a+\") as f:\n        received_persistent_ids = [x.strip() for x in f]\n\n      listen(credentials, on_notification, received_persistent_ids)\n\n\n", "description_content_type": "", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/Francesco149/push_receiver", "keywords": "fcm gcm push notification firebase google", "license": "Unlicense", "maintainer": "", "maintainer_email": "", "name": "push-receiver", "package_url": "https://pypi.org/project/push-receiver/", "platform": "", "project_url": "https://pypi.org/project/push-receiver/", "project_urls": {"Homepage": "https://github.com/Francesco149/push_receiver"}, "release_url": "https://pypi.org/project/push-receiver/0.1.1/", "requires_dist": ["oscrypto", "protobuf", "appdirs ; extra == 'example'", "http-ece ; extra == 'listen'"], "requires_python": "", "summary": "subscribe to GCM/FCM and receive notifications", "version": "0.1.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p>subscribe to GCM/FCM and receive notifications</p>\n<p>python implementation of <a href=\"https://github.com/MatthieuLemoine/push-receiver\" rel=\"nofollow\">https://github.com/MatthieuLemoine/push-receiver</a></p>\n<p>tested on python 2.7.16, 3.4.10 and 3.7.5</p>\n<p>I put this together in a day or so, it\u2019s still rough around the edges,\nespecially the listen part, which I don\u2019t really use myself and have just\nimplemented for fun and only briefly tested</p>\n<p>note that for the listening part I had to pull in http-ece which depends\non a full blown native crypto library rather than just oscrypto. it is\nan optional dependency so you\u2019ll have to install it explicitly by depending\non push_receiver[listen]</p>\n<div id=\"usage\">\n<h2>usage</h2>\n<pre>pip install push_receiver<span class=\"o\">[</span>listen,example<span class=\"o\">]</span>\n</pre>\n<p>basic usage example that stores and loads credentials and persistent ids\nand prints new notifications</p>\n<p>you can also run this example with this command (change the sender id)</p>\n<pre>python -m <span class=\"s2\">\"push_receiver\"</span> --sender-id<span class=\"o\">=</span><span class=\"m\">722915550290</span>\n</pre>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">push_receiver</span> <span class=\"kn\">import</span> <span class=\"n\">register</span><span class=\"p\">,</span> <span class=\"n\">listen</span>\n<span class=\"kn\">import</span> <span class=\"nn\">json</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">on_notification</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"n\">notification</span><span class=\"p\">,</span> <span class=\"n\">data_message</span><span class=\"p\">):</span>\n  <span class=\"n\">idstr</span> <span class=\"o\">=</span> <span class=\"n\">data_message</span><span class=\"o\">.</span><span class=\"n\">persistent_id</span> <span class=\"o\">+</span> <span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span>\n\n  <span class=\"c1\"># check if we already received the notification</span>\n  <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"persistent_ids.txt\"</span><span class=\"p\">,</span> <span class=\"s2\">\"r\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">idstr</span> <span class=\"ow\">in</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n      <span class=\"k\">return</span>\n\n  <span class=\"c1\"># new notification, store id so we don't read it again</span>\n  <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"persistent_ids.txt\"</span><span class=\"p\">,</span> <span class=\"s2\">\"a\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">idstr</span><span class=\"p\">)</span>\n\n  <span class=\"c1\"># print notification</span>\n  <span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"n\">notification</span><span class=\"p\">[</span><span class=\"s2\">\"notification\"</span><span class=\"p\">]</span>\n  <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">n</span><span class=\"p\">[</span><span class=\"s2\">\"title\"</span><span class=\"p\">]</span>\n  <span class=\"k\">if</span> <span class=\"n\">n</span><span class=\"p\">[</span><span class=\"s2\">\"body\"</span><span class=\"p\">]:</span>\n    <span class=\"n\">text</span> <span class=\"o\">+=</span> <span class=\"s2\">\": \"</span> <span class=\"o\">+</span> <span class=\"n\">n</span><span class=\"p\">[</span><span class=\"s2\">\"body\"</span><span class=\"p\">]</span>\n  <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">\"__main__\"</span><span class=\"p\">:</span>\n  <span class=\"n\">SENDER_ID</span> <span class=\"o\">=</span> <span class=\"mi\">722915550290</span>  <span class=\"c1\"># change this to your sender id</span>\n\n  <span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"c1\"># already registered, load previous credentials</span>\n    <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"credentials.json\"</span><span class=\"p\">,</span> <span class=\"s2\">\"r\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n      <span class=\"n\">credentials</span> <span class=\"o\">=</span> <span class=\"n\">json</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n\n  <span class=\"k\">except</span> <span class=\"ne\">FileNotFoundError</span><span class=\"p\">:</span>\n    <span class=\"c1\"># first time, register and store credentials</span>\n    <span class=\"n\">credentials</span> <span class=\"o\">=</span> <span class=\"n\">register</span><span class=\"p\">(</span><span class=\"n\">sender_id</span><span class=\"o\">=</span><span class=\"n\">SENDER_ID</span><span class=\"p\">)</span>\n    <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"credentials.json\"</span><span class=\"p\">,</span> <span class=\"s2\">\"w\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n      <span class=\"n\">json</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"p\">)</span>\n\n  <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"send notifications to </span><span class=\"si\">{}</span><span class=\"s2\">\"</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">[</span><span class=\"s2\">\"fcm\"</span><span class=\"p\">][</span><span class=\"s2\">\"token\"</span><span class=\"p\">]))</span>\n\n  <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"persistent_ids.txt\"</span><span class=\"p\">,</span> <span class=\"s2\">\"a+\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"n\">received_persistent_ids</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">x</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">x</span> <span class=\"ow\">in</span> <span class=\"n\">f</span><span class=\"p\">]</span>\n\n  <span class=\"n\">listen</span><span class=\"p\">(</span><span class=\"n\">credentials</span><span class=\"p\">,</span> <span class=\"n\">on_notification</span><span class=\"p\">,</span> <span class=\"n\">received_persistent_ids</span><span class=\"p\">)</span>\n</pre>\n</div>\n\n          </div>"}, "last_serial": 6144906, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "77cb43b1a4a5d38f5174c2969a1d3197", "sha256": "d8def7d875f425560f4594e9b51e2656fd6a2b2f30bf99e8d7fe49da9426898e"}, "downloads": -1, "filename": "push_receiver-0.1.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "77cb43b1a4a5d38f5174c2969a1d3197", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 17343, "upload_time": "2019-11-15T20:14:33", "upload_time_iso_8601": "2019-11-15T20:14:33.325767Z", "url": "https://files.pythonhosted.org/packages/2c/7f/c12008e59fc3d356809fc3a9b224514a67e576207c3a55bbdeb33513030e/push_receiver-0.1.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "dde0aa9baa8b175b9f68639a95f42afb", "sha256": "93ce0bde2cd9f618fd3f9e14f14acf6f2801dd98c91011bd083024272f92e04d"}, "downloads": -1, "filename": "push_receiver-0.1.0.tar.gz", "has_sig": false, "md5_digest": "dde0aa9baa8b175b9f68639a95f42afb", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15836, "upload_time": "2019-11-15T20:14:36", "upload_time_iso_8601": "2019-11-15T20:14:36.104315Z", "url": "https://files.pythonhosted.org/packages/54/15/c215f79fdd3c0c8400aa388f0e773562b545c52eae3da0a033191fc2b846/push_receiver-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "3786dc37096c2e461abc0fe140819b64", "sha256": "b16eebb79a04cf2e85ade8208df909566abded4095bae9936cefad87321a3fcd"}, "downloads": -1, "filename": "push_receiver-0.1.1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "3786dc37096c2e461abc0fe140819b64", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 17356, "upload_time": "2019-11-15T20:46:58", "upload_time_iso_8601": "2019-11-15T20:46:58.081050Z", "url": "https://files.pythonhosted.org/packages/f2/7d/a3c15baccf427796f517f18427bc084aabf61dc82b3915ea226461d26de7/push_receiver-0.1.1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "902578ea5bee2f74767a3477fe6746ee", "sha256": "4e49e6adadfd41f03e3a0ad1c732832db90fb9c5bcce0747ab3e451909f360ec"}, "downloads": -1, "filename": "push_receiver-0.1.1.tar.gz", "has_sig": false, "md5_digest": "902578ea5bee2f74767a3477fe6746ee", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15856, "upload_time": "2019-11-15T20:47:00", "upload_time_iso_8601": "2019-11-15T20:47:00.058787Z", "url": "https://files.pythonhosted.org/packages/75/98/3722c171b49980f33291e6f83ffd7224c30bbe06419501a4c180ad4ec736/push_receiver-0.1.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3786dc37096c2e461abc0fe140819b64", "sha256": "b16eebb79a04cf2e85ade8208df909566abded4095bae9936cefad87321a3fcd"}, "downloads": -1, "filename": "push_receiver-0.1.1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "3786dc37096c2e461abc0fe140819b64", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 17356, "upload_time": "2019-11-15T20:46:58", "upload_time_iso_8601": "2019-11-15T20:46:58.081050Z", "url": "https://files.pythonhosted.org/packages/f2/7d/a3c15baccf427796f517f18427bc084aabf61dc82b3915ea226461d26de7/push_receiver-0.1.1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "902578ea5bee2f74767a3477fe6746ee", "sha256": "4e49e6adadfd41f03e3a0ad1c732832db90fb9c5bcce0747ab3e451909f360ec"}, "downloads": -1, "filename": "push_receiver-0.1.1.tar.gz", "has_sig": false, "md5_digest": "902578ea5bee2f74767a3477fe6746ee", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15856, "upload_time": "2019-11-15T20:47:00", "upload_time_iso_8601": "2019-11-15T20:47:00.058787Z", "url": "https://files.pythonhosted.org/packages/75/98/3722c171b49980f33291e6f83ffd7224c30bbe06419501a4c180ad4ec736/push_receiver-0.1.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:13:07 2020"}