{"info": {"author": "Ryan Hiebert", "author_email": "ryan@aspiredu.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7"], "description": "===========================================================\ndjango-safemigrate: Safely run migrations before deployment\n===========================================================\n\n.. image:: https://img.shields.io/pypi/v/django-safemigrate.svg\n   :target: https://pypi.org/project/django-safemigrate/\n   :alt: Latest Version\n\n.. image:: https://dev.azure.com/aspiredu/django-safemigrate/_apis/build/status/1?branchName=master\n   :target: https://dev.azure.com/aspiredu/django-safemigrate/_build/latest?definitionId=1&branchName=master\n   :alt: Build status\n\n.. image:: https://codecov.io/gh/aspiredu/django-safemigrate/branch/master/graph/badge.svg\n   :target: https://codecov.io/gh/aspiredu/django-safemigrate\n   :alt: Code Coverage\n\n.. image:: https://img.shields.io/badge/code%20style-black-000000.svg\n   :target: https://github.com/ambv/black\n   :alt: Code style: black\n\n|\n\ndjango-safemigrate adds a ``safemigrate`` command to Django\nto allow for safely running a migration command when deploying.\n\nUsage\n=====\n\nInstall ``django-safemigrate``, then add this to the\n``INSTALLED_APPS`` in the settings file:\n\n.. code-block:: python\n\n    INSTALLED_APPS = [\n        # ...\n        \"django_safemigrate.apps.SafeMigrateConfig\",\n    ]\n\nThen mark any migration that may be run\nduring a pre-deployment stage,\nsuch as a migration to add a column.\n\n.. code-block:: python\n\n    from django_safemigrate import Safe\n\n    class Migration(migrations.Migration):\n        safe = Safe.before_deploy\n\nAt this point you can run the ``safemigrate`` Django command\nto run the migrations, and only these migrations will run.\nHowever, if migrations that are not safe to run before\nthe code is deployed are dependencies of this migration,\nthen these migrations will be blocked, and the safemigrate\ncommand will fail with an error.\n\nWhen the code is fully deployed, just run the normal ``migrate``\nDjango command, which still functions normally.\nFor example, you could add the command to the release phase\nfor your Heroku app, and the safe migrations will be run\nautomatically when the new release is promoted.\n\nSafety Options\n==============\n\nThere are three options for the value of the\n``safe`` property of the migration.\n\n* ``Safe.before_deploy``\n\n  This migration is only safe to run before the code change is deployed.\n  For example, a migration that adds a new field to a model.\n\n* ``Safe.after_deploy``\n\n  This migration is only safe to run after the code change is deployed.\n  This is the default that is applied if no ``safe`` property is given.\n  For example, a migration that removes a field from a model.\n\n* ``Safe.always``\n\n  This migration is safe to run before *and* after\n  the code change is deployed.\n  For example, a migration that changes the ``help_text`` of a field.\n\nNonstrict Mode\n==============\n\nUnder normal operation, if there are migrations\nthat must run before the deployment that depend\non any migration that is marked to run after deployment\n(or is not marked),\nthe command will raise an error to indicate\nthat there are protected migrations that\nshould have already been run, but have not been,\nand are blocking migrations that are expected to run.\n\nIn development, however, it is common that these\nwould accumulate between developers,\nand since it is acceptable for there to be downtime\nduring the transitional period in development,\nit is better to allow the command to continue without raising.\n\nTo enable nonstrict mode, add the ``SAFEMIGRATE`` setting:\n\n.. code-block:: python\n\n    SAFEMIGRATE = \"nonstrict\"\n\nIn this mode ``safemigrate`` will run all the migrations\nthat are not blocked by any unsafe migrations.\nAny remaining migrations can be run after the fact\nusing the normal ``migrate`` Django command.\n", "description_content_type": "text/x-rst", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "", "keywords": "", "license": "MIT", "maintainer": "Ryan Hiebert", "maintainer_email": "ryan@aspiredu.com", "name": "django-safemigrate", "package_url": "https://pypi.org/project/django-safemigrate/", "platform": "", "project_url": "https://pypi.org/project/django-safemigrate/", "project_urls": null, "release_url": "https://pypi.org/project/django-safemigrate/2.1/", "requires_dist": ["django (>=2.1,<4.0)"], "requires_python": ">=3.6,<4.0", "summary": "Safely run migrations before deployment", "version": "2.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <a href=\"https://pypi.org/project/django-safemigrate/\" rel=\"nofollow\"><img alt=\"Latest Version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/f4fcc05be7824cedbb32619cd00a8a06757124b2/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f646a616e676f2d736166656d6967726174652e737667\"></a>\n<a href=\"https://dev.azure.com/aspiredu/django-safemigrate/_build/latest?definitionId=1&amp;branchName=master\" rel=\"nofollow\"><img alt=\"Build status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/8a669be3ce99346ae86d8b253b5db00a982c779c/68747470733a2f2f6465762e617a7572652e636f6d2f61737069726564752f646a616e676f2d736166656d6967726174652f5f617069732f6275696c642f7374617475732f313f6272616e63684e616d653d6d6173746572\"></a>\n<a href=\"https://codecov.io/gh/aspiredu/django-safemigrate\" rel=\"nofollow\"><img alt=\"Code Coverage\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/0318bb5991161b5da261482011afe88a0bf5ff47/68747470733a2f2f636f6465636f762e696f2f67682f61737069726564752f646a616e676f2d736166656d6967726174652f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a>\n<a href=\"https://github.com/ambv/black\" rel=\"nofollow\"><img alt=\"Code style: black\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/fbfdc7754183ecf079bc71ddeabaf88f6cbc5c00/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c61636b2d3030303030302e737667\"></a>\n<div>\n<div><br></div>\n</div>\n<p>django-safemigrate adds a <tt>safemigrate</tt> command to Django\nto allow for safely running a migration command when deploying.</p>\n<div id=\"usage\">\n<h2>Usage</h2>\n<p>Install <tt><span class=\"pre\">django-safemigrate</span></tt>, then add this to the\n<tt>INSTALLED_APPS</tt> in the settings file:</p>\n<pre><span class=\"n\">INSTALLED_APPS</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"s2\">\"django_safemigrate.apps.SafeMigrateConfig\"</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n</pre>\n<p>Then mark any migration that may be run\nduring a pre-deployment stage,\nsuch as a migration to add a column.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_safemigrate</span> <span class=\"kn\">import</span> <span class=\"n\">Safe</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">Migration</span><span class=\"p\">(</span><span class=\"n\">migrations</span><span class=\"o\">.</span><span class=\"n\">Migration</span><span class=\"p\">):</span>\n    <span class=\"n\">safe</span> <span class=\"o\">=</span> <span class=\"n\">Safe</span><span class=\"o\">.</span><span class=\"n\">before_deploy</span>\n</pre>\n<p>At this point you can run the <tt>safemigrate</tt> Django command\nto run the migrations, and only these migrations will run.\nHowever, if migrations that are not safe to run before\nthe code is deployed are dependencies of this migration,\nthen these migrations will be blocked, and the safemigrate\ncommand will fail with an error.</p>\n<p>When the code is fully deployed, just run the normal <tt>migrate</tt>\nDjango command, which still functions normally.\nFor example, you could add the command to the release phase\nfor your Heroku app, and the safe migrations will be run\nautomatically when the new release is promoted.</p>\n</div>\n<div id=\"safety-options\">\n<h2>Safety Options</h2>\n<p>There are three options for the value of the\n<tt>safe</tt> property of the migration.</p>\n<ul>\n<li><p><tt>Safe.before_deploy</tt></p>\n<p>This migration is only safe to run before the code change is deployed.\nFor example, a migration that adds a new field to a model.</p>\n</li>\n<li><p><tt>Safe.after_deploy</tt></p>\n<p>This migration is only safe to run after the code change is deployed.\nThis is the default that is applied if no <tt>safe</tt> property is given.\nFor example, a migration that removes a field from a model.</p>\n</li>\n<li><p><tt>Safe.always</tt></p>\n<p>This migration is safe to run before <em>and</em> after\nthe code change is deployed.\nFor example, a migration that changes the <tt>help_text</tt> of a field.</p>\n</li>\n</ul>\n</div>\n<div id=\"nonstrict-mode\">\n<h2>Nonstrict Mode</h2>\n<p>Under normal operation, if there are migrations\nthat must run before the deployment that depend\non any migration that is marked to run after deployment\n(or is not marked),\nthe command will raise an error to indicate\nthat there are protected migrations that\nshould have already been run, but have not been,\nand are blocking migrations that are expected to run.</p>\n<p>In development, however, it is common that these\nwould accumulate between developers,\nand since it is acceptable for there to be downtime\nduring the transitional period in development,\nit is better to allow the command to continue without raising.</p>\n<p>To enable nonstrict mode, add the <tt>SAFEMIGRATE</tt> setting:</p>\n<pre><span class=\"n\">SAFEMIGRATE</span> <span class=\"o\">=</span> <span class=\"s2\">\"nonstrict\"</span>\n</pre>\n<p>In this mode <tt>safemigrate</tt> will run all the migrations\nthat are not blocked by any unsafe migrations.\nAny remaining migrations can be run after the fact\nusing the normal <tt>migrate</tt> Django command.</p>\n</div>\n\n          </div>"}, "last_serial": 6248777, "releases": {"1.0": [{"comment_text": "", "digests": {"md5": "34d3ab286ab2fcd93105f83ea3c93ee3", "sha256": "7c8d25f1b17e6dd72d4db2515067efb9525a0ba1d8cf79f0eaf98b9f9f385210"}, "downloads": -1, "filename": "django_safemigrate-1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "34d3ab286ab2fcd93105f83ea3c93ee3", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 7220, "upload_time": "2019-01-13T18:17:45", "upload_time_iso_8601": "2019-01-13T18:17:45.490363Z", "url": "https://files.pythonhosted.org/packages/1e/68/0d68be097ee5550288c7dd265ee1e8dbe74c812f0c8d2ce0ca15c3e73b06/django_safemigrate-1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f10197dd74da0a36d0ace7ae38283316", "sha256": "aaee0bf695c4ef452ad4eaa4b76866b4fab57bb9afddf4339f5a54e40ccc4982"}, "downloads": -1, "filename": "django-safemigrate-1.0.tar.gz", "has_sig": false, "md5_digest": "f10197dd74da0a36d0ace7ae38283316", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 3147, "upload_time": "2019-01-13T18:17:42", "upload_time_iso_8601": "2019-01-13T18:17:42.762034Z", "url": "https://files.pythonhosted.org/packages/b4/11/48019a1806af717cfd43259ea5210df64ebfec814d70073166824d0f08c6/django-safemigrate-1.0.tar.gz", "yanked": false}], "2.0": [{"comment_text": "", "digests": {"md5": "b41fd2acd946e85b8f92e5de20347d58", "sha256": "611303b68623c72a44c1c487a46e72b53d4859b14c9953fc68721e2991f73893"}, "downloads": -1, "filename": "django_safemigrate-2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "b41fd2acd946e85b8f92e5de20347d58", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 9673, "upload_time": "2019-01-17T20:24:21", "upload_time_iso_8601": "2019-01-17T20:24:21.408819Z", "url": "https://files.pythonhosted.org/packages/fe/89/7fe25eb068e6160cd199335483b68c85fe1e05a1cf98edb43eb6c83f24c6/django_safemigrate-2.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "268653071e65449000178e5a87121de7", "sha256": "256a2265d072ba93c18dfe8e0087cf50fc23ce69983ea63ee6febbcf63cc003a"}, "downloads": -1, "filename": "django-safemigrate-2.0.tar.gz", "has_sig": false, "md5_digest": "268653071e65449000178e5a87121de7", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5083, "upload_time": "2019-01-17T20:24:19", "upload_time_iso_8601": "2019-01-17T20:24:19.445777Z", "url": "https://files.pythonhosted.org/packages/1a/7b/d99ebe5c8ff877d94256c532a31c5c45be97d41279dc2f5029eddb854ee3/django-safemigrate-2.0.tar.gz", "yanked": false}], "2.1": [{"comment_text": "", "digests": {"md5": "c99700e6fef9343a153faee7a1d4a577", "sha256": "d6fd77c5bf44af107e907dcd6a913a8a099443f1b17a9d569fcaa48347ffe8f1"}, "downloads": -1, "filename": "django_safemigrate-2.1-py3-none-any.whl", "has_sig": false, "md5_digest": "c99700e6fef9343a153faee7a1d4a577", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5728, "upload_time": "2019-12-05T18:09:18", "upload_time_iso_8601": "2019-12-05T18:09:18.047968Z", "url": "https://files.pythonhosted.org/packages/0b/47/16118a1fa636e4cc5f3f65c562998175ea5cd76b4fb915dadb8128a52592/django_safemigrate-2.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "4fa59915454a1fbd3a2b04e5a70438df", "sha256": "688c20bf90ad24bbf8555f8b03315cf011a4e0f2db810e50ec764bbef062d8ab"}, "downloads": -1, "filename": "django-safemigrate-2.1.tar.gz", "has_sig": false, "md5_digest": "4fa59915454a1fbd3a2b04e5a70438df", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5135, "upload_time": "2019-12-05T18:09:16", "upload_time_iso_8601": "2019-12-05T18:09:16.215965Z", "url": "https://files.pythonhosted.org/packages/2b/d9/302f7d9ea465e8030f5a59c3dd8b10000e90cbab211e2946d5c5e4f7d676/django-safemigrate-2.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "c99700e6fef9343a153faee7a1d4a577", "sha256": "d6fd77c5bf44af107e907dcd6a913a8a099443f1b17a9d569fcaa48347ffe8f1"}, "downloads": -1, "filename": "django_safemigrate-2.1-py3-none-any.whl", "has_sig": false, "md5_digest": "c99700e6fef9343a153faee7a1d4a577", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5728, "upload_time": "2019-12-05T18:09:18", "upload_time_iso_8601": "2019-12-05T18:09:18.047968Z", "url": "https://files.pythonhosted.org/packages/0b/47/16118a1fa636e4cc5f3f65c562998175ea5cd76b4fb915dadb8128a52592/django_safemigrate-2.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "4fa59915454a1fbd3a2b04e5a70438df", "sha256": "688c20bf90ad24bbf8555f8b03315cf011a4e0f2db810e50ec764bbef062d8ab"}, "downloads": -1, "filename": "django-safemigrate-2.1.tar.gz", "has_sig": false, "md5_digest": "4fa59915454a1fbd3a2b04e5a70438df", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5135, "upload_time": "2019-12-05T18:09:16", "upload_time_iso_8601": "2019-12-05T18:09:16.215965Z", "url": "https://files.pythonhosted.org/packages/2b/d9/302f7d9ea465e8030f5a59c3dd8b10000e90cbab211e2946d5c5e4f7d676/django-safemigrate-2.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:53:49 2020"}