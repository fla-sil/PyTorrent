{"info": {"author": "T. Yuan", "author_email": "tyuan@icecube.wisc.edu", "bugtrack_url": null, "classifiers": [], "description": "Getting started\n=================\n`pip install fb8`\n\n```Python\nimport numpy as np\nfrom matplotlib import pyplot as plt\nfrom matplotlib import cm\nfrom mpl_toolkits.mplot3d import Axes3D\nfrom sphere.distribution import fb8\n\n\ndef grid(npts):\n    return [_.flatten() for _ in np.meshgrid(np.linspace(0, np.pi, npts), np.linspace(0,2*np.pi, npts))]\n\n\ndef plot_fb8(fb8, npts):\n    \"\"\"\n    Plot fb8 on 3D sphere\n    \"\"\"\n    xs = fb8.spherical_coordinates_to_nu(*grid(npts))\n    pdfs = fb8.pdf(xs)\n    z,x,y = xs.T #!!! Note the ordering for xs here is used consistently throughout. Follows Kent's 1982 paper.\n\n    fig = plt.figure(figsize=plt.figaspect(1.))\n    ax = fig.add_subplot(111, projection='3d')\n    ax.plot_surface(x.reshape(npts, npts),\n                    y.reshape(npts, npts),\n                    z.reshape(npts, npts),\n                    alpha=0.5,\n                    rstride=1, cstride=1,\n                    facecolors=cm.plasma(pdfs.reshape(npts, npts)/pdfs.max()))\n    ax.set_axis_off()\n    plt.tight_layout(-5)\n    plt.show()\n\n\nplot_fb8(fb8(np.pi/16,-np.pi/3,0,10,10,-1,0.5,0.3), 200)\n```\n\nBasic information\n=================\nImplements the FB8 distribution on a sphere, which is a generalization of the FB6, FB5 (Kent), and FB4 (Bingham-Mardia) distributions described below.\n\nImplements the FB6 distribution that is first introduced in Rivest ([1984](https://www.doi.org/10.1214/aos/1176346724)).\n\nImplements calculation of the density and fitting (using maximum likelihood estimate) of the Kent distribution based on Kent ([1982](https://doi.org/10.1111/j.2517-6161.1982.tb01189.x)). A unittest is performed if distribution.py is called from the command line.\n\nImplements the Bingham-Mardia distribution whose mode is a small-circle on the sphere based on Bingham, Mardia ([1978](https://doi.org/10.1093/biomet/65.2.379)).\n\nAlso calculates directional, percentile levels which can be used to indicate the N% highest-posterior-density regions in the sky.\n\n![maps](https://github.com/tianluyuan/sphere/blob/master/fig/example.png?raw=true)\n\nAdditional references\n=================\nKent, Hussein, Jah, [_Directional distributions in tracking of space debris_](https://ieeexplore.ieee.org/abstract/document/7528139) \n\nTerdik, Jammalamadaka, Wainwright, [_Simulation and visualization of spherical distributions_](https://www.researchgate.net/profile/Gyorgy_Terdik/publication/324605982_Simulation_and_Visualization_of_Spherical_Distributions/links/5ad8edceaca272fdaf81fe04/Simulation-and-Visualization-of-Spherical-Distributions.pdf)\n\nMardia, Jupp, [_Directional statistics_](https://www.doi.org/10.1002/9780470316979)\n\nNotes\n=================\nCurrently the `scipy.special.hyp2f1` is used and may exhibit inaccuracies for large parameters. See github [issues](https://github.com/scipy/scipy/issues?utf8=%E2%9C%93&q=is%3Aissue+is%3Aopen+hyp2f1).\n\nContributors\n=================\n\nThis project was originally developed for the FB5 (Kent) distribution [here](https://github.com/edfraenkel/kent_distribution).\n\n_Tianlu Yuan_\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/tianluyuan/sphere.git", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "fb8", "package_url": "https://pypi.org/project/fb8/", "platform": "", "project_url": "https://pypi.org/project/fb8/", "project_urls": {"Homepage": "https://github.com/tianluyuan/sphere.git"}, "release_url": "https://pypi.org/project/fb8/0.2.1/", "requires_dist": ["numpy", "scipy", "matplotlib; extra == 'plotting'", "healpy; extra == 'plotting'"], "requires_python": "", "summary": "Implementation of FB8, a generalization of the Kent (1982) and Bingham-Mardia (1978) distributions on a sphere", "version": "0.2.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Getting started</h1>\n<p><code>pip install fb8</code></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">matplotlib</span> <span class=\"kn\">import</span> <span class=\"n\">pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">matplotlib</span> <span class=\"kn\">import</span> <span class=\"n\">cm</span>\n<span class=\"kn\">from</span> <span class=\"nn\">mpl_toolkits.mplot3d</span> <span class=\"kn\">import</span> <span class=\"n\">Axes3D</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sphere.distribution</span> <span class=\"kn\">import</span> <span class=\"n\">fb8</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">grid</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"p\">[</span><span class=\"n\">_</span><span class=\"o\">.</span><span class=\"n\">flatten</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">meshgrid</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">))]</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">plot_fb8</span><span class=\"p\">(</span><span class=\"n\">fb8</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">    Plot fb8 on 3D sphere</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"n\">xs</span> <span class=\"o\">=</span> <span class=\"n\">fb8</span><span class=\"o\">.</span><span class=\"n\">spherical_coordinates_to_nu</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">))</span>\n    <span class=\"n\">pdfs</span> <span class=\"o\">=</span> <span class=\"n\">fb8</span><span class=\"o\">.</span><span class=\"n\">pdf</span><span class=\"p\">(</span><span class=\"n\">xs</span><span class=\"p\">)</span>\n    <span class=\"n\">z</span><span class=\"p\">,</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">xs</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"c1\">#!!! Note the ordering for xs here is used consistently throughout. Follows Kent's 1982 paper.</span>\n\n    <span class=\"n\">fig</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figaspect</span><span class=\"p\">(</span><span class=\"mf\">1.</span><span class=\"p\">))</span>\n    <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"mi\">111</span><span class=\"p\">,</span> <span class=\"n\">projection</span><span class=\"o\">=</span><span class=\"s1\">'3d'</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot_surface</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">),</span>\n                    <span class=\"n\">y</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">),</span>\n                    <span class=\"n\">z</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">),</span>\n                    <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span>\n                    <span class=\"n\">rstride</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">cstride</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span>\n                    <span class=\"n\">facecolors</span><span class=\"o\">=</span><span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">plasma</span><span class=\"p\">(</span><span class=\"n\">pdfs</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">npts</span><span class=\"p\">,</span> <span class=\"n\">npts</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"n\">pdfs</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">()))</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_axis_off</span><span class=\"p\">()</span>\n    <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n\n<span class=\"n\">plot_fb8</span><span class=\"p\">(</span><span class=\"n\">fb8</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span><span class=\"o\">/</span><span class=\"mi\">16</span><span class=\"p\">,</span><span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">10</span><span class=\"p\">,</span><span class=\"mi\">10</span><span class=\"p\">,</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"mf\">0.3</span><span class=\"p\">),</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n</pre>\n<h1>Basic information</h1>\n<p>Implements the FB8 distribution on a sphere, which is a generalization of the FB6, FB5 (Kent), and FB4 (Bingham-Mardia) distributions described below.</p>\n<p>Implements the FB6 distribution that is first introduced in Rivest (<a href=\"https://www.doi.org/10.1214/aos/1176346724\" rel=\"nofollow\">1984</a>).</p>\n<p>Implements calculation of the density and fitting (using maximum likelihood estimate) of the Kent distribution based on Kent (<a href=\"https://doi.org/10.1111/j.2517-6161.1982.tb01189.x\" rel=\"nofollow\">1982</a>). A unittest is performed if distribution.py is called from the command line.</p>\n<p>Implements the Bingham-Mardia distribution whose mode is a small-circle on the sphere based on Bingham, Mardia (<a href=\"https://doi.org/10.1093/biomet/65.2.379\" rel=\"nofollow\">1978</a>).</p>\n<p>Also calculates directional, percentile levels which can be used to indicate the N% highest-posterior-density regions in the sky.</p>\n<p><img alt=\"maps\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/d899195c646ff4ce2701d45f69fdd326e1898e6d/68747470733a2f2f6769746875622e636f6d2f7469616e6c757975616e2f7370686572652f626c6f622f6d61737465722f6669672f6578616d706c652e706e673f7261773d74727565\"></p>\n<h1>Additional references</h1>\n<p>Kent, Hussein, Jah, <a href=\"https://ieeexplore.ieee.org/abstract/document/7528139\" rel=\"nofollow\"><em>Directional distributions in tracking of space debris</em></a></p>\n<p>Terdik, Jammalamadaka, Wainwright, <a href=\"https://www.researchgate.net/profile/Gyorgy_Terdik/publication/324605982_Simulation_and_Visualization_of_Spherical_Distributions/links/5ad8edceaca272fdaf81fe04/Simulation-and-Visualization-of-Spherical-Distributions.pdf\" rel=\"nofollow\"><em>Simulation and visualization of spherical distributions</em></a></p>\n<p>Mardia, Jupp, <a href=\"https://www.doi.org/10.1002/9780470316979\" rel=\"nofollow\"><em>Directional statistics</em></a></p>\n<h1>Notes</h1>\n<p>Currently the <code>scipy.special.hyp2f1</code> is used and may exhibit inaccuracies for large parameters. See github <a href=\"https://github.com/scipy/scipy/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+is%3Aopen+hyp2f1\" rel=\"nofollow\">issues</a>.</p>\n<h1>Contributors</h1>\n<p>This project was originally developed for the FB5 (Kent) distribution <a href=\"https://github.com/edfraenkel/kent_distribution\" rel=\"nofollow\">here</a>.</p>\n<p><em>Tianlu Yuan</em></p>\n\n          </div>"}, "last_serial": 6220461, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "4c0849690c420988bb16471d859c32a1", "sha256": "d14063f6b9a9a8db5aff16cde8ea94d7ce15e3f9690dbcd4502dc318bb3f9d8b"}, "downloads": -1, "filename": "fb8-0.1.0-py2-none-any.whl", "has_sig": false, "md5_digest": "4c0849690c420988bb16471d859c32a1", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 17198, "upload_time": "2019-05-12T21:34:30", "upload_time_iso_8601": "2019-05-12T21:34:30.467621Z", "url": "https://files.pythonhosted.org/packages/72/83/c200633d061eddaaab3e8b090daef233c5a76c563b0dd506f19414cdad47/fb8-0.1.0-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "292c86cd2d11acf07bf30265f4cb06e4", "sha256": "b3dd290b9a0f5caabcbb934580cebcce485afb538c7a093131bff572fd28244e"}, "downloads": -1, "filename": "fb8-0.1.0.tar.gz", "has_sig": false, "md5_digest": "292c86cd2d11acf07bf30265f4cb06e4", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15935, "upload_time": "2019-05-12T21:34:32", "upload_time_iso_8601": "2019-05-12T21:34:32.967728Z", "url": "https://files.pythonhosted.org/packages/1e/2d/04c257b6357ce1a57d7d7eda28c71906ed27be2fe5bd5cd6174e275aeb16/fb8-0.1.0.tar.gz", "yanked": false}], "0.2.0": [{"comment_text": "", "digests": {"md5": "d2123ec631f855f3e52d1f775ded4d5a", "sha256": "fa7407c67e958b66e7ba27fca8f669d2bfa79a4101cfe83ccd9119208f9ac8a1"}, "downloads": -1, "filename": "fb8-0.2.0-py2-none-any.whl", "has_sig": false, "md5_digest": "d2123ec631f855f3e52d1f775ded4d5a", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 19671, "upload_time": "2019-06-19T17:31:39", "upload_time_iso_8601": "2019-06-19T17:31:39.934327Z", "url": "https://files.pythonhosted.org/packages/57/1e/9b1fd759b5f6d828bcc168a519ecdd7a867883986c60ff5243754910dd0b/fb8-0.2.0-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "c65aee75598a8764ddc40c7c5beb2f42", "sha256": "9f2585b410c279efab3510134cc5139908a61a5fc2955ac1a019e74395462d88"}, "downloads": -1, "filename": "fb8-0.2.0.tar.gz", "has_sig": false, "md5_digest": "c65aee75598a8764ddc40c7c5beb2f42", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18530, "upload_time": "2019-06-19T17:31:41", "upload_time_iso_8601": "2019-06-19T17:31:41.443350Z", "url": "https://files.pythonhosted.org/packages/55/ff/b847bc5dae2f9e24b804425043a8843907fb8b914249189f6a6d6a2cee52/fb8-0.2.0.tar.gz", "yanked": false}], "0.2.1": [{"comment_text": "", "digests": {"md5": "a8aca5a29a0cc732f2a56b39508b6121", "sha256": "7cae33cfb9ecf2e8ef640ada0a8c402117b139166e505df6992ec624ccf16b4d"}, "downloads": -1, "filename": "fb8-0.2.1-py2-none-any.whl", "has_sig": false, "md5_digest": "a8aca5a29a0cc732f2a56b39508b6121", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 19893, "upload_time": "2019-11-30T03:59:30", "upload_time_iso_8601": "2019-11-30T03:59:30.295768Z", "url": "https://files.pythonhosted.org/packages/34/3d/cdfae70758b95c715d8580ad869afd96f6737857822c20c870d7085b84df/fb8-0.2.1-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "14bdd27011413d1a1615492e6c0aa374", "sha256": "a66e045776a8fa49fa2b00ea098a84e976f37d90626d1278ed90afcaf3262fae"}, "downloads": -1, "filename": "fb8-0.2.1.tar.gz", "has_sig": false, "md5_digest": "14bdd27011413d1a1615492e6c0aa374", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18899, "upload_time": "2019-11-30T03:59:31", "upload_time_iso_8601": "2019-11-30T03:59:31.854598Z", "url": "https://files.pythonhosted.org/packages/1b/e0/80febd95db21d1810f79153023b263f61077932cd10533ad4621f4e9581b/fb8-0.2.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "a8aca5a29a0cc732f2a56b39508b6121", "sha256": "7cae33cfb9ecf2e8ef640ada0a8c402117b139166e505df6992ec624ccf16b4d"}, "downloads": -1, "filename": "fb8-0.2.1-py2-none-any.whl", "has_sig": false, "md5_digest": "a8aca5a29a0cc732f2a56b39508b6121", "packagetype": "bdist_wheel", "python_version": "py2", "requires_python": null, "size": 19893, "upload_time": "2019-11-30T03:59:30", "upload_time_iso_8601": "2019-11-30T03:59:30.295768Z", "url": "https://files.pythonhosted.org/packages/34/3d/cdfae70758b95c715d8580ad869afd96f6737857822c20c870d7085b84df/fb8-0.2.1-py2-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "14bdd27011413d1a1615492e6c0aa374", "sha256": "a66e045776a8fa49fa2b00ea098a84e976f37d90626d1278ed90afcaf3262fae"}, "downloads": -1, "filename": "fb8-0.2.1.tar.gz", "has_sig": false, "md5_digest": "14bdd27011413d1a1615492e6c0aa374", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18899, "upload_time": "2019-11-30T03:59:31", "upload_time_iso_8601": "2019-11-30T03:59:31.854598Z", "url": "https://files.pythonhosted.org/packages/1b/e0/80febd95db21d1810f79153023b263f61077932cd10533ad4621f4e9581b/fb8-0.2.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:43:17 2020"}