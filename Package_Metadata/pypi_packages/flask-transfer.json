{"info": {"author": "Alec Nikolas Reiter", "author_email": "alecreiter@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Environment :: Web Environment", "Framework :: Flask", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3.4"], "description": "\nFlask-Transfer\n==============\n\nValidate, process and persist file uploads easily through a single\nobject instead of cramming all that stuff into your routes.\n\nTired of this?\n--------------\n\n.. code:: python\n\n    @app.route('/upload', methods=['GET', 'POST'])\n    def handle_upload():\n        form = FileUploadForm()\n        \n        if form.validate_on_submit():\n            filehandle = form.uploaded.data\n            allowed_exts = ('md', 'txt', 'rst')\n            if not os.path.splitext(filehandle.filename)[1] in allowed_exts:\n                raise SomeError('Unallowed extension!')\n            if filehandle.read() != b'Hello World!':\n                raise SomeError('File contents not allowed!')\n            filehandle.seek(0)\n            \n            username = g.current_user.name\n            upload_dir = current_app.config['UPLOAD_DIR']\n            full_path = os.path.join(upload_dir, username, secure_filename(filehandle.filename))\n            filehandle.save(full_path)\n            flash(\"Uploaded {}!\".format(filehandle.filename), 'success')\n            return redirect(url_for('handle_upload'))\n        else:\n            return render_template('upload.html', form=form)\n\nThat's a mess. Your test runner is literally running away from you.\nThere's like four or five different things going on in this single\nroute! Argh.\n\nThere's a better way\n--------------------\n\n.. code:: python\n\n    from flask_transfer import Transfer, UploadError\n    from flask_transfer.validators import AllowedExts\n    \n    TextFileTransfer = Transfer(validators=[AllowedExts('md', 'rst', 'txt')])\n    \n    @TextFileTransfer.destination\n    def save_to_user_dir(filehandle, metadata):\n        username = g.current_user.name\n        upload_path = current_app.config['UPLOAD_DIR']\n        full_path = os.path.join(upload_dir, username, secure_filename(filehandle.filename))\n        filehandle.save(full_path)\n    \n    \n    @TextFileTransfer.validator\n    def check_file_contents(filehandle, metadata):\n        if filehandle.read() != metadata['allowed_contents']:\n            raise UploadError('File contents not allowed!')\n        filehandle.seek(0)\n        return True\n    \n    \n    @app.route('/upload', methods=['GET', 'POST'])\n    def handle_upload():\n        form = FileUploadForm()\n        \n        if form.validate_on_submit():\n            filehandle = form.uploaded.data\n            TextFileTransfer.save(filehandle, metadata={'allowed_contents': b'Hello World!'})\n            flash('Uploaded {}!'.format(filehandle.filename), 'success')\n            return redirect(url_for('handle_upload'))\n        else:\n            return render_template('upload.html', form=form)\n\nAaaah. Sure, it's a little bit more code. But it's separated out into\nbits and pieces. It's easy to test each bit and the intent in the route\nis very clear.\n\nMore Power\n----------\n\nFlask-Transfer supplies hooks for validation, preprocessing and\npostprocessing file uploads via decorators. If you need to always create\nthumbnails of uploaded images, you can supply a callable to\n``MyTransfer.preprocessor`` or ``MyTransfer.postprocessor`` that'll do\nthat for you.\n\nAnd validation beyond just simple extension checking is at your\nfingertips as well. Perhaps, you've limited your user to a certain\namount of disk space and they should be told to delete data before\nuploading more. Write a simple function to check current disk usage and\nif the upload would exceed the cap. Then hook it to your Transfer object\nwith ``MyTransfer.validator``.\n\nFinally, persisting files is easy! Maybe you're running on Heroku and\ncan't rely on the local filesystem. Just write a callable that'll pass\nthe file to your S3 bucket! Hook it in with ``MyTransfer.destination``.\nFlask-Transfer handles using string paths and writable objects as\ndestinations as well.\n\nCheck out the `quickstart <quickstart.rst>`__ for some more information,\nas well!\n\nTodo\n----\n\nThere's still quite a bit to do. For example, better error handle.\nPerhaps a tighter integration with Flask, or running the opposite way\nand cleaving the already few dependencies on werkzeug to become\nframework independent.\n\nContributions\n-------------\n\nGiven the infancy of this project, pull requests and issue are more than\nwelcome. Just add yourself to the authors file, write some tests for the\nadded or change functionality and submit it!\n", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/justanr/Flask-Transfer", "keywords": "flask,uploads", "license": "MIT", "maintainer": null, "maintainer_email": null, "name": "flask-transfer", "package_url": "https://pypi.org/project/flask-transfer/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/flask-transfer/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/justanr/Flask-Transfer"}, "release_url": "https://pypi.org/project/flask-transfer/0.1.0/", "requires_dist": null, "requires_python": null, "summary": "Validate and process file uploads in Flask easily", "version": "0.1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p>Validate, process and persist file uploads easily through a single\nobject instead of cramming all that stuff into your routes.</p>\n<div id=\"tired-of-this\">\n<h2>Tired of this?</h2>\n<pre><span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">route</span><span class=\"p\">(</span><span class=\"s1\">'/upload'</span><span class=\"p\">,</span> <span class=\"n\">methods</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'GET'</span><span class=\"p\">,</span> <span class=\"s1\">'POST'</span><span class=\"p\">])</span>\n<span class=\"k\">def</span> <span class=\"nf\">handle_upload</span><span class=\"p\">():</span>\n    <span class=\"n\">form</span> <span class=\"o\">=</span> <span class=\"n\">FileUploadForm</span><span class=\"p\">()</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">form</span><span class=\"o\">.</span><span class=\"n\">validate_on_submit</span><span class=\"p\">():</span>\n        <span class=\"n\">filehandle</span> <span class=\"o\">=</span> <span class=\"n\">form</span><span class=\"o\">.</span><span class=\"n\">uploaded</span><span class=\"o\">.</span><span class=\"n\">data</span>\n        <span class=\"n\">allowed_exts</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">'md'</span><span class=\"p\">,</span> <span class=\"s1\">'txt'</span><span class=\"p\">,</span> <span class=\"s1\">'rst'</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">splitext</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">)[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"ow\">in</span> <span class=\"n\">allowed_exts</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">SomeError</span><span class=\"p\">(</span><span class=\"s1\">'Unallowed extension!'</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span> <span class=\"o\">!=</span> <span class=\"sa\">b</span><span class=\"s1\">'Hello World!'</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">SomeError</span><span class=\"p\">(</span><span class=\"s1\">'File contents not allowed!'</span><span class=\"p\">)</span>\n        <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">seek</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n\n        <span class=\"n\">username</span> <span class=\"o\">=</span> <span class=\"n\">g</span><span class=\"o\">.</span><span class=\"n\">current_user</span><span class=\"o\">.</span><span class=\"n\">name</span>\n        <span class=\"n\">upload_dir</span> <span class=\"o\">=</span> <span class=\"n\">current_app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s1\">'UPLOAD_DIR'</span><span class=\"p\">]</span>\n        <span class=\"n\">full_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">upload_dir</span><span class=\"p\">,</span> <span class=\"n\">username</span><span class=\"p\">,</span> <span class=\"n\">secure_filename</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">))</span>\n        <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">(</span><span class=\"n\">full_path</span><span class=\"p\">)</span>\n        <span class=\"n\">flash</span><span class=\"p\">(</span><span class=\"s2\">\"Uploaded </span><span class=\"si\">{}</span><span class=\"s2\">!\"</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">),</span> <span class=\"s1\">'success'</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">redirect</span><span class=\"p\">(</span><span class=\"n\">url_for</span><span class=\"p\">(</span><span class=\"s1\">'handle_upload'</span><span class=\"p\">))</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">render_template</span><span class=\"p\">(</span><span class=\"s1\">'upload.html'</span><span class=\"p\">,</span> <span class=\"n\">form</span><span class=\"o\">=</span><span class=\"n\">form</span><span class=\"p\">)</span>\n</pre>\n<p>That\u2019s a mess. Your test runner is literally running away from you.\nThere\u2019s like four or five different things going on in this single\nroute! Argh.</p>\n</div>\n<div id=\"there-s-a-better-way\">\n<h2>There\u2019s a better way</h2>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">flask_transfer</span> <span class=\"kn\">import</span> <span class=\"n\">Transfer</span><span class=\"p\">,</span> <span class=\"n\">UploadError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">flask_transfer.validators</span> <span class=\"kn\">import</span> <span class=\"n\">AllowedExts</span>\n\n<span class=\"n\">TextFileTransfer</span> <span class=\"o\">=</span> <span class=\"n\">Transfer</span><span class=\"p\">(</span><span class=\"n\">validators</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">AllowedExts</span><span class=\"p\">(</span><span class=\"s1\">'md'</span><span class=\"p\">,</span> <span class=\"s1\">'rst'</span><span class=\"p\">,</span> <span class=\"s1\">'txt'</span><span class=\"p\">)])</span>\n\n<span class=\"nd\">@TextFileTransfer</span><span class=\"o\">.</span><span class=\"n\">destination</span>\n<span class=\"k\">def</span> <span class=\"nf\">save_to_user_dir</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"p\">,</span> <span class=\"n\">metadata</span><span class=\"p\">):</span>\n    <span class=\"n\">username</span> <span class=\"o\">=</span> <span class=\"n\">g</span><span class=\"o\">.</span><span class=\"n\">current_user</span><span class=\"o\">.</span><span class=\"n\">name</span>\n    <span class=\"n\">upload_path</span> <span class=\"o\">=</span> <span class=\"n\">current_app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s1\">'UPLOAD_DIR'</span><span class=\"p\">]</span>\n    <span class=\"n\">full_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">upload_dir</span><span class=\"p\">,</span> <span class=\"n\">username</span><span class=\"p\">,</span> <span class=\"n\">secure_filename</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">))</span>\n    <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">(</span><span class=\"n\">full_path</span><span class=\"p\">)</span>\n\n\n<span class=\"nd\">@TextFileTransfer</span><span class=\"o\">.</span><span class=\"n\">validator</span>\n<span class=\"k\">def</span> <span class=\"nf\">check_file_contents</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"p\">,</span> <span class=\"n\">metadata</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span> <span class=\"o\">!=</span> <span class=\"n\">metadata</span><span class=\"p\">[</span><span class=\"s1\">'allowed_contents'</span><span class=\"p\">]:</span>\n        <span class=\"k\">raise</span> <span class=\"n\">UploadError</span><span class=\"p\">(</span><span class=\"s1\">'File contents not allowed!'</span><span class=\"p\">)</span>\n    <span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">seek</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"kc\">True</span>\n\n\n<span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">route</span><span class=\"p\">(</span><span class=\"s1\">'/upload'</span><span class=\"p\">,</span> <span class=\"n\">methods</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'GET'</span><span class=\"p\">,</span> <span class=\"s1\">'POST'</span><span class=\"p\">])</span>\n<span class=\"k\">def</span> <span class=\"nf\">handle_upload</span><span class=\"p\">():</span>\n    <span class=\"n\">form</span> <span class=\"o\">=</span> <span class=\"n\">FileUploadForm</span><span class=\"p\">()</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">form</span><span class=\"o\">.</span><span class=\"n\">validate_on_submit</span><span class=\"p\">():</span>\n        <span class=\"n\">filehandle</span> <span class=\"o\">=</span> <span class=\"n\">form</span><span class=\"o\">.</span><span class=\"n\">uploaded</span><span class=\"o\">.</span><span class=\"n\">data</span>\n        <span class=\"n\">TextFileTransfer</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"p\">,</span> <span class=\"n\">metadata</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">'allowed_contents'</span><span class=\"p\">:</span> <span class=\"sa\">b</span><span class=\"s1\">'Hello World!'</span><span class=\"p\">})</span>\n        <span class=\"n\">flash</span><span class=\"p\">(</span><span class=\"s1\">'Uploaded </span><span class=\"si\">{}</span><span class=\"s1\">!'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">filehandle</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">),</span> <span class=\"s1\">'success'</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">redirect</span><span class=\"p\">(</span><span class=\"n\">url_for</span><span class=\"p\">(</span><span class=\"s1\">'handle_upload'</span><span class=\"p\">))</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">render_template</span><span class=\"p\">(</span><span class=\"s1\">'upload.html'</span><span class=\"p\">,</span> <span class=\"n\">form</span><span class=\"o\">=</span><span class=\"n\">form</span><span class=\"p\">)</span>\n</pre>\n<p>Aaaah. Sure, it\u2019s a little bit more code. But it\u2019s separated out into\nbits and pieces. It\u2019s easy to test each bit and the intent in the route\nis very clear.</p>\n</div>\n<div id=\"more-power\">\n<h2>More Power</h2>\n<p>Flask-Transfer supplies hooks for validation, preprocessing and\npostprocessing file uploads via decorators. If you need to always create\nthumbnails of uploaded images, you can supply a callable to\n<tt>MyTransfer.preprocessor</tt> or <tt>MyTransfer.postprocessor</tt> that\u2019ll do\nthat for you.</p>\n<p>And validation beyond just simple extension checking is at your\nfingertips as well. Perhaps, you\u2019ve limited your user to a certain\namount of disk space and they should be told to delete data before\nuploading more. Write a simple function to check current disk usage and\nif the upload would exceed the cap. Then hook it to your Transfer object\nwith <tt>MyTransfer.validator</tt>.</p>\n<p>Finally, persisting files is easy! Maybe you\u2019re running on Heroku and\ncan\u2019t rely on the local filesystem. Just write a callable that\u2019ll pass\nthe file to your S3 bucket! Hook it in with <tt>MyTransfer.destination</tt>.\nFlask-Transfer handles using string paths and writable objects as\ndestinations as well.</p>\n<p>Check out the <a href=\"quickstart.rst\" rel=\"nofollow\">quickstart</a> for some more information,\nas well!</p>\n</div>\n<div id=\"todo\">\n<h2>Todo</h2>\n<p>There\u2019s still quite a bit to do. For example, better error handle.\nPerhaps a tighter integration with Flask, or running the opposite way\nand cleaving the already few dependencies on werkzeug to become\nframework independent.</p>\n</div>\n<div id=\"contributions\">\n<h2>Contributions</h2>\n<p>Given the infancy of this project, pull requests and issue are more than\nwelcome. Just add yourself to the authors file, write some tests for the\nadded or change functionality and submit it!</p>\n</div>\n\n          </div>"}, "last_serial": 1816297, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "1e8586bad2bd8a38b18985a53ff6700b", "sha256": "f7838af5d191555acb3f08c5b745f85dbec57066dac76e1148e78503c297e074"}, "downloads": -1, "filename": "flask-transfer-0.0.1.tar.gz", "has_sig": false, "md5_digest": "1e8586bad2bd8a38b18985a53ff6700b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6468, "upload_time": "2015-06-16T17:31:18", "upload_time_iso_8601": "2015-06-16T17:31:18.694851Z", "url": "https://files.pythonhosted.org/packages/c9/90/87e11f9019fdf1237f31794f20212e05aec8467e0e77fc5ba5a698e77312/flask-transfer-0.0.1.tar.gz", "yanked": false}], "0.1.0": [{"comment_text": "", "digests": {"md5": "302a95196089815bc6a1e900dbdec890", "sha256": "a5adab0fe558d54285142611e36af0c2e264637be5fc08a7d942672e5a8b1cf5"}, "downloads": -1, "filename": "flask-transfer-0.1.0.tar.gz", "has_sig": false, "md5_digest": "302a95196089815bc6a1e900dbdec890", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 8308, "upload_time": "2015-11-14T15:15:00", "upload_time_iso_8601": "2015-11-14T15:15:00.527454Z", "url": "https://files.pythonhosted.org/packages/f0/7d/55327a4332f93ee4dc4e7b99cf0d7210a0368227d56db31d278999ed418a/flask-transfer-0.1.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "302a95196089815bc6a1e900dbdec890", "sha256": "a5adab0fe558d54285142611e36af0c2e264637be5fc08a7d942672e5a8b1cf5"}, "downloads": -1, "filename": "flask-transfer-0.1.0.tar.gz", "has_sig": false, "md5_digest": "302a95196089815bc6a1e900dbdec890", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 8308, "upload_time": "2015-11-14T15:15:00", "upload_time_iso_8601": "2015-11-14T15:15:00.527454Z", "url": "https://files.pythonhosted.org/packages/f0/7d/55327a4332f93ee4dc4e7b99cf0d7210a0368227d56db31d278999ed418a/flask-transfer-0.1.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 01:02:11 2020"}