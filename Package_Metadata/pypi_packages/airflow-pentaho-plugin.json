{"info": {"author": "Damavis", "author_email": "info@damavis.com", "bugtrack_url": null, "classifiers": ["Environment :: Plugins", "License :: OSI Approved :: Apache Software License", "Operating System :: Unix", "Programming Language :: Python :: 3"], "description": "# Pentaho Airflow plugin\n\n[![Build Status](https://travis-ci.org/damavis/airflow-pentaho-plugin.svg?branch=master)](https://travis-ci.org/damavis/airflow-pentaho-plugin)\n[![codecov](https://codecov.io/gh/damavis/airflow-pentaho-plugin/branch/master/graph/badge.svg)](https://codecov.io/gh/damavis/airflow-pentaho-plugin)\n[![PyPI](https://img.shields.io/pypi/v/airflow-pentaho-plugin)](https://pypi.org/project/airflow-pentaho-plugin/)\n[![PyPI - Downloads](https://img.shields.io/pypi/dm/airflow-pentaho-plugin)](https://pypi.org/project/airflow-pentaho-plugin/)\n\nThis plugins runs Jobs and Transformations through Carte servers.\nIt allows to orchestrate a massive number of trans/jobs taking care \nof the dependencies between them, even between different instances.\nThis is done by using `CarteJobOperator` and `CarteTransOperator`\n\nIt also runs Pan (transformations) and Kitchen (Jobs) in local mode,\nboth from repository and local XML files. For this approach, use\n`KitchenOperator` and `PanOperator`\n\n## Requirements\n\n1. A Apache Airflow system deployed.\n2. One or many working PDI CE installations.\n3. A Carte server for Carte Operators.\n\n## Setup\n\nThe same setup process must be performed on webserver, scheduler\nand workers (that runs this tasks) to get it working. If you want to\ndeploy specific workers to run this kind of tasks, see \n[Queues](https://airflow.apache.org/docs/stable/concepts.html#queues),\nin **Airflow** *Concepts* section.\n\n### Pip package\n\nFirst of all, the package should be installed via `pip install` command.\n\n```bash\npip install airflow-pentaho-plugin\n```\n\n### Airflow connection\n\nThen, a new connection needs to be added to Airflow Connections, to do this,\ngo to Airflow web UI, and click on `Admin -> Connections` on the top menu.\nNow, click on `Create` tab.\n\nEnter the **Conn Id**, this plugin uses `pdi_default` by default, the username\nand the password for your Pentaho Repository.\n\nAt the bottom of the form, fill the **Extra** field with `pentaho_home`, the\npath where your pdi-ce is placed, and `rep`, the repository name for this\nconnection, using a json formatted string like it follows.\n\n```json\n{\n    \"pentaho_home\": \"/opt/pentaho\",\n    \"rep\": \"Default\"\n}\n```\n\n### Carte\n\nIn order to use `CarteJobOperator`, the connection should be set different. Fill\n`host` and `port` for Carte hostname and port, `username` and `password` for PDI\nrepository, and `extra` as it follows.\n\n```json\n{\n    \"rep\": \"Default\",\n    \"carte_username\": \"cluster\",\n    \"carte_password\": \"cluster\"\n}\n```\n\n## Usage\n\n### CarteJobOperator\n\nCarteJobOperator is responsible for running jobs in remote slave servers. Here\nit is an example of `CarteJobOperator` usage.\n\n```python\nfrom airflow.operators.pentaho import CarteJobOperator\n\n# ... #\n\n# Define the task using the CarteJobOperator\navg_spent = CarteJobOperator(\n    conn_id='pdi_default',\n    task_id=\"average_spent\",\n    job=\"/home/bi/average_spent\",\n    params={\"date\": \"{{ ds }}\"},  # Date in yyyy-mm-dd format\n    dag=dag)\n\n# ... #\n\nsome_task >> avg_spent >> another_task\n```\n\n### KitchenOperator\n\nKitchen operator is responsible for running Jobs. Lets suppose that we have\na defined *Job* saved on `/home/bi/average_spent` in our repository with\nthe argument `date` as input parameter. Lets define the task using the\n`KitchenOperator`.\n\n```python\nfrom airflow.operators.pentaho import KitchenOperator\n\n# ... #\n\n# Define the task using the KitchenOperator\navg_spent = KitchenOperator(\n    conn_id='pdi_default',\n    queue=\"pdi\",\n    task_id=\"average_spent\",\n    directory=\"/home/bi\",\n    job=\"average_spent\",\n    params={\"date\": \"{{ ds }}\"},  # Date in yyyy-mm-dd format\n    dag=dag)\n\n# ... #\n\nsome_task >> avg_spent >> another_task\n```\n\n### CarteTransOperator\n\nCarteTransOperator is responsible for running transformations in remote slave\nservers. Here it is an example of `CarteTransOperator` usage.\n\n```python\nfrom airflow.operators.pentaho import CarteTransOperator\n\n# ... #\n\n# Define the task using the CarteJobOperator\nenriche_customers = CarteTransOperator(\n    conn_id='pdi_default',\n    task_id=\"enrich_customer_data\",\n    job=\"/home/bi/enrich_customer_data\",\n    params={\"date\": \"{{ ds }}\"},  # Date in yyyy-mm-dd format\n    dag=dag)\n\n# ... #\n\nsome_task >> enrich_customers >> another_task\n```\n\n### PanOperator\n\nPan operator is responsible for running transformations. Lets suppose that\nwe have one saved on `/home/bi/clean_somedata`. Lets define the task using the\n`PanOperator`. In this case, the transformation receives a parameter that\ndetermines the file to be cleaned.\n\n```python\nfrom airflow.operators.pentaho import PanOperator\n\n# ... #\n\n# Define the task using the KitchenOperator\nclean_input = PanOperator(\n    conn_id='pdi_default',\n    queue=\"pdi\",\n    task_id=\"cleanup\",\n    directory=\"/home/bi\",\n    trans=\"clean_somedata\",\n    params={\"file\": \"/tmp/input_data/{{ ds }}/sells.csv\"},\n    dag=dag)\n\n# ... #\n\nsome_task >> clean_input >> another_task\n```\n\nFor more information, please see `sample_dags/pdi_flow.py`", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/damavis/airflow-pentaho-plugin", "keywords": "", "license": "Apache 2.0", "maintainer": "", "maintainer_email": "", "name": "airflow-pentaho-plugin", "package_url": "https://pypi.org/project/airflow-pentaho-plugin/", "platform": "", "project_url": "https://pypi.org/project/airflow-pentaho-plugin/", "project_urls": {"Homepage": "https://github.com/damavis/airflow-pentaho-plugin"}, "release_url": "https://pypi.org/project/airflow-pentaho-plugin/0.1.0b3.post1/", "requires_dist": null, "requires_python": ">=3.6", "summary": "", "version": "0.1.0b3.post1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Pentaho Airflow plugin</h1>\n<p><a href=\"https://travis-ci.org/damavis/airflow-pentaho-plugin\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/23567faeaab6fb066cd2c58fa9a8777e8e994a7e/68747470733a2f2f7472617669732d63692e6f72672f64616d617669732f616972666c6f772d70656e7461686f2d706c7567696e2e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://codecov.io/gh/damavis/airflow-pentaho-plugin\" rel=\"nofollow\"><img alt=\"codecov\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c146530f885151a6a47185c7084249fbc20d7c5b/68747470733a2f2f636f6465636f762e696f2f67682f64616d617669732f616972666c6f772d70656e7461686f2d706c7567696e2f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a>\n<a href=\"https://pypi.org/project/airflow-pentaho-plugin/\" rel=\"nofollow\"><img alt=\"PyPI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ccd220dbd5f9222630b74bb34ddbd8e22a4a315a/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f616972666c6f772d70656e7461686f2d706c7567696e\"></a>\n<a href=\"https://pypi.org/project/airflow-pentaho-plugin/\" rel=\"nofollow\"><img alt=\"PyPI - Downloads\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/302d2f5ff806f2c515c18ad3016eabc761419b43/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f616972666c6f772d70656e7461686f2d706c7567696e\"></a></p>\n<p>This plugins runs Jobs and Transformations through Carte servers.\nIt allows to orchestrate a massive number of trans/jobs taking care\nof the dependencies between them, even between different instances.\nThis is done by using <code>CarteJobOperator</code> and <code>CarteTransOperator</code></p>\n<p>It also runs Pan (transformations) and Kitchen (Jobs) in local mode,\nboth from repository and local XML files. For this approach, use\n<code>KitchenOperator</code> and <code>PanOperator</code></p>\n<h2>Requirements</h2>\n<ol>\n<li>A Apache Airflow system deployed.</li>\n<li>One or many working PDI CE installations.</li>\n<li>A Carte server for Carte Operators.</li>\n</ol>\n<h2>Setup</h2>\n<p>The same setup process must be performed on webserver, scheduler\nand workers (that runs this tasks) to get it working. If you want to\ndeploy specific workers to run this kind of tasks, see\n<a href=\"https://airflow.apache.org/docs/stable/concepts.html#queues\" rel=\"nofollow\">Queues</a>,\nin <strong>Airflow</strong> <em>Concepts</em> section.</p>\n<h3>Pip package</h3>\n<p>First of all, the package should be installed via <code>pip install</code> command.</p>\n<pre>pip install airflow-pentaho-plugin\n</pre>\n<h3>Airflow connection</h3>\n<p>Then, a new connection needs to be added to Airflow Connections, to do this,\ngo to Airflow web UI, and click on <code>Admin -&gt; Connections</code> on the top menu.\nNow, click on <code>Create</code> tab.</p>\n<p>Enter the <strong>Conn Id</strong>, this plugin uses <code>pdi_default</code> by default, the username\nand the password for your Pentaho Repository.</p>\n<p>At the bottom of the form, fill the <strong>Extra</strong> field with <code>pentaho_home</code>, the\npath where your pdi-ce is placed, and <code>rep</code>, the repository name for this\nconnection, using a json formatted string like it follows.</p>\n<pre><span class=\"p\">{</span>\n    <span class=\"nt\">\"pentaho_home\"</span><span class=\"p\">:</span> <span class=\"s2\">\"/opt/pentaho\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"rep\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Default\"</span>\n<span class=\"p\">}</span>\n</pre>\n<h3>Carte</h3>\n<p>In order to use <code>CarteJobOperator</code>, the connection should be set different. Fill\n<code>host</code> and <code>port</code> for Carte hostname and port, <code>username</code> and <code>password</code> for PDI\nrepository, and <code>extra</code> as it follows.</p>\n<pre><span class=\"p\">{</span>\n    <span class=\"nt\">\"rep\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Default\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"carte_username\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cluster\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"carte_password\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cluster\"</span>\n<span class=\"p\">}</span>\n</pre>\n<h2>Usage</h2>\n<h3>CarteJobOperator</h3>\n<p>CarteJobOperator is responsible for running jobs in remote slave servers. Here\nit is an example of <code>CarteJobOperator</code> usage.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">airflow.operators.pentaho</span> <span class=\"kn\">import</span> <span class=\"n\">CarteJobOperator</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"c1\"># Define the task using the CarteJobOperator</span>\n<span class=\"n\">avg_spent</span> <span class=\"o\">=</span> <span class=\"n\">CarteJobOperator</span><span class=\"p\">(</span>\n    <span class=\"n\">conn_id</span><span class=\"o\">=</span><span class=\"s1\">'pdi_default'</span><span class=\"p\">,</span>\n    <span class=\"n\">task_id</span><span class=\"o\">=</span><span class=\"s2\">\"average_spent\"</span><span class=\"p\">,</span>\n    <span class=\"n\">job</span><span class=\"o\">=</span><span class=\"s2\">\"/home/bi/average_spent\"</span><span class=\"p\">,</span>\n    <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"{{ ds }}\"</span><span class=\"p\">},</span>  <span class=\"c1\"># Date in yyyy-mm-dd format</span>\n    <span class=\"n\">dag</span><span class=\"o\">=</span><span class=\"n\">dag</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"n\">some_task</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">avg_spent</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">another_task</span>\n</pre>\n<h3>KitchenOperator</h3>\n<p>Kitchen operator is responsible for running Jobs. Lets suppose that we have\na defined <em>Job</em> saved on <code>/home/bi/average_spent</code> in our repository with\nthe argument <code>date</code> as input parameter. Lets define the task using the\n<code>KitchenOperator</code>.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">airflow.operators.pentaho</span> <span class=\"kn\">import</span> <span class=\"n\">KitchenOperator</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"c1\"># Define the task using the KitchenOperator</span>\n<span class=\"n\">avg_spent</span> <span class=\"o\">=</span> <span class=\"n\">KitchenOperator</span><span class=\"p\">(</span>\n    <span class=\"n\">conn_id</span><span class=\"o\">=</span><span class=\"s1\">'pdi_default'</span><span class=\"p\">,</span>\n    <span class=\"n\">queue</span><span class=\"o\">=</span><span class=\"s2\">\"pdi\"</span><span class=\"p\">,</span>\n    <span class=\"n\">task_id</span><span class=\"o\">=</span><span class=\"s2\">\"average_spent\"</span><span class=\"p\">,</span>\n    <span class=\"n\">directory</span><span class=\"o\">=</span><span class=\"s2\">\"/home/bi\"</span><span class=\"p\">,</span>\n    <span class=\"n\">job</span><span class=\"o\">=</span><span class=\"s2\">\"average_spent\"</span><span class=\"p\">,</span>\n    <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"{{ ds }}\"</span><span class=\"p\">},</span>  <span class=\"c1\"># Date in yyyy-mm-dd format</span>\n    <span class=\"n\">dag</span><span class=\"o\">=</span><span class=\"n\">dag</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"n\">some_task</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">avg_spent</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">another_task</span>\n</pre>\n<h3>CarteTransOperator</h3>\n<p>CarteTransOperator is responsible for running transformations in remote slave\nservers. Here it is an example of <code>CarteTransOperator</code> usage.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">airflow.operators.pentaho</span> <span class=\"kn\">import</span> <span class=\"n\">CarteTransOperator</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"c1\"># Define the task using the CarteJobOperator</span>\n<span class=\"n\">enriche_customers</span> <span class=\"o\">=</span> <span class=\"n\">CarteTransOperator</span><span class=\"p\">(</span>\n    <span class=\"n\">conn_id</span><span class=\"o\">=</span><span class=\"s1\">'pdi_default'</span><span class=\"p\">,</span>\n    <span class=\"n\">task_id</span><span class=\"o\">=</span><span class=\"s2\">\"enrich_customer_data\"</span><span class=\"p\">,</span>\n    <span class=\"n\">job</span><span class=\"o\">=</span><span class=\"s2\">\"/home/bi/enrich_customer_data\"</span><span class=\"p\">,</span>\n    <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"{{ ds }}\"</span><span class=\"p\">},</span>  <span class=\"c1\"># Date in yyyy-mm-dd format</span>\n    <span class=\"n\">dag</span><span class=\"o\">=</span><span class=\"n\">dag</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"n\">some_task</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">enrich_customers</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">another_task</span>\n</pre>\n<h3>PanOperator</h3>\n<p>Pan operator is responsible for running transformations. Lets suppose that\nwe have one saved on <code>/home/bi/clean_somedata</code>. Lets define the task using the\n<code>PanOperator</code>. In this case, the transformation receives a parameter that\ndetermines the file to be cleaned.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">airflow.operators.pentaho</span> <span class=\"kn\">import</span> <span class=\"n\">PanOperator</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"c1\"># Define the task using the KitchenOperator</span>\n<span class=\"n\">clean_input</span> <span class=\"o\">=</span> <span class=\"n\">PanOperator</span><span class=\"p\">(</span>\n    <span class=\"n\">conn_id</span><span class=\"o\">=</span><span class=\"s1\">'pdi_default'</span><span class=\"p\">,</span>\n    <span class=\"n\">queue</span><span class=\"o\">=</span><span class=\"s2\">\"pdi\"</span><span class=\"p\">,</span>\n    <span class=\"n\">task_id</span><span class=\"o\">=</span><span class=\"s2\">\"cleanup\"</span><span class=\"p\">,</span>\n    <span class=\"n\">directory</span><span class=\"o\">=</span><span class=\"s2\">\"/home/bi\"</span><span class=\"p\">,</span>\n    <span class=\"n\">trans</span><span class=\"o\">=</span><span class=\"s2\">\"clean_somedata\"</span><span class=\"p\">,</span>\n    <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"file\"</span><span class=\"p\">:</span> <span class=\"s2\">\"/tmp/input_data/{{ ds }}/sells.csv\"</span><span class=\"p\">},</span>\n    <span class=\"n\">dag</span><span class=\"o\">=</span><span class=\"n\">dag</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ... #</span>\n\n<span class=\"n\">some_task</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">clean_input</span> <span class=\"o\">&gt;&gt;</span> <span class=\"n\">another_task</span>\n</pre>\n<p>For more information, please see <code>sample_dags/pdi_flow.py</code></p>\n\n          </div>"}, "last_serial": 6927819, "releases": {"0.1.0b3": [{"comment_text": "", "digests": {"md5": "912d120b38a0d067fd6e19bcf792d56d", "sha256": "55f8b448bab59aac96e3076a8b1c84997b7efe5e0e5631255e4f383ba451dad2"}, "downloads": -1, "filename": "airflow-pentaho-plugin-0.1.0b3.tar.gz", "has_sig": false, "md5_digest": "912d120b38a0d067fd6e19bcf792d56d", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 8206, "upload_time": "2020-04-01T07:51:25", "upload_time_iso_8601": "2020-04-01T07:51:25.902371Z", "url": "https://files.pythonhosted.org/packages/7b/28/a0b62a733089f9b9929fe45af5a5a712d0eedf87258aaff2c2be229475f0/airflow-pentaho-plugin-0.1.0b3.tar.gz", "yanked": false}], "0.1.0b3.post1": [{"comment_text": "", "digests": {"md5": "6ed8886908049a84fe262dd597cb57f6", "sha256": "02f47f72883b2da33f6415b883c88187a8debedfabd9b3157c5cf2a9b42a2a65"}, "downloads": -1, "filename": "airflow-pentaho-plugin-0.1.0b3.post1.tar.gz", "has_sig": false, "md5_digest": "6ed8886908049a84fe262dd597cb57f6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 8989, "upload_time": "2020-04-01T14:00:55", "upload_time_iso_8601": "2020-04-01T14:00:55.078050Z", "url": "https://files.pythonhosted.org/packages/49/12/d6df05b2748c06321d93094d05a019134b16bc739e9a23e46acca7364f73/airflow-pentaho-plugin-0.1.0b3.post1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "6ed8886908049a84fe262dd597cb57f6", "sha256": "02f47f72883b2da33f6415b883c88187a8debedfabd9b3157c5cf2a9b42a2a65"}, "downloads": -1, "filename": "airflow-pentaho-plugin-0.1.0b3.post1.tar.gz", "has_sig": false, "md5_digest": "6ed8886908049a84fe262dd597cb57f6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 8989, "upload_time": "2020-04-01T14:00:55", "upload_time_iso_8601": "2020-04-01T14:00:55.078050Z", "url": "https://files.pythonhosted.org/packages/49/12/d6df05b2748c06321d93094d05a019134b16bc739e9a23e46acca7364f73/airflow-pentaho-plugin-0.1.0b3.post1.tar.gz", "yanked": false}], "timestamp": "Thu May  7 16:20:29 2020"}