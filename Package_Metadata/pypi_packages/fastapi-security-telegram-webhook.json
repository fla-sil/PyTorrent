{"info": {"author": "Dima Boger", "author_email": "kotvberloge@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "# fastapi-security-telegram-webhook\n\nPlugin for [FastAPI](https://github.com/tiangolo/fastapi) which allows you to secure your Telegram Bot API webhook\n endpoint with IP restriction and an optional secret token.\n\nTelegram provides two ways of getting updates: long polling and webhook. When you use webhook you just register\nendpoint address and telegram sends JSON to this address. If the bad guy finds out the address of your webhook, then\nhe can send fake \"telegram updates\" to your bot.\n\nTelegram doesn't provide any security features like signing or authentication mechanisms, so securing webhook is a task\nfor a bot developer.\n\nThence, for securing your webhook you have only two option:\n - Allow requests only from Telegram subnets. \n [Telegram assures](https://core.telegram.org/bots/webhooks#the-short-version) that they won't change.\n - Use secret value in endpoint address, e.g. `/telegram-webhook/468e95826f224a60a4e9355ab76e0875`. It will\n  complicate the brute force attack and you can easily change it if the value was compromised.\n\nThis little plugin allows you to use both ways to secure.\n\n## How to use\n\nUse pip or another package management util:\n```bash\npip install fastapi-security-telegram-webhook\n```\n\nor\n\n```bash\npoetry add fastapi-security-telegram-webhook\n```\n\nor\n\n```bash\npipenv install fastapi-security-telegram-webhook\n```\n\nPackage contains two Security objects: \n - `OnlyTelegramNetwork` allows request only from telegram subnets\n - `OnlyTelegramNetworkWithSecret` additionally checks secret in path\n \nExample with `OnlyTelegramNetworkWithSecret`. Pay attention to `{secret}` in path operation, it's required\n\n```python\nfrom fastapi import FastAPI, Body, Depends\nfrom fastapi_security_telegram_webhook import OnlyTelegramNetworkWithSecret\n\napp = FastAPI()\nwebhook_security = OnlyTelegramNetworkWithSecret(real_secret=\"your-secret-from-config-or-env\")\n\n# {secret} in path and OnlyTelegramNetworkWithSecret as dependency:\n@app.post('/webhook/{secret}', dependencies=[Depends(webhook_security)])\ndef process_telegram_update(update_raw = Body(...)):\n   ...\n\n```\n\n## Use behind proxy\n\nThe plugin uses `starlette.Request.client.host` for extracting IP address of the request, so if your web-app is\nbehind proxy you should pass the real IP to the app.\n\nFor `uvicorn` you can use `--proxy-headers` as it describes in \n[documentation](https://www.uvicorn.org/deployment/#running-behind-nginx).  ", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/piterpy-meetup/fastapi-security-telegram-webhook", "keywords": "fastapi,fastapi security,telegram,telegram webhook,bot webhook", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "fastapi-security-telegram-webhook", "package_url": "https://pypi.org/project/fastapi-security-telegram-webhook/", "platform": "", "project_url": "https://pypi.org/project/fastapi-security-telegram-webhook/", "project_urls": {"Homepage": "https://github.com/piterpy-meetup/fastapi-security-telegram-webhook", "Repository": "https://github.com/piterpy-meetup/fastapi-security-telegram-webhook"}, "release_url": "https://pypi.org/project/fastapi-security-telegram-webhook/0.2.0/", "requires_dist": ["fastapi"], "requires_python": ">=3.6", "summary": "", "version": "0.2.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>fastapi-security-telegram-webhook</h1>\n<p>Plugin for <a href=\"https://github.com/tiangolo/fastapi\" rel=\"nofollow\">FastAPI</a> which allows you to secure your Telegram Bot API webhook\nendpoint with IP restriction and an optional secret token.</p>\n<p>Telegram provides two ways of getting updates: long polling and webhook. When you use webhook you just register\nendpoint address and telegram sends JSON to this address. If the bad guy finds out the address of your webhook, then\nhe can send fake \"telegram updates\" to your bot.</p>\n<p>Telegram doesn't provide any security features like signing or authentication mechanisms, so securing webhook is a task\nfor a bot developer.</p>\n<p>Thence, for securing your webhook you have only two option:</p>\n<ul>\n<li>Allow requests only from Telegram subnets.\n<a href=\"https://core.telegram.org/bots/webhooks#the-short-version\" rel=\"nofollow\">Telegram assures</a> that they won't change.</li>\n<li>Use secret value in endpoint address, e.g. <code>/telegram-webhook/468e95826f224a60a4e9355ab76e0875</code>. It will\ncomplicate the brute force attack and you can easily change it if the value was compromised.</li>\n</ul>\n<p>This little plugin allows you to use both ways to secure.</p>\n<h2>How to use</h2>\n<p>Use pip or another package management util:</p>\n<pre>pip install fastapi-security-telegram-webhook\n</pre>\n<p>or</p>\n<pre>poetry add fastapi-security-telegram-webhook\n</pre>\n<p>or</p>\n<pre>pipenv install fastapi-security-telegram-webhook\n</pre>\n<p>Package contains two Security objects:</p>\n<ul>\n<li><code>OnlyTelegramNetwork</code> allows request only from telegram subnets</li>\n<li><code>OnlyTelegramNetworkWithSecret</code> additionally checks secret in path</li>\n</ul>\n<p>Example with <code>OnlyTelegramNetworkWithSecret</code>. Pay attention to <code>{secret}</code> in path operation, it's required</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">fastapi</span> <span class=\"kn\">import</span> <span class=\"n\">FastAPI</span><span class=\"p\">,</span> <span class=\"n\">Body</span><span class=\"p\">,</span> <span class=\"n\">Depends</span>\n<span class=\"kn\">from</span> <span class=\"nn\">fastapi_security_telegram_webhook</span> <span class=\"kn\">import</span> <span class=\"n\">OnlyTelegramNetworkWithSecret</span>\n\n<span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">FastAPI</span><span class=\"p\">()</span>\n<span class=\"n\">webhook_security</span> <span class=\"o\">=</span> <span class=\"n\">OnlyTelegramNetworkWithSecret</span><span class=\"p\">(</span><span class=\"n\">real_secret</span><span class=\"o\">=</span><span class=\"s2\">\"your-secret-from-config-or-env\"</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># {secret} in path and OnlyTelegramNetworkWithSecret as dependency:</span>\n<span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"p\">(</span><span class=\"s1\">'/webhook/</span><span class=\"si\">{secret}</span><span class=\"s1\">'</span><span class=\"p\">,</span> <span class=\"n\">dependencies</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">Depends</span><span class=\"p\">(</span><span class=\"n\">webhook_security</span><span class=\"p\">)])</span>\n<span class=\"k\">def</span> <span class=\"nf\">process_telegram_update</span><span class=\"p\">(</span><span class=\"n\">update_raw</span> <span class=\"o\">=</span> <span class=\"n\">Body</span><span class=\"p\">(</span><span class=\"o\">...</span><span class=\"p\">)):</span>\n   <span class=\"o\">...</span>\n</pre>\n<h2>Use behind proxy</h2>\n<p>The plugin uses <code>starlette.Request.client.host</code> for extracting IP address of the request, so if your web-app is\nbehind proxy you should pass the real IP to the app.</p>\n<p>For <code>uvicorn</code> you can use <code>--proxy-headers</code> as it describes in\n<a href=\"https://www.uvicorn.org/deployment/#running-behind-nginx\" rel=\"nofollow\">documentation</a>.</p>\n\n          </div>"}, "last_serial": 6798346, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "c0a12ccfdb427b1023014e165eaf7d8f", "sha256": "5c8398e06e7dc9e450fb59d934c926b31e6fa6763bdc8df2b74c641e04297368"}, "downloads": -1, "filename": "fastapi_security_telegram_webhook-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "c0a12ccfdb427b1023014e165eaf7d8f", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 4474, "upload_time": "2020-03-10T14:29:01", "upload_time_iso_8601": "2020-03-10T14:29:01.702337Z", "url": "https://files.pythonhosted.org/packages/0b/2d/6a9ec3b5f0c219538dd325d012510997c54baeb9c2d92f057588477fb5bb/fastapi_security_telegram_webhook-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "6e56de60999eb193749a3517878ccd19", "sha256": "aebb221fcf7a5b0fe0a120545752cd70fa7d4cbe8074f75cac60315650909902"}, "downloads": -1, "filename": "fastapi-security-telegram-webhook-0.1.0.tar.gz", "has_sig": false, "md5_digest": "6e56de60999eb193749a3517878ccd19", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 3611, "upload_time": "2020-03-10T14:28:59", "upload_time_iso_8601": "2020-03-10T14:28:59.256087Z", "url": "https://files.pythonhosted.org/packages/a0/f6/ef9dfb24cf89fcd89a85475901d408ecb7c129cb1f36149bfca4b3ba575f/fastapi-security-telegram-webhook-0.1.0.tar.gz", "yanked": false}], "0.2.0": [{"comment_text": "", "digests": {"md5": "585f4a21c11e72bb92a8aa909617563d", "sha256": "22d1575add1a6e239956ccc8fb8819964393d2e5ee8bef181e6f4e5ee63a8df1"}, "downloads": -1, "filename": "fastapi_security_telegram_webhook-0.2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "585f4a21c11e72bb92a8aa909617563d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 5073, "upload_time": "2020-03-12T09:28:09", "upload_time_iso_8601": "2020-03-12T09:28:09.702200Z", "url": "https://files.pythonhosted.org/packages/87/1f/6eca16f56b30563dcebcbbf8b151f42317b85e3ef462d2de4f6327c79a38/fastapi_security_telegram_webhook-0.2.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "9515e48051921fdab6844d3582f5e0c0", "sha256": "aa3c908cfa8ba9305fa483d2958aea52bd4605554fea9f429bbf95c2bf2e2d51"}, "downloads": -1, "filename": "fastapi-security-telegram-webhook-0.2.0.tar.gz", "has_sig": false, "md5_digest": "9515e48051921fdab6844d3582f5e0c0", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 4243, "upload_time": "2020-03-12T09:28:08", "upload_time_iso_8601": "2020-03-12T09:28:08.615510Z", "url": "https://files.pythonhosted.org/packages/48/ba/5de4d413b4882a4ec423ede8dedf4bfea925456c347db4190c5e071ab846/fastapi-security-telegram-webhook-0.2.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "585f4a21c11e72bb92a8aa909617563d", "sha256": "22d1575add1a6e239956ccc8fb8819964393d2e5ee8bef181e6f4e5ee63a8df1"}, "downloads": -1, "filename": "fastapi_security_telegram_webhook-0.2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "585f4a21c11e72bb92a8aa909617563d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 5073, "upload_time": "2020-03-12T09:28:09", "upload_time_iso_8601": "2020-03-12T09:28:09.702200Z", "url": "https://files.pythonhosted.org/packages/87/1f/6eca16f56b30563dcebcbbf8b151f42317b85e3ef462d2de4f6327c79a38/fastapi_security_telegram_webhook-0.2.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "9515e48051921fdab6844d3582f5e0c0", "sha256": "aa3c908cfa8ba9305fa483d2958aea52bd4605554fea9f429bbf95c2bf2e2d51"}, "downloads": -1, "filename": "fastapi-security-telegram-webhook-0.2.0.tar.gz", "has_sig": false, "md5_digest": "9515e48051921fdab6844d3582f5e0c0", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 4243, "upload_time": "2020-03-12T09:28:08", "upload_time_iso_8601": "2020-03-12T09:28:08.615510Z", "url": "https://files.pythonhosted.org/packages/48/ba/5de4d413b4882a4ec423ede8dedf4bfea925456c347db4190c5e071ab846/fastapi-security-telegram-webhook-0.2.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:43:39 2020"}