{"info": {"author": "Bernhard Posselt", "author_email": "dev@bernhard-posselt.com", "bugtrack_url": null, "classifiers": ["Environment :: Console", "Intended Audience :: System Administrators", "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)", "Operating System :: POSIX :: Linux", "Programming Language :: Python :: 3 :: Only", "Topic :: Utilities"], "description": "Nextcloud News Updater\n======================\n\n.. image:: https://img.shields.io/pypi/v/nextcloud_news_updater.svg\n    :target: https://pypi.python.org/pypi/nextcloud_news_updater\n.. image:: https://travis-ci.org/nextcloud/news-updater.svg?branch=master\n    :target: https://travis-ci.org/nextcloud/news-updater\n\nThis Python library is a parallel feed updater for the `Nextcloud News app <https://github.com/nextcloud/news>`_\n\n\nNextcloud does not require people to install threading or multiprocessing\nlibraries. Because the feed update process is mainly limited by I/O, parallel\nfetching of RSS feed updates can speed up the updating process significantly.\n\nIn addition, Web Cron is not a supported cron setting since the update\nprocess may time out.\n\nTherefore the News app provides an API that offers a more fine grained\ncontrol over updating feeds. This Python project implements an update\nmechanism that is based on the `updater REST API <https://github.com/nextcloud/news/tree/master/docs>`_ or (new in Nextcloud News 8.1.0) the\nconsole based update API.\n\n.. contents:: :local:\n\nDependencies\n------------\n\n* **Python >=3.5**\n\nPre-Installation\n----------------\n\nTo run the updates via an external threaded script the cron updater has to be\ndisabled. To do that go to the admin section an uncheck the **Use Nextcloud\ncron** checkbox or open **nextcloud/data/news/config/config.ini** and set::\n\n    useCronUpdates = true\n\nto::\n\n    useCronUpdates = false\n\nInstallation\n------------\nThere are two different ways to install the updater:\n\n* Installation using pip (recommended)\n* Manual installation\n* No installation\n\nInstallation Using Pip\n~~~~~~~~~~~~~~~~~~~~~~\nSince 8.2 the package is available on pypi for installation via pip (the\nPython library package manager).\n\nTo install pip on your distribution of choice, `consolidate the pip\ndocumentation <http://python-packaging-user-guide.readthedocs.org/en/latest/install_requirements_linux/>`_\n\n**Note**: You need to install the Python 3 version of pip\n\nAfter installing pip, run::\n\n    sudo pip3 install nextcloud_news_updater --install-option=\"--install-scripts=/usr/bin\"\n\nTo update the library, run::\n\n    sudo pip3 install --upgrade nextcloud_news_updater --install-option=\"--install-scripts=/usr/bin\"\n\nTo uninstall the library run::\n\n    sudo pip3 uninstall nextcloud_news_updater\n\nManual Installation\n~~~~~~~~~~~~~~~~~~~\nIf you don't want to install the updater via pip, you can install it manually.\nThis requires setuptools to be installed. On Ubuntu this can be done by running::\n\n    sudo apt-get install python3-setuptools\n\nThen install the package like this::\n\n    python3 setup.py install --install-scripts=/usr/bin\n\nTo uninstall the updater run::\n\n    python3 setup.py uninstall\n\nNo Installation\n~~~~~~~~~~~~~~~\nIf you do not want to install the script at all you can call it directly.\n\nSimply run the updater using::\n\n    python3 -m nextcloud_news_updater /path/to/nextcloud\n\nUsage\n-----\n\nThere are two ways to run the updater:\n\n* Using the console API (recommended)::\n\n    nextcloud-news-updater /path/to/nextcloud\n\n* Using the REST API (when running the updater on a different machine than Nextcloud)::\n\n    nextcloud-news-updater https://domain.com/path/to/nextcloud --user admin_user --password admin_password\n\n**Note**: **admin_user** is a user id with admin rights, **admin_password** the user's password\n\nYou can view all options by running::\n\n    nextcloud-news-updater --help\n\n::\n\n    usage: nextcloud-news-updater [-h] [--threads THREADS] [--timeout TIMEOUT]\n                       [--interval INTERVAL] [--apilevel {v1-2,v2}]\n                       [--loglevel {info,error}] [--config CONFIG]\n                       [--phpini PHPINI] [--user USER] [--password PASSWORD]\n                       [--version] [--mode {endless,singlerun}] [--php PHP]\n                       [url]\n\n    positional arguments:\n      url                   The URL or absolute path to the directory where\n                            Nextcloud is installed. Must be specified on the\n                            command line or in the config file. If the URL starts\n                            with http:// or https://, a user and password are\n                            required. Otherwise the updater tries to use the\n                            console based API which was added in 8.1.0\n\n    optional arguments:\n      -h, --help            show this help message and exit\n      --threads THREADS, -t THREADS\n                            How many feeds should be fetched in parallel, defaults\n                            to 10\n      --timeout TIMEOUT, -s TIMEOUT\n                            Maximum number of seconds for updating a feed,\n                            defaults to 5 minutes\n      --interval INTERVAL, -i INTERVAL\n                            Update interval between fetching the next round of\n                            updates in seconds, defaults to 15 minutes. The update\n                            timespan will be subtracted from the interval.\n      --apilevel {v1-2,v2}, -a {v1-2,v2}\n                            API level. Use v1-2, v2 is currently a draft only\n      --loglevel {info,error}, -l {info,error}\n                            Log granularity, info will log all urls and received\n                            data, error will only log errors\n      --config CONFIG, -c CONFIG\n                            Path to config file where all parameters except can be\n                            defined as key values pair. An example is in\n                            bin/example_config.ini\n      --phpini PHPINI, -P PHPINI\n                            Custom absolute path to the php.ini file to use for\n                            the command line updater. If omitted, the default one\n                            will be used\n      --user USER, -u USER  Admin username to log into Nextcloud. Must be\n                            specified on the command line or in the config file if\n                            the updater should update over HTTP\n      --password PASSWORD, -p PASSWORD\n                            Admin password to log into Nextcloud if the updater\n                            should update over HTTP\n      --version, -v         Prints the updater's version\n      --mode {endless,singlerun}, -m {endless,singlerun}\n                            Mode to run the updater in: endless runs the update\n                            again after the specified interval, singlerun only\n                            executes the update once\n      --php PHP             Path to the PHP binary, e.g. /usr/bin/php7.0, defaults\n                            to php\n\n\n\n\nYou can also put your settings in a config file, looking like this:\n\n.. code:: ini\n\n    [updater]\n    # only needed when using the REST API\n    user = admin\n    # only needed when using the REST API\n    password = admin\n    threads = 10\n    interval = 900\n    loglevel = error\n    # or https://domain.com/nextcloud when using the REST API\n    url = /path/to/nextcloud\n    phpini = /path/to/custom/php.ini\n    # or v2 which is currently a draft\n    apilevel = v1-2\n    mode = endless\n    # path to php binary\n    php = /usr/bin/php7.0\n\n**Note**: You can omit options in the config file if you want to use the defaults, but you can not have more than the allowed parameters present, otherwise an exception will abort the updater.\n\nThen run the updater with::\n\n    nextcloud-news-updater -c /path/to/config\n\n\n**Note**: Command line parameters will always overwrite config parameters, so if you just want to change your loglevel to info for one run you can now do the following without globally changing the config file::\n\n    nextcloud-news-updater -c /path/to/config --mode singlerun --loglevel info\n\nRunning The Updater As Systemd Service\n--------------------------------------\nAlmost always you want to run and stop the updater using your in init system.\nAs for Systemd, you can create a simple text file at\n**/etc/systemd/system/nextcloud-news-updater.service** with the following contents:\n\n.. code:: ini\n\n    [Unit]\n    After=default.target\n\n    [Service]\n    Type=simple\n    User=http\n    ExecStart=/usr/bin/nextcloud-news-updater -c /etc/nextcloud/news/updater.ini\n\n    [Install]\n    WantedBy=default.target\n\nThen to enable and start it run::\n\n    sudo systemctl enable nextcloud-news-updater.service\n    sudo systemctl start nextcloud-news-updater.service\n\n**Note**: If you are using the cli based updater (as in set an absolute directory as url)\nyou need to set the web-server user as user in the unit file. Otherwise the command\nwill fail because Nextcloud checks for the owner of its files. This user\nvaries from distribution to distribution, e.g in Debian and Ubuntu you would use the\n**www-data** user:\n\n.. code:: ini\n\n    [Unit]\n    After=default.target\n\n    [Service]\n    Type=simple\n    User=www-data\n    ExecStart=/usr/bin/nextcloud-news-updater -c /etc/nextcloud/news/updater.ini\n\n    [Install]\n    WantedBy=default.target\n\nIf you are using the REST API, most of the time you can get away by using **nobody** as\nuser, but again, that might vary depending on your distribution.\n\nTroubleshooting\n----------------\nIf you are having trouble debugging updater errors, try running it again using the **info** loglevel::\n\n    nextcloud-news-updater --loglevel info -c /path/to/config.ini\n\nHow Do I Enable Support For Self-Signed Certificates\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIf you are using self-signed certificates, don't. It's very easy to sign your cert for free from either one of the following three websites:\n\n* `Lets Encrypt <https://letsencrypt.org/>`_\n* `StartSSL <https://www.startssl.com/>`_\n* `WoSign <https://www.wosign.com/english/>`_\n\nIf you still have to use a self-signed certificate no matter what, don't patch the code to turn off certificate verification but rather globally add your certificate to the trusted certificates. Read up on your distributions documentation to find out how.\n\nCan I Run The Updater Using Cron\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nYes, you can by using the **--mode singlerun** parameter which will exit after one full update.\n\nHowever it's your job to ensure, that the job will not be executed more than once at the same time. If update jobs overlap, they **can take down your system and/or server** since each new updater will slow down the previous ones causing more updaters to be spawned.\n\nIf you can not ensure that the updater is run only one at a time use the default mode (**--mode endless**). This mode runs the update in a loop. You can control the update frequency through the **--interval** parameter (or **interval** using a config file). The updater works in the following way:\n* If a full update takes longer than the passed interval, another update will be run immediately afterwards\n* If a full update took less than the passed interval, the updater will sleep for the remaining time and run an update afterwards\n\n\nUsing The CLI Based Updater Fails\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nThe updater uses the PHP executable to run the occ file inside your nextcloud directory. The general process boils down to the following:\n\n.. code-block:: bash\n\n    # delete folders and feeds marked for deletion\n    php -f /home/bernhard/programming/core/occ news:updater:before-update\n\n    # get all feeds to udpate\n    php -f /home/bernhard/programming/core/occ news:updater:all-feeds\n\n    # run all feed updates\n    php -f /home/bernhard/programming/core/occ news:updater:update-feed FEED_ID USER_ID\n\n    # delete old articles\n    php -f /home/bernhard/programming/core/occ news:updater:after-update\n\nMost of the time there are two possible points of failure that can be debugged by using the **--logelevel info** parameter:\n\n\n* Most distributions uses different **php.ini** files for your command line and web-server. This can manifest itself in weird errors like not being able to connect to the database. The solution is to either adjust **php.ini** used for the CLI PHP or to use a different **php.ini** altogether by specifying the **--phpini** parameter, e.g.::\n\n    nextcloud-news-updater -c /path/to/config --phpini /etc/php/nextcloud-news-updater.ini\n\n* The **news:updater:all-feeds** command returns invalid JSON. This can be due to due broken or missing **php.ini** settings or PHP warnings/errors produced by Nextcloud. The solution to this issue can range from adjusting your **php.ini** (see previous point) to manually patching Nextcloud to remove the warnings from the output.\n", "description_content_type": null, "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/nextcloud/news-updater", "keywords": "nextcloud", "license": "GPL", "maintainer": "", "maintainer_email": "", "name": "nextcloud_news_updater", "package_url": "https://pypi.org/project/nextcloud_news_updater/", "platform": "", "project_url": "https://pypi.org/project/nextcloud_news_updater/", "project_urls": {"Homepage": "https://github.com/nextcloud/news-updater"}, "release_url": "https://pypi.org/project/nextcloud_news_updater/10.0.1/", "requires_dist": null, "requires_python": "", "summary": "Nextcloud News updater - Fast updates for your RSS/Atom feeds", "version": "10.0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <a href=\"https://pypi.python.org/pypi/nextcloud_news_updater\" rel=\"nofollow\"><img alt=\"https://img.shields.io/pypi/v/nextcloud_news_updater.svg\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6baee88b06171b49808eb8db0208783110093835/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6e657874636c6f75645f6e6577735f757064617465722e737667\"></a>\n<a href=\"https://travis-ci.org/nextcloud/news-updater\" rel=\"nofollow\"><img alt=\"https://travis-ci.org/nextcloud/news-updater.svg?branch=master\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/41610309197ddc8bd8718062658c489a9682d0fb/68747470733a2f2f7472617669732d63692e6f72672f6e657874636c6f75642f6e6577732d757064617465722e7376673f6272616e63683d6d6173746572\"></a>\n<p>This Python library is a parallel feed updater for the <a href=\"https://github.com/nextcloud/news\" rel=\"nofollow\">Nextcloud News app</a></p>\n<p>Nextcloud does not require people to install threading or multiprocessing\nlibraries. Because the feed update process is mainly limited by I/O, parallel\nfetching of RSS feed updates can speed up the updating process significantly.</p>\n<p>In addition, Web Cron is not a supported cron setting since the update\nprocess may time out.</p>\n<p>Therefore the News app provides an API that offers a more fine grained\ncontrol over updating feeds. This Python project implements an update\nmechanism that is based on the <a href=\"https://github.com/nextcloud/news/tree/master/docs\" rel=\"nofollow\">updater REST API</a> or (new in Nextcloud News 8.1.0) the\nconsole based update API.</p>\n<div id=\"contents\">\n<ul>\n<li><a href=\"#dependencies\" id=\"id1\" rel=\"nofollow\">Dependencies</a></li>\n<li><a href=\"#pre-installation\" id=\"id2\" rel=\"nofollow\">Pre-Installation</a></li>\n<li><a href=\"#installation\" id=\"id3\" rel=\"nofollow\">Installation</a><ul>\n<li><a href=\"#installation-using-pip\" id=\"id4\" rel=\"nofollow\">Installation Using Pip</a></li>\n<li><a href=\"#manual-installation\" id=\"id5\" rel=\"nofollow\">Manual Installation</a></li>\n<li><a href=\"#no-installation\" id=\"id6\" rel=\"nofollow\">No Installation</a></li>\n</ul>\n</li>\n<li><a href=\"#usage\" id=\"id7\" rel=\"nofollow\">Usage</a></li>\n<li><a href=\"#running-the-updater-as-systemd-service\" id=\"id8\" rel=\"nofollow\">Running The Updater As Systemd Service</a></li>\n<li><a href=\"#troubleshooting\" id=\"id9\" rel=\"nofollow\">Troubleshooting</a><ul>\n<li><a href=\"#how-do-i-enable-support-for-self-signed-certificates\" id=\"id10\" rel=\"nofollow\">How Do I Enable Support For Self-Signed Certificates</a></li>\n<li><a href=\"#can-i-run-the-updater-using-cron\" id=\"id11\" rel=\"nofollow\">Can I Run The Updater Using Cron</a></li>\n<li><a href=\"#using-the-cli-based-updater-fails\" id=\"id12\" rel=\"nofollow\">Using The CLI Based Updater Fails</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div id=\"dependencies\">\n<h2><a href=\"#id1\" rel=\"nofollow\">Dependencies</a></h2>\n<ul>\n<li><strong>Python &gt;=3.5</strong></li>\n</ul>\n</div>\n<div id=\"pre-installation\">\n<h2><a href=\"#id2\" rel=\"nofollow\">Pre-Installation</a></h2>\n<p>To run the updates via an external threaded script the cron updater has to be\ndisabled. To do that go to the admin section an uncheck the <strong>Use Nextcloud\ncron</strong> checkbox or open <strong>nextcloud/data/news/config/config.ini</strong> and set:</p>\n<pre>useCronUpdates = true\n</pre>\n<p>to:</p>\n<pre>useCronUpdates = false\n</pre>\n</div>\n<div id=\"installation\">\n<h2><a href=\"#id3\" rel=\"nofollow\">Installation</a></h2>\n<p>There are two different ways to install the updater:</p>\n<ul>\n<li>Installation using pip (recommended)</li>\n<li>Manual installation</li>\n<li>No installation</li>\n</ul>\n<div id=\"installation-using-pip\">\n<h3><a href=\"#id4\" rel=\"nofollow\">Installation Using Pip</a></h3>\n<p>Since 8.2 the package is available on pypi for installation via pip (the\nPython library package manager).</p>\n<p>To install pip on your distribution of choice, <a href=\"http://python-packaging-user-guide.readthedocs.org/en/latest/install_requirements_linux/\" rel=\"nofollow\">consolidate the pip\ndocumentation</a></p>\n<p><strong>Note</strong>: You need to install the Python 3 version of pip</p>\n<p>After installing pip, run:</p>\n<pre>sudo pip3 install nextcloud_news_updater --install-option=\"--install-scripts=/usr/bin\"\n</pre>\n<p>To update the library, run:</p>\n<pre>sudo pip3 install --upgrade nextcloud_news_updater --install-option=\"--install-scripts=/usr/bin\"\n</pre>\n<p>To uninstall the library run:</p>\n<pre>sudo pip3 uninstall nextcloud_news_updater\n</pre>\n</div>\n<div id=\"manual-installation\">\n<h3><a href=\"#id5\" rel=\"nofollow\">Manual Installation</a></h3>\n<p>If you don\u2019t want to install the updater via pip, you can install it manually.\nThis requires setuptools to be installed. On Ubuntu this can be done by running:</p>\n<pre>sudo apt-get install python3-setuptools\n</pre>\n<p>Then install the package like this:</p>\n<pre>python3 setup.py install --install-scripts=/usr/bin\n</pre>\n<p>To uninstall the updater run:</p>\n<pre>python3 setup.py uninstall\n</pre>\n</div>\n<div id=\"no-installation\">\n<h3><a href=\"#id6\" rel=\"nofollow\">No Installation</a></h3>\n<p>If you do not want to install the script at all you can call it directly.</p>\n<p>Simply run the updater using:</p>\n<pre>python3 -m nextcloud_news_updater /path/to/nextcloud\n</pre>\n</div>\n</div>\n<div id=\"usage\">\n<h2><a href=\"#id7\" rel=\"nofollow\">Usage</a></h2>\n<p>There are two ways to run the updater:</p>\n<ul>\n<li><p>Using the console API (recommended):</p>\n<pre>nextcloud-news-updater /path/to/nextcloud\n</pre>\n</li>\n<li><p>Using the REST API (when running the updater on a different machine than Nextcloud):</p>\n<pre>nextcloud-news-updater https://domain.com/path/to/nextcloud --user admin_user --password admin_password\n</pre>\n</li>\n</ul>\n<p><strong>Note</strong>: <strong>admin_user</strong> is a user id with admin rights, <strong>admin_password</strong> the user\u2019s password</p>\n<p>You can view all options by running:</p>\n<pre>nextcloud-news-updater --help\n</pre>\n<pre>usage: nextcloud-news-updater [-h] [--threads THREADS] [--timeout TIMEOUT]\n                   [--interval INTERVAL] [--apilevel {v1-2,v2}]\n                   [--loglevel {info,error}] [--config CONFIG]\n                   [--phpini PHPINI] [--user USER] [--password PASSWORD]\n                   [--version] [--mode {endless,singlerun}] [--php PHP]\n                   [url]\n\npositional arguments:\n  url                   The URL or absolute path to the directory where\n                        Nextcloud is installed. Must be specified on the\n                        command line or in the config file. If the URL starts\n                        with http:// or https://, a user and password are\n                        required. Otherwise the updater tries to use the\n                        console based API which was added in 8.1.0\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --threads THREADS, -t THREADS\n                        How many feeds should be fetched in parallel, defaults\n                        to 10\n  --timeout TIMEOUT, -s TIMEOUT\n                        Maximum number of seconds for updating a feed,\n                        defaults to 5 minutes\n  --interval INTERVAL, -i INTERVAL\n                        Update interval between fetching the next round of\n                        updates in seconds, defaults to 15 minutes. The update\n                        timespan will be subtracted from the interval.\n  --apilevel {v1-2,v2}, -a {v1-2,v2}\n                        API level. Use v1-2, v2 is currently a draft only\n  --loglevel {info,error}, -l {info,error}\n                        Log granularity, info will log all urls and received\n                        data, error will only log errors\n  --config CONFIG, -c CONFIG\n                        Path to config file where all parameters except can be\n                        defined as key values pair. An example is in\n                        bin/example_config.ini\n  --phpini PHPINI, -P PHPINI\n                        Custom absolute path to the php.ini file to use for\n                        the command line updater. If omitted, the default one\n                        will be used\n  --user USER, -u USER  Admin username to log into Nextcloud. Must be\n                        specified on the command line or in the config file if\n                        the updater should update over HTTP\n  --password PASSWORD, -p PASSWORD\n                        Admin password to log into Nextcloud if the updater\n                        should update over HTTP\n  --version, -v         Prints the updater's version\n  --mode {endless,singlerun}, -m {endless,singlerun}\n                        Mode to run the updater in: endless runs the update\n                        again after the specified interval, singlerun only\n                        executes the update once\n  --php PHP             Path to the PHP binary, e.g. /usr/bin/php7.0, defaults\n                        to php\n</pre>\n<p>You can also put your settings in a config file, looking like this:</p>\n<pre><span class=\"k\">[updater]</span>\n<span class=\"c1\"># only needed when using the REST API</span>\n<span class=\"na\">user</span> <span class=\"o\">=</span> <span class=\"s\">admin</span>\n<span class=\"c1\"># only needed when using the REST API</span>\n<span class=\"na\">password</span> <span class=\"o\">=</span> <span class=\"s\">admin</span>\n<span class=\"na\">threads</span> <span class=\"o\">=</span> <span class=\"s\">10</span>\n<span class=\"na\">interval</span> <span class=\"o\">=</span> <span class=\"s\">900</span>\n<span class=\"na\">loglevel</span> <span class=\"o\">=</span> <span class=\"s\">error</span>\n<span class=\"c1\"># or https://domain.com/nextcloud when using the REST API</span>\n<span class=\"na\">url</span> <span class=\"o\">=</span> <span class=\"s\">/path/to/nextcloud</span>\n<span class=\"na\">phpini</span> <span class=\"o\">=</span> <span class=\"s\">/path/to/custom/php.ini</span>\n<span class=\"c1\"># or v2 which is currently a draft</span>\n<span class=\"na\">apilevel</span> <span class=\"o\">=</span> <span class=\"s\">v1-2</span>\n<span class=\"na\">mode</span> <span class=\"o\">=</span> <span class=\"s\">endless</span>\n<span class=\"c1\"># path to php binary</span>\n<span class=\"na\">php</span> <span class=\"o\">=</span> <span class=\"s\">/usr/bin/php7.0</span>\n</pre>\n<p><strong>Note</strong>: You can omit options in the config file if you want to use the defaults, but you can not have more than the allowed parameters present, otherwise an exception will abort the updater.</p>\n<p>Then run the updater with:</p>\n<pre>nextcloud-news-updater -c /path/to/config\n</pre>\n<p><strong>Note</strong>: Command line parameters will always overwrite config parameters, so if you just want to change your loglevel to info for one run you can now do the following without globally changing the config file:</p>\n<pre>nextcloud-news-updater -c /path/to/config --mode singlerun --loglevel info\n</pre>\n</div>\n<div id=\"running-the-updater-as-systemd-service\">\n<h2><a href=\"#id8\" rel=\"nofollow\">Running The Updater As Systemd Service</a></h2>\n<p>Almost always you want to run and stop the updater using your in init system.\nAs for Systemd, you can create a simple text file at\n<strong>/etc/systemd/system/nextcloud-news-updater.service</strong> with the following contents:</p>\n<pre><span class=\"k\">[Unit]</span>\n<span class=\"na\">After</span><span class=\"o\">=</span><span class=\"s\">default.target</span>\n\n<span class=\"k\">[Service]</span>\n<span class=\"na\">Type</span><span class=\"o\">=</span><span class=\"s\">simple</span>\n<span class=\"na\">User</span><span class=\"o\">=</span><span class=\"s\">http</span>\n<span class=\"na\">ExecStart</span><span class=\"o\">=</span><span class=\"s\">/usr/bin/nextcloud-news-updater -c /etc/nextcloud/news/updater.ini</span>\n\n<span class=\"k\">[Install]</span>\n<span class=\"na\">WantedBy</span><span class=\"o\">=</span><span class=\"s\">default.target</span>\n</pre>\n<p>Then to enable and start it run:</p>\n<pre>sudo systemctl enable nextcloud-news-updater.service\nsudo systemctl start nextcloud-news-updater.service\n</pre>\n<p><strong>Note</strong>: If you are using the cli based updater (as in set an absolute directory as url)\nyou need to set the web-server user as user in the unit file. Otherwise the command\nwill fail because Nextcloud checks for the owner of its files. This user\nvaries from distribution to distribution, e.g in Debian and Ubuntu you would use the\n<strong>www-data</strong> user:</p>\n<pre><span class=\"k\">[Unit]</span>\n<span class=\"na\">After</span><span class=\"o\">=</span><span class=\"s\">default.target</span>\n\n<span class=\"k\">[Service]</span>\n<span class=\"na\">Type</span><span class=\"o\">=</span><span class=\"s\">simple</span>\n<span class=\"na\">User</span><span class=\"o\">=</span><span class=\"s\">www-data</span>\n<span class=\"na\">ExecStart</span><span class=\"o\">=</span><span class=\"s\">/usr/bin/nextcloud-news-updater -c /etc/nextcloud/news/updater.ini</span>\n\n<span class=\"k\">[Install]</span>\n<span class=\"na\">WantedBy</span><span class=\"o\">=</span><span class=\"s\">default.target</span>\n</pre>\n<p>If you are using the REST API, most of the time you can get away by using <strong>nobody</strong> as\nuser, but again, that might vary depending on your distribution.</p>\n</div>\n<div id=\"troubleshooting\">\n<h2><a href=\"#id9\" rel=\"nofollow\">Troubleshooting</a></h2>\n<p>If you are having trouble debugging updater errors, try running it again using the <strong>info</strong> loglevel:</p>\n<pre>nextcloud-news-updater --loglevel info -c /path/to/config.ini\n</pre>\n<div id=\"how-do-i-enable-support-for-self-signed-certificates\">\n<h3><a href=\"#id10\" rel=\"nofollow\">How Do I Enable Support For Self-Signed Certificates</a></h3>\n<p>If you are using self-signed certificates, don\u2019t. It\u2019s very easy to sign your cert for free from either one of the following three websites:</p>\n<ul>\n<li><a href=\"https://letsencrypt.org/\" rel=\"nofollow\">Lets Encrypt</a></li>\n<li><a href=\"https://www.startssl.com/\" rel=\"nofollow\">StartSSL</a></li>\n<li><a href=\"https://www.wosign.com/english/\" rel=\"nofollow\">WoSign</a></li>\n</ul>\n<p>If you still have to use a self-signed certificate no matter what, don\u2019t patch the code to turn off certificate verification but rather globally add your certificate to the trusted certificates. Read up on your distributions documentation to find out how.</p>\n</div>\n<div id=\"can-i-run-the-updater-using-cron\">\n<h3><a href=\"#id11\" rel=\"nofollow\">Can I Run The Updater Using Cron</a></h3>\n<p>Yes, you can by using the <strong>\u2013mode singlerun</strong> parameter which will exit after one full update.</p>\n<p>However it\u2019s your job to ensure, that the job will not be executed more than once at the same time. If update jobs overlap, they <strong>can take down your system and/or server</strong> since each new updater will slow down the previous ones causing more updaters to be spawned.</p>\n<p>If you can not ensure that the updater is run only one at a time use the default mode (<strong>\u2013mode endless</strong>). This mode runs the update in a loop. You can control the update frequency through the <strong>\u2013interval</strong> parameter (or <strong>interval</strong> using a config file). The updater works in the following way:\n* If a full update takes longer than the passed interval, another update will be run immediately afterwards\n* If a full update took less than the passed interval, the updater will sleep for the remaining time and run an update afterwards</p>\n</div>\n<div id=\"using-the-cli-based-updater-fails\">\n<h3><a href=\"#id12\" rel=\"nofollow\">Using The CLI Based Updater Fails</a></h3>\n<p>The updater uses the PHP executable to run the occ file inside your nextcloud directory. The general process boils down to the following:</p>\n<pre><span class=\"c1\"># delete folders and feeds marked for deletion\n</span>php -f /home/bernhard/programming/core/occ news:updater:before-update\n\n<span class=\"c1\"># get all feeds to udpate\n</span>php -f /home/bernhard/programming/core/occ news:updater:all-feeds\n\n<span class=\"c1\"># run all feed updates\n</span>php -f /home/bernhard/programming/core/occ news:updater:update-feed FEED_ID USER_ID\n\n<span class=\"c1\"># delete old articles\n</span>php -f /home/bernhard/programming/core/occ news:updater:after-update\n</pre>\n<p>Most of the time there are two possible points of failure that can be debugged by using the <strong>\u2013logelevel info</strong> parameter:</p>\n<ul>\n<li><p>Most distributions uses different <strong>php.ini</strong> files for your command line and web-server. This can manifest itself in weird errors like not being able to connect to the database. The solution is to either adjust <strong>php.ini</strong> used for the CLI PHP or to use a different <strong>php.ini</strong> altogether by specifying the <strong>\u2013phpini</strong> parameter, e.g.:</p>\n<pre>nextcloud-news-updater -c /path/to/config --phpini /etc/php/nextcloud-news-updater.ini\n</pre>\n</li>\n<li><p>The <strong>news:updater:all-feeds</strong> command returns invalid JSON. This can be due to due broken or missing <strong>php.ini</strong> settings or PHP warnings/errors produced by Nextcloud. The solution to this issue can range from adjusting your <strong>php.ini</strong> (see previous point) to manually patching Nextcloud to remove the warnings from the output.</p>\n</li>\n</ul>\n</div>\n</div>\n\n          </div>"}, "last_serial": 3471831, "releases": {"10.0.0": [{"comment_text": "", "digests": {"md5": "3a5be2907324e2c84cf1c6289a0a5262", "sha256": "40226a2d2a168988ba40050c5b235c8d1745fa03559b557df0206872c167fa02"}, "downloads": -1, "filename": "nextcloud_news_updater-10.0.0.tar.gz", "has_sig": false, "md5_digest": "3a5be2907324e2c84cf1c6289a0a5262", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 33153, "upload_time": "2017-07-06T15:39:52", "upload_time_iso_8601": "2017-07-06T15:39:52.066863Z", "url": "https://files.pythonhosted.org/packages/dc/d0/af3e3eb52536ae645ae961f87259c3739cac9d784bf91a80d7ff309c1b96/nextcloud_news_updater-10.0.0.tar.gz", "yanked": false}], "10.0.1": [{"comment_text": "", "digests": {"md5": "542823b95554b2fc50993cdc159bdd85", "sha256": "d87cd0026e3f3ab1b0318cbc2422b26e1b0d1640a9911167a8daf113081f5292"}, "downloads": -1, "filename": "nextcloud_news_updater-10.0.1.tar.gz", "has_sig": false, "md5_digest": "542823b95554b2fc50993cdc159bdd85", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 32760, "upload_time": "2018-01-08T18:16:21", "upload_time_iso_8601": "2018-01-08T18:16:21.576202Z", "url": "https://files.pythonhosted.org/packages/53/15/f395d8aa11e3592cd716a09fb641cbe7858ac3220bf06b3123027ca9a26a/nextcloud_news_updater-10.0.1.tar.gz", "yanked": false}], "9.0.2": [{"comment_text": "", "digests": {"md5": "89935837b39ae278bae47e37d62d6967", "sha256": "9caa7372e358bb0adc030ae7c41e5359807855a23c92289da072fb1f5221cfd4"}, "downloads": -1, "filename": "nextcloud_news_updater-9.0.2.tar.gz", "has_sig": false, "md5_digest": "89935837b39ae278bae47e37d62d6967", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 33005, "upload_time": "2016-08-21T07:39:20", "upload_time_iso_8601": "2016-08-21T07:39:20.013858Z", "url": "https://files.pythonhosted.org/packages/ce/b1/36346bb57b5d6bcf78fc4585a1929c1b92cafc674c146df54a2940037ad9/nextcloud_news_updater-9.0.2.tar.gz", "yanked": false}], "9.0.3": [{"comment_text": "", "digests": {"md5": "19239eb0e77c2611823c474a0dedeecf", "sha256": "b4d455bd6cc4e66dcee20394f39e15b0b60217b7aedeb92aa76b4a525587b52d"}, "downloads": -1, "filename": "nextcloud_news_updater-9.0.3.tar.gz", "has_sig": false, "md5_digest": "19239eb0e77c2611823c474a0dedeecf", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 33158, "upload_time": "2017-07-06T15:39:16", "upload_time_iso_8601": "2017-07-06T15:39:16.219957Z", "url": "https://files.pythonhosted.org/packages/86/a5/d49877874359e60c9963e28b8d684a68ab70f8fd7a55187e1a7dc65e7195/nextcloud_news_updater-9.0.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "542823b95554b2fc50993cdc159bdd85", "sha256": "d87cd0026e3f3ab1b0318cbc2422b26e1b0d1640a9911167a8daf113081f5292"}, "downloads": -1, "filename": "nextcloud_news_updater-10.0.1.tar.gz", "has_sig": false, "md5_digest": "542823b95554b2fc50993cdc159bdd85", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 32760, "upload_time": "2018-01-08T18:16:21", "upload_time_iso_8601": "2018-01-08T18:16:21.576202Z", "url": "https://files.pythonhosted.org/packages/53/15/f395d8aa11e3592cd716a09fb641cbe7858ac3220bf06b3123027ca9a26a/nextcloud_news_updater-10.0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:45:36 2020"}