{"info": {"author": "Maxim Kochurov", "author_email": "maxim.v.kochurov@gmail.com", "bugtrack_url": null, "classifiers": [], "description": "******\nbiwrap\n******\nYet simple util to make wrapper with optional arguments\n\nInstallation\n############\n\nMaster branch\n\n.. code-block:: bash\n\n    pip install git+https://github.com/ferrine/biwrap\n\nLatest release\n\n.. code-block:: bash\n\n    pip install biwrap\n\nProblem outlined\n################\n**Readability and transparent implementation is important.** Wrappers is an advanced topic in programming and making them readable in some cases is difficult. The particular case is parametrizable wrapper. It can either be called with or without arguments. Implementation to handle this case is often tricky and looks weird (see `SO thread <https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments>`__). This package solves the problem and provides with simple and generic solution.\n\nAPI\n###\nA minimal snippet to apply it to your problem.\n\n.. code-block:: python\n\n    import biwrap\n\n    @biwrap.biwrap\n    def wrapper(fn, arg1='default', arg2='default'):\n        def wrapped(*fn_args, **fn_kwargs):\n            ...  # depends on `arg1`, `arg2`\n        return wrapped\n\n    @wrapper  # use defaults\n    def func1(a, b):\n        ...\n\n    @wrapper(arg1='non default')  # change defaults\n    def func2(a, b):\n        ...\n\nExample\n#######\n\nLet's discuss a case when it is needed to put functions into a registry. Some functions can have alias names.\n\nNaive Solution\n**************\n\n.. code-block:: python\n\n    def register(alias=None):\n        def inner(fn):\n            if fn.__name__ not in register.storage:\n                register.storage[fn.__name__] = fn\n            elif register.storage[fn.__name__] is not fn:\n                raise KeyError('{} is already in storage'.format(fn.__name__))\n            if alias is not None and alias not in register.storage:\n                register.storage[alias] = fn\n            elif alias is not None:\n                raise KeyError('{} is already in storage'.format(alias))\n            return fn\n        return inner\n    register.storage = {}\n\n\n    @register()\n    def f1(a):\n        return a\n\n    print(register.storage)\n    #> {'f1': <function f1 at 0x11ff519d8>}\n\n\n    @register(alias='fn3')\n    def f2(a):\n        return a\n\n    print(register.storage)\n    #> {'f1': <function f1 at 0x11ff519d8>, 'f2': <function f2 at 0x10a87d0d0>, 'fn3': <function f2 at 0x10a87d0d0>}\n\n\nAnalysis\n========\n\nThe above example shows redundancy in\n\n-   decorator definition has double nesting (double ``def``)\n-   usage requires trailing parenthesis ``@register()`` even in case we do not use optional argument\n\nMore readable code should avoid these two points and look like:\n\n.. code-block:: python\n\n    def register(fn, alias=None):\n        ...\n\n    @register\n    def f1(a):\n        return a\n\n    @register(alias='fn3')  # <- (1)\n    def f2(a):\n        return a\n\nNaive implementation of the above API won't work. Line marked above as ``(1)`` will fail as first argument ``fn`` is not passed. But we want the output to be the same.\n\nBetter solution\n***************\n\n.. code-block:: python\n\n    import biwrap\n\n    @biwrap.biwrap\n    def register(fn, alias=None):\n        if fn.__name__ not in register.storage:\n            register.storage[fn.__name__] = fn\n        elif register.storage[fn.__name__] is not fn:\n            raise KeyError('{} is already in storage'.format(fn.__name__))\n        if alias is not None and alias not in register.storage:\n            register.storage[alias] = fn\n        elif alias is not None:\n            raise KeyError('{} is already in storage'.format(alias))\n        return fn\n    register.storage = {}\n\n    @register\n    def f1(a):\n        return a\n\n    print(register.storage)\n    #> {'f1': <function f1 at 0x10f45a048>}\n\n    @register(alias='fn3')\n    def f2(a):\n        return a\n\n    print(register.storage)\n    #> {'f1': <function f1 at 0x10f45a048>, 'f2': <function f2 at 0x10f45a488>, 'fn3': <function f2 at 0x10f45a488>}\n\n\nFunctionality Overview\n######################\nSome corner cases may exist and custom coding can create a boilerplate for each usecase (see this `SO thread <https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments>`__). This package takes the best and implements yet simple but generic solution to resolve them all(?).\n\nSetup\n*****\n\nLet's take a simple wrapper as an example. It will print ``hi`` or ``bye`` depending on parametrization, default is ``hi``.\n\n.. code-block:: python\n\n    import biwrap\n\n    @biwrap.biwrap\n    def hiwrap(fn, hi=True):\n        def new(*args, **kwargs):\n            if hi:\n                print('hi')\n            else:\n                print('bye')\n            return fn(*args, **kwargs)\n        return new\n\nCases\n*****\n\nFunction wrapping\n=================\nDefined wrapper can be used in both ways\n\n.. code-block:: python\n\n    @hiwrap\n    def fn(n):\n        print(n)\n    fn(1)\n    #> hi\n    #> 1\n\n    @hiwrap(hi=False)\n    def fn(n):\n        print(n)\n    fn(1)\n    #> bye\n    #> 1\n\n\nBound method wrapper\n=====================\n\n``biwrap`` also works for bound methods. As seen in `SO thread <https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments>`__ this can be a problem as first positional argument is ``self`` instead of a function.\n\n.. code-block:: python\n\n    class W:\n        def __init__(self, n):\n            self.n = n\n\n        @biwrap.biwrap\n        def wrap(self, fn, text='hi'):\n            def wrapped(*args, **kwargs):\n                for _ in range(self.n):\n                    print(text)\n                return fn(*args, **kwargs)\n            return wrapped\n    wr = W(3)\n\n    @wr.wrap\n    def fn(n):\n        print(n)\n\n    fn(1)\n    #> hi\n    #> hi\n    #> hi\n    #> 1\n\n    @wr.wrap(text='bye')\n    def fn(n):\n        print(n)\n\n    wr.n = 2\n    fn(2)\n    #> bye\n    #> bye\n    #> 2\n\nClass methods / properties wrapping\n===================================\n\nImplementation deals with these cases as well\n\n.. code-block:: python\n\n    class O:\n        def __init__(self, n):\n            self.n = n\n\n        @classmethod\n        @hiwrap\n        def fn(cls, n):\n            print(n)\n\n        @property\n        @hiwrap(hi=False)\n        def num(self):\n            return self.n\n\n\n    o = O(2)\n    o.fn(1)\n    #> hi\n    #> 1\n    print(o.num)\n    #> bye\n    #> 2\n\nWrapper as a function\n=====================\n\nFunction like call is OK too\n\n.. code-block:: python\n\n    def fn(n):\n        print(n)\n\n    fn = hiwrap(fn, hi=False)\n    fn(1)\n    #> bye\n    #> 1\n\n", "description_content_type": null, "docs_url": null, "download_url": "https://github.com/ferrine/biwrap/archive/v0.1.6.zip", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/ferrine/biwrap", "keywords": "", "license": "MIT License", "maintainer": "", "maintainer_email": "", "name": "biwrap", "package_url": "https://pypi.org/project/biwrap/", "platform": "", "project_url": "https://pypi.org/project/biwrap/", "project_urls": {"Download": "https://github.com/ferrine/biwrap/archive/v0.1.6.zip", "Homepage": "https://github.com/ferrine/biwrap"}, "release_url": "https://pypi.org/project/biwrap/0.1.6/", "requires_dist": null, "requires_python": "", "summary": "Yet simple util to make wrapper with optional arguments", "version": "0.1.6", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p>Yet simple util to make wrapper with optional arguments</p>\n<div id=\"installation\">\n<h2>Installation</h2>\n<p>Master branch</p>\n<pre>pip install git+https://github.com/ferrine/biwrap\n</pre>\n<p>Latest release</p>\n<pre>pip install biwrap\n</pre>\n</div>\n<div id=\"problem-outlined\">\n<h2>Problem outlined</h2>\n<p><strong>Readability and transparent implementation is important.</strong> Wrappers is an advanced topic in programming and making them readable in some cases is difficult. The particular case is parametrizable wrapper. It can either be called with or without arguments. Implementation to handle this case is often tricky and looks weird (see <a href=\"https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments\" rel=\"nofollow\">SO thread</a>). This package solves the problem and provides with simple and generic solution.</p>\n</div>\n<div id=\"api\">\n<h2>API</h2>\n<p>A minimal snippet to apply it to your problem.</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">biwrap</span>\n\n<span class=\"nd\">@biwrap</span><span class=\"o\">.</span><span class=\"n\">biwrap</span>\n<span class=\"k\">def</span> <span class=\"nf\">wrapper</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">arg1</span><span class=\"o\">=</span><span class=\"s1\">'default'</span><span class=\"p\">,</span> <span class=\"n\">arg2</span><span class=\"o\">=</span><span class=\"s1\">'default'</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">wrapped</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">fn_args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">fn_kwargs</span><span class=\"p\">):</span>\n        <span class=\"o\">...</span>  <span class=\"c1\"># depends on `arg1`, `arg2`</span>\n    <span class=\"k\">return</span> <span class=\"n\">wrapped</span>\n\n<span class=\"nd\">@wrapper</span>  <span class=\"c1\"># use defaults</span>\n<span class=\"k\">def</span> <span class=\"nf\">func1</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">):</span>\n    <span class=\"o\">...</span>\n\n<span class=\"nd\">@wrapper</span><span class=\"p\">(</span><span class=\"n\">arg1</span><span class=\"o\">=</span><span class=\"s1\">'non default'</span><span class=\"p\">)</span>  <span class=\"c1\"># change defaults</span>\n<span class=\"k\">def</span> <span class=\"nf\">func2</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">):</span>\n    <span class=\"o\">...</span>\n</pre>\n</div>\n<div id=\"example\">\n<h2>Example</h2>\n<p>Let\u2019s discuss a case when it is needed to put functions into a registry. Some functions can have alias names.</p>\n<div id=\"naive-solution\">\n<h3>Naive Solution</h3>\n<pre><span class=\"k\">def</span> <span class=\"nf\">register</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">inner</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">:</span>\n            <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">fn</span>\n        <span class=\"k\">elif</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">]</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">fn</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">{}</span><span class=\"s1\"> is already in storage'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">))</span>\n        <span class=\"k\">if</span> <span class=\"n\">alias</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">alias</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">:</span>\n            <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">alias</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">fn</span>\n        <span class=\"k\">elif</span> <span class=\"n\">alias</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">{}</span><span class=\"s1\"> is already in storage'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"p\">))</span>\n        <span class=\"k\">return</span> <span class=\"n\">fn</span>\n    <span class=\"k\">return</span> <span class=\"n\">inner</span>\n<span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n\n<span class=\"nd\">@register</span><span class=\"p\">()</span>\n<span class=\"k\">def</span> <span class=\"nf\">f1</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; {'f1': &lt;function f1 at 0x11ff519d8&gt;}</span>\n\n\n<span class=\"nd\">@register</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"s1\">'fn3'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">f2</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; {'f1': &lt;function f1 at 0x11ff519d8&gt;, 'f2': &lt;function f2 at 0x10a87d0d0&gt;, 'fn3': &lt;function f2 at 0x10a87d0d0&gt;}</span>\n</pre>\n<div id=\"analysis\">\n<h4>Analysis</h4>\n<p>The above example shows redundancy in</p>\n<ul>\n<li>decorator definition has double nesting (double <tt>def</tt>)</li>\n<li>usage requires trailing parenthesis <tt>@register()</tt> even in case we do not use optional argument</li>\n</ul>\n<p>More readable code should avoid these two points and look like:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">register</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"o\">...</span>\n\n<span class=\"nd\">@register</span>\n<span class=\"k\">def</span> <span class=\"nf\">f1</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n\n<span class=\"nd\">@register</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"s1\">'fn3'</span><span class=\"p\">)</span>  <span class=\"c1\"># &lt;- (1)</span>\n<span class=\"k\">def</span> <span class=\"nf\">f2</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n</pre>\n<p>Naive implementation of the above API won\u2019t work. Line marked above as <tt>(1)</tt> will fail as first argument <tt>fn</tt> is not passed. But we want the output to be the same.</p>\n</div>\n</div>\n<div id=\"better-solution\">\n<h3>Better solution</h3>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">biwrap</span>\n\n<span class=\"nd\">@biwrap</span><span class=\"o\">.</span><span class=\"n\">biwrap</span>\n<span class=\"k\">def</span> <span class=\"nf\">register</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">:</span>\n        <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">fn</span>\n    <span class=\"k\">elif</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">]</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">fn</span><span class=\"p\">:</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">{}</span><span class=\"s1\"> is already in storage'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">))</span>\n    <span class=\"k\">if</span> <span class=\"n\">alias</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span> <span class=\"ow\">and</span> <span class=\"n\">alias</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">:</span>\n        <span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">[</span><span class=\"n\">alias</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">fn</span>\n    <span class=\"k\">elif</span> <span class=\"n\">alias</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">{}</span><span class=\"s1\"> is already in storage'</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"p\">))</span>\n    <span class=\"k\">return</span> <span class=\"n\">fn</span>\n<span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n<span class=\"nd\">@register</span>\n<span class=\"k\">def</span> <span class=\"nf\">f1</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; {'f1': &lt;function f1 at 0x10f45a048&gt;}</span>\n\n<span class=\"nd\">@register</span><span class=\"p\">(</span><span class=\"n\">alias</span><span class=\"o\">=</span><span class=\"s1\">'fn3'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">f2</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">a</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">register</span><span class=\"o\">.</span><span class=\"n\">storage</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; {'f1': &lt;function f1 at 0x10f45a048&gt;, 'f2': &lt;function f2 at 0x10f45a488&gt;, 'fn3': &lt;function f2 at 0x10f45a488&gt;}</span>\n</pre>\n</div>\n</div>\n<div id=\"functionality-overview\">\n<h2>Functionality Overview</h2>\n<p>Some corner cases may exist and custom coding can create a boilerplate for each usecase (see this <a href=\"https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments\" rel=\"nofollow\">SO thread</a>). This package takes the best and implements yet simple but generic solution to resolve them all(?).</p>\n<div id=\"setup\">\n<h3>Setup</h3>\n<p>Let\u2019s take a simple wrapper as an example. It will print <tt>hi</tt> or <tt>bye</tt> depending on parametrization, default is <tt>hi</tt>.</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">biwrap</span>\n\n<span class=\"nd\">@biwrap</span><span class=\"o\">.</span><span class=\"n\">biwrap</span>\n<span class=\"k\">def</span> <span class=\"nf\">hiwrap</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">hi</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">hi</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'hi'</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'bye'</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">new</span>\n</pre>\n</div>\n<div id=\"cases\">\n<h3>Cases</h3>\n<div id=\"function-wrapping\">\n<h4>Function wrapping</h4>\n<p>Defined wrapper can be used in both ways</p>\n<pre><span class=\"nd\">@hiwrap</span>\n<span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n<span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; hi</span>\n<span class=\"c1\">#&gt; 1</span>\n\n<span class=\"nd\">@hiwrap</span><span class=\"p\">(</span><span class=\"n\">hi</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n<span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; bye</span>\n<span class=\"c1\">#&gt; 1</span>\n</pre>\n</div>\n<div id=\"bound-method-wrapper\">\n<h4>Bound method wrapper</h4>\n<p><tt>biwrap</tt> also works for bound methods. As seen in <a href=\"https://stackoverflow.com/questions/3888158/making-decorators-with-optional-arguments\" rel=\"nofollow\">SO thread</a> this can be a problem as first positional argument is <tt>self</tt> instead of a function.</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">W</span><span class=\"p\">:</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"n\">n</span>\n\n    <span class=\"nd\">@biwrap</span><span class=\"o\">.</span><span class=\"n\">biwrap</span>\n    <span class=\"k\">def</span> <span class=\"nf\">wrap</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">'hi'</span><span class=\"p\">):</span>\n        <span class=\"k\">def</span> <span class=\"nf\">wrapped</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n            <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n</span><span class=\"p\">):</span>\n                <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span> <span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">wrapped</span>\n<span class=\"n\">wr</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">)</span>\n\n<span class=\"nd\">@wr</span><span class=\"o\">.</span><span class=\"n\">wrap</span>\n<span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n<span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; hi</span>\n<span class=\"c1\">#&gt; hi</span>\n<span class=\"c1\">#&gt; hi</span>\n<span class=\"c1\">#&gt; 1</span>\n\n<span class=\"nd\">@wr</span><span class=\"o\">.</span><span class=\"n\">wrap</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s1\">'bye'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n<span class=\"n\">wr</span><span class=\"o\">.</span><span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"mi\">2</span>\n<span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; bye</span>\n<span class=\"c1\">#&gt; bye</span>\n<span class=\"c1\">#&gt; 2</span>\n</pre>\n</div>\n<div id=\"class-methods-properties-wrapping\">\n<h4>Class methods / properties wrapping</h4>\n<p>Implementation deals with these cases as well</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">O</span><span class=\"p\">:</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"n\">n</span>\n\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"nd\">@hiwrap</span>\n    <span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"nd\">@hiwrap</span><span class=\"p\">(</span><span class=\"n\">hi</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">num</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n</span>\n\n\n<span class=\"n\">o</span> <span class=\"o\">=</span> <span class=\"n\">O</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">o</span><span class=\"o\">.</span><span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; hi</span>\n<span class=\"c1\">#&gt; 1</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">o</span><span class=\"o\">.</span><span class=\"n\">num</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; bye</span>\n<span class=\"c1\">#&gt; 2</span>\n</pre>\n</div>\n<div id=\"wrapper-as-a-function\">\n<h4>Wrapper as a function</h4>\n<p>Function like call is OK too</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">fn</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n<span class=\"n\">fn</span> <span class=\"o\">=</span> <span class=\"n\">hiwrap</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">hi</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\">#&gt; bye</span>\n<span class=\"c1\">#&gt; 1</span>\n</pre>\n</div>\n</div>\n</div>\n\n          </div>"}, "last_serial": 3487628, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "49a2bb2fce4e584fbb5b16f35e3f0e1e", "sha256": "e2031dd5620a2f40e2566044cb15c14e2dbb2719dd3f3e106435a44485d45c88"}, "downloads": -1, "filename": "biwrap-0.1.0.tar.gz", "has_sig": false, "md5_digest": "49a2bb2fce4e584fbb5b16f35e3f0e1e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 1098, "upload_time": "2018-01-13T13:07:47", "upload_time_iso_8601": "2018-01-13T13:07:47.489235Z", "url": "https://files.pythonhosted.org/packages/38/d5/73d3c4d4b1f0dc6cbb640c1e604a1a2d75868834e65bb52a61872165b184/biwrap-0.1.0.tar.gz", "yanked": false}], "0.1.2": [{"comment_text": "", "digests": {"md5": "474a42287d9a06bb07ff272183bb60f9", "sha256": "24b37c4a6049f19436848e2a3370ff34c8231e4dcda9f1a2eedf23b12761cf9b"}, "downloads": -1, "filename": "biwrap-0.1.2.tar.gz", "has_sig": false, "md5_digest": "474a42287d9a06bb07ff272183bb60f9", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4283, "upload_time": "2018-01-13T20:55:15", "upload_time_iso_8601": "2018-01-13T20:55:15.957529Z", "url": "https://files.pythonhosted.org/packages/b3/27/e6011f75c7572ae69f00e29b8a6c68e5eb9d00c3583a6a5862aea3fff2ea/biwrap-0.1.2.tar.gz", "yanked": false}], "0.1.3": [{"comment_text": "", "digests": {"md5": "052e397e816157944aa9b7889bde6ca0", "sha256": "0c51f04764f405d1e63d303decf07422afc42fbeb84b4472e758617cd5e6643b"}, "downloads": -1, "filename": "biwrap-0.1.3.tar.gz", "has_sig": false, "md5_digest": "052e397e816157944aa9b7889bde6ca0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4330, "upload_time": "2018-01-13T20:57:34", "upload_time_iso_8601": "2018-01-13T20:57:34.417443Z", "url": "https://files.pythonhosted.org/packages/dd/3e/f1cb50ef067a143e47ce7f8e502e0915aadadaaf5e7d9100d6cfd2293a81/biwrap-0.1.3.tar.gz", "yanked": false}], "0.1.4": [{"comment_text": "", "digests": {"md5": "dfc2e7a364123bef449ffcac7d9d09e0", "sha256": "c0c8c15ac520a3c569d84808cb054494d959c2d925f9167af6a452ecb37dff0d"}, "downloads": -1, "filename": "biwrap-0.1.4.tar.gz", "has_sig": false, "md5_digest": "dfc2e7a364123bef449ffcac7d9d09e0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3723, "upload_time": "2018-01-13T21:00:03", "upload_time_iso_8601": "2018-01-13T21:00:03.778066Z", "url": "https://files.pythonhosted.org/packages/c8/e9/f33dc8723307b0d43164d9d7b6c626085c3b0b2e24b93b12974685204617/biwrap-0.1.4.tar.gz", "yanked": false}], "0.1.5": [{"comment_text": "", "digests": {"md5": "7e8658947a7f729e9620b76e3db28617", "sha256": "633f275d09e12706b0b96fb7f3b246ecac816470a04112e1d1dc5c4c37665634"}, "downloads": -1, "filename": "biwrap-0.1.5.tar.gz", "has_sig": false, "md5_digest": "7e8658947a7f729e9620b76e3db28617", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3743, "upload_time": "2018-01-13T21:03:23", "upload_time_iso_8601": "2018-01-13T21:03:23.278243Z", "url": "https://files.pythonhosted.org/packages/b2/10/dd29e16f2be4ce7250791f94e9901987d698bb7deb33c79007f77c69aa80/biwrap-0.1.5.tar.gz", "yanked": false}], "0.1.6": [{"comment_text": "", "digests": {"md5": "10b52d62edcdb656e72ae1bfb67cb821", "sha256": "f6346f9973727d101258cf03e5c343197b8fc50a8f7fe80353e808581a021450"}, "downloads": -1, "filename": "biwrap-0.1.6.tar.gz", "has_sig": false, "md5_digest": "10b52d62edcdb656e72ae1bfb67cb821", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3891, "upload_time": "2018-01-13T22:33:07", "upload_time_iso_8601": "2018-01-13T22:33:07.059146Z", "url": "https://files.pythonhosted.org/packages/ac/54/78d4d5459d7385f90908185641647ff2e8ed4a4b5c239976f78e26888679/biwrap-0.1.6.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "10b52d62edcdb656e72ae1bfb67cb821", "sha256": "f6346f9973727d101258cf03e5c343197b8fc50a8f7fe80353e808581a021450"}, "downloads": -1, "filename": "biwrap-0.1.6.tar.gz", "has_sig": false, "md5_digest": "10b52d62edcdb656e72ae1bfb67cb821", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3891, "upload_time": "2018-01-13T22:33:07", "upload_time_iso_8601": "2018-01-13T22:33:07.059146Z", "url": "https://files.pythonhosted.org/packages/ac/54/78d4d5459d7385f90908185641647ff2e8ed4a4b5c239976f78e26888679/biwrap-0.1.6.tar.gz", "yanked": false}], "timestamp": "Thu May  7 22:37:12 2020"}