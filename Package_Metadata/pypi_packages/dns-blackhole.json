{"info": {"author": "Olivier Mauras", "author_email": "olivier@mauras.ch", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: System Administrators", "License :: OSI Approved :: MIT License", "Programming Language :: Python :: 2", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Topic :: Internet :: Name Service (DNS)"], "description": "dns-blackhole\n=============\n\n| Most of code comes from here:\n  http://git.mauras.ch/Various/powerdns\\_recursor\\_ads\\_blocking\n| Check it for history.\n\n| This script helps you create a blackhole zone for your DNS server,\n  using some well known ads/tracking/malware lists.\n| As long as your DNS server allows to include a file containing one\n  domain per line with its config syntax it should work.\n| Right now known to work and tested:\n\n-  `Unbound <https://www.unbound.net/>`__\n-  `PowerDNS recursor <https://www.powerdns.com/recursor.html>`__\n-  `Dnsmasq <http://www.thekelleys.org.uk/dnsmasq/doc.html>`__\n\nGenerating an agregated host file is also possible.\n\nFeatures\n--------\n\n-  Not bound to a specific DNS server, generates a file format of your\n   choice\n-  Supports 3 different list format\n\n   -  Host file\n   -  `Easylist <https://easylist.to/>`__\n   -  `Disconnect <https://disconnect.me/>`__\n\n-  Lets you whitelist/blacklist domains\n-  YAML configuration file\n\nInstallation\n------------\n\nThe script requires ``PyYAML`` and ``requests`` modules.\n\n.. code:: bash\n\n    pip install [--upgrade] dns-blackhole\n\nUnbound\n^^^^^^^\n\n| Requires unbound >= ``1.6``, using the default zone file with unbound\n  ``1.5`` will certainly make it eat all your ram and swap before\n  getting killed.\n| Add ``include: \"/etc/unbound/blackhole.zone\"`` right after your\n  ``server:`` block.\n| Use the following ``zone_data`` in your ``dns-blackhole.yml``\n  (default):\n\n.. code:: yaml\n\n    zone_data: 'local-zone: \"{domain}\" always_nxdomain'\n\n``{domain}`` wil be replaced by the blackholed domains\n\nPowerDNS Recursor\n^^^^^^^^^^^^^^^^^\n\n| Add ``forward-zones-file=/etc/pdns/blackhole.zone`` in your recursor\n  configuration.\n| Use the following ``zone_data`` in your ``dns-blackhole.yml``:\n\n.. code:: yaml\n\n    zone_data: '{domain}='\n\n``{domain}`` wil be replaced by the blackholed domains\n\nDnsmasq\n^^^^^^^\n\n| Add ``conf-dir=/etc/dnsmasq.d`` in your dnsmasq config and point your\n  ``zone_file`` option to ``/etc/dnsmasq.d/blackhole.conf``\n| Use the following ``zone_data`` in your ``dns-blackhole.yml``:\n\n.. code:: yaml\n\n    zone_data: 'server=/{domain}/'\n\n``{domain}`` wil be replaced by the blackholed domains\n\nHost file\n^^^^^^^^^\n\nUse the following ``zone_data`` in your ``dns-blackhole.yml``:\n\n.. code:: yaml\n\n    zone_data: '127.0.0.1 {domain}'\n\n| Once you're happy with your configuration Just run ``dns-blackhole``.\n| The default lists in ``dns-blackhole.yml`` will generate a zone\n  containing ~698000 entries.\n\nConfiguration\n-------------\n\nAs the configuration file is in YAML, you can use YAML anchors\n\n.. code:: yaml\n\n    dns-blackhole:\n      general:\n        cache: /var/cache/dns-blackhole\n        log: /var/log/dns-blackhole/dns-blackhole.log\n        whitelist: /etc/dns-blackhole/whitelist\n        blacklist: /etc/dns-blackhole/blacklist\n        blackhole_lists:\n          hosts:\n            - http://someonewhocares.org/hosts/hosts\n            - https://hosts-file.net/download/hosts.txt\n            - http://winhelp2002.mvps.org/hosts.txt\n            - http://www.malwaredomainlist.com/hostslist/hosts.txt\n            - https://pgl.yoyo.org/adservers/serverlist.php?hostformat=hosts;showintro=0\n          easylist: &bh_easy\n            - https://easylist.to/easylist/easylist.txt\n            - https://raw.githubusercontent.com/paulgb/BarbBlock/master/BarbBlock.txt\n          disconnect: &bh_disconnect\n            url: https://services.disconnect.me/disconnect-plaintext.json\n            categories: # Advertising, Analytics, Disconnect, Social\n              - Advertising\n              - Analytics\n      config:\n        zone_file: /etc/unbound/blackhole.zone\n        # {domain} will be replaced by the blackholed domain, do not change it here\n        zone_data: 'local-zone: \"{domain}\" always_nxdomain'\n        blackhole_lists:\n          hosts:\n            - http://winhelp2002.mvps.org/hosts.txt\n          easylist: *bh_easy\n          disconnect: *bh_disconnect\n\nIn this example you would keep ``easylist`` and ``disconnect`` lists,\nbut would remove all host file lists except mvps.\n\nFAQ\n---\n\nWhat's the advantage of having the DNS server returning NX instead of 127.0.0.1\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n| Host lists are usually returning ``127.0.0.1`` or ``0.0.0.0``.\n| Depending of the system and/or browser you use, you can end up having\n  timeout/slowness issues as it retries to connect several times before\n  considering the remote resource down.\n\nHaving your DNS server return NXDOMAIN - Non existant domain - on the\nother side makes your client behave faster as there's nothing to retry\nwhen the domain doesn't exist.\n\nWhy using forward-zones-file option instead of auth-zones in PowerDNS recursor?\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n| Syntax of the ``auth-zones`` is like this:\n  ``auth-zones=dom1=<zone>,dom2=<zone>,dom3=<zone>,etc``\n| While this may work for 5000 black holed domains, for almost 700 000\n  the speed of generation is so slow that it takes several tens of\n  minutes to complete. Even worse, with such a list, pdns-recursor is\n  not even able to start and will crash.\n| By using the ``forward-zones-file`` pdns-recursor takes around 5 more\n  seconds to process the zone file.\n\nWhich DNS server is the best?\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nIt's really a matter of preferences and what you have available. Use the\none you're the most comfortable with.\n\nTODO\n----\n\n-  Cache is not implemented yet\n-  Log is not implemented yet", "description_content_type": null, "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/coredumb/dns-blackhole", "keywords": "DNS blackhole", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "dns-blackhole", "package_url": "https://pypi.org/project/dns-blackhole/", "platform": "", "project_url": "https://pypi.org/project/dns-blackhole/", "project_urls": {"Homepage": "https://github.com/coredumb/dns-blackhole"}, "release_url": "https://pypi.org/project/dns-blackhole/0.12/", "requires_dist": null, "requires_python": "", "summary": "A generic DNS black hole zone generator", "version": "0.12", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div>\n<div>Most of code comes from here:\n<a href=\"http://git.mauras.ch/Various/powerdns_recursor_ads_blocking\" rel=\"nofollow\">http://git.mauras.ch/Various/powerdns_recursor_ads_blocking</a></div>\n<div>Check it for history.</div>\n</div>\n<div>\n<div>This script helps you create a blackhole zone for your DNS server,\nusing some well known ads/tracking/malware lists.</div>\n<div>As long as your DNS server allows to include a file containing one\ndomain per line with its config syntax it should work.</div>\n<div>Right now known to work and tested:</div>\n</div>\n<ul>\n<li><a href=\"https://www.unbound.net/\" rel=\"nofollow\">Unbound</a></li>\n<li><a href=\"https://www.powerdns.com/recursor.html\" rel=\"nofollow\">PowerDNS recursor</a></li>\n<li><a href=\"http://www.thekelleys.org.uk/dnsmasq/doc.html\" rel=\"nofollow\">Dnsmasq</a></li>\n</ul>\n<p>Generating an agregated host file is also possible.</p>\n<div id=\"features\">\n<h2>Features</h2>\n<ul>\n<li>Not bound to a specific DNS server, generates a file format of your\nchoice</li>\n<li>Supports 3 different list format<ul>\n<li>Host file</li>\n<li><a href=\"https://easylist.to/\" rel=\"nofollow\">Easylist</a></li>\n<li><a href=\"https://disconnect.me/\" rel=\"nofollow\">Disconnect</a></li>\n</ul>\n</li>\n<li>Lets you whitelist/blacklist domains</li>\n<li>YAML configuration file</li>\n</ul>\n</div>\n<div id=\"installation\">\n<h2>Installation</h2>\n<p>The script requires <tt>PyYAML</tt> and <tt>requests</tt> modules.</p>\n<pre>pip install <span class=\"o\">[</span>--upgrade<span class=\"o\">]</span> dns-blackhole\n</pre>\n<div id=\"unbound\">\n<h3>Unbound</h3>\n<div>\n<div>Requires unbound &gt;= <tt>1.6</tt>, using the default zone file with unbound\n<tt>1.5</tt> will certainly make it eat all your ram and swap before\ngetting killed.</div>\n<div>Add <tt>include: \"/etc/unbound/blackhole.zone\"</tt> right after your\n<tt>server:</tt> block.</div>\n<div>Use the following <tt>zone_data</tt> in your <tt><span class=\"pre\">dns-blackhole.yml</span></tt>\n(default):</div>\n</div>\n<pre><span class=\"nt\">zone_data</span><span class=\"p\">:</span> <span class=\"s\">'local-zone:</span><span class=\"nv\"> </span><span class=\"s\">\"{domain}\"</span><span class=\"nv\"> </span><span class=\"s\">always_nxdomain'</span>\n</pre>\n<p><tt>{domain}</tt> wil be replaced by the blackholed domains</p>\n</div>\n<div id=\"powerdns-recursor\">\n<h3>PowerDNS Recursor</h3>\n<div>\n<div>Add <tt><span class=\"pre\">forward-zones-file=/etc/pdns/blackhole.zone</span></tt> in your recursor\nconfiguration.</div>\n<div>Use the following <tt>zone_data</tt> in your <tt><span class=\"pre\">dns-blackhole.yml</span></tt>:</div>\n</div>\n<pre><span class=\"nt\">zone_data</span><span class=\"p\">:</span> <span class=\"s\">'{domain}='</span>\n</pre>\n<p><tt>{domain}</tt> wil be replaced by the blackholed domains</p>\n</div>\n<div id=\"dnsmasq\">\n<h3>Dnsmasq</h3>\n<div>\n<div>Add <tt><span class=\"pre\">conf-dir=/etc/dnsmasq.d</span></tt> in your dnsmasq config and point your\n<tt>zone_file</tt> option to <tt>/etc/dnsmasq.d/blackhole.conf</tt></div>\n<div>Use the following <tt>zone_data</tt> in your <tt><span class=\"pre\">dns-blackhole.yml</span></tt>:</div>\n</div>\n<pre><span class=\"nt\">zone_data</span><span class=\"p\">:</span> <span class=\"s\">'server=/{domain}/'</span>\n</pre>\n<p><tt>{domain}</tt> wil be replaced by the blackholed domains</p>\n</div>\n<div id=\"host-file\">\n<h3>Host file</h3>\n<p>Use the following <tt>zone_data</tt> in your <tt><span class=\"pre\">dns-blackhole.yml</span></tt>:</p>\n<pre><span class=\"nt\">zone_data</span><span class=\"p\">:</span> <span class=\"s\">'127.0.0.1</span><span class=\"nv\"> </span><span class=\"s\">{domain}'</span>\n</pre>\n<div>\n<div>Once you\u2019re happy with your configuration Just run <tt><span class=\"pre\">dns-blackhole</span></tt>.</div>\n<div>The default lists in <tt><span class=\"pre\">dns-blackhole.yml</span></tt> will generate a zone\ncontaining ~698000 entries.</div>\n</div>\n</div>\n</div>\n<div id=\"configuration\">\n<h2>Configuration</h2>\n<p>As the configuration file is in YAML, you can use YAML anchors</p>\n<pre><span class=\"nt\">dns-blackhole</span><span class=\"p\">:</span>\n  <span class=\"nt\">general</span><span class=\"p\">:</span>\n    <span class=\"nt\">cache</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">/var/cache/dns-blackhole</span>\n    <span class=\"nt\">log</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">/var/log/dns-blackhole/dns-blackhole.log</span>\n    <span class=\"nt\">whitelist</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">/etc/dns-blackhole/whitelist</span>\n    <span class=\"nt\">blacklist</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">/etc/dns-blackhole/blacklist</span>\n    <span class=\"nt\">blackhole_lists</span><span class=\"p\">:</span>\n      <span class=\"nt\">hosts</span><span class=\"p\">:</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">http://someonewhocares.org/hosts/hosts</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">https://hosts-file.net/download/hosts.txt</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">http://winhelp2002.mvps.org/hosts.txt</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">http://www.malwaredomainlist.com/hostslist/hosts.txt</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">https://pgl.yoyo.org/adservers/serverlist.php?hostformat=hosts;showintro=0</span>\n      <span class=\"nt\">easylist</span><span class=\"p\">:</span> <span class=\"nl\">&amp;bh_easy</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">https://easylist.to/easylist/easylist.txt</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">https://raw.githubusercontent.com/paulgb/BarbBlock/master/BarbBlock.txt</span>\n      <span class=\"nt\">disconnect</span><span class=\"p\">:</span> <span class=\"nl\">&amp;bh_disconnect</span>\n        <span class=\"nt\">url</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">https://services.disconnect.me/disconnect-plaintext.json</span>\n        <span class=\"nt\">categories</span><span class=\"p\">:</span> <span class=\"c1\"># Advertising, Analytics, Disconnect, Social</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">Advertising</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">Analytics</span>\n  <span class=\"nt\">config</span><span class=\"p\">:</span>\n    <span class=\"nt\">zone_file</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">/etc/unbound/blackhole.zone</span>\n    <span class=\"c1\"># {domain} will be replaced by the blackholed domain, do not change it here</span>\n    <span class=\"nt\">zone_data</span><span class=\"p\">:</span> <span class=\"s\">'local-zone:</span><span class=\"nv\"> </span><span class=\"s\">\"{domain}\"</span><span class=\"nv\"> </span><span class=\"s\">always_nxdomain'</span>\n    <span class=\"nt\">blackhole_lists</span><span class=\"p\">:</span>\n      <span class=\"nt\">hosts</span><span class=\"p\">:</span>\n        <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">http://winhelp2002.mvps.org/hosts.txt</span>\n      <span class=\"nt\">easylist</span><span class=\"p\">:</span> <span class=\"nv\">*bh_easy</span>\n      <span class=\"nt\">disconnect</span><span class=\"p\">:</span> <span class=\"nv\">*bh_disconnect</span>\n</pre>\n<p>In this example you would keep <tt>easylist</tt> and <tt>disconnect</tt> lists,\nbut would remove all host file lists except mvps.</p>\n</div>\n<div id=\"faq\">\n<h2>FAQ</h2>\n<div id=\"what-s-the-advantage-of-having-the-dns-server-returning-nx-instead-of-127-0-0-1\">\n<h3>What\u2019s the advantage of having the DNS server returning NX instead of 127.0.0.1</h3>\n<div>\n<div>Host lists are usually returning <tt>127.0.0.1</tt> or <tt>0.0.0.0</tt>.</div>\n<div>Depending of the system and/or browser you use, you can end up having\ntimeout/slowness issues as it retries to connect several times before\nconsidering the remote resource down.</div>\n</div>\n<p>Having your DNS server return NXDOMAIN - Non existant domain - on the\nother side makes your client behave faster as there\u2019s nothing to retry\nwhen the domain doesn\u2019t exist.</p>\n</div>\n<div id=\"why-using-forward-zones-file-option-instead-of-auth-zones-in-powerdns-recursor\">\n<h3>Why using forward-zones-file option instead of auth-zones in PowerDNS recursor?</h3>\n<div>\n<div>Syntax of the <tt><span class=\"pre\">auth-zones</span></tt> is like this:\n<tt><span class=\"pre\">auth-zones=dom1=&lt;zone&gt;,dom2=&lt;zone&gt;,dom3=&lt;zone&gt;,etc</span></tt></div>\n<div>While this may work for 5000 black holed domains, for almost 700 000\nthe speed of generation is so slow that it takes several tens of\nminutes to complete. Even worse, with such a list, pdns-recursor is\nnot even able to start and will crash.</div>\n<div>By using the <tt><span class=\"pre\">forward-zones-file</span></tt> pdns-recursor takes around 5 more\nseconds to process the zone file.</div>\n</div>\n</div>\n<div id=\"which-dns-server-is-the-best\">\n<h3>Which DNS server is the best?</h3>\n<p>It\u2019s really a matter of preferences and what you have available. Use the\none you\u2019re the most comfortable with.</p>\n</div>\n</div>\n<div id=\"todo\">\n<h2>TODO</h2>\n<ul>\n<li>Cache is not implemented yet</li>\n<li>Log is not implemented yet</li>\n</ul>\n</div>\n\n          </div>"}, "last_serial": 3204728, "releases": {"0.12": [{"comment_text": "", "digests": {"md5": "5666bd24069387aa6bd98da7545af368", "sha256": "b80b114092261cb2bae451838e4d398a427800af49f8682167e04f83163767ed"}, "downloads": -1, "filename": "dns-blackhole-0.12.tar.gz", "has_sig": false, "md5_digest": "5666bd24069387aa6bd98da7545af368", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7696, "upload_time": "2017-09-26T18:23:19", "upload_time_iso_8601": "2017-09-26T18:23:19.932066Z", "url": "https://files.pythonhosted.org/packages/fb/b5/fa36087c723eeea3fc67b92592d077de847cea6f73e54934c63b03902ba2/dns-blackhole-0.12.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "5666bd24069387aa6bd98da7545af368", "sha256": "b80b114092261cb2bae451838e4d398a427800af49f8682167e04f83163767ed"}, "downloads": -1, "filename": "dns-blackhole-0.12.tar.gz", "has_sig": false, "md5_digest": "5666bd24069387aa6bd98da7545af368", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7696, "upload_time": "2017-09-26T18:23:19", "upload_time_iso_8601": "2017-09-26T18:23:19.932066Z", "url": "https://files.pythonhosted.org/packages/fb/b5/fa36087c723eeea3fc67b92592d077de847cea6f73e54934c63b03902ba2/dns-blackhole-0.12.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:51:07 2020"}