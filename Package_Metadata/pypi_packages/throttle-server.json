{"info": {"author": "Markus klein", "author_email": "", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 2", "Programming Language :: Python :: 3"], "description": "# Throttle\n\nSemaphores for distributed systems.\n\n## Motivation\n\nThrottle provides semaphores as a service via an http interface. As the name indicates the primary usecase in mind is to throttle a systems access to a resource, by having the elements of that system to ask for permission (i.e. acquiring a lease) first. If the system consists of several process running on different machines, or virtual machines in the same Network, throttle might fit the bill.\n\nThrottle aims to be easy to operate, well-behaved in edge cases and works without a persistence backend.\n\n## Features\n\n* Server builds and runs on Windows, Linux, and OS-X.\n* Python Client is available.\n* Prevents Deadlocks, through enforcing lock hierarchies.\n* Fairness (longer waiting peers have priority)\n* Locks with large count, won't be starved by lots of others with a small counts.\n* Resilient against Network outages.\n  * Locks expire to prevent leaking semaphore count due to Network errors or client crashes.\n  * Locks can be prolonged indefinetly using heartbeats which are send to the server.\n* Observability\n  * Prometheus Metrics\n  * Logging to stderr or gelf server\n* No persistence backend is required.\n  * Server keeps state in memory.\n  * Clients restore state to the server, in case of server reboot.\n\n## Usage\n\n### Operating a Throttle server\n\n#### Starting and Shutdown\n\nAssuming the throttle executable to be in your path environment variable, you start a throttle sever by executing it. You can display the availible command line options using the `--help` flag. Starting it without any arguments is going to boot the server with default configuration.\n\n```bash\nthrottle\n```\n\nThis starts the server in the current process. Navigate with a browser to `localhost:8000` to see a welcoming message. You can shut Throttle down gracefully by pressing `Ctrl + C`.\n\n#### Default logging to stderr\n\nSet the `THROTTLE_LOG` environment variable to see more output on standard error. Valid values are `ERROR`, `WARN`, `INFO`, `DEBUG` and `TRACE`.\n\nIn bash:\n\n```bash\nTHROTTLE_LOG=WARN\n```\n\nor PowerShell:\n\n```shell\n$env:THROTLLE_LOG=\"INFO\"\n```\n\nStarting the server now yields more information.\n\n```log\n[2020-04-12T18:56:23Z INFO  throttle] Hello From Throttle\n[2020-04-12T18:56:23Z WARN  throttle] No semaphores configured.\n[2020-04-12T18:56:23Z INFO  actix_server::builder] Starting 8 workers\n[2020-04-12T18:56:23Z INFO  actix_server::builder] Starting \"actix-web-service-127.0.0.1:8000\" service on 127.0.0.1:8000\n[2020-04-12T18:56:23Z INFO  throttle::litter_collection] Start litter collection with interval: 300s\n```\n\n*Hint:* Enabling Gelf logging currently disables logging to standard error.\n\n#### Toml configuration file\n\nTo actually serve semaphores, we need to configure their names and full count. By default Throttle is looking for a configuration in the working directories `throttle.toml` file should it exist.\n\n```toml\n# Sample throttle.cfg Explaining the options\n\n# The time interval in which the litter collection backgroud thread checks for expired leases.\n# Default is set to 5 minutes.\nlitter_collection_interval = \"5min\"\n\n[semaphores]\n# Specify name and full count of semaphores. Below line creates a semaphore named A with a full\n# count of 42. Setting the count to 1 would create a Mutex.\nA = 42\n\n\n# Optional logging config, to log into graylog\n[logging.gelf]\nname = \"MyThrottleServer\"\nhost = \"my_graylog_instance.cloud\"\nport = 12201\n# Set this to either ERROR, WARN, INFO, DEBUG or TRACE.\nlevel = \"INFO\"\n\n\n## Optional logging config, to log to stderr. Can be overwritten using the `THROTTLE_LOG`\n## environment variable.\n# [logging.stderr]\n# Set this to either ERROR, WARN, INFO, DEBUG or TRACE.\n# level = \"INFO\"\n```\n\n#### Metrics\n\nThrottle supports Prometheus metrics, via the `/metrics` endpoint. Depending on your configuration and state they may e.g. look like this:\n\n```prometheus\n# HELP throttle_acquired Sum of all acquired locks.\n# TYPE throttle_acquired gauge\nthrottle_acquired{semaphore=\"A\"} 0\n# HELP throttle_longest_pending_sec Time the longest pending peer is waiting until now, to acquire a lock to a semaphore.\n# TYPE throttle_longest_pending_sec gauge\nthrottle_longest_pending_sec{semaphore=\"A\"} 0\n# HELP throttle_max Maximum allowed lock count for this semaphore.\n# TYPE throttle_max gauge\nthrottle_max{semaphore=\"A\"} 42\n# HELP throttle_num_404 Number of Get requests to unknown resource.\n# TYPE throttle_num_404 counter\nthrottle_num_404 0\n# HELP throttle_pending Sum of all pending locks\n# TYPE throttle_pending gauge\nthrottle_pending{semaphore=\"A\"} 0\n```\n\n### Python client\n\nThrottle ships with a Python client. Here is how to use it in a nutshell.\n\n```python\nfrom throttle_client import Peer, lock\n\n# Configure endpoint to throttle server\nurl = \"http://localhost:8000\"\n\n# Acquire a lock (with count 1) to semaphore A\nwith lock(url, \"A\"):\n    # Do stuff while holding lock to \"A\"\n    # ...\n\n# For acquiring lock count != 1 the count can be explicitly specified.\nwith lock(url, \"A\", count=4):\n    # Do stuff while holding lock to \"A\"\n    # ...\n\n# A is released at the end of with block\n```\n\n### Preventing Deadlocks with lock hierarchies\n\nAssume two semaphores `A` and `B`.\n\n```toml\n[semaphores]\nA = 1\nB = 1\n```\n\nYou want to acquire locks to them in a nested fashion:\n\n```python\nfrom throttle_client import Peer, lock\n\n# Configure endpoint to throttle server\nurl = \"http://localhost:8000\"\n\n# Acquire a lock to semaphore A\nwith lock(url, \"A\"):\n    # Do stuff while holding lock to \"A\"\n    # ...\n    with lock(url, \"B\") # <-- This throws an exception: \"Lock Hierarchy Violation\".\n      # ...\n\n```\n\nThe throttle server helps you preventing deadlocks. If `A` and `B` are not always locked in the same\norder, your system might deadlock at some point. Such errors can be hard to Debug, which is why\nthrottle fails early at any chance of deadlock. To enable the use case above, give `A` a lock level\nhigher than `B`.\n\n```toml\n[semaphores]\nA = { max=1, level=1 }\n# Level 0 is default. So the short notation is still good for B.\nB = 1\n```\n\n### Http routes\n\n* GET `/`: Prints a greeting message\n* GET `/health`: Always answers with `200 OK`\n* GET `/metrics:`: Metrics for prometheus\n* GET `/version`: Returns server version.\n\n#### Routes for managing peers and locks\n\n* POST `new_peer`: Creates a new peer. The body to this request must contain a human readable time duration with dimension in quotes. E.g.: `\"expires_in\": \"5m\"`, `\"expires_in\": \"30s\"` or `\"expires_in\": \"12h\"`. This is the time after which the peer is going to expire if not kept alive by prolonging its expiration time. Every lock acquired is always associated with a peer. If a peer expires, all locks are released. The request returns a random integer as peer id.\n* DELETE `/peer/{id}`: Removes the peer, releasing all its locks in the process. Every call to `new_peer` should be matched by a call to this route, so other peers do not have to wait for this peer to expire in order to acquire locks to the same semaphores.\n* PUT `/peer/{id}/{semaphore}`: Acquires lock to a semaphore for an existing peer. The body must contain the desired lock count. Throttle will answer either with `200 Ok` in case the lock could be acquired, or `202 Accepted` in case the lock can not be acquired until other peers release their lock. Specifying a lock count higher than the full count of the lock message or violating lock hierarchy will result in a `409 Conflict` error. Requesting a lock for an unknown semaphore or unknown peer is going to result in `400 Bad Request`. This request is idempotent, so acquiring locks can be repeated in case of a timeout, without risk of draining the semaphore. If waiting for a lock on the client side, busy waiting can be avoided using the optional `block_for` query parameter. E.g. `/peer/{id}/{semaphore}?block_for=10s`. The semantics for acquiring a lock with count `0` would be akward, so it's forbidden for now.\n* DELETE `/peer/{id}/{semaphore}`: Releases one specific lock for a peer.\n* POST `/restore`: Can be used by the client to react to a `400 Bad Request` those body contains `Unknown Semaphore`. This error indicates that the server does not remeber the clients state (e.g. the client may have expired due to prolonged connection loss). In this situation the client may choose to restore its previous state and acquired locks to the server. The body contains a JSON like this:\n\n  ```json\n  {\n    \"expires_in\": \"5m\",\n    \"peer_id\": 42,\n    \"acquired\": {\n      \"A\": 3,\n      \"B\": 1\n    }\n  }\n  ```\n\n  This would restore a client with id `42` and a lifetime of 5 minutes. It has a lock with count 3 to `A` and one with count 1 to `B`.\n* `Get` `/remainder?semaphore={semaphore}`: Answers the maximum semaphore count minus the sum of all acquired locks for this semaphore. Response is a plain text integer.\n* `Get` `/peers/{id}/is_acquired`: Answers `false` if peer has a pending lock. If all the locks of the peer are acquired the answer is `true`.\n\n## Installation\n\n### Server\n\nThe server binary is published to [crates.io](https://crates.io) and thus installable via cargo.\n\n```bash\ncargo install throttle-server\n```\n\nAlternativly there are ready to use binaries deployed to PyPI, which can be installed via pip:\n\n```bash\npip install throttle-server\n```\n\nThis has been done manly for the convinience of Python users, who want to try out the client without installing a Rust toolchain.\n\n### Python Client\n\nPython client is publish to [PyPi](https://pypi.org) and can be installed using pip.\n\n```bash\npip install throttle-client\n```\n\n## Local build and test setup\n\n* Install Rust compiler and Cargo. Follow the instructions on\n  [this site](https://www.rust-lang.org/en-US/install.html)\n* Checkout the sources with\n\n  ```bash\n  git clone https://github.com/pacman82/throttle.git\n  ```\n\n* You can run the build and run unit tests by executing\n\n  ```bash\n  cd throttle\n  cargo test\n  ```\n\n* Execute integration test with clients\n\n  ```bash\n  cd python_client\n  pip install -r test-requirements.txt\n  pip install -e .\n  pytest\n  ```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/pacman82/throttle", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "throttle-server", "package_url": "https://pypi.org/project/throttle-server/", "platform": "", "project_url": "https://pypi.org/project/throttle-server/", "project_urls": {"Homepage": "https://github.com/pacman82/throttle"}, "release_url": "https://pypi.org/project/throttle-server/0.3.6/", "requires_dist": null, "requires_python": "", "summary": "Throttle server. Throttle is a http semaphore service, providingsemaphores for distributed systems. Packaged as a wheel for the convinience ofPython users.", "version": "0.3.6", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Throttle</h1>\n<p>Semaphores for distributed systems.</p>\n<h2>Motivation</h2>\n<p>Throttle provides semaphores as a service via an http interface. As the name indicates the primary usecase in mind is to throttle a systems access to a resource, by having the elements of that system to ask for permission (i.e. acquiring a lease) first. If the system consists of several process running on different machines, or virtual machines in the same Network, throttle might fit the bill.</p>\n<p>Throttle aims to be easy to operate, well-behaved in edge cases and works without a persistence backend.</p>\n<h2>Features</h2>\n<ul>\n<li>Server builds and runs on Windows, Linux, and OS-X.</li>\n<li>Python Client is available.</li>\n<li>Prevents Deadlocks, through enforcing lock hierarchies.</li>\n<li>Fairness (longer waiting peers have priority)</li>\n<li>Locks with large count, won't be starved by lots of others with a small counts.</li>\n<li>Resilient against Network outages.\n<ul>\n<li>Locks expire to prevent leaking semaphore count due to Network errors or client crashes.</li>\n<li>Locks can be prolonged indefinetly using heartbeats which are send to the server.</li>\n</ul>\n</li>\n<li>Observability\n<ul>\n<li>Prometheus Metrics</li>\n<li>Logging to stderr or gelf server</li>\n</ul>\n</li>\n<li>No persistence backend is required.\n<ul>\n<li>Server keeps state in memory.</li>\n<li>Clients restore state to the server, in case of server reboot.</li>\n</ul>\n</li>\n</ul>\n<h2>Usage</h2>\n<h3>Operating a Throttle server</h3>\n<h4>Starting and Shutdown</h4>\n<p>Assuming the throttle executable to be in your path environment variable, you start a throttle sever by executing it. You can display the availible command line options using the <code>--help</code> flag. Starting it without any arguments is going to boot the server with default configuration.</p>\n<pre>throttle\n</pre>\n<p>This starts the server in the current process. Navigate with a browser to <code>localhost:8000</code> to see a welcoming message. You can shut Throttle down gracefully by pressing <code>Ctrl + C</code>.</p>\n<h4>Default logging to stderr</h4>\n<p>Set the <code>THROTTLE_LOG</code> environment variable to see more output on standard error. Valid values are <code>ERROR</code>, <code>WARN</code>, <code>INFO</code>, <code>DEBUG</code> and <code>TRACE</code>.</p>\n<p>In bash:</p>\n<pre><span class=\"nv\">THROTTLE_LOG</span><span class=\"o\">=</span>WARN\n</pre>\n<p>or PowerShell:</p>\n<pre><span class=\"nv\">$env</span>:THROTLLE_LOG<span class=\"o\">=</span><span class=\"s2\">\"INFO\"</span>\n</pre>\n<p>Starting the server now yields more information.</p>\n<pre>[2020-04-12T18:56:23Z INFO  throttle] Hello From Throttle\n[2020-04-12T18:56:23Z WARN  throttle] No semaphores configured.\n[2020-04-12T18:56:23Z INFO  actix_server::builder] Starting 8 workers\n[2020-04-12T18:56:23Z INFO  actix_server::builder] Starting \"actix-web-service-127.0.0.1:8000\" service on 127.0.0.1:8000\n[2020-04-12T18:56:23Z INFO  throttle::litter_collection] Start litter collection with interval: 300s\n</pre>\n<p><em>Hint:</em> Enabling Gelf logging currently disables logging to standard error.</p>\n<h4>Toml configuration file</h4>\n<p>To actually serve semaphores, we need to configure their names and full count. By default Throttle is looking for a configuration in the working directories <code>throttle.toml</code> file should it exist.</p>\n<pre><span class=\"c1\"># Sample throttle.cfg Explaining the options</span>\n\n<span class=\"c1\"># The time interval in which the litter collection backgroud thread checks for expired leases.</span>\n<span class=\"c1\"># Default is set to 5 minutes.</span>\n<span class=\"n\">litter_collection_interval</span> <span class=\"o\">=</span> <span class=\"s\">\"5min\"</span>\n\n<span class=\"k\">[semaphores]</span>\n<span class=\"c1\"># Specify name and full count of semaphores. Below line creates a semaphore named A with a full</span>\n<span class=\"c1\"># count of 42. Setting the count to 1 would create a Mutex.</span>\n<span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"mi\">42</span>\n\n\n<span class=\"c1\"># Optional logging config, to log into graylog</span>\n<span class=\"k\">[logging.gelf]</span>\n<span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s\">\"MyThrottleServer\"</span>\n<span class=\"n\">host</span> <span class=\"o\">=</span> <span class=\"s\">\"my_graylog_instance.cloud\"</span>\n<span class=\"n\">port</span> <span class=\"o\">=</span> <span class=\"mi\">12201</span>\n<span class=\"c1\"># Set this to either ERROR, WARN, INFO, DEBUG or TRACE.</span>\n<span class=\"n\">level</span> <span class=\"o\">=</span> <span class=\"s\">\"INFO\"</span>\n\n\n<span class=\"c1\">## Optional logging config, to log to stderr. Can be overwritten using the `THROTTLE_LOG`</span>\n<span class=\"c1\">## environment variable.</span>\n<span class=\"c1\"># [logging.stderr]</span>\n<span class=\"c1\"># Set this to either ERROR, WARN, INFO, DEBUG or TRACE.</span>\n<span class=\"c1\"># level = \"INFO\"</span>\n</pre>\n<h4>Metrics</h4>\n<p>Throttle supports Prometheus metrics, via the <code>/metrics</code> endpoint. Depending on your configuration and state they may e.g. look like this:</p>\n<pre># HELP throttle_acquired Sum of all acquired locks.\n# TYPE throttle_acquired gauge\nthrottle_acquired{semaphore=\"A\"} 0\n# HELP throttle_longest_pending_sec Time the longest pending peer is waiting until now, to acquire a lock to a semaphore.\n# TYPE throttle_longest_pending_sec gauge\nthrottle_longest_pending_sec{semaphore=\"A\"} 0\n# HELP throttle_max Maximum allowed lock count for this semaphore.\n# TYPE throttle_max gauge\nthrottle_max{semaphore=\"A\"} 42\n# HELP throttle_num_404 Number of Get requests to unknown resource.\n# TYPE throttle_num_404 counter\nthrottle_num_404 0\n# HELP throttle_pending Sum of all pending locks\n# TYPE throttle_pending gauge\nthrottle_pending{semaphore=\"A\"} 0\n</pre>\n<h3>Python client</h3>\n<p>Throttle ships with a Python client. Here is how to use it in a nutshell.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">throttle_client</span> <span class=\"kn\">import</span> <span class=\"n\">Peer</span><span class=\"p\">,</span> <span class=\"n\">lock</span>\n\n<span class=\"c1\"># Configure endpoint to throttle server</span>\n<span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"http://localhost:8000\"</span>\n\n<span class=\"c1\"># Acquire a lock (with count 1) to semaphore A</span>\n<span class=\"k\">with</span> <span class=\"n\">lock</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"s2\">\"A\"</span><span class=\"p\">):</span>\n    <span class=\"c1\"># Do stuff while holding lock to \"A\"</span>\n    <span class=\"c1\"># ...</span>\n\n<span class=\"c1\"># For acquiring lock count != 1 the count can be explicitly specified.</span>\n<span class=\"k\">with</span> <span class=\"n\">lock</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"s2\">\"A\"</span><span class=\"p\">,</span> <span class=\"n\">count</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">):</span>\n    <span class=\"c1\"># Do stuff while holding lock to \"A\"</span>\n    <span class=\"c1\"># ...</span>\n\n<span class=\"c1\"># A is released at the end of with block</span>\n</pre>\n<h3>Preventing Deadlocks with lock hierarchies</h3>\n<p>Assume two semaphores <code>A</code> and <code>B</code>.</p>\n<pre><span class=\"k\">[semaphores]</span>\n<span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n<span class=\"n\">B</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n</pre>\n<p>You want to acquire locks to them in a nested fashion:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">throttle_client</span> <span class=\"kn\">import</span> <span class=\"n\">Peer</span><span class=\"p\">,</span> <span class=\"n\">lock</span>\n\n<span class=\"c1\"># Configure endpoint to throttle server</span>\n<span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"http://localhost:8000\"</span>\n\n<span class=\"c1\"># Acquire a lock to semaphore A</span>\n<span class=\"k\">with</span> <span class=\"n\">lock</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"s2\">\"A\"</span><span class=\"p\">):</span>\n    <span class=\"c1\"># Do stuff while holding lock to \"A\"</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"k\">with</span> <span class=\"n\">lock</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"s2\">\"B\"</span><span class=\"p\">)</span> <span class=\"c1\"># &lt;-- This throws an exception: \"Lock Hierarchy Violation\".</span>\n      <span class=\"c1\"># ...</span>\n</pre>\n<p>The throttle server helps you preventing deadlocks. If <code>A</code> and <code>B</code> are not always locked in the same\norder, your system might deadlock at some point. Such errors can be hard to Debug, which is why\nthrottle fails early at any chance of deadlock. To enable the use case above, give <code>A</code> a lock level\nhigher than <code>B</code>.</p>\n<pre><span class=\"k\">[semaphores]</span>\n<span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"n\">max</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">1</span> <span class=\"p\">}</span>\n<span class=\"c1\"># Level 0 is default. So the short notation is still good for B.</span>\n<span class=\"n\">B</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n</pre>\n<h3>Http routes</h3>\n<ul>\n<li>GET <code>/</code>: Prints a greeting message</li>\n<li>GET <code>/health</code>: Always answers with <code>200 OK</code></li>\n<li>GET <code>/metrics:</code>: Metrics for prometheus</li>\n<li>GET <code>/version</code>: Returns server version.</li>\n</ul>\n<h4>Routes for managing peers and locks</h4>\n<ul>\n<li>\n<p>POST <code>new_peer</code>: Creates a new peer. The body to this request must contain a human readable time duration with dimension in quotes. E.g.: <code>\"expires_in\": \"5m\"</code>, <code>\"expires_in\": \"30s\"</code> or <code>\"expires_in\": \"12h\"</code>. This is the time after which the peer is going to expire if not kept alive by prolonging its expiration time. Every lock acquired is always associated with a peer. If a peer expires, all locks are released. The request returns a random integer as peer id.</p>\n</li>\n<li>\n<p>DELETE <code>/peer/{id}</code>: Removes the peer, releasing all its locks in the process. Every call to <code>new_peer</code> should be matched by a call to this route, so other peers do not have to wait for this peer to expire in order to acquire locks to the same semaphores.</p>\n</li>\n<li>\n<p>PUT <code>/peer/{id}/{semaphore}</code>: Acquires lock to a semaphore for an existing peer. The body must contain the desired lock count. Throttle will answer either with <code>200 Ok</code> in case the lock could be acquired, or <code>202 Accepted</code> in case the lock can not be acquired until other peers release their lock. Specifying a lock count higher than the full count of the lock message or violating lock hierarchy will result in a <code>409 Conflict</code> error. Requesting a lock for an unknown semaphore or unknown peer is going to result in <code>400 Bad Request</code>. This request is idempotent, so acquiring locks can be repeated in case of a timeout, without risk of draining the semaphore. If waiting for a lock on the client side, busy waiting can be avoided using the optional <code>block_for</code> query parameter. E.g. <code>/peer/{id}/{semaphore}?block_for=10s</code>. The semantics for acquiring a lock with count <code>0</code> would be akward, so it's forbidden for now.</p>\n</li>\n<li>\n<p>DELETE <code>/peer/{id}/{semaphore}</code>: Releases one specific lock for a peer.</p>\n</li>\n<li>\n<p>POST <code>/restore</code>: Can be used by the client to react to a <code>400 Bad Request</code> those body contains <code>Unknown Semaphore</code>. This error indicates that the server does not remeber the clients state (e.g. the client may have expired due to prolonged connection loss). In this situation the client may choose to restore its previous state and acquired locks to the server. The body contains a JSON like this:</p>\n<pre><span class=\"p\">{</span>\n  <span class=\"nt\">\"expires_in\"</span><span class=\"p\">:</span> <span class=\"s2\">\"5m\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"peer_id\"</span><span class=\"p\">:</span> <span class=\"mi\">42</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"acquired\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"A\"</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"B\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre>\n<p>This would restore a client with id <code>42</code> and a lifetime of 5 minutes. It has a lock with count 3 to <code>A</code> and one with count 1 to <code>B</code>.</p>\n</li>\n<li>\n<p><code>Get</code> <code>/remainder?semaphore={semaphore}</code>: Answers the maximum semaphore count minus the sum of all acquired locks for this semaphore. Response is a plain text integer.</p>\n</li>\n<li>\n<p><code>Get</code> <code>/peers/{id}/is_acquired</code>: Answers <code>false</code> if peer has a pending lock. If all the locks of the peer are acquired the answer is <code>true</code>.</p>\n</li>\n</ul>\n<h2>Installation</h2>\n<h3>Server</h3>\n<p>The server binary is published to <a href=\"https://crates.io\" rel=\"nofollow\">crates.io</a> and thus installable via cargo.</p>\n<pre>cargo install throttle-server\n</pre>\n<p>Alternativly there are ready to use binaries deployed to PyPI, which can be installed via pip:</p>\n<pre>pip install throttle-server\n</pre>\n<p>This has been done manly for the convinience of Python users, who want to try out the client without installing a Rust toolchain.</p>\n<h3>Python Client</h3>\n<p>Python client is publish to <a href=\"https://pypi.org\" rel=\"nofollow\">PyPi</a> and can be installed using pip.</p>\n<pre>pip install throttle-client\n</pre>\n<h2>Local build and test setup</h2>\n<ul>\n<li>\n<p>Install Rust compiler and Cargo. Follow the instructions on\n<a href=\"https://www.rust-lang.org/en-US/install.html\" rel=\"nofollow\">this site</a></p>\n</li>\n<li>\n<p>Checkout the sources with</p>\n<pre>git clone https://github.com/pacman82/throttle.git\n</pre>\n</li>\n<li>\n<p>You can run the build and run unit tests by executing</p>\n<pre><span class=\"nb\">cd</span> throttle\ncargo <span class=\"nb\">test</span>\n</pre>\n</li>\n<li>\n<p>Execute integration test with clients</p>\n<pre><span class=\"nb\">cd</span> python_client\npip install -r test-requirements.txt\npip install -e .\npytest\n</pre>\n</li>\n</ul>\n\n          </div>"}, "last_serial": 7118542, "releases": {"0.3.0": [{"comment_text": "", "digests": {"md5": "033067bbf52317704b57caebccc92147", "sha256": "1d46c32e3147dba7aeefd5bb8044500526ecc24d8cdde0ee9668da94d0b99cf8"}, "downloads": -1, "filename": "throttle_server-0.3.0-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "033067bbf52317704b57caebccc92147", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1825244, "upload_time": "2020-04-25T11:43:14", "upload_time_iso_8601": "2020-04-25T11:43:14.131571Z", "url": "https://files.pythonhosted.org/packages/88/5f/7f2cb1b763ff858088adfd1af47b3ff48ecfffa64e311d7b35322ccb6e30/throttle_server-0.3.0-py2.py3-none-win_amd64.whl", "yanked": false}], "0.3.3": [{"comment_text": "", "digests": {"md5": "c1c3bea78f577d36429ccb34f8223699", "sha256": "65148e2e25fd7393bb3dc12f48bf9a6c63dbe9aa538fbfa60257ac770fc0d5ed"}, "downloads": -1, "filename": "throttle_server-0.3.3-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "c1c3bea78f577d36429ccb34f8223699", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1787238, "upload_time": "2020-04-25T11:43:38", "upload_time_iso_8601": "2020-04-25T11:43:38.123762Z", "url": "https://files.pythonhosted.org/packages/b2/30/b84bfd6b2e5dcd1f99b0a75bf4be1c42492d4871ae138edd3d933322685f/throttle_server-0.3.3-py2.py3-none-win_amd64.whl", "yanked": false}], "0.3.4": [{"comment_text": "", "digests": {"md5": "8e31731604c374610e59e274e03c952e", "sha256": "25559f26996ea878129614c8b55e3cca2a34fd249e8180340f240cad3fee8d82"}, "downloads": -1, "filename": "throttle_server-0.3.4-cp38-cp38-macosx_10_13_x86_64.whl", "has_sig": false, "md5_digest": "8e31731604c374610e59e274e03c952e", "packagetype": "bdist_wheel", "python_version": "cp38", "requires_python": null, "size": 2109810, "upload_time": "2020-04-25T13:17:32", "upload_time_iso_8601": "2020-04-25T13:17:32.540650Z", "url": "https://files.pythonhosted.org/packages/6c/1d/da4883591e2510554bdd99a63195106bbd41ae18d02f490cd53c5d2f6422/throttle_server-0.3.4-cp38-cp38-macosx_10_13_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f78c6df994b47cf40af5f7866118bcd1", "sha256": "9208fa094c3719f3bde8ccdd36619121c71d6dd48e02cfdba7f8b66e10a2dad1"}, "downloads": -1, "filename": "throttle_server-0.3.4-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "f78c6df994b47cf40af5f7866118bcd1", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1815261, "upload_time": "2020-04-25T13:23:11", "upload_time_iso_8601": "2020-04-25T13:23:11.800552Z", "url": "https://files.pythonhosted.org/packages/f3/3f/6a6a3ed851dc7cc46ceeb4e98d78671699a50c51b219b06b94dc494714fb/throttle_server-0.3.4-py2.py3-none-win_amd64.whl", "yanked": false}], "0.3.5": [{"comment_text": "", "digests": {"md5": "f8736fda367ac098fa63138e96dba7b6", "sha256": "b15df5f57d59f86b55ba41d101000e4a462d263f8dc4feeb5171893a90b42b8f"}, "downloads": -1, "filename": "throttle_server-0.3.5-cp38-cp38-macosx_10_13_x86_64.whl", "has_sig": false, "md5_digest": "f8736fda367ac098fa63138e96dba7b6", "packagetype": "bdist_wheel", "python_version": "cp38", "requires_python": null, "size": 2105611, "upload_time": "2020-04-28T07:06:22", "upload_time_iso_8601": "2020-04-28T07:06:22.799774Z", "url": "https://files.pythonhosted.org/packages/b1/98/652486ad1505feb7be450efeb17a6b462b622cfcdbdbd64c5edfbeef228e/throttle_server-0.3.5-cp38-cp38-macosx_10_13_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "5a2535b480c461590fdf528283bae148", "sha256": "32f909895723485424f26ae46d98f43e229a27e0d9e5ee37cd43bbb79b38e0ae"}, "downloads": -1, "filename": "throttle_server-0.3.5-cp38-cp38-manylinux1_x86_64.whl", "has_sig": false, "md5_digest": "5a2535b480c461590fdf528283bae148", "packagetype": "bdist_wheel", "python_version": "cp38", "requires_python": null, "size": 2420101, "upload_time": "2020-04-28T07:16:09", "upload_time_iso_8601": "2020-04-28T07:16:09.438326Z", "url": "https://files.pythonhosted.org/packages/2e/eb/68836a054d159115ff96c5f40145b5b3cc52b04c11d40a390796ffbd7f4c/throttle_server-0.3.5-cp38-cp38-manylinux1_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "0b511952ea79034e6ed7dafd2d1e5c5d", "sha256": "f0f1a9f5633a80b8552fce789894b7302e625de356b63ef71a2290e76c26482e"}, "downloads": -1, "filename": "throttle_server-0.3.5-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "0b511952ea79034e6ed7dafd2d1e5c5d", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1816477, "upload_time": "2020-04-28T07:12:37", "upload_time_iso_8601": "2020-04-28T07:12:37.924933Z", "url": "https://files.pythonhosted.org/packages/7a/e1/9e038930d4abf58e014250f3c7543d64ff1403bbbb3ae0c7805606adbcfb/throttle_server-0.3.5-py2.py3-none-win_amd64.whl", "yanked": false}], "0.3.6": [{"comment_text": "", "digests": {"md5": "9c8154d0ab020a5fbb7e2b1c0a3bfa2f", "sha256": "bc9b570ac98e54c2f4f94a5d39f5ad35418445f5fe9aff3a7c1fa04640c9f9a6"}, "downloads": -1, "filename": "throttle_server-0.3.6-cp38-cp38-macosx_10_13_x86_64.whl", "has_sig": false, "md5_digest": "9c8154d0ab020a5fbb7e2b1c0a3bfa2f", "packagetype": "bdist_wheel", "python_version": "cp38", "requires_python": null, "size": 2108634, "upload_time": "2020-04-28T08:59:58", "upload_time_iso_8601": "2020-04-28T08:59:58.514579Z", "url": "https://files.pythonhosted.org/packages/c1/39/7f5e6b23f86548dd988d91c5429db09b0dff1b3337cb8822f18976eadc5f/throttle_server-0.3.6-cp38-cp38-macosx_10_13_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "570dcef4e5ababed854e37d6927ce566", "sha256": "8933cda4293ea73970c438921221f708bf56e3ebdcd33bdc1053f7c4abde8a04"}, "downloads": -1, "filename": "throttle_server-0.3.6-py2.py3-none-manylinux1_x86_64.whl", "has_sig": false, "md5_digest": "570dcef4e5ababed854e37d6927ce566", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 2421392, "upload_time": "2020-04-28T09:11:59", "upload_time_iso_8601": "2020-04-28T09:11:59.315577Z", "url": "https://files.pythonhosted.org/packages/53/38/5ae3a0641dbad22a8938dbdb36e8b96f845b5bbf5c778a1f25c861fea0f9/throttle_server-0.3.6-py2.py3-none-manylinux1_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "da22170e3049683a4ec4f3c57198934c", "sha256": "9155f35217becab1c2576f9b0410418e96d15c791f36e557ff39161454a46e3e"}, "downloads": -1, "filename": "throttle_server-0.3.6-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "da22170e3049683a4ec4f3c57198934c", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1814689, "upload_time": "2020-04-28T09:05:47", "upload_time_iso_8601": "2020-04-28T09:05:47.945093Z", "url": "https://files.pythonhosted.org/packages/96/ba/b26d1a476d5b25b53bc506bb3a6a1d2080058af33b0363fd55ed2f914b6f/throttle_server-0.3.6-py2.py3-none-win_amd64.whl", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "9c8154d0ab020a5fbb7e2b1c0a3bfa2f", "sha256": "bc9b570ac98e54c2f4f94a5d39f5ad35418445f5fe9aff3a7c1fa04640c9f9a6"}, "downloads": -1, "filename": "throttle_server-0.3.6-cp38-cp38-macosx_10_13_x86_64.whl", "has_sig": false, "md5_digest": "9c8154d0ab020a5fbb7e2b1c0a3bfa2f", "packagetype": "bdist_wheel", "python_version": "cp38", "requires_python": null, "size": 2108634, "upload_time": "2020-04-28T08:59:58", "upload_time_iso_8601": "2020-04-28T08:59:58.514579Z", "url": "https://files.pythonhosted.org/packages/c1/39/7f5e6b23f86548dd988d91c5429db09b0dff1b3337cb8822f18976eadc5f/throttle_server-0.3.6-cp38-cp38-macosx_10_13_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "570dcef4e5ababed854e37d6927ce566", "sha256": "8933cda4293ea73970c438921221f708bf56e3ebdcd33bdc1053f7c4abde8a04"}, "downloads": -1, "filename": "throttle_server-0.3.6-py2.py3-none-manylinux1_x86_64.whl", "has_sig": false, "md5_digest": "570dcef4e5ababed854e37d6927ce566", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 2421392, "upload_time": "2020-04-28T09:11:59", "upload_time_iso_8601": "2020-04-28T09:11:59.315577Z", "url": "https://files.pythonhosted.org/packages/53/38/5ae3a0641dbad22a8938dbdb36e8b96f845b5bbf5c778a1f25c861fea0f9/throttle_server-0.3.6-py2.py3-none-manylinux1_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "da22170e3049683a4ec4f3c57198934c", "sha256": "9155f35217becab1c2576f9b0410418e96d15c791f36e557ff39161454a46e3e"}, "downloads": -1, "filename": "throttle_server-0.3.6-py2.py3-none-win_amd64.whl", "has_sig": false, "md5_digest": "da22170e3049683a4ec4f3c57198934c", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 1814689, "upload_time": "2020-04-28T09:05:47", "upload_time_iso_8601": "2020-04-28T09:05:47.945093Z", "url": "https://files.pythonhosted.org/packages/96/ba/b26d1a476d5b25b53bc506bb3a6a1d2080058af33b0363fd55ed2f914b6f/throttle_server-0.3.6-py2.py3-none-win_amd64.whl", "yanked": false}], "timestamp": "Fri May  8 02:53:39 2020"}