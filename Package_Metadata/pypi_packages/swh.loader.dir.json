{"info": {"author": "Software Heritage developers", "author_email": "swh-devel@inria.fr", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Developers", "License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "SWH-loader-dir\n===================\n\nThe Software Heritage Directory Loader is a tool and a library.\n\nIts sole purpose is to walk a local directory and inject into the SWH\ndataset all unknown contained files from that directory structure.\n\n\n## Configuration\n\nThe loader needs a configuration file in *`{/etc/softwareheritage |\n~/.config/swh | ~/.swh}`/loader/dir.yml*.\n\nThis file should be similar to this (adapt according to your needs)\u0018:\n\n``` yaml\nstorage:\n  cls: remote\n  args:\n    url: http://localhost:5002/\n```\n\n## Run\n\nTo run the loader, you can use either:\n\n- python3's toplevel\n- celery\n\n### Toplevel\n\nLoad directory directly from code or toplevel:\n\n``` Python\ndir_path = '/home/storage/dir/'\n\n# Fill in those\norigin = {'url': 'some-origin', 'type': 'dir'}\nvisit_date = 'Tue, 3 May 2017 17:16:32 +0200'\nrevision = {\n    'author': {'name': 'some', 'fullname': 'one', 'email': 'something'},\n    'committer': {'name': 'some', 'fullname': 'one', 'email': 'something'},\n    'message': '1.0 Released',\n    'date': None,\n    'committer_date': None,\n    'type': 'tar',\n    'metadata': {}\n}\nimport logging\nlogging.basicConfig(level=logging.DEBUG)\n\nfrom swh.loader.dir.tasks import LoadDirRepository\nl = LoadDirRepository()\nl.run_task(dir_path=dir_path, origin=origin, visit_date=visit_date,\n           revision=revision, release=None, branch_name='master')\n```\n\n### Celery\n\nTo use celery, add the following entries in the\n*`{/etc/softwareheritage | ~/.config/swh | ~/.swh}`/worker.yml*` file:\n\n``` yaml\ntask_modules:\n  - swh.loader.dir.tasks\ntask_queues:\n  - swh_loader_dir\n```\n\ncf. [swh-core's documentation](https://forge.softwareheritage.org/diffusion/DCORE/browse/master/README.md) for\nmore details.\n\nYou can then send the following message to the task queue:\n\n``` Python\nfrom swh.loader.dir.tasks import LoadDirRepository\n\n# Fill in those\norigin = {'url': 'some-origin', 'type': 'dir'}\nvisit_date = 'Tue, 3 May 2017 17:16:32 +0200'\nrelease = None\nrevision = {}\noccurrence = {}\n\n# Send message to the task queue\nLoaderDirRepository().run(('/path/to/dir', origin, visit_date, revision, release, [occurrence]))\n```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://forge.softwareheritage.org/diffusion/DLDDIR", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "swh.loader.dir", "package_url": "https://pypi.org/project/swh.loader.dir/", "platform": "", "project_url": "https://pypi.org/project/swh.loader.dir/", "project_urls": {"Bug Reports": "https://forge.softwareheritage.org/maniphest", "Funding": "https://www.softwareheritage.org/donate", "Homepage": "https://forge.softwareheritage.org/diffusion/DLDDIR", "Source": "https://forge.softwareheritage.org/source/swh-loader-dir"}, "release_url": "https://pypi.org/project/swh.loader.dir/0.0.35/", "requires_dist": ["vcversioner", "retrying", "click", "swh.model (>=0.0.27)", "swh.scheduler (>=0.0.39)", "swh.storage (>=0.0.83)", "swh.loader.core (>=0.0.35)", "pytest ; extra == 'testing'"], "requires_python": "", "summary": "Software Heritage Directory Loader", "version": "0.0.35", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>SWH-loader-dir</h1>\n<p>The Software Heritage Directory Loader is a tool and a library.</p>\n<p>Its sole purpose is to walk a local directory and inject into the SWH\ndataset all unknown contained files from that directory structure.</p>\n<h2>Configuration</h2>\n<p>The loader needs a configuration file in <em><code>{/etc/softwareheritage | ~/.config/swh | ~/.swh}</code>/loader/dir.yml</em>.</p>\n<p>This file should be similar to this (adapt according to your needs)?:</p>\n<pre><span class=\"nt\">storage</span><span class=\"p\">:</span>\n  <span class=\"nt\">cls</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">remote</span>\n  <span class=\"nt\">args</span><span class=\"p\">:</span>\n    <span class=\"nt\">url</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://localhost:5002/</span>\n</pre>\n<h2>Run</h2>\n<p>To run the loader, you can use either:</p>\n<ul>\n<li>python3's toplevel</li>\n<li>celery</li>\n</ul>\n<h3>Toplevel</h3>\n<p>Load directory directly from code or toplevel:</p>\n<pre><span class=\"n\">dir_path</span> <span class=\"o\">=</span> <span class=\"s1\">'/home/storage/dir/'</span>\n\n<span class=\"c1\"># Fill in those</span>\n<span class=\"n\">origin</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'url'</span><span class=\"p\">:</span> <span class=\"s1\">'some-origin'</span><span class=\"p\">,</span> <span class=\"s1\">'type'</span><span class=\"p\">:</span> <span class=\"s1\">'dir'</span><span class=\"p\">}</span>\n<span class=\"n\">visit_date</span> <span class=\"o\">=</span> <span class=\"s1\">'Tue, 3 May 2017 17:16:32 +0200'</span>\n<span class=\"n\">revision</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'author'</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">'name'</span><span class=\"p\">:</span> <span class=\"s1\">'some'</span><span class=\"p\">,</span> <span class=\"s1\">'fullname'</span><span class=\"p\">:</span> <span class=\"s1\">'one'</span><span class=\"p\">,</span> <span class=\"s1\">'email'</span><span class=\"p\">:</span> <span class=\"s1\">'something'</span><span class=\"p\">},</span>\n    <span class=\"s1\">'committer'</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">'name'</span><span class=\"p\">:</span> <span class=\"s1\">'some'</span><span class=\"p\">,</span> <span class=\"s1\">'fullname'</span><span class=\"p\">:</span> <span class=\"s1\">'one'</span><span class=\"p\">,</span> <span class=\"s1\">'email'</span><span class=\"p\">:</span> <span class=\"s1\">'something'</span><span class=\"p\">},</span>\n    <span class=\"s1\">'message'</span><span class=\"p\">:</span> <span class=\"s1\">'1.0 Released'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'date'</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"s1\">'committer_date'</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"s1\">'type'</span><span class=\"p\">:</span> <span class=\"s1\">'tar'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'metadata'</span><span class=\"p\">:</span> <span class=\"p\">{}</span>\n<span class=\"p\">}</span>\n<span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">basicConfig</span><span class=\"p\">(</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">)</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">swh.loader.dir.tasks</span> <span class=\"kn\">import</span> <span class=\"n\">LoadDirRepository</span>\n<span class=\"n\">l</span> <span class=\"o\">=</span> <span class=\"n\">LoadDirRepository</span><span class=\"p\">()</span>\n<span class=\"n\">l</span><span class=\"o\">.</span><span class=\"n\">run_task</span><span class=\"p\">(</span><span class=\"n\">dir_path</span><span class=\"o\">=</span><span class=\"n\">dir_path</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"n\">origin</span><span class=\"p\">,</span> <span class=\"n\">visit_date</span><span class=\"o\">=</span><span class=\"n\">visit_date</span><span class=\"p\">,</span>\n           <span class=\"n\">revision</span><span class=\"o\">=</span><span class=\"n\">revision</span><span class=\"p\">,</span> <span class=\"n\">release</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">branch_name</span><span class=\"o\">=</span><span class=\"s1\">'master'</span><span class=\"p\">)</span>\n</pre>\n<h3>Celery</h3>\n<p>To use celery, add the following entries in the\n<em><code>{/etc/softwareheritage | ~/.config/swh | ~/.swh}</code>/worker.yml</em>` file:</p>\n<pre><span class=\"nt\">task_modules</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"l l-Scalar l-Scalar-Plain\">swh.loader.dir.tasks</span>\n<span class=\"nt\">task_queues</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"l l-Scalar l-Scalar-Plain\">swh_loader_dir</span>\n</pre>\n<p>cf. <a href=\"https://forge.softwareheritage.org/diffusion/DCORE/browse/master/README.md\" rel=\"nofollow\">swh-core's documentation</a> for\nmore details.</p>\n<p>You can then send the following message to the task queue:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">swh.loader.dir.tasks</span> <span class=\"kn\">import</span> <span class=\"n\">LoadDirRepository</span>\n\n<span class=\"c1\"># Fill in those</span>\n<span class=\"n\">origin</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'url'</span><span class=\"p\">:</span> <span class=\"s1\">'some-origin'</span><span class=\"p\">,</span> <span class=\"s1\">'type'</span><span class=\"p\">:</span> <span class=\"s1\">'dir'</span><span class=\"p\">}</span>\n<span class=\"n\">visit_date</span> <span class=\"o\">=</span> <span class=\"s1\">'Tue, 3 May 2017 17:16:32 +0200'</span>\n<span class=\"n\">release</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n<span class=\"n\">revision</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n<span class=\"n\">occurrence</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n<span class=\"c1\"># Send message to the task queue</span>\n<span class=\"n\">LoaderDirRepository</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">((</span><span class=\"s1\">'/path/to/dir'</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"p\">,</span> <span class=\"n\">visit_date</span><span class=\"p\">,</span> <span class=\"n\">revision</span><span class=\"p\">,</span> <span class=\"n\">release</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">occurrence</span><span class=\"p\">]))</span>\n</pre>\n\n          </div>"}, "last_serial": 5945251, "releases": {"0.0.32": [{"comment_text": "", "digests": {"md5": "36de367dfc81e83289cd445e3f57cad2", "sha256": "6436aa5b044b824f77464bd95ce21aa4a53a96e151a980b1a82b9ff1789bf08b"}, "downloads": -1, "filename": "swh.loader.dir-0.0.32-py3-none-any.whl", "has_sig": true, "md5_digest": "36de367dfc81e83289cd445e3f57cad2", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 18777, "upload_time": "2018-10-18T09:00:20", "upload_time_iso_8601": "2018-10-18T09:00:20.344929Z", "url": "https://files.pythonhosted.org/packages/6c/c5/4dfd80e3defc27a359ce697ebeeeda307d3d9d34e5a00a3cc23f7e76927f/swh.loader.dir-0.0.32-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "3e19411a06554cd7c56d78bd082747ed", "sha256": "83e3f79d506b85ff0045d40dd634a08ef03194e62a2c50b3ff4f77ca1e7c2ad3"}, "downloads": -1, "filename": "swh.loader.dir-0.0.32.tar.gz", "has_sig": true, "md5_digest": "3e19411a06554cd7c56d78bd082747ed", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5698, "upload_time": "2018-10-18T09:00:21", "upload_time_iso_8601": "2018-10-18T09:00:21.773089Z", "url": "https://files.pythonhosted.org/packages/ed/45/a67a21e8a96a566a9cf7f98ed43b7eb67f4336a665145a351058d37e84da/swh.loader.dir-0.0.32.tar.gz", "yanked": false}], "0.0.33": [{"comment_text": "", "digests": {"md5": "171fcdf7770017e684d9341ee7d67fd4", "sha256": "8b51abcb8a71c03267bd9b5c02aa9ed6f09a831a94945da0625ec1fed9271640"}, "downloads": -1, "filename": "swh.loader.dir-0.0.33-py3-none-any.whl", "has_sig": false, "md5_digest": "171fcdf7770017e684d9341ee7d67fd4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 24119, "upload_time": "2018-12-05T13:47:16", "upload_time_iso_8601": "2018-12-05T13:47:16.888666Z", "url": "https://files.pythonhosted.org/packages/df/19/21c3153740e098152aece8a34d2ed278ec4e57b4458ab66e3091b4d4cdac/swh.loader.dir-0.0.33-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "e43f83176dc9f9ded0e37e956d322b4f", "sha256": "ec660fae7d81695ff3e0e09018cf259053d0dbabb5bb411013486370ee3697cd"}, "downloads": -1, "filename": "swh.loader.dir-0.0.33.tar.gz", "has_sig": false, "md5_digest": "e43f83176dc9f9ded0e37e956d322b4f", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 9356, "upload_time": "2018-12-05T13:47:18", "upload_time_iso_8601": "2018-12-05T13:47:18.514783Z", "url": "https://files.pythonhosted.org/packages/ff/ae/3c9f8e32bf4ee666a85d6690b6401982b0495fd37f74cb7c31758cb02194/swh.loader.dir-0.0.33.tar.gz", "yanked": false}], "0.0.34": [{"comment_text": "", "digests": {"md5": "2e8f17cfe4ddebd69c37545780de05f4", "sha256": "6b605c6f2eb8a473cb971f0c52508006d56a488b6c31690b80021402efb64fbc"}, "downloads": -1, "filename": "swh.loader.dir-0.0.34-py3-none-any.whl", "has_sig": false, "md5_digest": "2e8f17cfe4ddebd69c37545780de05f4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 24087, "upload_time": "2019-02-07T16:35:25", "upload_time_iso_8601": "2019-02-07T16:35:25.186534Z", "url": "https://files.pythonhosted.org/packages/bf/e4/8d522ce809aa0cc8f382075c67924797e26a7d1e3a66d0433b132b0914a0/swh.loader.dir-0.0.34-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "2bb5f6c9d0f4cb70187377c93d2817a0", "sha256": "89ad979fb1284c381467504ab373a7daffa0c65c255db2f928103ad334affa64"}, "downloads": -1, "filename": "swh.loader.dir-0.0.34.tar.gz", "has_sig": false, "md5_digest": "2bb5f6c9d0f4cb70187377c93d2817a0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 9332, "upload_time": "2019-02-07T16:35:26", "upload_time_iso_8601": "2019-02-07T16:35:26.633025Z", "url": "https://files.pythonhosted.org/packages/86/f8/e0fa3ca4dadb858c4baea761474e5b950d20f3bfeb6c6e3c563a0b0ead32/swh.loader.dir-0.0.34.tar.gz", "yanked": false}], "0.0.35": [{"comment_text": "", "digests": {"md5": "3fcf9523111f47ce5f4ffbe360338d2c", "sha256": "6a22c2cd2413ff2efdaa4bfab13993b669b2abbe44ebf953a74045bdad6a4d84"}, "downloads": -1, "filename": "swh.loader.dir-0.0.35-py3-none-any.whl", "has_sig": false, "md5_digest": "3fcf9523111f47ce5f4ffbe360338d2c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 24355, "upload_time": "2019-10-08T14:58:45", "upload_time_iso_8601": "2019-10-08T14:58:45.170797Z", "url": "https://files.pythonhosted.org/packages/f7/e5/c9f7d11b03b013c4ca3232d855c87cd62ce8cc49901baafc4ee73e44fc4a/swh.loader.dir-0.0.35-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "a685a5ac2d1f6f5eeddefadeb830bcb0", "sha256": "cc36bd04f86b0cb6d1693b8f87c78750c91e6d37dcf6c4084f0530deadc804ce"}, "downloads": -1, "filename": "swh.loader.dir-0.0.35.tar.gz", "has_sig": false, "md5_digest": "a685a5ac2d1f6f5eeddefadeb830bcb0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 9406, "upload_time": "2019-10-08T14:58:48", "upload_time_iso_8601": "2019-10-08T14:58:48.602797Z", "url": "https://files.pythonhosted.org/packages/b3/f3/bcaa6af8ecd803e9e58cd7e0022ad280c0fa0dc7115b364321fc7448f974/swh.loader.dir-0.0.35.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3fcf9523111f47ce5f4ffbe360338d2c", "sha256": "6a22c2cd2413ff2efdaa4bfab13993b669b2abbe44ebf953a74045bdad6a4d84"}, "downloads": -1, "filename": "swh.loader.dir-0.0.35-py3-none-any.whl", "has_sig": false, "md5_digest": "3fcf9523111f47ce5f4ffbe360338d2c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 24355, "upload_time": "2019-10-08T14:58:45", "upload_time_iso_8601": "2019-10-08T14:58:45.170797Z", "url": "https://files.pythonhosted.org/packages/f7/e5/c9f7d11b03b013c4ca3232d855c87cd62ce8cc49901baafc4ee73e44fc4a/swh.loader.dir-0.0.35-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "a685a5ac2d1f6f5eeddefadeb830bcb0", "sha256": "cc36bd04f86b0cb6d1693b8f87c78750c91e6d37dcf6c4084f0530deadc804ce"}, "downloads": -1, "filename": "swh.loader.dir-0.0.35.tar.gz", "has_sig": false, "md5_digest": "a685a5ac2d1f6f5eeddefadeb830bcb0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 9406, "upload_time": "2019-10-08T14:58:48", "upload_time_iso_8601": "2019-10-08T14:58:48.602797Z", "url": "https://files.pythonhosted.org/packages/b3/f3/bcaa6af8ecd803e9e58cd7e0022ad280c0fa0dc7115b364321fc7448f974/swh.loader.dir-0.0.35.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:59:33 2020"}