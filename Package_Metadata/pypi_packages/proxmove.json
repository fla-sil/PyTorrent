{"info": {"author": "Walter Doekes, OSSO B.V.", "author_email": "wjdoekes+proxmove@osso.nl", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: System Administrators", "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)", "Operating System :: POSIX :: Linux", "Programming Language :: Python :: 3", "Topic :: System :: Clustering"], "description": "|proxmove|\n==========\n\n*The Proxmox VM migrator: migrates VMs between different Proxmox VE clusters.*\n\nMigrating a virtual machine (VM) on a PVE-cluster from one node to\nanother is implemented in the Proxmox Virtual Environment (PVE). But\nmigrating a VM from one PVE-cluster to another is not.\n\nproxmove helps you move VMs between PVE-clusters with minimal hassle.\n\n.. code-block:: console\n\n    usage: proxmove [-c FILENAME] [-n] [--bwlimit MBPS] [--no-verify-ssl]\n                    [--skip-disks] [--skip-start] [--ssh-ciphers CIPHERS]\n                    [--debug] [--ignore-exists] [-h] [--version]\n                    source destination nodeid storage vm [vm ...]\n\n    Migrate VMs from one Proxmox cluster to another.\n\n    positional arguments:\n      source                alias of source cluster\n      destination           alias of destination cluster\n      nodeid                node on destination cluster\n      storage               storage on destination node\n      vm                    one or more VMs (guests) to move\n\n    optional arguments:\n      -c FILENAME, --config FILENAME\n                            use alternate configuration inifile\n      -n, --dry-run         stop before doing any writes\n      --bwlimit MBPS        limit bandwidth in Mbit/s\n      --no-verify-ssl       skip ssl verification on the api hosts\n      --skip-disks          do the move, but skip copying of the disks; implies\n                            --skip-start\n      --skip-start          do the move, but do not start the new instance\n      --ssh-ciphers CIPHERS\n                            comma separated list of ssh -c ciphers to prefer,\n                            (aes128-gcm@openssh.com is supposed to be fast if you\n                            have aes on your cpu); set to \"-\" to use ssh defaults\n\n    debug arguments:\n      --debug               enables extra debug logging\n      --ignore-exists       continue, even though the VM name exists on the target\n\n    other actions:\n      -h, --help            show this help message and exit\n      --version             show program's version number and exit\n\n    Cluster aliases and storage locations should be defined in ~/.proxmoverc (or\n    see -c option). See the example proxmoverc.sample. It requires\n    [pve:CLUSTER_ALIAS] sections for the proxmox \"api\" URL and\n    [storage:CLUSTER_ALIAS:STORAGE_NAME] sections with \"ssh\", \"path\" and \"temp\"\n    settings.\n\n\nExample run\n-----------\n\nFirst you need to configure ``~/.proxmoverc``; see below.\n\nWhen configured, you can do something like this:\n\n.. code-block:: console\n\n    $ proxmove banana-cluster the-new-cluster node2 node2-ssd the-vm-to-move\n    12:12:27: Attempt moving banana-cluster<e1400248> => the-new-cluster<6669ad2c> (node 'node2'): the-vm-to-move\n    12:12:27: - source VM the-vm-to-move@node1<qemu/565/running>\n    12:12:27: - storage 'ide2': None,media=cdrom (host=<unknown>, guest=<unknown>)\n    12:12:27: - storage 'virtio0': sharedsan:565/vm-565-disk-1.qcow2,format=qcow2,iops_rd=4000,iops_wr=500,size=50G (host=37.7GiB, guest=50.0GiB)\n    12:12:27: Creating new VM 'the-vm-to-move' on 'the-new-cluster', node 'node2'\n    12:12:27: - created new VM 'the-vm-to-move--CREATING' as UPID:node2:00005977:1F4D78F4:57C55C0B:qmcreate:126:user@pve:; waiting for it to show up\n    12:12:34: - created new VM 'the-vm-to-move--CREATING': the-vm-to-move--CREATING@node2<qemu/126/stopped>\n    12:12:34: Stopping VM the-vm-to-move@node1<qemu/565/running>\n    12:12:42: - stopped VM the-vm-to-move@node1<qemu/565/stopped>\n    12:12:42: Ejected (cdrom?) volume 'ide2' (none) added to the-vm-to-move--CREATING@node2<qemu/126/stopped>\n    12:12:42: Begin copy of 'virtio0' (sharedsan:565/vm-565-disk-1.qcow2,format=qcow2,iops_rd=4000,iops_wr=500,size=50G) to local-ssd\n    12:12:42: scp(1) copy from '/pool0/san/images/565/vm-565-disk-1.qcow2' (on sharedsan) to 'root@node2.the-new-cluster.com:/node2-ssd/temp/temp-proxmove/vm-126-virtio0'\n    Warning: Permanently added 'node2.the-new-cluster.com' (ECDSA) to the list of known hosts.\n    vm-565-disk-1.qcow2   100%   50GB   90.5MB/s   09:26\n    Connection to san.banana-cluster.com closed.\n    12:22:08: Temp data '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' on local-ssd\n    12:22:08: Writing data from temp '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' to '/dev/zvol/node2-ssd/vm-126-virtio0' (on local-ssd)\n        (100.00/100%)\n    Connection to node2.the-new-cluster.com closed.\n    12:24:25: Removing temp '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' (on local-ssd)\n    12:24:26: Starting VM the-vm-to-move@node2<qemu/126/stopped>\n    12:24:27: - started VM the-vm-to-move@node2<qemu/126/running>\n    12:24:27: Completed moving banana-cluster<e1400248> => the-new-cluster<6669ad2c> (node 'node2'): the-vm-to-move\n\nBefore, ``the-vm-to-move`` was running on ``banana-cluster`` on ``node1``.\n\nAfterwards, ``the-vm-to-move`` is running on ``the-new-cluster`` on ``node2``.\nThe ``the-vm-to-move`` on the ``banana-cluster`` has been stopped and renamed to\n``the-vm-to-move--MIGRATED``.\n\n\nConfiguration\n-------------\n\nSet up the ``~/.proxmoverc`` config file. First you need to define which\nclusters you have. For example *banana-cluster* and *the-new-cluster*.\n\n.. code-block:: ini\n\n    ; Example cluster named \"banana-cluster\" with 3 storage devices, one\n    ; shared, and two which exist on a single node only.\n    ;\n    ; The user requires various permissions found in the PVEVMAdmin role (VM\n    ; allocate + audit) and PVEAuditor role (Datastore audit).\n    ;\n    [pve:banana-cluster]\n    api=https://user@pve:PASSWORD@banana-cluster.com:443\n\n    ; Example cluster named \"the-new-cluster\" with 2 storage devices; both\n    ; storage devices exist on the respective nodes only.\n    [pve:the-new-cluster]\n    api=https://user@pve:PASSWORD@the-new-cluster.com:443\n\nNext, it needs configuration for the storage devices. They are expected\nto be reachable over SSH; both from the caller and from each other\n(using SSH-agent forwarding).\n\nThe following defines two storage devices for the *banana-cluster*, one shared\nand one local to *node1* only.\n\nIf on *sharedsan*, the images are probably called something like\n``/pool0/san/images/VMID/vm-VMID-disk1.qcow2``, while in Proxmox, they are\nreferred to as ``sharedsan:VMID/vm-VMID-disk1.qcow2``.\n\n.. code-block:: ini\n\n    [storage:banana-cluster:sharedsan] ; \"sharedsan\" is available on all nodes\n    ssh=root@san.banana-cluster.com\n    path=/pool0/san/images\n    temp=/pool0/san/private\n\n    [storage:banana-cluster:local@node1] ; local disk on node1 only\n    ssh=root@node1.banana-cluster.com\n    path=/srv/images\n    temp=/srv/temp\n\nIf you use ZFS storage on *the-new-cluster*, the storage bits could look\nlike this. Disk volumes exist on the ZFS filesystem ``node1-ssd/images``\nand ``node2-ssd/images`` on the nodes *node1* and *node2* respectively.\n\nNote that the ``temp=`` path is always a regular path.\n\n.. code-block:: ini\n\n    [storage:the-new-cluster:node1-ssd@node1]\n    ssh=root@node1.the-new-cluster.com\n    path=zfs:node1-ssd/images\n    temp=/node1-ssd/temp\n\n    [storage:the-new-cluster:node2-ssd@node2]\n    ssh=root@node2.the-new-cluster.com\n    path=zfs:node2-ssd/images\n    temp=/node2-ssd/temp\n\nThe config file looks better with indentation. The author suggests this layout:\n\n.. code-block:: ini\n\n    [pve:banana-cluster]\n    ...\n\n      [storage:banana-cluster:sharedsan]\n      ...\n      [storage:banana-cluster:local@node1]\n      ...\n\n    [pve:the-new-cluster]\n    ...\n\n      [storage:the-new-cluster:node1-ssd@node1]\n      ...\n\n\nDebugging\n---------\n\nIf you run into a ``ResourceException``, you may want to patch proxmoxer 1.0.3\nto show the HTTP error reason as well.\n\n.. code-block:: udiff\n\n    --- proxmoxer/core.py\t2019-04-04 09:13:16.832961589 +0200\n    +++ proxmoxer/core.py\t2019-04-04 09:15:45.434175030 +0200\n    @@ -75,8 +75,10 @@ class ProxmoxResource(ProxmoxResourceBas\n             logger.debug('Status code: %s, output: %s', resp.status_code, resp.content)\n\n             if resp.status_code >= 400:\n    -            raise ResourceException(\"{0} {1}: {2}\".format(resp.status_code, httplib.responses[resp.status_code],\n    -                                                          resp.content))\n    +            raise ResourceException('{0} {1} (\"{2}\"): {3}'.format(\n    +                resp.status_code, httplib.responses[resp.status_code],\n    +                resp.reason,  # reason = textual status_code\n    +                resp.content))\n             elif 200 <= resp.status_code <= 299:\n                 return self._store[\"serializer\"].loads(resp)\n\nIt might reveal a bug (or new feature), like::\n\n    proxmoxer.core.ResourceException:\n      500 Internal Server Error (\"only root can set 'vmgenid' config\"):\n      b'{\"data\":null}'\n\n\nLicense\n-------\n\nproxmove is free software: you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free\nSoftware Foundation, version 3 or any later version.\n\n\n.. |proxmove| image:: assets/proxmove_head.png\n    :alt: proxmove\n\n\nChanges\n-------\n\n* **1.0** - 2020-01-17\n\n  Features/fixes:\n\n  - Fix disk I/O resource hog overuse on newer PVE clusters.\n  - Fix API connection to newer PVE clusters.\n  - Add faster ssh cipher by default.\n  - Work around Proxmox API timeout.\n  - Improved usability through better logging and prepare checks.\n\n* **0.1.0** - 2018-11-22\n\n  Bugs fixed:\n\n  - Show that not seeing a VM is probably a PVEAdmin-permissions issue.\n  - Don't die if image_size cannot be determined.\n  - Place the sample files and docs in a /usr/share/...proxmove subdir.\n\n* **0.0.9** - 2017-03-28\n\n  New features:\n\n  - Added --no-verify-ssl option.\n\n  Bugs fixed:\n\n  - Fix str-cast bug with ZFS destination creation.\n  - Fix ignoring of non-volume properties like \"scsihw\".\n\n* **0.0.8** - 2017-01-26\n\n  New features:\n\n  - Partial LXC container move implemented. Not complete.\n\n  Bugs fixed:\n\n  - Allow ZFS paths to be more than just the a pool name. Instead of\n    e.g. ``path=zfs:mc9-8-ssd`` we now also allow\n    ``path=zfs:rpool/data/images``. Closes #7.\n\n* **v0.0.7** - 2016-10-07\n\n  Bugs fixed:\n\n  - Instead of trusting on the \"size=XXG\" which may or may not be\n    present in the storage volume config, it reads the QCOW header or\n    ZFS volume size directly. Also checks that the values are available\n    before attempting a move.\n\n* **v0.0.6** - 2016-09-21\n\n  New features:\n\n  - Add --bwlimit in Mbit/s to limit bandwidth during transfer. Will use\n    the scp(1) -l option or for ZFS use the mbuffer(1) auxiliary. As an\n    added bonus mbuffer may improve ZFS send/recv speed through\n    buffering. Closes #4.\n  - Add --skip-disks option to skip copying of the disks. Use this if\n    you want to copy the disks manually. Closes #3.\n  - Add --skip-start option to skip autostarting of the VM.\n  - Adds optional pv(1) pipe viewer progress bar to get ETA in ZFS\n    transfers.\n  - Add hidden --debug option for more verbosity.\n  - Add hidden --ignore-exists option that allows you to test moves\n    between the same cluster by creating an alias (second config).\n\n  Bugs fixed:\n\n  - Format is not always specified in the properties. If it isn't, use\n    the image filename suffix when available.\n  - Sometimes old values aren't available in the \"pending\" list. Don't croak.\n    Closes #2.\n  - Begun refactoring. Testing bettercodehub.com.\n  - Also check whether temporary (renamed) VMs exist before starting.\n\n* **v0.0.5** - 2016-08-30\n\n  - Added support for ZFS to ZFS disk copy. QCOW2 to ZFS and ZFS to ZFS\n    is now tested.\n\n* **v0.0.4** - 2016-08-30\n\n  - Major overhaul of configuration format and other changes.\n\n\nTODO\n----\n\n* On missing disk (bad config), the zfs send stalls and mbuffer waits for\n  infinity.\n\n* Rename \"VM\" to \"Instance\" so \"LXC\" containers don't feel misrepresented.\n\n* Communicate with the storage API to check/configure storage (more easily).\n\n* Create a ``--config`` command to set up a basic configuration. Combine with\n  storage API reading.\n\n* Fix so LXC-copying works (this is a bit tricky because of the necessity for\n  a temporary image/tarball to install).\n\n* Create a proxmoxer_api example that returns test data, so we can run tests.\n\n* Let it work with pve-zsync -- a daemon that syncs data between nodes:\n  https://pve.proxmox.com/wiki/PVE-zsync", "description_content_type": "", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/ossobv/proxmove", "keywords": "", "license": "GPLv3+", "maintainer": "", "maintainer_email": "", "name": "proxmove", "package_url": "https://pypi.org/project/proxmove/", "platform": "linux", "project_url": "https://pypi.org/project/proxmove/", "project_urls": {"Homepage": "https://github.com/ossobv/proxmove"}, "release_url": "https://pypi.org/project/proxmove/1.0/", "requires_dist": null, "requires_python": "", "summary": "Migrate virtual machines between different Proxmox VM clusters", "version": "1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p><em>The Proxmox VM migrator: migrates VMs between different Proxmox VE clusters.</em></p>\n<p>Migrating a virtual machine (VM) on a PVE-cluster from one node to\nanother is implemented in the Proxmox Virtual Environment (PVE). But\nmigrating a VM from one PVE-cluster to another is not.</p>\n<p>proxmove helps you move VMs between PVE-clusters with minimal hassle.</p>\n<pre><span class=\"go\">usage: proxmove [-c FILENAME] [-n] [--bwlimit MBPS] [--no-verify-ssl]\n                [--skip-disks] [--skip-start] [--ssh-ciphers CIPHERS]\n                [--debug] [--ignore-exists] [-h] [--version]\n                source destination nodeid storage vm [vm ...]\n\nMigrate VMs from one Proxmox cluster to another.\n\npositional arguments:\n  source                alias of source cluster\n  destination           alias of destination cluster\n  nodeid                node on destination cluster\n  storage               storage on destination node\n  vm                    one or more VMs (guests) to move\n\noptional arguments:\n  -c FILENAME, --config FILENAME\n                        use alternate configuration inifile\n  -n, --dry-run         stop before doing any writes\n  --bwlimit MBPS        limit bandwidth in Mbit/s\n  --no-verify-ssl       skip ssl verification on the api hosts\n  --skip-disks          do the move, but skip copying of the disks; implies\n                        --skip-start\n  --skip-start          do the move, but do not start the new instance\n  --ssh-ciphers CIPHERS\n                        comma separated list of ssh -c ciphers to prefer,\n                        (aes128-gcm@openssh.com is supposed to be fast if you\n                        have aes on your cpu); set to \"-\" to use ssh defaults\n\ndebug arguments:\n  --debug               enables extra debug logging\n  --ignore-exists       continue, even though the VM name exists on the target\n\nother actions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n\nCluster aliases and storage locations should be defined in ~/.proxmoverc (or\nsee -c option). See the example proxmoverc.sample. It requires\n[pve:CLUSTER_ALIAS] sections for the proxmox \"api\" URL and\n[storage:CLUSTER_ALIAS:STORAGE_NAME] sections with \"ssh\", \"path\" and \"temp\"\nsettings.</span>\n</pre>\n<div id=\"example-run\">\n<h2>Example run</h2>\n<p>First you need to configure <tt><span class=\"pre\">~/.proxmoverc</span></tt>; see below.</p>\n<p>When configured, you can do something like this:</p>\n<pre><span class=\"gp\">$</span> proxmove banana-cluster the-new-cluster node2 node2-ssd the-vm-to-move\n<span class=\"go\">12:12:27: Attempt moving banana-cluster&lt;e1400248&gt; =&gt; the-new-cluster&lt;6669ad2c&gt; (node 'node2'): the-vm-to-move\n12:12:27: - source VM the-vm-to-move@node1&lt;qemu/565/running&gt;\n12:12:27: - storage 'ide2': None,media=cdrom (host=&lt;unknown&gt;, guest=&lt;unknown&gt;)\n12:12:27: - storage 'virtio0': sharedsan:565/vm-565-disk-1.qcow2,format=qcow2,iops_rd=4000,iops_wr=500,size=50G (host=37.7GiB, guest=50.0GiB)\n12:12:27: Creating new VM 'the-vm-to-move' on 'the-new-cluster', node 'node2'\n12:12:27: - created new VM 'the-vm-to-move--CREATING' as UPID:node2:00005977:1F4D78F4:57C55C0B:qmcreate:126:user@pve:; waiting for it to show up\n12:12:34: - created new VM 'the-vm-to-move--CREATING': the-vm-to-move--CREATING@node2&lt;qemu/126/stopped&gt;\n12:12:34: Stopping VM the-vm-to-move@node1&lt;qemu/565/running&gt;\n12:12:42: - stopped VM the-vm-to-move@node1&lt;qemu/565/stopped&gt;\n12:12:42: Ejected (cdrom?) volume 'ide2' (none) added to the-vm-to-move--CREATING@node2&lt;qemu/126/stopped&gt;\n12:12:42: Begin copy of 'virtio0' (sharedsan:565/vm-565-disk-1.qcow2,format=qcow2,iops_rd=4000,iops_wr=500,size=50G) to local-ssd\n12:12:42: scp(1) copy from '/pool0/san/images/565/vm-565-disk-1.qcow2' (on sharedsan) to 'root@node2.the-new-cluster.com:/node2-ssd/temp/temp-proxmove/vm-126-virtio0'\nWarning: Permanently added 'node2.the-new-cluster.com' (ECDSA) to the list of known hosts.\nvm-565-disk-1.qcow2   100%   50GB   90.5MB/s   09:26\nConnection to san.banana-cluster.com closed.\n12:22:08: Temp data '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' on local-ssd\n12:22:08: Writing data from temp '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' to '/dev/zvol/node2-ssd/vm-126-virtio0' (on local-ssd)\n    (100.00/100%)\nConnection to node2.the-new-cluster.com closed.\n12:24:25: Removing temp '/node2-ssd/temp/temp-proxmove/vm-126-virtio0' (on local-ssd)\n12:24:26: Starting VM the-vm-to-move@node2&lt;qemu/126/stopped&gt;\n12:24:27: - started VM the-vm-to-move@node2&lt;qemu/126/running&gt;\n12:24:27: Completed moving banana-cluster&lt;e1400248&gt; =&gt; the-new-cluster&lt;6669ad2c&gt; (node 'node2'): the-vm-to-move</span>\n</pre>\n<p>Before, <tt><span class=\"pre\">the-vm-to-move</span></tt> was running on <tt><span class=\"pre\">banana-cluster</span></tt> on <tt>node1</tt>.</p>\n<p>Afterwards, <tt><span class=\"pre\">the-vm-to-move</span></tt> is running on <tt><span class=\"pre\">the-new-cluster</span></tt> on <tt>node2</tt>.\nThe <tt><span class=\"pre\">the-vm-to-move</span></tt> on the <tt><span class=\"pre\">banana-cluster</span></tt> has been stopped and renamed to\n<tt><span class=\"pre\">the-vm-to-move--MIGRATED</span></tt>.</p>\n</div>\n<div id=\"configuration\">\n<h2>Configuration</h2>\n<p>Set up the <tt><span class=\"pre\">~/.proxmoverc</span></tt> config file. First you need to define which\nclusters you have. For example <em>banana-cluster</em> and <em>the-new-cluster</em>.</p>\n<pre><span class=\"c1\">; Example cluster named \"banana-cluster\" with 3 storage devices, one</span>\n<span class=\"c1\">; shared, and two which exist on a single node only.</span>\n<span class=\"c1\">;</span>\n<span class=\"c1\">; The user requires various permissions found in the PVEVMAdmin role (VM</span>\n<span class=\"c1\">; allocate + audit) and PVEAuditor role (Datastore audit).</span>\n<span class=\"c1\">;</span>\n<span class=\"k\">[pve:banana-cluster]</span>\n<span class=\"na\">api</span><span class=\"o\">=</span><span class=\"s\">https://user@pve:PASSWORD@banana-cluster.com:443</span>\n\n<span class=\"c1\">; Example cluster named \"the-new-cluster\" with 2 storage devices; both</span>\n<span class=\"c1\">; storage devices exist on the respective nodes only.</span>\n<span class=\"k\">[pve:the-new-cluster]</span>\n<span class=\"na\">api</span><span class=\"o\">=</span><span class=\"s\">https://user@pve:PASSWORD@the-new-cluster.com:443</span>\n</pre>\n<p>Next, it needs configuration for the storage devices. They are expected\nto be reachable over SSH; both from the caller and from each other\n(using SSH-agent forwarding).</p>\n<p>The following defines two storage devices for the <em>banana-cluster</em>, one shared\nand one local to <em>node1</em> only.</p>\n<p>If on <em>sharedsan</em>, the images are probably called something like\n<tt><span class=\"pre\">/pool0/san/images/VMID/vm-VMID-disk1.qcow2</span></tt>, while in Proxmox, they are\nreferred to as <tt><span class=\"pre\">sharedsan:VMID/vm-VMID-disk1.qcow2</span></tt>.</p>\n<pre><span class=\"na\">[storage:banana-cluster:sharedsan] ; \"sharedsan\" is available on all nodes</span>\n<span class=\"na\">ssh</span><span class=\"o\">=</span><span class=\"s\">root@san.banana-cluster.com</span>\n<span class=\"na\">path</span><span class=\"o\">=</span><span class=\"s\">/pool0/san/images</span>\n<span class=\"na\">temp</span><span class=\"o\">=</span><span class=\"s\">/pool0/san/private</span>\n\n<span class=\"na\">[storage:banana-cluster:local@node1] ; local disk on node1 only</span>\n<span class=\"na\">ssh</span><span class=\"o\">=</span><span class=\"s\">root@node1.banana-cluster.com</span>\n<span class=\"na\">path</span><span class=\"o\">=</span><span class=\"s\">/srv/images</span>\n<span class=\"na\">temp</span><span class=\"o\">=</span><span class=\"s\">/srv/temp</span>\n</pre>\n<p>If you use ZFS storage on <em>the-new-cluster</em>, the storage bits could look\nlike this. Disk volumes exist on the ZFS filesystem <tt><span class=\"pre\">node1-ssd/images</span></tt>\nand <tt><span class=\"pre\">node2-ssd/images</span></tt> on the nodes <em>node1</em> and <em>node2</em> respectively.</p>\n<p>Note that the <tt>temp=</tt> path is always a regular path.</p>\n<pre><span class=\"k\">[storage:the-new-cluster:node1-ssd@node1]</span>\n<span class=\"na\">ssh</span><span class=\"o\">=</span><span class=\"s\">root@node1.the-new-cluster.com</span>\n<span class=\"na\">path</span><span class=\"o\">=</span><span class=\"s\">zfs:node1-ssd/images</span>\n<span class=\"na\">temp</span><span class=\"o\">=</span><span class=\"s\">/node1-ssd/temp</span>\n\n<span class=\"k\">[storage:the-new-cluster:node2-ssd@node2]</span>\n<span class=\"na\">ssh</span><span class=\"o\">=</span><span class=\"s\">root@node2.the-new-cluster.com</span>\n<span class=\"na\">path</span><span class=\"o\">=</span><span class=\"s\">zfs:node2-ssd/images</span>\n<span class=\"na\">temp</span><span class=\"o\">=</span><span class=\"s\">/node2-ssd/temp</span>\n</pre>\n<p>The config file looks better with indentation. The author suggests this layout:</p>\n<pre><span class=\"k\">[pve:banana-cluster]</span>\n<span class=\"na\">...</span>\n\n  <span class=\"k\">[storage:banana-cluster:sharedsan]</span>\n  <span class=\"na\">...</span>\n  <span class=\"k\">[storage:banana-cluster:local@node1]</span>\n  <span class=\"na\">...</span>\n\n<span class=\"k\">[pve:the-new-cluster]</span>\n<span class=\"na\">...</span>\n\n  <span class=\"k\">[storage:the-new-cluster:node1-ssd@node1]</span>\n  <span class=\"na\">...</span>\n</pre>\n</div>\n<div id=\"debugging\">\n<h2>Debugging</h2>\n<p>If you run into a <tt>ResourceException</tt>, you may want to patch proxmoxer 1.0.3\nto show the HTTP error reason as well.</p>\n<pre><span class=\"gd\">--- proxmoxer/core.py       2019-04-04 09:13:16.832961589 +0200\n</span><span class=\"gi\">+++ proxmoxer/core.py       2019-04-04 09:15:45.434175030 +0200\n</span><span class=\"gu\">@@ -75,8 +75,10 @@ class ProxmoxResource(ProxmoxResourceBas\n</span>         logger.debug('Status code: %s, output: %s', resp.status_code, resp.content)\n\n         if resp.status_code &gt;= 400:\n<span class=\"gd\">-            raise ResourceException(\"{0} {1}: {2}\".format(resp.status_code, httplib.responses[resp.status_code],\n-                                                          resp.content))\n</span><span class=\"gi\">+            raise ResourceException('{0} {1} (\"{2}\"): {3}'.format(\n+                resp.status_code, httplib.responses[resp.status_code],\n+                resp.reason,  # reason = textual status_code\n+                resp.content))\n</span>         elif 200 &lt;= resp.status_code &lt;= 299:\n             return self._store[\"serializer\"].loads(resp)\n</pre>\n<p>It might reveal a bug (or new feature), like:</p>\n<pre>proxmoxer.core.ResourceException:\n  500 Internal Server Error (\"only root can set 'vmgenid' config\"):\n  b'{\"data\":null}'\n</pre>\n</div>\n<div id=\"license\">\n<h2>License</h2>\n<p>proxmove is free software: you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free\nSoftware Foundation, version 3 or any later version.</p>\n</div>\n<div id=\"changes\">\n<h2>Changes</h2>\n<ul>\n<li><p><strong>1.0</strong> - 2020-01-17</p>\n<p>Features/fixes:</p>\n<ul>\n<li>Fix disk I/O resource hog overuse on newer PVE clusters.</li>\n<li>Fix API connection to newer PVE clusters.</li>\n<li>Add faster ssh cipher by default.</li>\n<li>Work around Proxmox API timeout.</li>\n<li>Improved usability through better logging and prepare checks.</li>\n</ul>\n</li>\n<li><p><strong>0.1.0</strong> - 2018-11-22</p>\n<p>Bugs fixed:</p>\n<ul>\n<li>Show that not seeing a VM is probably a PVEAdmin-permissions issue.</li>\n<li>Don\u2019t die if image_size cannot be determined.</li>\n<li>Place the sample files and docs in a /usr/share/\u2026proxmove subdir.</li>\n</ul>\n</li>\n<li><p><strong>0.0.9</strong> - 2017-03-28</p>\n<p>New features:</p>\n<ul>\n<li>Added \u2013no-verify-ssl option.</li>\n</ul>\n<p>Bugs fixed:</p>\n<ul>\n<li>Fix str-cast bug with ZFS destination creation.</li>\n<li>Fix ignoring of non-volume properties like \u201cscsihw\u201d.</li>\n</ul>\n</li>\n<li><p><strong>0.0.8</strong> - 2017-01-26</p>\n<p>New features:</p>\n<ul>\n<li>Partial LXC container move implemented. Not complete.</li>\n</ul>\n<p>Bugs fixed:</p>\n<ul>\n<li>Allow ZFS paths to be more than just the a pool name. Instead of\ne.g. <tt><span class=\"pre\">path=zfs:mc9-8-ssd</span></tt> we now also allow\n<tt>path=zfs:rpool/data/images</tt>. Closes #7.</li>\n</ul>\n</li>\n<li><p><strong>v0.0.7</strong> - 2016-10-07</p>\n<p>Bugs fixed:</p>\n<ul>\n<li>Instead of trusting on the \u201csize=XXG\u201d which may or may not be\npresent in the storage volume config, it reads the QCOW header or\nZFS volume size directly. Also checks that the values are available\nbefore attempting a move.</li>\n</ul>\n</li>\n<li><p><strong>v0.0.6</strong> - 2016-09-21</p>\n<p>New features:</p>\n<ul>\n<li>Add \u2013bwlimit in Mbit/s to limit bandwidth during transfer. Will use\nthe scp(1) -l option or for ZFS use the mbuffer(1) auxiliary. As an\nadded bonus mbuffer may improve ZFS send/recv speed through\nbuffering. Closes #4.</li>\n<li>Add \u2013skip-disks option to skip copying of the disks. Use this if\nyou want to copy the disks manually. Closes #3.</li>\n<li>Add \u2013skip-start option to skip autostarting of the VM.</li>\n<li>Adds optional pv(1) pipe viewer progress bar to get ETA in ZFS\ntransfers.</li>\n<li>Add hidden \u2013debug option for more verbosity.</li>\n<li>Add hidden \u2013ignore-exists option that allows you to test moves\nbetween the same cluster by creating an alias (second config).</li>\n</ul>\n<p>Bugs fixed:</p>\n<ul>\n<li>Format is not always specified in the properties. If it isn\u2019t, use\nthe image filename suffix when available.</li>\n<li>Sometimes old values aren\u2019t available in the \u201cpending\u201d list. Don\u2019t croak.\nCloses #2.</li>\n<li>Begun refactoring. Testing bettercodehub.com.</li>\n<li>Also check whether temporary (renamed) VMs exist before starting.</li>\n</ul>\n</li>\n<li><p><strong>v0.0.5</strong> - 2016-08-30</p>\n<ul>\n<li>Added support for ZFS to ZFS disk copy. QCOW2 to ZFS and ZFS to ZFS\nis now tested.</li>\n</ul>\n</li>\n<li><p><strong>v0.0.4</strong> - 2016-08-30</p>\n<ul>\n<li>Major overhaul of configuration format and other changes.</li>\n</ul>\n</li>\n</ul>\n</div>\n<div id=\"todo\">\n<h2>TODO</h2>\n<ul>\n<li>On missing disk (bad config), the zfs send stalls and mbuffer waits for\ninfinity.</li>\n<li>Rename \u201cVM\u201d to \u201cInstance\u201d so \u201cLXC\u201d containers don\u2019t feel misrepresented.</li>\n<li>Communicate with the storage API to check/configure storage (more easily).</li>\n<li>Create a <tt><span class=\"pre\">--config</span></tt> command to set up a basic configuration. Combine with\nstorage API reading.</li>\n<li>Fix so LXC-copying works (this is a bit tricky because of the necessity for\na temporary image/tarball to install).</li>\n<li>Create a proxmoxer_api example that returns test data, so we can run tests.</li>\n<li>Let it work with pve-zsync \u2013 a daemon that syncs data between nodes:\n<a href=\"https://pve.proxmox.com/wiki/PVE-zsync\" rel=\"nofollow\">https://pve.proxmox.com/wiki/PVE-zsync</a></li>\n</ul>\n</div>\n\n          </div>"}, "last_serial": 6472541, "releases": {"0.0.2": [{"comment_text": "", "digests": {"md5": "41c5210566e09302c2a074930f076a24", "sha256": "bc446e6011b398cc83de8bcce3ed1c56448ef0a34d1e69a330ed90a668903e65"}, "downloads": -1, "filename": "proxmove-0.0.2.tar.gz", "has_sig": false, "md5_digest": "41c5210566e09302c2a074930f076a24", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7012, "upload_time": "2016-08-25T14:13:12", "upload_time_iso_8601": "2016-08-25T14:13:12.136580Z", "url": "https://files.pythonhosted.org/packages/70/33/43f1cc330935e3cbddd058aa577d2306a937876598483c9386fdf1812014/proxmove-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "591de7e901e49f791df3263b362c9915", "sha256": "d68d72ca2ce53ddef7705d07e4f2ec9607a1854fc2f086c8678fe4c4834efa3b"}, "downloads": -1, "filename": "proxmove-0.0.3.tar.gz", "has_sig": false, "md5_digest": "591de7e901e49f791df3263b362c9915", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7161, "upload_time": "2016-08-25T15:38:52", "upload_time_iso_8601": "2016-08-25T15:38:52.617313Z", "url": "https://files.pythonhosted.org/packages/b3/55/4d7823d516b485d884e5971ef465fd02b37d2f09d1ba0b645717bdd70cd6/proxmove-0.0.3.tar.gz", "yanked": false}], "0.0.4": [{"comment_text": "", "digests": {"md5": "c588a473d4e041b07034b91e540f4292", "sha256": "4ee44b0069ca163354bfc5bb259b51ac5e24f6d081adef616a92ef0f234e9857"}, "downloads": -1, "filename": "proxmove-0.0.4.tar.gz", "has_sig": false, "md5_digest": "c588a473d4e041b07034b91e540f4292", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13559, "upload_time": "2016-08-30T11:39:59", "upload_time_iso_8601": "2016-08-30T11:39:59.341165Z", "url": "https://files.pythonhosted.org/packages/2c/20/1475217e3565fa022d7b6795e1eba5f64f58d5e11a36d62e2a79f85342de/proxmove-0.0.4.tar.gz", "yanked": false}], "0.0.5": [{"comment_text": "", "digests": {"md5": "7305fc0a4a3d38ab95b4b0c7f93c69ed", "sha256": "70c6dc5631fafc073841cdc30046db3e89cab58a879888b4336cfe407a97539d"}, "downloads": -1, "filename": "proxmove-0.0.5.tar.gz", "has_sig": false, "md5_digest": "7305fc0a4a3d38ab95b4b0c7f93c69ed", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 14279, "upload_time": "2016-08-30T15:09:19", "upload_time_iso_8601": "2016-08-30T15:09:19.978398Z", "url": "https://files.pythonhosted.org/packages/00/dc/215cdca5022cc39346fbb6f688663ac8226b567a10de69d4ae4906775926/proxmove-0.0.5.tar.gz", "yanked": false}], "0.0.6": [{"comment_text": "", "digests": {"md5": "b196d7e5a618677d639931143a9aa136", "sha256": "9f42aa87bee5c3eae8034b14b4cb8de57417b775d2a222c33a9b2b1e722fdb24"}, "downloads": -1, "filename": "proxmove-0.0.6.tar.gz", "has_sig": false, "md5_digest": "b196d7e5a618677d639931143a9aa136", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 18298, "upload_time": "2016-09-21T15:51:52", "upload_time_iso_8601": "2016-09-21T15:51:52.828648Z", "url": "https://files.pythonhosted.org/packages/22/d4/5a530248f4e9e7e51adbb23f6a36e4382dafefa925cbd7b827850d56c411/proxmove-0.0.6.tar.gz", "yanked": false}], "0.0.7": [{"comment_text": "", "digests": {"md5": "e867e4196de3aca36e77b88225d42d1c", "sha256": "65cfbc912c0e281b70bae6e48be524230fe93f0e7207959b4ef46cc61bf90269"}, "downloads": -1, "filename": "proxmove-0.0.7.tar.gz", "has_sig": false, "md5_digest": "e867e4196de3aca36e77b88225d42d1c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 19490, "upload_time": "2016-10-07T11:48:20", "upload_time_iso_8601": "2016-10-07T11:48:20.219455Z", "url": "https://files.pythonhosted.org/packages/89/6d/6d605c4ddf331cbbf6362b504a61b74be76474a4511f06fce0009d5523e3/proxmove-0.0.7.tar.gz", "yanked": false}], "0.0.8": [{"comment_text": "", "digests": {"md5": "206593b42b7da7342aa077b190385b07", "sha256": "0679fe1ecab56a67d49d1adf4a10c385911cbaccf4dedaa56b94577402567db4"}, "downloads": -1, "filename": "proxmove-0.0.8.tar.gz", "has_sig": false, "md5_digest": "206593b42b7da7342aa077b190385b07", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21290, "upload_time": "2017-01-26T08:51:11", "upload_time_iso_8601": "2017-01-26T08:51:11.485902Z", "url": "https://files.pythonhosted.org/packages/81/44/c8f2e2220d753d9ab6badd4000d20224a1e1d8124ea73a649bf47860b065/proxmove-0.0.8.tar.gz", "yanked": false}], "0.0.9": [{"comment_text": "", "digests": {"md5": "3591b72e6812294cf77352b69d33b44b", "sha256": "81c1cd84e1de60c6666c41a603980bf6a700d33cdda05a53a7877cc569c82fb9"}, "downloads": -1, "filename": "proxmove-0.0.9.tar.gz", "has_sig": false, "md5_digest": "3591b72e6812294cf77352b69d33b44b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21616, "upload_time": "2017-03-28T09:52:36", "upload_time_iso_8601": "2017-03-28T09:52:36.292051Z", "url": "https://files.pythonhosted.org/packages/99/ed/3a8e5163cfc86b386fd2402f29e547fbdfb6f748b9c9ff2effb8c289f19b/proxmove-0.0.9.tar.gz", "yanked": false}], "0.1.0": [{"comment_text": "", "digests": {"md5": "634af0dec1b1383a65470b2817852488", "sha256": "04b610614979f1be844910514d52529d1f333b24818b32462d5a440304e0af1c"}, "downloads": -1, "filename": "proxmove-0.1.0.tar.gz", "has_sig": false, "md5_digest": "634af0dec1b1383a65470b2817852488", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21848, "upload_time": "2018-11-22T16:08:04", "upload_time_iso_8601": "2018-11-22T16:08:04.965514Z", "url": "https://files.pythonhosted.org/packages/5d/b8/819bc40ad185fc24663e3940314b9c608abb84ab163deeac29f066c40bc6/proxmove-0.1.0.tar.gz", "yanked": false}], "1.0": [{"comment_text": "", "digests": {"md5": "c07bd033cf76765c4b3d5196f2042967", "sha256": "0af6da42c821cc96e1ca4082e6e5d6114cf19055623120e22fa9166eb27eae66"}, "downloads": -1, "filename": "proxmove-1.0.tar.gz", "has_sig": false, "md5_digest": "c07bd033cf76765c4b3d5196f2042967", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24602, "upload_time": "2020-01-17T11:28:11", "upload_time_iso_8601": "2020-01-17T11:28:11.888855Z", "url": "https://files.pythonhosted.org/packages/f1/2c/bb75dba52f4d5bde8cab309624903814717581ae928026b50d8bff87f122/proxmove-1.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "c07bd033cf76765c4b3d5196f2042967", "sha256": "0af6da42c821cc96e1ca4082e6e5d6114cf19055623120e22fa9166eb27eae66"}, "downloads": -1, "filename": "proxmove-1.0.tar.gz", "has_sig": false, "md5_digest": "c07bd033cf76765c4b3d5196f2042967", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24602, "upload_time": "2020-01-17T11:28:11", "upload_time_iso_8601": "2020-01-17T11:28:11.888855Z", "url": "https://files.pythonhosted.org/packages/f1/2c/bb75dba52f4d5bde8cab309624903814717581ae928026b50d8bff87f122/proxmove-1.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:16:22 2020"}