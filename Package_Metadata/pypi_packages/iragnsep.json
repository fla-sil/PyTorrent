{"info": {"author": "Emmanuel Bernhard", "author_email": "manu.p.bernhard@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# iragnsep\n\niragnsep performs IR (i.e. 8--1000 microns) SED fits, separated into AGN and galaxy contributions, and measure host galaxy properties (e.g. SFRs) free of AGN contamination. The advantage of iragnsep is that, in addition to fitting observed broadband photometric fluxes, it also allows to incorporate IR spectra in the fits which, if available, greatly  improves the robustness of the galaxy-AGN separation. \n\nFor the galaxy component iragnsep uses a library of galaxy templates built and presented in Bernhard et al. (in prep.). In terms of the AGN contribution, if the input dataset is a mixture of spectral and photometric data, iragnsep uses a combination of power-laws for the AGN continuum and some broad features for the silicate emission. If, instead, the dataset contains photometric data alone, the AGN contribution is accounted for by using the library of AGN templates presented in Bernhard et al. (in prep.).\n\nThe advanced fitting techniques used by iragnsep (i.e. MLE optimised with MCMC) combined with the powerful model comparison tests (i.e. AIC) allow iragnsep to provide a statistically robust interpretation of IR SEDs in terms of AGN\u2013galaxy contributions, even when the AGN contribution is highly diluted by the host galaxy emission.\n\nThe aim of this README is to show how to use iragnsep. This document also contains important information such as limitations and cautions and the modules and functions which define iragnsep.\n\nFor a detailed description on the templates and fitting technique, see Bernhard et al. (in prep.).\n\nContacts: e.p.bernhard[at]sheffield.ac.uk\n\n## Getting Started\nThese instructions should assist you in getting iragnsep running on your machine. iragnsep is written in python 3 and is available on PyPI.\n\n### Prerequisites\niragnsep requires some non-standard libraries (dependencies) to run. These should automatically get installed when downloading and installing iragnsep via PyPi. If not, these can be manually installed using the pip3 command. The dependencies are as follow,\n\n* [NumPy](https://numpy.org) - NumPy is the fundamental package for scientific computing with Python.\n* [Matplotlib](https://matplotlib.org) - Matplotlib is a Python 2D plotting library.\n* [Astropy](https://www.astropy.org) - The Astropy Project is a community effort to develop a common core package for Astronomy in Python and foster an ecosystem of inter-operable astronomy packages.\n* [SciPy](https://www.scipy.org) - SciPy is a Python-based ecosystem of open-source software for mathematics, science, and engineering.\n* [pandas](https://pandas.pydata.org) - pandas is an open source, BSD-licensed library providing high-performance, easy-to-use data structures and data analysis tools for the Python programming language.\n* [emcee](https://emcee.readthedocs.io/en/stable/#) - emcee is an MIT licensed pure-Python implementation of Goodman & Weare\u2019s Affine Invariant Markov chain Monte Carlo (MCMC) Ensemble sampler.\n* [Numba](http://numba.pydata.org) - Numba translates Python functions to optimised machine code at runtime using the industry-standard LLVM compiler library. Numba-compiled numerical algorithms in Python can approach the speeds of C or FORTRAN.\n\n### Installation\nWe recommend to install iragnsep and its dependencies using pip,\n\n```\npip3 install iragnsep\n```\nThe project is also publicly available on bitbucket at https://bitbucket.org/ebernhard/iragnsep/src/master/ .\n\n## Quick start\n\nIn this section we show how to infer the SFR of the galaxy mrk1066 using iragnsep.\n\n### Step 1: Get the data and the script\n\nYou can download the data at https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/. The file data_mrk1066.csv contains the Herschel fluxes of mrk1066, and the file data_mrk1066_spec.csv contains the Spitzer-IRS spectrum of mrk1066. The file main.py is the main script. Once downloaded, create a folder with all of these files.\n\n### Step 2: Run the script\n\nIn a terminal simply cd to the folder that contains the files and run,\n\n```\npython3 main.py\n```\n\niragnsep is now fitting mrk1066, first using a combination of the IRS spectra and Herschel photometry, then using photometry only as if the IRS spectra was not available. The user can open the file main.py which is commented and can be used as a template for future use of iragnsep.\n\n### Step 3: Output\n\nOnce the fits are performed the plots and tables are generated and saved in the same folder. \n\n* **mrk1066_fitRes_spec.csv** - ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitRes_spec.csv)) contains the results of the fits for the 12 possible combinations of models considered by iragnsep. Each row corresponds to a specific model. This file contains the results of the fits performed on data which included the IRS spectrum. The best model is flagged by a value of 1.0 in the column 'bestModelFlag'. See section ** Description of the tables** for a full description.\n* **mrk1066_fitResAll_spec.pdf** - ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResAll_photo.pdf)) shows each of the 12 possible models fit to the data which included the IRS spectrum.\n* **mrk1066_fitResBM_spec.pdf** -  ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResBM_spec.pdf)) shows the best fit to the data which included the IRS spectrum. The best fit corresponds to a statistically weighted sum of all of the 12 different models.\n* **mrk1066_fitRes_photo.csv** - ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitRes_photo.csv)) contains the results of the fits for the 18 possible combinations of templates. Each row corresponds to a specific model. This file contains the results of the fits performed in photometry only (i.e. the IRS spectra was replaced by photometry). The best model is flagged by a value of 1.0 in the column 'bestModelFlag'. See the section ** Description of the tables** for a full description.\n* **mrk1066_fitResAll_photo.pdf** - ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResAll_photo.pdf)) shows each of the 18 models fit to the photometric data.\n* **mrk1066_fitResBM_photo.pdf** - ([Available here](https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResBM_photo.pdf)) shows the best fit to the photometric data. The best fit corresponds to a statistically weighted sum of all of the 18 different models..\n\n## Preparing your data\nAs this is the first release of iragnsep it is important to make sure that the input data are compatible with the code. Future versions will allow more flexibility in the format of the input data. The main input are the wavelengths of the SED (or combined spectrum and photometry) and the corresponding fluxes and their uncertainties. Here is a (non-exhaustive) check list of points that are required to ensure a robust behaviour of iragnsep.\n\n* the wavelengths are in microns, the fluxes and the uncertainties are in Jy.\n* the vector wavelength is in monotonically increasing order.\n* their is no negative or undefined (e.g. nan) values in the fluxes and their uncertainties (upper-limits can be passed via the keywords UL and ULphot).\n* if using iragnsep with a combination of a spectrum and photometry, make sure that no photometric points are overlapping with the spectral data (e.g. IRS spectra and MIPS 24 micron would be overlapping).\n* from practice, a good value for Nmc (the number of steps in the MCMC) is at least 10000 steps.\n* do not forget to set the redshift of the source using the keyword z.\n* for the photometric version, avoid photometry below roughly 5 microns rest-frame as iragnsep has not been designed to account for emissions below this value (e.g. old stellar population and very host dust component).\n\nShould you find anything non-intuitive missing from the above list, contact us at: e.p.bernhard[at]sheffield.ac.uk\n\n## Description of the tables\n\nThe output of the fits can be saved using the keyword saveRes as shown in the main.py of the Quick Start example on mrk1066. In particular two types of tables can be generated whether using the version of the code with spectra or that of with photometry alone.\n\nThe table sourceName_fitRes_spec.csv (where sourceName is the name of the source passed by the user) is a comma separated values (CSV) table which contains the results of the fits performed on data which included spectra. Each table row corresponds to one of the 12 possible models considered by iragnsep. Columns are as follow,\n\n* **tplName** - the name of the galaxy template [gal1_dust, gal2_dust, gal3_dust, gal4_dust, gal1_emp, gal2_emp].\n* **AGNon** - if  0.0, the results are for a fit that does not contain any AGN contribution, while if 1.0 the results are for a fit that accounts for AGN contribution.\n* **logNormGal_dust, elogNormGal_dust** - the log-normalisation of the galaxy dust continuum template and its uncertainties.\n* **logNormGal_PAH, elognNormGal_PAH** - the log-normalisation of the PAH emission template and its uncertainties.\n* **logNormAGN_PL, elogNormAGN_PL** - the overall normalisation of the continuum emission for AGN (combination of borken power-laws) and its uncertainties.\n* **lBreak_PL, elBreak_PL** - the position of the main break for the AGN emission and its uncertainties.\n* **alpha1_PL, ealpha1_PL** - the slope of the AGN power-law below 15 micron and its uncertainties.\n* **alpha2_PL, ealpha2_PL** - the slope of the AGN power-law above 15 micron and below lbreak_PL and its uncertainties.\n* **logNorm_Si11, elogNorm_Si11** - the log-normalisation of the silicate emission at 11 micron and its uncertainties.\n* **logNorm_Si18, elogNorm_Si18** - the log-normalisation of the silicate emission at 18 micron and its uncertainties.\n* **loglumIR_host, eloglumIR_host** - the IR (8--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumMIR_host, eloglumMIR_host** - the MIR (5--35 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumFIR_host, eloglumFIR_host** - the FIR (40--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumIR_AGN, eloglumIR_AGN** - the IR luminosity of the AGN free of host contamination, and its uncertainties.\n* **loglumMIR_AGN, eloglumMIR_AGN** - the MIR luminosity of the AGN free of host contamination, and its uncertainties.\n* **loglumFIR_AGN, eloglumFIR_AGN** - the FIR luminosity of the AGN free of host contamination, and its uncertainties.\n* **AGNfrac_IR** - the fraction of the total IR luminosity which is attributed to the AGN, and its uncertainties.\n* **AGNfrac_MIR** - the fraction of the total MIR luminosity which is attributed to the AGN, and its uncertainties.\n* **AGNfrac_FIR** - the fraction of the total FIR luminosity which is attributed to the AGN, and its uncertainties.\n* **SFR, eSFR** - the star formation rate free of AGN contamination, and its uncertainties.\n* **wSFR, ewSFR** - the weighted star formation rate free of AGN contamination, and its uncertainties.\n* **logl** - the loglikelihood of the fit given the model.\n* **Aw** - the Akaike weight of the model.\n* **tau9p7** - the total extinction at 9.7 micron.\n* **bestModelFlag** - a value of 1.0 indicates the best model.\n\nThe table sourceName_fitRes_photo.csv is a CSV table which contains the results of the fits performed on data with photometry alone. Each table row corresponds to one of the 18 possible models considered by iragnsep. Columns are as follow,\n\n* **tplName_gal** - the name of the galaxy template [gal1_dust, gal2_dust, gal3_dust, gal4_dust, gal1_emp, gal2_emp].\n* **AGNon** - if  0.0, the results are for a fit that does not contain any AGN contribution, while if 1.0 the results are for a fit that accounts for AGN contribution.\n* **tplName_AGN** - the name of the AGN continuum template [AGN_A, AGN_B].\n* **logNormGal_dust, elogNormGal_dust** - the log-normalisation of the galaxy dust continuum template and its uncertainties.\n* **logNormGal_PAH, elogNormGal_PAH** - the log-normalisation of the PAH emission template and its uncertainties.\n* **logNormAGN, elogNormAGN** - the log-normalisation of the AGN continuum template and its uncertainties.\n* **logNormSiem, elogNormSiem** - the log-normalisation of the silicate emission template (if included in the fit) and its uncertainties.\n* **loglumIR_host, eloglumIR_host** - the IR (8--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumMIR_host, eloglumMIR_host** - the MIR (5--35 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumFIR_host, eloglumFIR_host** - the FIR (40--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.\n* **loglumIR_AGN, eloglumIR_AGN** - the IR luminosity of the AGN free of host contamination, and its uncertainties.\n* **loglumMIR_AGN, eloglumMIR_AGN** - the MIR luminosity of the AGN free of host contamination, and its uncertainties.\n* **loglumFIR_AGN, eloglumFIR_AGN** - the FIR luminosity of the AGN free of host contamination, and its uncertainties.\n* **AGNfrac_IR** - the fraction of the total IR luminosity which is attributed to the AGN, and its uncertainties.\n* **AGNfrac_MIR** - the fraction of the total MIR luminosity which is attributed to the AGN, and its uncertainties.\n* **AGNfrac_FIR** - the fraction of the total FIR luminosity which is attributed to the AGN, and its uncertainties.\n* **SFR, eSFR** - the star formation rate free of AGN contamination, and its uncertainties.\n* **wSFR, ewSFR** - the weighted star formation rate free of AGN contamination, and its uncertainties.\n* **logl** - the loglikelihood of the fit given the model.\n* **Aw** - the Akaike weight of the model.\n* **bestModelFlag** - a value of 1.0 indicates the best model.\n\n## The templates\n\nirasgnsep uses a library of templates for the galaxy and the AGN emission. Interested reader are referred to Bernhard et al. (in prep.) for a detailed description of the templates. The templates are available as a CSV table at: https://bitbucket.org/ebernhard/iragnsep/src/master/iragnsep/iragnsep_templ.csv . Columns are as follow,\n\n* **lambda_mic** - the wavelength in micron spanning 1--1000 microns.\n* **gal1_dust, egal1_dust** - the nuLnu of the first semi-empirical galaxy continuum template, normalised to Lir (i.e. integrated from 1-1000microns), and its uncertainties.\n* **gal2_dust, egal2_dust** - the nuLnu of the second semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.\n* **gal3_dust, egal3_dust** -  the nuLnu of the third semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.\n* **gal4_dust, egal4_dust** -  the nuLnu of the fourth semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.\n* **gal1_emp, egal1_emp** -  the nuLnu of the first empirical galaxy continuum template, normalised to Lir, and its uncertainties.\n* **gal2_emp, egal2_emp** -  the nuLnu of the second empirical galaxy continuum template, normalised to Lir, and its uncertainties.\n* **gal_PAH, egal_PAH** -  the nuLnu of the PAH emission template, normalised to Lir, and its uncertainties.\n* **AGN_Siem** -  the nuLnu of the silicate emission template, normalised to Lir, and its uncertainties.\n* **AGN_A** -  the nuLnu of the first AGN continuum template, normalised to Lir, and its uncertainties.\n* **AGN_B** - the nuLnu of the second AGN continuum template, normalised to Lir, and its uncertainties.\n\n## iragnsep: modules\n\n--\n\n### run_all\n\n--\n\nDescription:\n\nThe module run_all eases the use of iragnsep by running everything from the fits to the plots and give the possibility to save the result of the fits as CSV tables. run_all contains two functions. fitSpec performs everything on datasets which combine spectral and photometric data, and fitPhoto does the same but on photometry alone datasets.\n\n----\n\n**res, resBM = fitSpec(wavSpec, fluxSpec, efluxSpec,\\\n\t\t\twavPhot, fluxPhot, efluxPhot, \\\n\t\t\tfilters, \\\n\t\t\tz = -0.01,\\\n\t\t\tULPhot = [],\\\n\t\t\tobsCorr = True,\\\n\t\t\tS9p7_fixed = -99.,\\\n\t\t\tNmc = 10000, pgrbar = 1, \\\n\t\t\tPdust = [10., 3.], PPAH = [9., 3.], Ppl = [-1., 3.], Pbreak = [1.603, 0.01], Pslope1 = [1., 2.], Pslope2 = [1., 2.], \\\n\t\t\tPlsg = [-1., 3.], Pllg = [-1., 3.],\\\n\t\t\tsourceName = 'NoName', pathTable = './', pathFig = './', \\\n\t\t\tredoFit = True, saveRes = True)**\n\n\nThis function fits the observed SED when a spectrum is combined to photometric data. The observed wavelengths, fluxes and uncertainties on the fluxes are passed separately for the spectrum and the photometric data.\n  \nINPUT:\n\n* **wavSpec** - observed wavelengths for the spectrum (in microns).\n* **fluxSpec** - observed fluxes for the spectrum (in Jansky).\n* **efluxSpec** - observed uncertainties on the fluxes for the spectrum (in Jansky).\n* **wavPhot** - observed wavelengths for the photometry (in microns).\n* **fluxPhot** - observed fluxes for the photometry (in Jansky).\n* **efluxPhot** - observed uncertainties on the fluxes for the photometry (in Jansky).\n* **filters** - name of the photometric filters corresponding to the observed photometry passed in wavPhot.\n\nOUTPUT:\n\n* **res_fit** - dataframe containing the results of all the possible fits.\n* **res_fitBM** - dataframe containing the results of the best fit only.\n\nKEYWORDS:\n    \n* **z** - redshift of the source. Default = 0.01.\n* **ULPhot** - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n* **obsCorr** - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True\n* **S9p7_fixed** - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.\n* **Nmc** - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thinning of 10 is applied. Default = 10000.\n* **pgrbar** - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.\n* **Pdust** - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).\n* **PPAH** - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].\n* **Ppl** - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].\n* **Pbreak** - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].\n* **Pslope1** - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].\n* **Pslope2** - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].\n* **Plsg** - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].\n* **Pllg** - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].\n* **sourceName** - name of the source. Default = 'NoName'.\n* **pathTable** - if saveRes is set to True, the tables containing the results of the fits will be saved at the location pathTable. Default = './'.\n* **pathFig** - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n* **redoFit** - if set to True, re-performs the fits. Otherwise, find the table saved at pathTable and reproduces the analysis and the figures only. Default = True.\n* **saveRes** - if set to True, the tables containing the results of the fits, as well as the figures are saved. Default = True.\n\n----\n\n**res, resBM = fitPhoto(wav, flux, eflux,\\\n\t\t\t filters, \\\n\t\t\t z = -0.01,\\\n\t\t\t UL = [], \\\n\t\t\t Nmc = 10000, pgrbar = 1, \\\n\t\t\t NoSiem = False, \\\n\t\t\t Pdust = [10., 3.], PPAH = [9., 3.], PnormAGN = [10., 3.], PSiEm = [10., 3.], \\\n\t\t\t sourceName = 'NoName', pathTable = './', pathFig = './', \\\n\t\t\t redoFit = True, saveRes = True, NOAGN = False)**\n\nThis function fits the observed photometric SED.\n\nINPUT:\n\n* **wav** - observed wavelengths (in microns).\n* **fluxSpec** - observed fluxes (in Jansky).\n* **efluxSpec** - observed uncertainties on the fluxes (in Jansky).\n* **filters** - name of the photometric filters corresponding to the observed photometry passed in wav.\n\nOUTPUT:\n\n* **res_fit** - dataframe containing the results of all the possible fits.\n* **res_fitBM** - dataframe containing the results of the best fit only.\n\nKEYWORDS:\n\n**z** - redshift of the source. Default = 0.01.\n**UL** - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n**Nmc** - * **Nmc** - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.\n**pgrbar** - if set to 1, display a progress bar while fitting the SED. Default = 1.\n**NoSiem** - if set to True, no silicate emission template is included in the fit. Default = False.\n**Pdust** - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).\n**PPAH** - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].\n**PnormAGN** - normal prior on the log-normalisation of the AGN template. Default = [10., 3.].\n**PSiem** - normal prior on the log-normalisation of the silicate emission template. Default = [10., 3.].\n**sourceName** - name of the source. Default = 'NoName'.\n**pathTable** - if saveRes is set to True, the tables containing the results of the fits will be saved at the location pathTable. Default = './'.\n**pathFig** - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n**redoFit** - if set to True, re-performs the fits. Otherwise, find the table saved at pathTable and reproduces the analysis and the figures only. Default = True.\n**saveRes** - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n**NOAGN** - if set to True, the AGN component is not included in the fits, Default = False.\n\n----\n\n--\n\n### SEDanalysis\n\n--\n\nDescription:\n\nThe module SEDanalysis is the module which runs the fits (yet see the **run_all** module for an easier use of iragnsep, including generating plots and tables). SEDanalysis contains two main functions. **runSEDspecFit** is for dataset which combines spectral and photometric fluxes, and **runSEDphotFit** is for dataset which contains photometric data only.\n\n-- --\n\n**dfRes = runSEDspecFit(wavSpec, fluxSpec, efluxSpec,\\\n\t\t\t\t  wavPhot, fluxPhot, efluxPhot, filters, \\\n\t\t\t\t  z = -0.01,\\\n\t\t\t\t  ULPhot = [], \\\n\t\t\t\t  obsCorr = True,\\\n\t\t\t\t  S9p7_fixed = -99., \\\n\t\t\t\t  Nmc = 10000, pgrbar = 1, \\\n\t\t\t\t  Pdust = [10., 3.], PPAH = [9., 3.], Ppl = [-1., 3.], Pbreak = [1.603, 0.01], Pslope1 = [1., 2.], Pslope2 = [1., 2.], \\\n\t\t\t\t  Plsg = [-1., 3.], Pllg = [-1., 3.],\\\n\t\t\t\t  templ = '')**\n\nThis function fits the observed SED when a spectrum is combined to photometric data. The observed wavelengths, fluxes and uncertainties on the fluxes are passed separately for the spectrum and the photometric data.\n\nINPUT:\n\n* **wavSpec** - observed wavelengths for the spectrum (in microns).\n* **fluxSpec** - observed fluxes for the spectrum (in Jansky).\n* **efluxSpec** - observed uncertainties on the fluxes for the spectrum (in Jansky).\n* **wavPhot** - observed wavelengths for the photometry (in microns).\n* **fluxPhot** - observed fluxes for the photometry (in Jansky).\n* **efluxPhot** - observed uncertainties on the fluxes for the photometry (in Jansky).\n* **filters** - name of the photometric filters corresponding to the observed photometry passed in wavSpec.\n\nOUTPUT:\n\n* **dfRes** - dataframe containing the results of all the possible fits.\n\nKEYWORDS:\n    \n* **z** - redshift of the source. Default = 0.01.\n* **ULPhot** - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n* **obsCorr** - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True\n* **S9p7_fixed** - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.\n* **Nmc** - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.\n* **pgrbar** - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.\n* **Pdust** - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).\n* **PPAH** - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].\n* **Ppl** - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].\n* **Pbreak** - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].\n* **Pslope1** - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].\n* **Pslope2** - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].\n* **Plsg** - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].\n* **Pllg** - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].\n* **templ** - pass the templates to be used. If none, use the library of templates from Bernhard et al. (in prep.). Default: ''.\n\n-- --\n\n**dfRes = runSEDphotFit(lambdaObs, fluxObs, efluxObs, \\\n\t\t\t\t  filters, \\\n\t\t\t\t  z = 0.01, \\\n\t\t\t\t  UL = [], \\\n\t\t\t\t  Nmc = 10000, pgrbar = 1, \\\n\t\t\t\t  NoSiem = False, \\\n\t\t\t\t  Pdust = [10., 13], PPAH = [9., 3.], PnormAGN = [10., 3.], PSiEm = [10., 3.], \\\n\t\t\t\t  templ = '', NOAGN = False)**\n\nThis function fits the observed photometric SED.\n\nINPUT:\n\n**lambdaObs** - observed wavelengths (in microns).\n**fluxObs** - observed fluxes (in Jansky).\n**efluxObs** - observed uncertainties on the fluxes (in Jansky).\n**filters** - name of the photometric filters to include in the fit.\n\nOUTPUT:\n\n**dfRes** - dataframe containing the results of all the possible fits.\n\nKEYWORDS:\n\n* **z** - redshift of the source. Default = 0.01.\n* **ULPhot** - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n* **obsCorr** - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True\n* **tau9p7_fixed** - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.\n* **Nmc** - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.\n* **pgrbar** - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.\n* **Pdust** - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).\n* **PPAH** - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].\n* **Ppl** - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].\n* **Pbreak** - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].\n* **Pslope1** - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].\n* **Pslope2** - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].\n* **Plsg** - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].\n* **Pllg** - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].\n* **templ** - pass the templates to be used. If none, use the library of templates from Bernhard et al. (in prep.). Default: ''.\n* **NOAGN** - if set to True, the AGN contribution is not included in the fits. Default: False.\n\n-- --\n\n--\n\n\n### toolplot\n\n--\n\nDescription:\n\nThe module toolplot generates plots based on the results of the fits. toolplot contains two functions. plotFitSpec generates a plot showing all of the possible combinations of models and generates a plot showing that of the best model for dataset which combines spectral and photometric data. plotFitPhoto is the same as plotFitSpec but for photometric datasets.\n\n-- --\n\n**plotFitSpec(df, wavSpec, fluxSpec, efluxSpec, wavPhot, fluxPhot, efluxPhot, UL = np.array([]), pathFig = './', sourceName = 'NoName', templ = '', z = 0.01, saveRes = True)**\n\nThis function plots the results of the fits for data which contain spectral + photometric fluxes.\n\nINPUT:\n\n**df** - data-frame contaning the results of the fits (i.e. optimised parameters) as returned by the function SEDanalysis.runSEDspecFit.\n**wavSpec** - observed wavelengthts for the spectrum (in microns).\n**fluxSpec** - observed fluxes for the spectrum (in Jansky).\n**efluxSpec** - observed uncertainties on the fluxes for the spectrum (in Jansky).\n**wavPhot** - observed wavelengths for the photometry (in microns).\n**fluxPhot** - observed fluxes for the photometry (in Jansky).\n**efluxPhot** - observed uncertainties on the fluxes for the photometry (in Jansky).\n\nKEYWORDS:\n\n**z** - redshift of the source. Default = 0.01.\n**UL** - vector of length Nphot, where Nphot is the number of photometric data. If any of the values is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n**sourceName** - name of the source. Default = 'NoName'.\n**pathFig** - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n**saveRes** - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n**templ** - pass the templates that have been used in the fits.\n\n-- --\n\n**plotFitPhoto(df, wav, flux, eflux, UL = np.array([]), pathFig = './', sourceName = 'NoName', templ = '', z = 0.01, saveRes = True)**\n\t\nThis function plots the results of the fits for photometric data.\n\nINPUT:\n\n**df** - data-frame contaning the results of the fits (i.e. optimised parameters) as returned by the function SEDanalysis.runSEDphotFit.\n**wav** - observed wavelengthts (in microns).\n**flux** - observed fluxes (in Jansky).\n**eflux** - observed uncertainties on the fluxes (in Jansky).\n\nKEYWORDS:\n\n**z** - redshift of the source. Default = 0.01.\n**UL** - vector of length Nphot, where Nphot is the number of photometric data. If any of the values is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n**sourceName** - name of the source. Default = 'NoName'.\n**pathFig** - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n**saveRes** - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n**templ** - set the templates that have been used in the fits.\n\n-- --\n\n--\n\n### func\n\n--\n\nDescription:\n\nThe module func contains the functions used to run the fits, the best model selection and the analysis.\n\n-- --\n\n**get_prop(df, echar, z = 0.01, specOn = True, templ = '')**\n\nThis function calculates the IR properties of the AGN and their hosts.\n\nINPUT:\n\n**df** - data-frame containing the results from the fits (i.e. optimised parameters) as returned by SEDanalysis.\n**echar** - characteristic uncertainties to calculate the uncertainties on the parameters.\n    \nOUTPUT:\n\n**loglum_hostIR** - the host IR (8--1000microns) log-luminosity free of AGN contamination (Lsun).\n**eloglum_hostIR** - uncertainties on loglum_hostIR.\n**loglum_hostMIR** - the host IR (5--35microns) log-luminosity free of AGN contamination (Lsun).\n**eloglum_hostIR** - uncertainties on loglum_hostMIR.\n**loglum_hostFIR** - the host IR (40--1000microns) log-luminosity free of AGN contamination (Lsun).\n**eloglum_hosFIR** - uncertainties on loglum_hostFIR.\n**loglum_AGNIR** - the AGN IR log-luminosity free of host contamination (Lsun).\n**loglum_AGNMIR** - the AGN MIR log-luminosity free of host contamination (Lsun).\n**loglum_AGNFIR** - the AGN FIR log-luminosity free of host contamination (Lsun).\n**AGNfrac_IR** - the AGN fraction in the IR.\n**AGNfrac_MIR** - the AGN fraction in the MIR.\n**AGNfrac_FIR** - the AGN fraction in the FIR.\n**SFR** - the SFR of the galaxy free of AGN contamination.\n**eSFR** - the uncertainties on SFR.\n**wSFR** - the SFR of the galaxy free of AGN contamination weighted by its Akaike weight.\n**ewSFR** - the uncertainties on wSFR.\n\nKEYWORDS:\n\n**z** - redshift\n**specOn** - set to True if the data contain a spectrum in addition to the photometry.\n**templ** - set the templates that have been used in the fits.\n\n-- --\n\n**basictests(wavSpec, fluxSpec, efluxSpec, wavPhot, fluxPhot, efluxPhot, filters, z, specOn = True)**\n\nThis function runs some basic tests prior to run the main fitting code.\n\nINPUT:\n\n**wavSpec** - observed wavelengths for the spectrum (in microns).\n**fluxSpec** - observed fluxes for the spectrum (in Jansky).\n**efluxSpec** - observed uncertainties on the fluxes for the spectrum (in Jansky).\n**wavPhot** - observed wavelengths for the photometry (in microns).\n**fluxPhot** - observed fluxes for the photometry (in Jansky).\n**efluxPhot** - observed uncertainties on the fluxes for the photometry (in Jansky).\n**filters** - name of the photometric filters to include in the fit.\n**z** - redshift.\n\nKEYWORDS:\n\n**specOn** - set to True if the data contain a spectrum in addition to the photometry.\n\n-- --\n\n**exctractBestModel(logl, k, n, corrected = True)**\n\nThis function extracts the best model and calculates the Akaike weights based on the log-likelihood returned by the fits.\n\nINPUT:\n\n**logl** - log-likelihood returned by the fits.\n**k** - number of free parameters.\n**n** - number of data points.\n\nOUTPUTS:\n\n**bestModelInd** - the index of the best model fit.\n**Awi** - Akaike weights of each of the models, with respect to the best model.\n\nKEYWORDS:\n\n**corrected** - if set to True, calculates the corrected AIC for small number of data points.\n\n-- -- \n\n**nuLnuToFnu(spec_wav, nuLnu, z)**\n\nThis function calculates the observed flux from nuLnu.\n\nINPUT:\n\n**spec_wav** - rest-wavelengths (in microns).\n**nuLnu** -  nuLnu.\n**z** - redshift.\n\nOUTPUT:\n\n**Fnu** - observed flux on Earth of the source located at redshift z (in Jansky).\n\n-- --\n\n**getFluxInFilt(filt_wav, filt_QE, spec_wav, nuLnu, z):**\n\nThis function calculates the synthetic flux in a given filter and at a given redshift from a source with luminosity nuLnu.\n\nINPUT:\n\n**filt_wav** - passband of the filter.\n**filt_QE** - quantum efficient of the filter.\n**spec_wav** - rest-wavelengths (in microns).\n**nuLnu** - nuLnu.\n**z** - redshift.\n \nOUTPUT:\n\n**flux_Obs** - observed flux on Earth of the source located at redshift z with luminosity nuLnu (in Jansky).\n\n-- --\n\n**logldet(ym, ydat, eydat, wei):**\n\nThis function calculates the log-likelihood of detected data.\n\nINPUT:\n\n**ym** - model values.\n**ydat** - observed values.\n**eydat** - observed uncertaities.\n**wei** - weights of the data points.\n\nOUTPUT:\n\n**logl** - log-likelihood of the model.\n\n-- --\n\n**erf_approx(x)**\n\nThis function calculates an approximation of the error function.\n\nINPUT:\n\n**x** - x values to which the error function is calculated at.\n\nOUTPUT:\n\n**erf_approx_eval** - approximate value of the error function.\n\n-- --\n\n**loglUL(ym, ydat)**\n\nThis function calculates the log-likelihood of undetected data.\n\nINPUT:\n\n**ym** - model values.\n**ydat** - observed values.\n\nOUTPUT:\n\n**logl** - log-likelihood of the model.\n\n-- --\n\n**Gauss_jit(x, mu, sigma)**\n\nThis function calculates a Gaussian normalised to its maximum.\n\nINPUT:\n\n**x** - x-values.\n**mu** - mean.\n**sigma** - standard deviation.\n\nOUTPUT:\n\n**Bnu** Gaussian evaluated at x, normalised to its maximum.\n\n-- --\n\n**AGNmodel_firstPL_jit(x, lambdab, alpha1, alpha2, s)**\n\nThis function calculates the first broken power-law of the AGN model.\n\nINPUT:\n\n**x** - x-values.\n**lambdab** - position of the break.\n**alpha1** - slope of the first power-law.\n**alpha2** - slope of the second power-law.\n**s** - sharpness parameter for the break between alpha1 and alpha2. \n\nOUTPUT:\n\n**Bnu** - corresponding broken power law evaluated at x, and normalised at 10 microns.\n\n-- --\n\n**AGNmodel_jit(x, lambdab1, lambdab2, alpha1, alpha2, alpha3)**\n\nThis function calculates the second broken power-law of the AGN model.\n\nINPUT:\n\n**x** - x-values.\n**lambdab1** - position of the break for the first broken power law.\n**lambdab2** - position of the break for the second broken power law.\n**alpha1** - slope of the first power-law.\n**alpha2** - slope of the second power-law.\n**alpha2** - slope of the third power-law.\n\nOUTPUT:\n\n**Bnu** - corresponding double-broken power law evaluated at x, and normalised at 10 microns.\n\n-- --\n\n**KVTextinctCurve(lambda_obs)**\n\nThis function calculates the extinction curve from Kemper et al. (2004).\n\nINPUT:\n\n**lambda_obs** - observed wavelengths.\n\nOUTPUT:\n\n**tau_return** - absorption coefficient tau per wavelength.\n\n-- --\n\n**drude(x, gamma_r, lambda_r, normed = True)**\n\nThis function calculates a Drude profile.\n\nINPUT:\n\n**x** - x-values.\n**gamma_r** - central wavelengths.\n**lambda_r** - fractional FWHM.\n\nOUTPUT:\n\n**drudeVal** - the Drude profile evaluated at x.\n\nKEYWORDS:\n\n**normed** - if set to True, normalise to the maximum value.\n\n-- -- \n\nobsC(wavRest, flux, eflux):\n\nThis function calculates the total obscuration at 9.7micron.\n\nINPUT:\n\n**wavRest** -rest-wavelength.\n**flux** - observed fluxes.\n**eflux** - uncertainties on the observed fluxes.\n\nOUTPUT:\n\n**_tau9p7** - the total obscuration at 9.7micron.\n\n-- --\n\n--\n\n### classes\n\n--\n\nThe module classes contains one class called 'modelToSED' which calls various functions to return the photometric point at a given wavelengths in a given filters for a model nuLnu. The available filters are as follow:\n\n* **IRAC1** - Spitzer IRAC, 3.6 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer\n* **IRAC2** - Spitzer IRAC, 4.5 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer\n* **IRAC3** - Spitzer IRAC, 5.8 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer\n* **IRAC4** - Spitzer IRAC, 8.0 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer\n* **WISE_W1** - WISE, 3.4 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=WISE\n* **WISE_W2** - WISE, 4.6 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=WISE\n* **WISE_W3** - WISE, 12 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=WISE\n* **WISE_W4** - WISE, 22 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=WISE\n* **IRAS12** - IRAS, 12 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=IRAS\n* **IRAS60** - IRAS, 60 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=IRAS\n* **IRAS100** - IRAS, 100 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=IRAS\n* **MIPS24** - Spitzer MIPS, 24 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer&gname2=MIPS\n* **MIPS70** - Spitzer MIPS, 70 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer&gname2=MIPS\n* **MIPS160** - Spitzer MIPS, 160 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Spitzer&gname2=MIPS\n* **PACS70** - Herschel PACS, 70 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel\n* **PACS100** - Herschel PACS, 100 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel\n* **PACS160** - Herschel PACS, 160 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel\n* **SPIRE250ps** - Herschel SPIRE, 250 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel&gname2=SPIRE\n* **SPIRE350ps** - Herschel SPIRE, 350 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel&gname2=SPIRE\n* **SPIRE500ps** - Herschel SPIRE, 500 micron, http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&gname=Herschel&gname2=SPIRE\n\nNote: to add filter please contact e.p.bernhard[at]sheffield.ac.uk.\n\n-- --\n\n## Cautionary notes\n\nAs this is the first version of iragnsep we suggest the user to carefully check results, and to report anything that is possibly a bug. To do this, please contact us at: e.p.bernhard[at]sheffield.ac.uk.\n\nThe templates and models built for iragnsep are based on observations out to z=0.3. We have tested these on photometry of galaxies in the COSMOS field at higher redshifts, and the results appear to be reliable. However, there is no formal proof, and we suggest that the user carefully check results for these sources.\n\nThe templates have been derived on moderate luminosity AGNs 41.6 erg/s<Log10(Lx2-10kev)<45.2 erg/s. As a consequence, using iragnsep for, let's say, bright QSOs is at the User's own risks. We stress however that our AGN templates are in agreement with AGN templates for quasars.\n\n## Future work\n\nFuture version will allow a more flexible input for the observed data. In addition it will be possible for the user to choose a complete different set of templates, if necessary.\n\nFor this version we use Numba to speed up the code. This python dependency pre-compiles the code allowing iragnsep to run faster. Using Numba, we have sped up iragnsep by a factor of 10. Since MCMC are time expensive, we are planning to further incorporate multi-threading for a possible increase in the speed.\n\nSo far we have tested iragnsep using data from the IRS spectra and  the Herschel photometry. We plan to test the possibility to incorporate other spectral data such as future JWST data.\n\n## Versioning\n\nWe use three numbers for the versions defined as x.y.z. If only y and z are changed the output of iragnsep is unchanged and minor patches are applied. If x changes it means that major changes has been applied and results are likely to differ from the x-1 version.\n\nThe first released version starts at x=5.\n\n## Authors\n\n* **Emmanuel Bernhard** - *Initial work*\n* James Mullaney\n* Clive Tadhunter\n\nThe associated paper can be found at Bernhard et al. (in prep).\n\n## Citation\n\nPlease cite Bernhard et al. (in prep) when using iragnsep.\n\n## License\n\nThis project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://bitbucket.org/ebernhard/iragnsep/src/master/", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "iragnsep", "package_url": "https://pypi.org/project/iragnsep/", "platform": "", "project_url": "https://pypi.org/project/iragnsep/", "project_urls": {"Homepage": "https://bitbucket.org/ebernhard/iragnsep/src/master/"}, "release_url": "https://pypi.org/project/iragnsep/6.0.0/", "requires_dist": null, "requires_python": ">=3.6", "summary": "Fits of IR SEDs including AGN contribution.", "version": "6.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>iragnsep</h1>\n<p>iragnsep performs IR (i.e. 8--1000 microns) SED fits, separated into AGN and galaxy contributions, and measure host galaxy properties (e.g. SFRs) free of AGN contamination. The advantage of iragnsep is that, in addition to fitting observed broadband photometric fluxes, it also allows to incorporate IR spectra in the fits which, if available, greatly  improves the robustness of the galaxy-AGN separation.</p>\n<p>For the galaxy component iragnsep uses a library of galaxy templates built and presented in Bernhard et al. (in prep.). In terms of the AGN contribution, if the input dataset is a mixture of spectral and photometric data, iragnsep uses a combination of power-laws for the AGN continuum and some broad features for the silicate emission. If, instead, the dataset contains photometric data alone, the AGN contribution is accounted for by using the library of AGN templates presented in Bernhard et al. (in prep.).</p>\n<p>The advanced fitting techniques used by iragnsep (i.e. MLE optimised with MCMC) combined with the powerful model comparison tests (i.e. AIC) allow iragnsep to provide a statistically robust interpretation of IR SEDs in terms of AGN\u2013galaxy contributions, even when the AGN contribution is highly diluted by the host galaxy emission.</p>\n<p>The aim of this README is to show how to use iragnsep. This document also contains important information such as limitations and cautions and the modules and functions which define iragnsep.</p>\n<p>For a detailed description on the templates and fitting technique, see Bernhard et al. (in prep.).</p>\n<p>Contacts: e.p.bernhard[at]sheffield.ac.uk</p>\n<h2>Getting Started</h2>\n<p>These instructions should assist you in getting iragnsep running on your machine. iragnsep is written in python 3 and is available on PyPI.</p>\n<h3>Prerequisites</h3>\n<p>iragnsep requires some non-standard libraries (dependencies) to run. These should automatically get installed when downloading and installing iragnsep via PyPi. If not, these can be manually installed using the pip3 command. The dependencies are as follow,</p>\n<ul>\n<li><a href=\"https://numpy.org\" rel=\"nofollow\">NumPy</a> - NumPy is the fundamental package for scientific computing with Python.</li>\n<li><a href=\"https://matplotlib.org\" rel=\"nofollow\">Matplotlib</a> - Matplotlib is a Python 2D plotting library.</li>\n<li><a href=\"https://www.astropy.org\" rel=\"nofollow\">Astropy</a> - The Astropy Project is a community effort to develop a common core package for Astronomy in Python and foster an ecosystem of inter-operable astronomy packages.</li>\n<li><a href=\"https://www.scipy.org\" rel=\"nofollow\">SciPy</a> - SciPy is a Python-based ecosystem of open-source software for mathematics, science, and engineering.</li>\n<li><a href=\"https://pandas.pydata.org\" rel=\"nofollow\">pandas</a> - pandas is an open source, BSD-licensed library providing high-performance, easy-to-use data structures and data analysis tools for the Python programming language.</li>\n<li><a href=\"https://emcee.readthedocs.io/en/stable/#\" rel=\"nofollow\">emcee</a> - emcee is an MIT licensed pure-Python implementation of Goodman &amp; Weare\u2019s Affine Invariant Markov chain Monte Carlo (MCMC) Ensemble sampler.</li>\n<li><a href=\"http://numba.pydata.org\" rel=\"nofollow\">Numba</a> - Numba translates Python functions to optimised machine code at runtime using the industry-standard LLVM compiler library. Numba-compiled numerical algorithms in Python can approach the speeds of C or FORTRAN.</li>\n</ul>\n<h3>Installation</h3>\n<p>We recommend to install iragnsep and its dependencies using pip,</p>\n<pre><code>pip3 install iragnsep\n</code></pre>\n<p>The project is also publicly available on bitbucket at <a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/\" rel=\"nofollow\">https://bitbucket.org/ebernhard/iragnsep/src/master/</a> .</p>\n<h2>Quick start</h2>\n<p>In this section we show how to infer the SFR of the galaxy mrk1066 using iragnsep.</p>\n<h3>Step 1: Get the data and the script</h3>\n<p>You can download the data at <a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/\" rel=\"nofollow\">https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/</a>. The file data_mrk1066.csv contains the Herschel fluxes of mrk1066, and the file data_mrk1066_spec.csv contains the Spitzer-IRS spectrum of mrk1066. The file main.py is the main script. Once downloaded, create a folder with all of these files.</p>\n<h3>Step 2: Run the script</h3>\n<p>In a terminal simply cd to the folder that contains the files and run,</p>\n<pre><code>python3 main.py\n</code></pre>\n<p>iragnsep is now fitting mrk1066, first using a combination of the IRS spectra and Herschel photometry, then using photometry only as if the IRS spectra was not available. The user can open the file main.py which is commented and can be used as a template for future use of iragnsep.</p>\n<h3>Step 3: Output</h3>\n<p>Once the fits are performed the plots and tables are generated and saved in the same folder.</p>\n<ul>\n<li><strong>mrk1066_fitRes_spec.csv</strong> - (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitRes_spec.csv\" rel=\"nofollow\">Available here</a>) contains the results of the fits for the 12 possible combinations of models considered by iragnsep. Each row corresponds to a specific model. This file contains the results of the fits performed on data which included the IRS spectrum. The best model is flagged by a value of 1.0 in the column 'bestModelFlag'. See section ** Description of the tables** for a full description.</li>\n<li><strong>mrk1066_fitResAll_spec.pdf</strong> - (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResAll_photo.pdf\" rel=\"nofollow\">Available here</a>) shows each of the 12 possible models fit to the data which included the IRS spectrum.</li>\n<li><strong>mrk1066_fitResBM_spec.pdf</strong> -  (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResBM_spec.pdf\" rel=\"nofollow\">Available here</a>) shows the best fit to the data which included the IRS spectrum. The best fit corresponds to a statistically weighted sum of all of the 12 different models.</li>\n<li><strong>mrk1066_fitRes_photo.csv</strong> - (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitRes_photo.csv\" rel=\"nofollow\">Available here</a>) contains the results of the fits for the 18 possible combinations of templates. Each row corresponds to a specific model. This file contains the results of the fits performed in photometry only (i.e. the IRS spectra was replaced by photometry). The best model is flagged by a value of 1.0 in the column 'bestModelFlag'. See the section ** Description of the tables** for a full description.</li>\n<li><strong>mrk1066_fitResAll_photo.pdf</strong> - (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResAll_photo.pdf\" rel=\"nofollow\">Available here</a>) shows each of the 18 models fit to the photometric data.</li>\n<li><strong>mrk1066_fitResBM_photo.pdf</strong> - (<a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/Mrk1066/mrk1066_fitResBM_photo.pdf\" rel=\"nofollow\">Available here</a>) shows the best fit to the photometric data. The best fit corresponds to a statistically weighted sum of all of the 18 different models..</li>\n</ul>\n<h2>Preparing your data</h2>\n<p>As this is the first release of iragnsep it is important to make sure that the input data are compatible with the code. Future versions will allow more flexibility in the format of the input data. The main input are the wavelengths of the SED (or combined spectrum and photometry) and the corresponding fluxes and their uncertainties. Here is a (non-exhaustive) check list of points that are required to ensure a robust behaviour of iragnsep.</p>\n<ul>\n<li>the wavelengths are in microns, the fluxes and the uncertainties are in Jy.</li>\n<li>the vector wavelength is in monotonically increasing order.</li>\n<li>their is no negative or undefined (e.g. nan) values in the fluxes and their uncertainties (upper-limits can be passed via the keywords UL and ULphot).</li>\n<li>if using iragnsep with a combination of a spectrum and photometry, make sure that no photometric points are overlapping with the spectral data (e.g. IRS spectra and MIPS 24 micron would be overlapping).</li>\n<li>from practice, a good value for Nmc (the number of steps in the MCMC) is at least 10000 steps.</li>\n<li>do not forget to set the redshift of the source using the keyword z.</li>\n<li>for the photometric version, avoid photometry below roughly 5 microns rest-frame as iragnsep has not been designed to account for emissions below this value (e.g. old stellar population and very host dust component).</li>\n</ul>\n<p>Should you find anything non-intuitive missing from the above list, contact us at: e.p.bernhard[at]sheffield.ac.uk</p>\n<h2>Description of the tables</h2>\n<p>The output of the fits can be saved using the keyword saveRes as shown in the main.py of the Quick Start example on mrk1066. In particular two types of tables can be generated whether using the version of the code with spectra or that of with photometry alone.</p>\n<p>The table sourceName_fitRes_spec.csv (where sourceName is the name of the source passed by the user) is a comma separated values (CSV) table which contains the results of the fits performed on data which included spectra. Each table row corresponds to one of the 12 possible models considered by iragnsep. Columns are as follow,</p>\n<ul>\n<li><strong>tplName</strong> - the name of the galaxy template [gal1_dust, gal2_dust, gal3_dust, gal4_dust, gal1_emp, gal2_emp].</li>\n<li><strong>AGNon</strong> - if  0.0, the results are for a fit that does not contain any AGN contribution, while if 1.0 the results are for a fit that accounts for AGN contribution.</li>\n<li><strong>logNormGal_dust, elogNormGal_dust</strong> - the log-normalisation of the galaxy dust continuum template and its uncertainties.</li>\n<li><strong>logNormGal_PAH, elognNormGal_PAH</strong> - the log-normalisation of the PAH emission template and its uncertainties.</li>\n<li><strong>logNormAGN_PL, elogNormAGN_PL</strong> - the overall normalisation of the continuum emission for AGN (combination of borken power-laws) and its uncertainties.</li>\n<li><strong>lBreak_PL, elBreak_PL</strong> - the position of the main break for the AGN emission and its uncertainties.</li>\n<li><strong>alpha1_PL, ealpha1_PL</strong> - the slope of the AGN power-law below 15 micron and its uncertainties.</li>\n<li><strong>alpha2_PL, ealpha2_PL</strong> - the slope of the AGN power-law above 15 micron and below lbreak_PL and its uncertainties.</li>\n<li><strong>logNorm_Si11, elogNorm_Si11</strong> - the log-normalisation of the silicate emission at 11 micron and its uncertainties.</li>\n<li><strong>logNorm_Si18, elogNorm_Si18</strong> - the log-normalisation of the silicate emission at 18 micron and its uncertainties.</li>\n<li><strong>loglumIR_host, eloglumIR_host</strong> - the IR (8--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumMIR_host, eloglumMIR_host</strong> - the MIR (5--35 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumFIR_host, eloglumFIR_host</strong> - the FIR (40--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumIR_AGN, eloglumIR_AGN</strong> - the IR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>loglumMIR_AGN, eloglumMIR_AGN</strong> - the MIR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>loglumFIR_AGN, eloglumFIR_AGN</strong> - the FIR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>AGNfrac_IR</strong> - the fraction of the total IR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>AGNfrac_MIR</strong> - the fraction of the total MIR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>AGNfrac_FIR</strong> - the fraction of the total FIR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>SFR, eSFR</strong> - the star formation rate free of AGN contamination, and its uncertainties.</li>\n<li><strong>wSFR, ewSFR</strong> - the weighted star formation rate free of AGN contamination, and its uncertainties.</li>\n<li><strong>logl</strong> - the loglikelihood of the fit given the model.</li>\n<li><strong>Aw</strong> - the Akaike weight of the model.</li>\n<li><strong>tau9p7</strong> - the total extinction at 9.7 micron.</li>\n<li><strong>bestModelFlag</strong> - a value of 1.0 indicates the best model.</li>\n</ul>\n<p>The table sourceName_fitRes_photo.csv is a CSV table which contains the results of the fits performed on data with photometry alone. Each table row corresponds to one of the 18 possible models considered by iragnsep. Columns are as follow,</p>\n<ul>\n<li><strong>tplName_gal</strong> - the name of the galaxy template [gal1_dust, gal2_dust, gal3_dust, gal4_dust, gal1_emp, gal2_emp].</li>\n<li><strong>AGNon</strong> - if  0.0, the results are for a fit that does not contain any AGN contribution, while if 1.0 the results are for a fit that accounts for AGN contribution.</li>\n<li><strong>tplName_AGN</strong> - the name of the AGN continuum template [AGN_A, AGN_B].</li>\n<li><strong>logNormGal_dust, elogNormGal_dust</strong> - the log-normalisation of the galaxy dust continuum template and its uncertainties.</li>\n<li><strong>logNormGal_PAH, elogNormGal_PAH</strong> - the log-normalisation of the PAH emission template and its uncertainties.</li>\n<li><strong>logNormAGN, elogNormAGN</strong> - the log-normalisation of the AGN continuum template and its uncertainties.</li>\n<li><strong>logNormSiem, elogNormSiem</strong> - the log-normalisation of the silicate emission template (if included in the fit) and its uncertainties.</li>\n<li><strong>loglumIR_host, eloglumIR_host</strong> - the IR (8--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumMIR_host, eloglumMIR_host</strong> - the MIR (5--35 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumFIR_host, eloglumFIR_host</strong> - the FIR (40--1000 microns) luminosity of the host free of AGN contamination, and its uncertainties.</li>\n<li><strong>loglumIR_AGN, eloglumIR_AGN</strong> - the IR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>loglumMIR_AGN, eloglumMIR_AGN</strong> - the MIR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>loglumFIR_AGN, eloglumFIR_AGN</strong> - the FIR luminosity of the AGN free of host contamination, and its uncertainties.</li>\n<li><strong>AGNfrac_IR</strong> - the fraction of the total IR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>AGNfrac_MIR</strong> - the fraction of the total MIR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>AGNfrac_FIR</strong> - the fraction of the total FIR luminosity which is attributed to the AGN, and its uncertainties.</li>\n<li><strong>SFR, eSFR</strong> - the star formation rate free of AGN contamination, and its uncertainties.</li>\n<li><strong>wSFR, ewSFR</strong> - the weighted star formation rate free of AGN contamination, and its uncertainties.</li>\n<li><strong>logl</strong> - the loglikelihood of the fit given the model.</li>\n<li><strong>Aw</strong> - the Akaike weight of the model.</li>\n<li><strong>bestModelFlag</strong> - a value of 1.0 indicates the best model.</li>\n</ul>\n<h2>The templates</h2>\n<p>irasgnsep uses a library of templates for the galaxy and the AGN emission. Interested reader are referred to Bernhard et al. (in prep.) for a detailed description of the templates. The templates are available as a CSV table at: <a href=\"https://bitbucket.org/ebernhard/iragnsep/src/master/iragnsep/iragnsep_templ.csv\" rel=\"nofollow\">https://bitbucket.org/ebernhard/iragnsep/src/master/iragnsep/iragnsep_templ.csv</a> . Columns are as follow,</p>\n<ul>\n<li><strong>lambda_mic</strong> - the wavelength in micron spanning 1--1000 microns.</li>\n<li><strong>gal1_dust, egal1_dust</strong> - the nuLnu of the first semi-empirical galaxy continuum template, normalised to Lir (i.e. integrated from 1-1000microns), and its uncertainties.</li>\n<li><strong>gal2_dust, egal2_dust</strong> - the nuLnu of the second semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>gal3_dust, egal3_dust</strong> -  the nuLnu of the third semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>gal4_dust, egal4_dust</strong> -  the nuLnu of the fourth semi-empirical galaxy continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>gal1_emp, egal1_emp</strong> -  the nuLnu of the first empirical galaxy continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>gal2_emp, egal2_emp</strong> -  the nuLnu of the second empirical galaxy continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>gal_PAH, egal_PAH</strong> -  the nuLnu of the PAH emission template, normalised to Lir, and its uncertainties.</li>\n<li><strong>AGN_Siem</strong> -  the nuLnu of the silicate emission template, normalised to Lir, and its uncertainties.</li>\n<li><strong>AGN_A</strong> -  the nuLnu of the first AGN continuum template, normalised to Lir, and its uncertainties.</li>\n<li><strong>AGN_B</strong> - the nuLnu of the second AGN continuum template, normalised to Lir, and its uncertainties.</li>\n</ul>\n<h2>iragnsep: modules</h2>\n<p>--</p>\n<h3>run_all</h3>\n<p>--</p>\n<p>Description:</p>\n<p>The module run_all eases the use of iragnsep by running everything from the fits to the plots and give the possibility to save the result of the fits as CSV tables. run_all contains two functions. fitSpec performs everything on datasets which combine spectral and photometric data, and fitPhoto does the same but on photometry alone datasets.</p>\n<hr>\n<p><strong>res, resBM = fitSpec(wavSpec, fluxSpec, efluxSpec,<br>\nwavPhot, fluxPhot, efluxPhot, <br>\nfilters, <br>\nz = -0.01,<br>\nULPhot = [],<br>\nobsCorr = True,<br>\nS9p7_fixed = -99.,<br>\nNmc = 10000, pgrbar = 1, <br>\nPdust = [10., 3.], PPAH = [9., 3.], Ppl = [-1., 3.], Pbreak = [1.603, 0.01], Pslope1 = [1., 2.], Pslope2 = [1., 2.], <br>\nPlsg = [-1., 3.], Pllg = [-1., 3.],<br>\nsourceName = 'NoName', pathTable = './', pathFig = './', <br>\nredoFit = True, saveRes = True)</strong></p>\n<p>This function fits the observed SED when a spectrum is combined to photometric data. The observed wavelengths, fluxes and uncertainties on the fluxes are passed separately for the spectrum and the photometric data.</p>\n<p>INPUT:</p>\n<ul>\n<li><strong>wavSpec</strong> - observed wavelengths for the spectrum (in microns).</li>\n<li><strong>fluxSpec</strong> - observed fluxes for the spectrum (in Jansky).</li>\n<li><strong>efluxSpec</strong> - observed uncertainties on the fluxes for the spectrum (in Jansky).</li>\n<li><strong>wavPhot</strong> - observed wavelengths for the photometry (in microns).</li>\n<li><strong>fluxPhot</strong> - observed fluxes for the photometry (in Jansky).</li>\n<li><strong>efluxPhot</strong> - observed uncertainties on the fluxes for the photometry (in Jansky).</li>\n<li><strong>filters</strong> - name of the photometric filters corresponding to the observed photometry passed in wavPhot.</li>\n</ul>\n<p>OUTPUT:</p>\n<ul>\n<li><strong>res_fit</strong> - dataframe containing the results of all the possible fits.</li>\n<li><strong>res_fitBM</strong> - dataframe containing the results of the best fit only.</li>\n</ul>\n<p>KEYWORDS:</p>\n<ul>\n<li><strong>z</strong> - redshift of the source. Default = 0.01.</li>\n<li><strong>ULPhot</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].</li>\n<li><strong>obsCorr</strong> - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True</li>\n<li><strong>S9p7_fixed</strong> - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.</li>\n<li><strong>Nmc</strong> - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thinning of 10 is applied. Default = 10000.</li>\n<li><strong>pgrbar</strong> - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.</li>\n<li><strong>Pdust</strong> - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).</li>\n<li><strong>PPAH</strong> - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].</li>\n<li><strong>Ppl</strong> - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].</li>\n<li><strong>Pbreak</strong> - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].</li>\n<li><strong>Pslope1</strong> - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].</li>\n<li><strong>Pslope2</strong> - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].</li>\n<li><strong>Plsg</strong> - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].</li>\n<li><strong>Pllg</strong> - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].</li>\n<li><strong>sourceName</strong> - name of the source. Default = 'NoName'.</li>\n<li><strong>pathTable</strong> - if saveRes is set to True, the tables containing the results of the fits will be saved at the location pathTable. Default = './'.</li>\n<li><strong>pathFig</strong> - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.</li>\n<li><strong>redoFit</strong> - if set to True, re-performs the fits. Otherwise, find the table saved at pathTable and reproduces the analysis and the figures only. Default = True.</li>\n<li><strong>saveRes</strong> - if set to True, the tables containing the results of the fits, as well as the figures are saved. Default = True.</li>\n</ul>\n<hr>\n<p><strong>res, resBM = fitPhoto(wav, flux, eflux,<br>\nfilters, <br>\nz = -0.01,<br>\nUL = [], <br>\nNmc = 10000, pgrbar = 1, <br>\nNoSiem = False, <br>\nPdust = [10., 3.], PPAH = [9., 3.], PnormAGN = [10., 3.], PSiEm = [10., 3.], <br>\nsourceName = 'NoName', pathTable = './', pathFig = './', <br>\nredoFit = True, saveRes = True, NOAGN = False)</strong></p>\n<p>This function fits the observed photometric SED.</p>\n<p>INPUT:</p>\n<ul>\n<li><strong>wav</strong> - observed wavelengths (in microns).</li>\n<li><strong>fluxSpec</strong> - observed fluxes (in Jansky).</li>\n<li><strong>efluxSpec</strong> - observed uncertainties on the fluxes (in Jansky).</li>\n<li><strong>filters</strong> - name of the photometric filters corresponding to the observed photometry passed in wav.</li>\n</ul>\n<p>OUTPUT:</p>\n<ul>\n<li><strong>res_fit</strong> - dataframe containing the results of all the possible fits.</li>\n<li><strong>res_fitBM</strong> - dataframe containing the results of the best fit only.</li>\n</ul>\n<p>KEYWORDS:</p>\n<p><strong>z</strong> - redshift of the source. Default = 0.01.\n<strong>UL</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n<strong>Nmc</strong> - * <strong>Nmc</strong> - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.\n<strong>pgrbar</strong> - if set to 1, display a progress bar while fitting the SED. Default = 1.\n<strong>NoSiem</strong> - if set to True, no silicate emission template is included in the fit. Default = False.\n<strong>Pdust</strong> - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).\n<strong>PPAH</strong> - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].\n<strong>PnormAGN</strong> - normal prior on the log-normalisation of the AGN template. Default = [10., 3.].\n<strong>PSiem</strong> - normal prior on the log-normalisation of the silicate emission template. Default = [10., 3.].\n<strong>sourceName</strong> - name of the source. Default = 'NoName'.\n<strong>pathTable</strong> - if saveRes is set to True, the tables containing the results of the fits will be saved at the location pathTable. Default = './'.\n<strong>pathFig</strong> - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n<strong>redoFit</strong> - if set to True, re-performs the fits. Otherwise, find the table saved at pathTable and reproduces the analysis and the figures only. Default = True.\n<strong>saveRes</strong> - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n<strong>NOAGN</strong> - if set to True, the AGN component is not included in the fits, Default = False.</p>\n<hr>\n<p>--</p>\n<h3>SEDanalysis</h3>\n<p>--</p>\n<p>Description:</p>\n<p>The module SEDanalysis is the module which runs the fits (yet see the <strong>run_all</strong> module for an easier use of iragnsep, including generating plots and tables). SEDanalysis contains two main functions. <strong>runSEDspecFit</strong> is for dataset which combines spectral and photometric fluxes, and <strong>runSEDphotFit</strong> is for dataset which contains photometric data only.</p>\n<hr>\n<p><strong>dfRes = runSEDspecFit(wavSpec, fluxSpec, efluxSpec,<br>\nwavPhot, fluxPhot, efluxPhot, filters, <br>\nz = -0.01,<br>\nULPhot = [], <br>\nobsCorr = True,<br>\nS9p7_fixed = -99., <br>\nNmc = 10000, pgrbar = 1, <br>\nPdust = [10., 3.], PPAH = [9., 3.], Ppl = [-1., 3.], Pbreak = [1.603, 0.01], Pslope1 = [1., 2.], Pslope2 = [1., 2.], <br>\nPlsg = [-1., 3.], Pllg = [-1., 3.],<br>\ntempl = '')</strong></p>\n<p>This function fits the observed SED when a spectrum is combined to photometric data. The observed wavelengths, fluxes and uncertainties on the fluxes are passed separately for the spectrum and the photometric data.</p>\n<p>INPUT:</p>\n<ul>\n<li><strong>wavSpec</strong> - observed wavelengths for the spectrum (in microns).</li>\n<li><strong>fluxSpec</strong> - observed fluxes for the spectrum (in Jansky).</li>\n<li><strong>efluxSpec</strong> - observed uncertainties on the fluxes for the spectrum (in Jansky).</li>\n<li><strong>wavPhot</strong> - observed wavelengths for the photometry (in microns).</li>\n<li><strong>fluxPhot</strong> - observed fluxes for the photometry (in Jansky).</li>\n<li><strong>efluxPhot</strong> - observed uncertainties on the fluxes for the photometry (in Jansky).</li>\n<li><strong>filters</strong> - name of the photometric filters corresponding to the observed photometry passed in wavSpec.</li>\n</ul>\n<p>OUTPUT:</p>\n<ul>\n<li><strong>dfRes</strong> - dataframe containing the results of all the possible fits.</li>\n</ul>\n<p>KEYWORDS:</p>\n<ul>\n<li><strong>z</strong> - redshift of the source. Default = 0.01.</li>\n<li><strong>ULPhot</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].</li>\n<li><strong>obsCorr</strong> - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True</li>\n<li><strong>S9p7_fixed</strong> - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.</li>\n<li><strong>Nmc</strong> - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.</li>\n<li><strong>pgrbar</strong> - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.</li>\n<li><strong>Pdust</strong> - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).</li>\n<li><strong>PPAH</strong> - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].</li>\n<li><strong>Ppl</strong> - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].</li>\n<li><strong>Pbreak</strong> - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].</li>\n<li><strong>Pslope1</strong> - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].</li>\n<li><strong>Pslope2</strong> - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].</li>\n<li><strong>Plsg</strong> - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].</li>\n<li><strong>Pllg</strong> - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].</li>\n<li><strong>templ</strong> - pass the templates to be used. If none, use the library of templates from Bernhard et al. (in prep.). Default: ''.</li>\n</ul>\n<hr>\n<p><strong>dfRes = runSEDphotFit(lambdaObs, fluxObs, efluxObs, <br>\nfilters, <br>\nz = 0.01, <br>\nUL = [], <br>\nNmc = 10000, pgrbar = 1, <br>\nNoSiem = False, <br>\nPdust = [10., 13], PPAH = [9., 3.], PnormAGN = [10., 3.], PSiEm = [10., 3.], <br>\ntempl = '', NOAGN = False)</strong></p>\n<p>This function fits the observed photometric SED.</p>\n<p>INPUT:</p>\n<p><strong>lambdaObs</strong> - observed wavelengths (in microns).\n<strong>fluxObs</strong> - observed fluxes (in Jansky).\n<strong>efluxObs</strong> - observed uncertainties on the fluxes (in Jansky).\n<strong>filters</strong> - name of the photometric filters to include in the fit.</p>\n<p>OUTPUT:</p>\n<p><strong>dfRes</strong> - dataframe containing the results of all the possible fits.</p>\n<p>KEYWORDS:</p>\n<ul>\n<li><strong>z</strong> - redshift of the source. Default = 0.01.</li>\n<li><strong>ULPhot</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the value is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].</li>\n<li><strong>obsCorr</strong> - if set to True, iragnsep attempt to calculate the total silicate absorption at 9.7micron, and to correct the observed fluxes for obscuration. Default = True</li>\n<li><strong>tau9p7_fixed</strong> - can be used to pass a fixed value for the total silicate absorption at 9.7 micron. Default = -99.</li>\n<li><strong>Nmc</strong> - numer of MCMC run. The final chain discards the first 20% of the Nmc steps as burnin and a thining of 10 is applied. Default = 10000.</li>\n<li><strong>pgrbar</strong> - if set to 1, displays a progress bar while fitting the SEDs. Default = 1.</li>\n<li><strong>Pdust</strong> - normal prior on the log-normalisation of the galaxy dust continuum template. Default = [10., 3.], ([mean, std dev]).</li>\n<li><strong>PPAH</strong> - normal prior on the log-normalisation of the PAH template. Default = [9., 3.].</li>\n<li><strong>Ppl</strong> - normal prior on the log-normalisation of the AGN continuum (defined at 10 micron). Default = [-1., 3.].</li>\n<li><strong>Pbreak</strong> - normal prior on lbreak, the position of the log-break. Default = [1.6, 0.01].</li>\n<li><strong>Pslope1</strong> - normal prior on alpha1, the slope of the first power-law defined between 1--15 microns. Default = [1., 2.].</li>\n<li><strong>Pslope2</strong> - normal prior on alpha2, the slope of the second power-law defined between 15-lbreak microns. Default = [1., 2.].</li>\n<li><strong>Plsg</strong> - normal prior on the log-normalisation of the silicate emission at 11micron. Default = [-1., 3.].</li>\n<li><strong>Pllg</strong> - normal prior on the log-normalisation of the silicate emission at 18micron. Default = [-1., 3.].</li>\n<li><strong>templ</strong> - pass the templates to be used. If none, use the library of templates from Bernhard et al. (in prep.). Default: ''.</li>\n<li><strong>NOAGN</strong> - if set to True, the AGN contribution is not included in the fits. Default: False.</li>\n</ul>\n<hr>\n<p>--</p>\n<h3>toolplot</h3>\n<p>--</p>\n<p>Description:</p>\n<p>The module toolplot generates plots based on the results of the fits. toolplot contains two functions. plotFitSpec generates a plot showing all of the possible combinations of models and generates a plot showing that of the best model for dataset which combines spectral and photometric data. plotFitPhoto is the same as plotFitSpec but for photometric datasets.</p>\n<hr>\n<p><strong>plotFitSpec(df, wavSpec, fluxSpec, efluxSpec, wavPhot, fluxPhot, efluxPhot, UL = np.array([]), pathFig = './', sourceName = 'NoName', templ = '', z = 0.01, saveRes = True)</strong></p>\n<p>This function plots the results of the fits for data which contain spectral + photometric fluxes.</p>\n<p>INPUT:</p>\n<p><strong>df</strong> - data-frame contaning the results of the fits (i.e. optimised parameters) as returned by the function SEDanalysis.runSEDspecFit.\n<strong>wavSpec</strong> - observed wavelengthts for the spectrum (in microns).\n<strong>fluxSpec</strong> - observed fluxes for the spectrum (in Jansky).\n<strong>efluxSpec</strong> - observed uncertainties on the fluxes for the spectrum (in Jansky).\n<strong>wavPhot</strong> - observed wavelengths for the photometry (in microns).\n<strong>fluxPhot</strong> - observed fluxes for the photometry (in Jansky).\n<strong>efluxPhot</strong> - observed uncertainties on the fluxes for the photometry (in Jansky).</p>\n<p>KEYWORDS:</p>\n<p><strong>z</strong> - redshift of the source. Default = 0.01.\n<strong>UL</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the values is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n<strong>sourceName</strong> - name of the source. Default = 'NoName'.\n<strong>pathFig</strong> - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n<strong>saveRes</strong> - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n<strong>templ</strong> - pass the templates that have been used in the fits.</p>\n<hr>\n<p><strong>plotFitPhoto(df, wav, flux, eflux, UL = np.array([]), pathFig = './', sourceName = 'NoName', templ = '', z = 0.01, saveRes = True)</strong></p>\n<p>This function plots the results of the fits for photometric data.</p>\n<p>INPUT:</p>\n<p><strong>df</strong> - data-frame contaning the results of the fits (i.e. optimised parameters) as returned by the function SEDanalysis.runSEDphotFit.\n<strong>wav</strong> - observed wavelengthts (in microns).\n<strong>flux</strong> - observed fluxes (in Jansky).\n<strong>eflux</strong> - observed uncertainties on the fluxes (in Jansky).</p>\n<p>KEYWORDS:</p>\n<p><strong>z</strong> - redshift of the source. Default = 0.01.\n<strong>UL</strong> - vector of length Nphot, where Nphot is the number of photometric data. If any of the values is set to 1, the corresponding flux is set has an upper limit in the fit. Default = [].\n<strong>sourceName</strong> - name of the source. Default = 'NoName'.\n<strong>pathFig</strong> - if saveRes is set to True, the figues showing the results of the fits will be saved at the location pathFig. Default = './'.\n<strong>saveRes</strong> - if set to True, the tables containing the results of the fits as well as the figures are saved. Default = True.\n<strong>templ</strong> - set the templates that have been used in the fits.</p>\n<hr>\n<p>--</p>\n<h3>func</h3>\n<p>--</p>\n<p>Description:</p>\n<p>The module func contains the functions used to run the fits, the best model selection and the analysis.</p>\n<hr>\n<p><strong>get_prop(df, echar, z = 0.01, specOn = True, templ = '')</strong></p>\n<p>This function calculates the IR properties of the AGN and their hosts.</p>\n<p>INPUT:</p>\n<p><strong>df</strong> - data-frame containing the results from the fits (i.e. optimised parameters) as returned by SEDanalysis.\n<strong>echar</strong> - characteristic uncertainties to calculate the uncertainties on the parameters.</p>\n<p>OUTPUT:</p>\n<p><strong>loglum_hostIR</strong> - the host IR (8--1000microns) log-luminosity free of AGN contamination (Lsun).\n<strong>eloglum_hostIR</strong> - uncertainties on loglum_hostIR.\n<strong>loglum_hostMIR</strong> - the host IR (5--35microns) log-luminosity free of AGN contamination (Lsun).\n<strong>eloglum_hostIR</strong> - uncertainties on loglum_hostMIR.\n<strong>loglum_hostFIR</strong> - the host IR (40--1000microns) log-luminosity free of AGN contamination (Lsun).\n<strong>eloglum_hosFIR</strong> - uncertainties on loglum_hostFIR.\n<strong>loglum_AGNIR</strong> - the AGN IR log-luminosity free of host contamination (Lsun).\n<strong>loglum_AGNMIR</strong> - the AGN MIR log-luminosity free of host contamination (Lsun).\n<strong>loglum_AGNFIR</strong> - the AGN FIR log-luminosity free of host contamination (Lsun).\n<strong>AGNfrac_IR</strong> - the AGN fraction in the IR.\n<strong>AGNfrac_MIR</strong> - the AGN fraction in the MIR.\n<strong>AGNfrac_FIR</strong> - the AGN fraction in the FIR.\n<strong>SFR</strong> - the SFR of the galaxy free of AGN contamination.\n<strong>eSFR</strong> - the uncertainties on SFR.\n<strong>wSFR</strong> - the SFR of the galaxy free of AGN contamination weighted by its Akaike weight.\n<strong>ewSFR</strong> - the uncertainties on wSFR.</p>\n<p>KEYWORDS:</p>\n<p><strong>z</strong> - redshift\n<strong>specOn</strong> - set to True if the data contain a spectrum in addition to the photometry.\n<strong>templ</strong> - set the templates that have been used in the fits.</p>\n<hr>\n<p><strong>basictests(wavSpec, fluxSpec, efluxSpec, wavPhot, fluxPhot, efluxPhot, filters, z, specOn = True)</strong></p>\n<p>This function runs some basic tests prior to run the main fitting code.</p>\n<p>INPUT:</p>\n<p><strong>wavSpec</strong> - observed wavelengths for the spectrum (in microns).\n<strong>fluxSpec</strong> - observed fluxes for the spectrum (in Jansky).\n<strong>efluxSpec</strong> - observed uncertainties on the fluxes for the spectrum (in Jansky).\n<strong>wavPhot</strong> - observed wavelengths for the photometry (in microns).\n<strong>fluxPhot</strong> - observed fluxes for the photometry (in Jansky).\n<strong>efluxPhot</strong> - observed uncertainties on the fluxes for the photometry (in Jansky).\n<strong>filters</strong> - name of the photometric filters to include in the fit.\n<strong>z</strong> - redshift.</p>\n<p>KEYWORDS:</p>\n<p><strong>specOn</strong> - set to True if the data contain a spectrum in addition to the photometry.</p>\n<hr>\n<p><strong>exctractBestModel(logl, k, n, corrected = True)</strong></p>\n<p>This function extracts the best model and calculates the Akaike weights based on the log-likelihood returned by the fits.</p>\n<p>INPUT:</p>\n<p><strong>logl</strong> - log-likelihood returned by the fits.\n<strong>k</strong> - number of free parameters.\n<strong>n</strong> - number of data points.</p>\n<p>OUTPUTS:</p>\n<p><strong>bestModelInd</strong> - the index of the best model fit.\n<strong>Awi</strong> - Akaike weights of each of the models, with respect to the best model.</p>\n<p>KEYWORDS:</p>\n<p><strong>corrected</strong> - if set to True, calculates the corrected AIC for small number of data points.</p>\n<hr>\n<p><strong>nuLnuToFnu(spec_wav, nuLnu, z)</strong></p>\n<p>This function calculates the observed flux from nuLnu.</p>\n<p>INPUT:</p>\n<p><strong>spec_wav</strong> - rest-wavelengths (in microns).\n<strong>nuLnu</strong> -  nuLnu.\n<strong>z</strong> - redshift.</p>\n<p>OUTPUT:</p>\n<p><strong>Fnu</strong> - observed flux on Earth of the source located at redshift z (in Jansky).</p>\n<hr>\n<p><strong>getFluxInFilt(filt_wav, filt_QE, spec_wav, nuLnu, z):</strong></p>\n<p>This function calculates the synthetic flux in a given filter and at a given redshift from a source with luminosity nuLnu.</p>\n<p>INPUT:</p>\n<p><strong>filt_wav</strong> - passband of the filter.\n<strong>filt_QE</strong> - quantum efficient of the filter.\n<strong>spec_wav</strong> - rest-wavelengths (in microns).\n<strong>nuLnu</strong> - nuLnu.\n<strong>z</strong> - redshift.</p>\n<p>OUTPUT:</p>\n<p><strong>flux_Obs</strong> - observed flux on Earth of the source located at redshift z with luminosity nuLnu (in Jansky).</p>\n<hr>\n<p><strong>logldet(ym, ydat, eydat, wei):</strong></p>\n<p>This function calculates the log-likelihood of detected data.</p>\n<p>INPUT:</p>\n<p><strong>ym</strong> - model values.\n<strong>ydat</strong> - observed values.\n<strong>eydat</strong> - observed uncertaities.\n<strong>wei</strong> - weights of the data points.</p>\n<p>OUTPUT:</p>\n<p><strong>logl</strong> - log-likelihood of the model.</p>\n<hr>\n<p><strong>erf_approx(x)</strong></p>\n<p>This function calculates an approximation of the error function.</p>\n<p>INPUT:</p>\n<p><strong>x</strong> - x values to which the error function is calculated at.</p>\n<p>OUTPUT:</p>\n<p><strong>erf_approx_eval</strong> - approximate value of the error function.</p>\n<hr>\n<p><strong>loglUL(ym, ydat)</strong></p>\n<p>This function calculates the log-likelihood of undetected data.</p>\n<p>INPUT:</p>\n<p><strong>ym</strong> - model values.\n<strong>ydat</strong> - observed values.</p>\n<p>OUTPUT:</p>\n<p><strong>logl</strong> - log-likelihood of the model.</p>\n<hr>\n<p><strong>Gauss_jit(x, mu, sigma)</strong></p>\n<p>This function calculates a Gaussian normalised to its maximum.</p>\n<p>INPUT:</p>\n<p><strong>x</strong> - x-values.\n<strong>mu</strong> - mean.\n<strong>sigma</strong> - standard deviation.</p>\n<p>OUTPUT:</p>\n<p><strong>Bnu</strong> Gaussian evaluated at x, normalised to its maximum.</p>\n<hr>\n<p><strong>AGNmodel_firstPL_jit(x, lambdab, alpha1, alpha2, s)</strong></p>\n<p>This function calculates the first broken power-law of the AGN model.</p>\n<p>INPUT:</p>\n<p><strong>x</strong> - x-values.\n<strong>lambdab</strong> - position of the break.\n<strong>alpha1</strong> - slope of the first power-law.\n<strong>alpha2</strong> - slope of the second power-law.\n<strong>s</strong> - sharpness parameter for the break between alpha1 and alpha2.</p>\n<p>OUTPUT:</p>\n<p><strong>Bnu</strong> - corresponding broken power law evaluated at x, and normalised at 10 microns.</p>\n<hr>\n<p><strong>AGNmodel_jit(x, lambdab1, lambdab2, alpha1, alpha2, alpha3)</strong></p>\n<p>This function calculates the second broken power-law of the AGN model.</p>\n<p>INPUT:</p>\n<p><strong>x</strong> - x-values.\n<strong>lambdab1</strong> - position of the break for the first broken power law.\n<strong>lambdab2</strong> - position of the break for the second broken power law.\n<strong>alpha1</strong> - slope of the first power-law.\n<strong>alpha2</strong> - slope of the second power-law.\n<strong>alpha2</strong> - slope of the third power-law.</p>\n<p>OUTPUT:</p>\n<p><strong>Bnu</strong> - corresponding double-broken power law evaluated at x, and normalised at 10 microns.</p>\n<hr>\n<p><strong>KVTextinctCurve(lambda_obs)</strong></p>\n<p>This function calculates the extinction curve from Kemper et al. (2004).</p>\n<p>INPUT:</p>\n<p><strong>lambda_obs</strong> - observed wavelengths.</p>\n<p>OUTPUT:</p>\n<p><strong>tau_return</strong> - absorption coefficient tau per wavelength.</p>\n<hr>\n<p><strong>drude(x, gamma_r, lambda_r, normed = True)</strong></p>\n<p>This function calculates a Drude profile.</p>\n<p>INPUT:</p>\n<p><strong>x</strong> - x-values.\n<strong>gamma_r</strong> - central wavelengths.\n<strong>lambda_r</strong> - fractional FWHM.</p>\n<p>OUTPUT:</p>\n<p><strong>drudeVal</strong> - the Drude profile evaluated at x.</p>\n<p>KEYWORDS:</p>\n<p><strong>normed</strong> - if set to True, normalise to the maximum value.</p>\n<hr>\n<p>obsC(wavRest, flux, eflux):</p>\n<p>This function calculates the total obscuration at 9.7micron.</p>\n<p>INPUT:</p>\n<p><strong>wavRest</strong> -rest-wavelength.\n<strong>flux</strong> - observed fluxes.\n<strong>eflux</strong> - uncertainties on the observed fluxes.</p>\n<p>OUTPUT:</p>\n<p><strong>_tau9p7</strong> - the total obscuration at 9.7micron.</p>\n<hr>\n<p>--</p>\n<h3>classes</h3>\n<p>--</p>\n<p>The module classes contains one class called 'modelToSED' which calls various functions to return the photometric point at a given wavelengths in a given filters for a model nuLnu. The available filters are as follow:</p>\n<ul>\n<li><strong>IRAC1</strong> - Spitzer IRAC, 3.6 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer</a></li>\n<li><strong>IRAC2</strong> - Spitzer IRAC, 4.5 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer</a></li>\n<li><strong>IRAC3</strong> - Spitzer IRAC, 5.8 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer</a></li>\n<li><strong>IRAC4</strong> - Spitzer IRAC, 8.0 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer</a></li>\n<li><strong>WISE_W1</strong> - WISE, 3.4 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE</a></li>\n<li><strong>WISE_W2</strong> - WISE, 4.6 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE</a></li>\n<li><strong>WISE_W3</strong> - WISE, 12 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE</a></li>\n<li><strong>WISE_W4</strong> - WISE, 22 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=WISE</a></li>\n<li><strong>IRAS12</strong> - IRAS, 12 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS</a></li>\n<li><strong>IRAS60</strong> - IRAS, 60 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS</a></li>\n<li><strong>IRAS100</strong> - IRAS, 100 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=IRAS</a></li>\n<li><strong>MIPS24</strong> - Spitzer MIPS, 24 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS</a></li>\n<li><strong>MIPS70</strong> - Spitzer MIPS, 70 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS</a></li>\n<li><strong>MIPS160</strong> - Spitzer MIPS, 160 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Spitzer&amp;gname2=MIPS</a></li>\n<li><strong>PACS70</strong> - Herschel PACS, 70 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel</a></li>\n<li><strong>PACS100</strong> - Herschel PACS, 100 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel</a></li>\n<li><strong>PACS160</strong> - Herschel PACS, 160 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel</a></li>\n<li><strong>SPIRE250ps</strong> - Herschel SPIRE, 250 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE</a></li>\n<li><strong>SPIRE350ps</strong> - Herschel SPIRE, 350 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE</a></li>\n<li><strong>SPIRE500ps</strong> - Herschel SPIRE, 500 micron, <a href=\"http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE\" rel=\"nofollow\">http://svo2.cab.inta-csic.es/theory/fps/index.php?mode=browse&amp;gname=Herschel&amp;gname2=SPIRE</a></li>\n</ul>\n<p>Note: to add filter please contact e.p.bernhard[at]sheffield.ac.uk.</p>\n<hr>\n<h2>Cautionary notes</h2>\n<p>As this is the first version of iragnsep we suggest the user to carefully check results, and to report anything that is possibly a bug. To do this, please contact us at: e.p.bernhard[at]sheffield.ac.uk.</p>\n<p>The templates and models built for iragnsep are based on observations out to z=0.3. We have tested these on photometry of galaxies in the COSMOS field at higher redshifts, and the results appear to be reliable. However, there is no formal proof, and we suggest that the user carefully check results for these sources.</p>\n<p>The templates have been derived on moderate luminosity AGNs 41.6 erg/s&lt;Log10(Lx2-10kev)&lt;45.2 erg/s. As a consequence, using iragnsep for, let's say, bright QSOs is at the User's own risks. We stress however that our AGN templates are in agreement with AGN templates for quasars.</p>\n<h2>Future work</h2>\n<p>Future version will allow a more flexible input for the observed data. In addition it will be possible for the user to choose a complete different set of templates, if necessary.</p>\n<p>For this version we use Numba to speed up the code. This python dependency pre-compiles the code allowing iragnsep to run faster. Using Numba, we have sped up iragnsep by a factor of 10. Since MCMC are time expensive, we are planning to further incorporate multi-threading for a possible increase in the speed.</p>\n<p>So far we have tested iragnsep using data from the IRS spectra and  the Herschel photometry. We plan to test the possibility to incorporate other spectral data such as future JWST data.</p>\n<h2>Versioning</h2>\n<p>We use three numbers for the versions defined as x.y.z. If only y and z are changed the output of iragnsep is unchanged and minor patches are applied. If x changes it means that major changes has been applied and results are likely to differ from the x-1 version.</p>\n<p>The first released version starts at x=5.</p>\n<h2>Authors</h2>\n<ul>\n<li><strong>Emmanuel Bernhard</strong> - <em>Initial work</em></li>\n<li>James Mullaney</li>\n<li>Clive Tadhunter</li>\n</ul>\n<p>The associated paper can be found at Bernhard et al. (in prep).</p>\n<h2>Citation</h2>\n<p>Please cite Bernhard et al. (in prep) when using iragnsep.</p>\n<h2>License</h2>\n<p>This project is licensed under the MIT License - see the <a href=\"LICENSE\" rel=\"nofollow\">LICENSE</a> file for details</p>\n\n          </div>"}, "last_serial": 7127968, "releases": {"0.0.0": [{"comment_text": "", "digests": {"md5": "3c4e2d61924c53dd5234f66e294ed497", "sha256": "81a810a8cf8bbd17bc56bc221dae7398435c7da5d660a35c3cf74a28684257f9"}, "downloads": -1, "filename": "iragnsep-0.0.0.tar.gz", "has_sig": false, "md5_digest": "3c4e2d61924c53dd5234f66e294ed497", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 177476, "upload_time": "2020-01-20T16:05:38", "upload_time_iso_8601": "2020-01-20T16:05:38.826697Z", "url": "https://files.pythonhosted.org/packages/05/4b/1ef7ce5234b086b3c28f947353b56d5e880eae49e1ef043c8be8bca73c20/iragnsep-0.0.0.tar.gz", "yanked": false}], "3.0.2": [{"comment_text": "", "digests": {"md5": "06056b7c8dee0de924bb082fcaa648a2", "sha256": "0904be9d84e6355bf5b9c7693345ac2f4df1dd6aca5862c3feea61cf1542642f"}, "downloads": -1, "filename": "iragnsep-3.0.2.tar.gz", "has_sig": false, "md5_digest": "06056b7c8dee0de924bb082fcaa648a2", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 177553, "upload_time": "2020-01-20T17:28:18", "upload_time_iso_8601": "2020-01-20T17:28:18.748656Z", "url": "https://files.pythonhosted.org/packages/33/c8/276019e324d8e833eddf3d19db0871f2f8348733be8fbf51447cf50eaaa3/iragnsep-3.0.2.tar.gz", "yanked": false}], "3.0.3": [{"comment_text": "", "digests": {"md5": "b645cd68e4723e29c510b4835c017358", "sha256": "e485dc66ca0c4c9170400a85010332c158008fb77c7b35c6c009e907c453857b"}, "downloads": -1, "filename": "iragnsep-3.0.3.tar.gz", "has_sig": false, "md5_digest": "b645cd68e4723e29c510b4835c017358", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 177603, "upload_time": "2020-01-20T17:31:41", "upload_time_iso_8601": "2020-01-20T17:31:41.074850Z", "url": "https://files.pythonhosted.org/packages/ed/d5/f7b73ba285f735f6d5226cedac13562e47803c8b5db29aa2e4009da147d6/iragnsep-3.0.3.tar.gz", "yanked": false}], "3.0.4": [{"comment_text": "", "digests": {"md5": "62609e57faf3f1699fd26b260db13545", "sha256": "567d21e8d8cb37bd5f1718ce890fd2e25813f9529df6b50f91f504dccb74954d"}, "downloads": -1, "filename": "iragnsep-3.0.4.tar.gz", "has_sig": false, "md5_digest": "62609e57faf3f1699fd26b260db13545", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 177606, "upload_time": "2020-01-20T17:38:35", "upload_time_iso_8601": "2020-01-20T17:38:35.994956Z", "url": "https://files.pythonhosted.org/packages/92/00/a0496ab7370a2cf87d25ffa4a8a93b7d4e5a037888cdc3ba5798a3efbf13/iragnsep-3.0.4.tar.gz", "yanked": false}], "4.0.0": [{"comment_text": "", "digests": {"md5": "d6c4ece76623bc1c5f0487c00068afbb", "sha256": "4823183f91bfbb19a0daf86723c726e62c99654bfbe64c1833cd74ed5e025a02"}, "downloads": -1, "filename": "iragnsep-4.0.0.tar.gz", "has_sig": false, "md5_digest": "d6c4ece76623bc1c5f0487c00068afbb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 175816, "upload_time": "2020-02-07T17:29:28", "upload_time_iso_8601": "2020-02-07T17:29:28.091671Z", "url": "https://files.pythonhosted.org/packages/ef/d5/280102474a666ebea3a71a1fe2b2596433874f140eaa47bc5ce33ffcb071/iragnsep-4.0.0.tar.gz", "yanked": false}], "4.0.1": [{"comment_text": "", "digests": {"md5": "c5128c9a10cd90bedf107c522d1ac258", "sha256": "a4a5ab14b2e914f13d8e3f91aede2168ecc79129e1f030bceb40405c9474b0c1"}, "downloads": -1, "filename": "iragnsep-4.0.1.tar.gz", "has_sig": false, "md5_digest": "c5128c9a10cd90bedf107c522d1ac258", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 175823, "upload_time": "2020-02-07T17:35:09", "upload_time_iso_8601": "2020-02-07T17:35:09.563872Z", "url": "https://files.pythonhosted.org/packages/2f/a0/ed3c96d727e6bf5a03fc49ee1f04da29800eefec16b719164564f033c80b/iragnsep-4.0.1.tar.gz", "yanked": false}], "4.0.2": [{"comment_text": "", "digests": {"md5": "3878c09d5e628ce5fa6ad6dd659bfd9e", "sha256": "d226293d0ed9400d26057406c8c3c22ab1ccfbf8265d065d6e58ca7e4f22731d"}, "downloads": -1, "filename": "iragnsep-4.0.2.tar.gz", "has_sig": false, "md5_digest": "3878c09d5e628ce5fa6ad6dd659bfd9e", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 175787, "upload_time": "2020-02-10T15:36:11", "upload_time_iso_8601": "2020-02-10T15:36:11.935861Z", "url": "https://files.pythonhosted.org/packages/94/4f/24d87304c23d19a2d39f9615f087f0912a7be052d787cb2032b36dd3a72a/iragnsep-4.0.2.tar.gz", "yanked": false}], "4.0.3": [{"comment_text": "", "digests": {"md5": "3cccad7176a9adb55a3b72ed7a65c98d", "sha256": "9e39b150dbf8bb2683244e6fb403b8c214b81a185fbfcb4ca95008ff76390088"}, "downloads": -1, "filename": "iragnsep-4.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "3cccad7176a9adb55a3b72ed7a65c98d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 164202, "upload_time": "2020-02-13T11:01:42", "upload_time_iso_8601": "2020-02-13T11:01:42.979529Z", "url": "https://files.pythonhosted.org/packages/b3/d1/91556033cb0d588bbce147463ac7815528c4a870d4a5aea1051a359e6f36/iragnsep-4.0.3-py3-none-any.whl", "yanked": false}], "4.0.4": [{"comment_text": "", "digests": {"md5": "8cea709a773f04d43afcb88bc856c1bf", "sha256": "f6362afd89ac959e23f734540f761498123e5691f9873a51d22da9991de688dc"}, "downloads": -1, "filename": "iragnsep-4.0.4-py3-none-any.whl", "has_sig": false, "md5_digest": "8cea709a773f04d43afcb88bc856c1bf", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 164518, "upload_time": "2020-02-13T15:52:07", "upload_time_iso_8601": "2020-02-13T15:52:07.707186Z", "url": "https://files.pythonhosted.org/packages/c2/f0/449fcbb7bc0e2ffb0cdf1487faac67549553c15cdda0f745c0a0ecc82213/iragnsep-4.0.4-py3-none-any.whl", "yanked": false}], "4.0.5": [{"comment_text": "", "digests": {"md5": "d132a648e8285aeb12d19e5013aec8b8", "sha256": "eb3f666efd94b0768297fa3934a0e51fd67ae9f260f626a672844cb83df5b9e8"}, "downloads": -1, "filename": "iragnsep-4.0.5-py3-none-any.whl", "has_sig": false, "md5_digest": "d132a648e8285aeb12d19e5013aec8b8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 164634, "upload_time": "2020-02-19T11:31:53", "upload_time_iso_8601": "2020-02-19T11:31:53.421343Z", "url": "https://files.pythonhosted.org/packages/50/20/28f859b71ff82f4020c391599966d76c270cc2d1f1b46f1285d0448ea44e/iragnsep-4.0.5-py3-none-any.whl", "yanked": false}], "4.0.6": [{"comment_text": "", "digests": {"md5": "716eb65be7c8811a77db2f6b9b22c778", "sha256": "6fcfd480756ba5966a0c75ec2645c62c55aec8165d36666b1bf9f3446496b5ba"}, "downloads": -1, "filename": "iragnsep-4.0.6-py3-none-any.whl", "has_sig": false, "md5_digest": "716eb65be7c8811a77db2f6b9b22c778", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 130643, "upload_time": "2020-02-24T11:36:02", "upload_time_iso_8601": "2020-02-24T11:36:02.784612Z", "url": "https://files.pythonhosted.org/packages/49/13/46ccc47ea74b9366aa6f75bc4867058b824b0c39f8f79472939144222a14/iragnsep-4.0.6-py3-none-any.whl", "yanked": false}], "4.1.0": [{"comment_text": "", "digests": {"md5": "033e04174ae43ad0676b28ecaf3654f7", "sha256": "4974a754a43fedb41544f2c991131dffb43d39fc7aa7442a67b1ae21602447f0"}, "downloads": -1, "filename": "iragnsep-4.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "033e04174ae43ad0676b28ecaf3654f7", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 130821, "upload_time": "2020-02-26T18:04:57", "upload_time_iso_8601": "2020-02-26T18:04:57.550012Z", "url": "https://files.pythonhosted.org/packages/70/85/5e082b24d0781778795bb228914ca81491d8806ba5605e6544302ec8b2d1/iragnsep-4.1.0-py3-none-any.whl", "yanked": false}], "4.2.0": [{"comment_text": "", "digests": {"md5": "1da227f1f9736b0e6d798417b1c8c90b", "sha256": "1bb57bf8893d3fe3656bb8464e2d9a318b53683e4ea9381a5411501be94d9986"}, "downloads": -1, "filename": "iragnsep-4.2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "1da227f1f9736b0e6d798417b1c8c90b", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 130894, "upload_time": "2020-03-03T10:54:34", "upload_time_iso_8601": "2020-03-03T10:54:34.397143Z", "url": "https://files.pythonhosted.org/packages/b3/b0/f2409c27d9a75b74dc910283db467abe5f734090ed3699b13cd00d098f7e/iragnsep-4.2.0-py3-none-any.whl", "yanked": false}], "5.0.0": [{"comment_text": "", "digests": {"md5": "28727c49903e9872b458d563558e0042", "sha256": "c56168b1bef5df570cb49f47f27df8a0d4b569e279c1aadb575540354a836dab"}, "downloads": -1, "filename": "iragnsep-5.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "28727c49903e9872b458d563558e0042", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 138331, "upload_time": "2020-04-06T14:34:04", "upload_time_iso_8601": "2020-04-06T14:34:04.450099Z", "url": "https://files.pythonhosted.org/packages/07/85/59285aced1e609c9e3fea36aaeeb085502ae4ac055de44136c353a864a91/iragnsep-5.0.0-py3-none-any.whl", "yanked": false}], "5.0.1": [{"comment_text": "", "digests": {"md5": "16d8f89783dcee1227bd5180f95a1745", "sha256": "38a07dc7dfc5acc793eb1b027d7d9aee4e5852daf9c5be323cc313291352c930"}, "downloads": -1, "filename": "iragnsep-5.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "16d8f89783dcee1227bd5180f95a1745", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 138327, "upload_time": "2020-04-06T14:47:23", "upload_time_iso_8601": "2020-04-06T14:47:23.302356Z", "url": "https://files.pythonhosted.org/packages/ee/27/539f15de7af1d1fafcaa7aff1b4e9eaa81801cf7560a3db3ebfd8f563af7/iragnsep-5.0.1-py3-none-any.whl", "yanked": false}], "5.0.2": [{"comment_text": "", "digests": {"md5": "81d28413e8972b51651034ecade0917e", "sha256": "4abc47c49f0759a5723b2fe29d231accfeb03ac095c92b99287e2746169668bf"}, "downloads": -1, "filename": "iragnsep-5.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "81d28413e8972b51651034ecade0917e", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 187996, "upload_time": "2020-04-06T14:50:05", "upload_time_iso_8601": "2020-04-06T14:50:05.099531Z", "url": "https://files.pythonhosted.org/packages/9f/89/b1dc8c4a7865d3d44bc62ee05222115c935cb2e9067d226c8e1118ae916f/iragnsep-5.0.2-py3-none-any.whl", "yanked": false}], "5.0.3": [{"comment_text": "", "digests": {"md5": "83c5e0919304cb116601c37e35f3101c", "sha256": "d4d53a899368540367a56bfcdf1f25f73da6da1c7b6deb2b893476bb74629b94"}, "downloads": -1, "filename": "iragnsep-5.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "83c5e0919304cb116601c37e35f3101c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 135482, "upload_time": "2020-04-06T14:59:26", "upload_time_iso_8601": "2020-04-06T14:59:26.720485Z", "url": "https://files.pythonhosted.org/packages/ed/ae/f8dd5863854a9d4efd32c94b9ba64af182256d1dc6a5a425c6fed3e65612/iragnsep-5.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f7e12757408ad83864617ea52c49b373", "sha256": "ad7b240af43c254e6334b43f1b470984673b0919efa094190064783b0158593d"}, "downloads": -1, "filename": "iragnsep-5.0.3.tar.gz", "has_sig": false, "md5_digest": "f7e12757408ad83864617ea52c49b373", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 150093, "upload_time": "2020-04-29T11:13:22", "upload_time_iso_8601": "2020-04-29T11:13:22.743953Z", "url": "https://files.pythonhosted.org/packages/86/0c/26e111502b3bc929192826ee89a14766f31a8eca8f2e35975c0ef0f028af/iragnsep-5.0.3.tar.gz", "yanked": false}], "6.0.0": [{"comment_text": "", "digests": {"md5": "aadb6eb37f875b67ee6534049478fc3c", "sha256": "fe5a1a57ac08b4600c98946aae7da1dd51df56706b0a5e330b630666e9f8e1c3"}, "downloads": -1, "filename": "iragnsep-6.0.0.tar.gz", "has_sig": false, "md5_digest": "aadb6eb37f875b67ee6534049478fc3c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 150098, "upload_time": "2020-04-29T11:13:25", "upload_time_iso_8601": "2020-04-29T11:13:25.544037Z", "url": "https://files.pythonhosted.org/packages/94/d7/c6f110c18d0e290bf5d645bdac787a276cb2629f1cade8694d1989493591/iragnsep-6.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "aadb6eb37f875b67ee6534049478fc3c", "sha256": "fe5a1a57ac08b4600c98946aae7da1dd51df56706b0a5e330b630666e9f8e1c3"}, "downloads": -1, "filename": "iragnsep-6.0.0.tar.gz", "has_sig": false, "md5_digest": "aadb6eb37f875b67ee6534049478fc3c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 150098, "upload_time": "2020-04-29T11:13:25", "upload_time_iso_8601": "2020-04-29T11:13:25.544037Z", "url": "https://files.pythonhosted.org/packages/94/d7/c6f110c18d0e290bf5d645bdac787a276cb2629f1cade8694d1989493591/iragnsep-6.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:54:21 2020"}