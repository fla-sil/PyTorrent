{"info": {"author": "Bertrand Coconnier", "author_email": "", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Environment :: Console", "Intended Audience :: Developers", "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)", "Operating System :: POSIX :: Linux", "Programming Language :: Python :: 3", "Topic :: Software Development :: Testing"], "description": "# Continuous Integration with Valgrind\n\nValgrindCI is a Python package that provides tools to facilitate the integration of [valgrind](https://valgrind.org/) into your Continuous Integration workflow.\n\nValgrind can sometimes generate an overwhelming amount of findings and it can be difficult to extract the information you need from these data. ValgrindCI most basic feature is to terminate a job if the findings from valgrind meet some criteria defined by the user, for example, as soon as valgrind reports a single error. ValgrindCI can also help you get a better insight into the errors reported by valgrind:\n\n- Errors can be grouped or filtered (for example leak errors only).\n- A summary of the errors found by valgrind can be printed in the console.\n- ValgrindCI can generate an HTML report to investigate the errors directly within your code.\n\n## Installation\n### Install from the sources\n#### Pre-requisites\nValgrindCI uses the Python packages [`defusedxml`](https://github.com/tiran/defusedxml) and [`jinja2`](https://palletsprojects.com/p/jinja/).\nIf you are building ValgrindCI from source, these dependencies must be installed with `pip` in the first place.\n```bash\n> pip install -r requirements.txt\n```\n#### Build and install the package\nValgrindCI uses the `setuptools` to build its package which can then be installed by `pip`\n```bash\n> python setup.py bdist_wheel\n> pip install ValgrindCI --no-index -f dist\n```\n### Download and install with `pip`\nValgrindCI is a tool written in Python and can be installed from `pip`.\n```bash\n> pip install ValgrindCI\n```\n\n## How to use\nValgrindCI is a command tool designed to be executed within jobs of your favorite Continuous Integration platform. It parses the XML output of valgrind to provide its services.\n\nFirst, Valgrind must be run with the options `--xml=yes` and `--xml-file` in order to report its findings in an XML file.\n```bash\n> valgrind --tool=memcheck --xml=yes --xml-file==/path/to/output_file.xml my_executable --options-of-my-executable\n```\n### Get basic information\nNow, ValgrindCI can be invoked to parse the XML output file and report the total number of errors found by valgrind.\n```bash\n> valgrind-ci /path/to/output_file.xml --number-of-errors\n```\n### Abort on errors\nMost CI platforms detect a job failure when the system command `exit()` is called with a non zero value. This feature allows ValgrindCI to report a failure as soon as valgrind reports an error:\n```bash\n> valgrind-ci /path/to/output_file.xml --abort-on-errors\n```\n\n### Summary report of errors\nYou can request ValgrindCI to print a summary report of the errors found by valgrind.\n```bash\n> valgrind-ci /path/to/output_file.xml --summary\n```\nAn example of the output is given below:\n```\nsrc/models/FGAtmosphere.cpp:\n9 errors\n\tline 125: UninitCondition\t(1 errors)\n\tline 129: UninitCondition\t(6 errors)\n\t          UninitValue\t(2 errors)\nsrc/models/FGMassBalance.cpp:\n13 errors\n\tline 207: UninitCondition\t(11 errors)\n\tline 472: SyscallParam\t(1 errors)\n\t          UninitCondition\t(1 errors)\n```\nSince a function can be called from different places, a single line of code can be reported several times as an offending line by valgrind. In the example above, the line 207 of the file `src/models/FGMassBalance.cpp` is reported 11 times, each time with a different call stack. Clearly, the added value of ValgrindCI in such a case is to group errors by source files and by line numbers. By this simple process, and for the particular case illustrated above, the number of errors has been narrowed down from 2147 to 185 !\n### HTML report\nValgrindCI can generate an HTML report that displays the errors reported by Valgrind inside your code. The command below generates an HTML report in the directory `html`. The argument `--source-dir` is used to build paths relative to that directory rather than absolute paths.\n```bash\n> valgrind-ci /path/to/output_file.xml --source-dir=/path/to/source/code --output-dir=html\n```\nIf you open the document `html/index.html` you can review the report with your web browser, errors with their corresponding call stack are displayed within the source code.\n\n![View of HTML report](https://github.com/bcoconni/ValgrindCI/raw/master/media/HTMLreport.png)\n### Other options\nValgrindCI command line tool has a number of arguments than can be used to adapt the tool to your specific need:\n```\nusage: valgrind-ci [-h] [--version] [--source-dir SOURCE_DIR]\n                   [--output-dir OUTPUT_DIR] [--summary] [--number-of-errors]\n                   [--lines-before LINES_BEFORE] [--lines-after LINES_AFTER]\n                   [--abort-on-errors]\n                   xml_file\n\npositional arguments:\n  xml_file              Valgrind XML file name\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --source-dir SOURCE_DIR\n                        specifies the source directory\n  --output-dir OUTPUT_DIR\n                        directory where the HTML report will be generated\n  --summary             print a summary of errors\n  --number-of-errors    print the total number of errors found by Valgrind\n  --lines-before LINES_BEFORE\n                        number of code lines to display in the HTML report\n                        before the error line (default to 3)\n  --lines-after LINES_AFTER\n                        number of code lines to display in the HTML report\n                        after the error line (default to 3)\n  --abort-on-errors     call exit(1) if errors have been reported by Valgrind\n```\n## Advanced usage\nValgrindCI can also be used as a Python library that helps you filter and select errors programmatically.\n### Errors filtering\nValgrind can generate a significant amount of errors, not all of which might be relevant to your project. In that case, ValgrindCI can filter data to report only the errors that are of interest to you.\n\nFor example, if you only need errors generated by the leaks that are definitely lost then you can filter the data with the method `filter_error_kind()` to report that kind of errors:\n```python\nfrom ValgrindCI.parse import ValgrindData\n\ndata = ValgrindData()\ndata.parse('/path/to/output_file.xml')\n# Output the number of errors for leaks definitely lost.\nprint(data.filter_error_kind('Leak_DefinitelyLost').get_num_errors()) \n```\nThere are some other filters available to select a subset of source files or a particular line of code.\n### HTML report\nOnce errors have been filtered to suit your need, you can generate an HTML report from the instance `data`:\n```python\nfrom ValgrindCI.render import HTMLRenderer\n\nrenderer = HTMLRenderer(data)\nrenderer.render('html', lines_before=3, lines_after=3)\n```\n### Summary report\nAlternatively you can print a summary report in the console:\n```python\nfrom ValgrindCI.report import Report\n\nreport = Report(data)\nprint(report.summary())\n```\n ## Releases\n\n- `v0.1.0`: Initial Release\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/bcoconni/ValgrindCI", "keywords": "valgrind valgrind-log-parsing html-report", "license": "GNU General Public License v3.0", "maintainer": "", "maintainer_email": "", "name": "ValgrindCI", "package_url": "https://pypi.org/project/ValgrindCI/", "platform": "", "project_url": "https://pypi.org/project/ValgrindCI/", "project_urls": {"Homepage": "https://github.com/bcoconni/ValgrindCI"}, "release_url": "https://pypi.org/project/ValgrindCI/0.1.0/", "requires_dist": ["defusedxml", "jinja2"], "requires_python": "", "summary": "Tools to integrate valgrind into your Continuous Integration workflow.", "version": "0.1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Continuous Integration with Valgrind</h1>\n<p>ValgrindCI is a Python package that provides tools to facilitate the integration of <a href=\"https://valgrind.org/\" rel=\"nofollow\">valgrind</a> into your Continuous Integration workflow.</p>\n<p>Valgrind can sometimes generate an overwhelming amount of findings and it can be difficult to extract the information you need from these data. ValgrindCI most basic feature is to terminate a job if the findings from valgrind meet some criteria defined by the user, for example, as soon as valgrind reports a single error. ValgrindCI can also help you get a better insight into the errors reported by valgrind:</p>\n<ul>\n<li>Errors can be grouped or filtered (for example leak errors only).</li>\n<li>A summary of the errors found by valgrind can be printed in the console.</li>\n<li>ValgrindCI can generate an HTML report to investigate the errors directly within your code.</li>\n</ul>\n<h2>Installation</h2>\n<h3>Install from the sources</h3>\n<h4>Pre-requisites</h4>\n<p>ValgrindCI uses the Python packages <a href=\"https://github.com/tiran/defusedxml\" rel=\"nofollow\"><code>defusedxml</code></a> and <a href=\"https://palletsprojects.com/p/jinja/\" rel=\"nofollow\"><code>jinja2</code></a>.\nIf you are building ValgrindCI from source, these dependencies must be installed with <code>pip</code> in the first place.</p>\n<pre>&gt; pip install -r requirements.txt\n</pre>\n<h4>Build and install the package</h4>\n<p>ValgrindCI uses the <code>setuptools</code> to build its package which can then be installed by <code>pip</code></p>\n<pre>&gt; python setup.py bdist_wheel\n&gt; pip install ValgrindCI --no-index -f dist\n</pre>\n<h3>Download and install with <code>pip</code></h3>\n<p>ValgrindCI is a tool written in Python and can be installed from <code>pip</code>.</p>\n<pre>&gt; pip install ValgrindCI\n</pre>\n<h2>How to use</h2>\n<p>ValgrindCI is a command tool designed to be executed within jobs of your favorite Continuous Integration platform. It parses the XML output of valgrind to provide its services.</p>\n<p>First, Valgrind must be run with the options <code>--xml=yes</code> and <code>--xml-file</code> in order to report its findings in an XML file.</p>\n<pre>&gt; valgrind --tool<span class=\"o\">=</span>memcheck --xml<span class=\"o\">=</span>yes --xml-file<span class=\"o\">==</span>/path/to/output_file.xml my_executable --options-of-my-executable\n</pre>\n<h3>Get basic information</h3>\n<p>Now, ValgrindCI can be invoked to parse the XML output file and report the total number of errors found by valgrind.</p>\n<pre>&gt; valgrind-ci /path/to/output_file.xml --number-of-errors\n</pre>\n<h3>Abort on errors</h3>\n<p>Most CI platforms detect a job failure when the system command <code>exit()</code> is called with a non zero value. This feature allows ValgrindCI to report a failure as soon as valgrind reports an error:</p>\n<pre>&gt; valgrind-ci /path/to/output_file.xml --abort-on-errors\n</pre>\n<h3>Summary report of errors</h3>\n<p>You can request ValgrindCI to print a summary report of the errors found by valgrind.</p>\n<pre>&gt; valgrind-ci /path/to/output_file.xml --summary\n</pre>\n<p>An example of the output is given below:</p>\n<pre><code>src/models/FGAtmosphere.cpp:\n9 errors\n\tline 125: UninitCondition\t(1 errors)\n\tline 129: UninitCondition\t(6 errors)\n\t          UninitValue\t(2 errors)\nsrc/models/FGMassBalance.cpp:\n13 errors\n\tline 207: UninitCondition\t(11 errors)\n\tline 472: SyscallParam\t(1 errors)\n\t          UninitCondition\t(1 errors)\n</code></pre>\n<p>Since a function can be called from different places, a single line of code can be reported several times as an offending line by valgrind. In the example above, the line 207 of the file <code>src/models/FGMassBalance.cpp</code> is reported 11 times, each time with a different call stack. Clearly, the added value of ValgrindCI in such a case is to group errors by source files and by line numbers. By this simple process, and for the particular case illustrated above, the number of errors has been narrowed down from 2147 to 185 !</p>\n<h3>HTML report</h3>\n<p>ValgrindCI can generate an HTML report that displays the errors reported by Valgrind inside your code. The command below generates an HTML report in the directory <code>html</code>. The argument <code>--source-dir</code> is used to build paths relative to that directory rather than absolute paths.</p>\n<pre>&gt; valgrind-ci /path/to/output_file.xml --source-dir<span class=\"o\">=</span>/path/to/source/code --output-dir<span class=\"o\">=</span>html\n</pre>\n<p>If you open the document <code>html/index.html</code> you can review the report with your web browser, errors with their corresponding call stack are displayed within the source code.</p>\n<p><img alt=\"View of HTML report\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/088eb7934ed478bc7a1cca91790120887dc43061/68747470733a2f2f6769746875622e636f6d2f62636f636f6e6e692f56616c6772696e6443492f7261772f6d61737465722f6d656469612f48544d4c7265706f72742e706e67\"></p>\n<h3>Other options</h3>\n<p>ValgrindCI command line tool has a number of arguments than can be used to adapt the tool to your specific need:</p>\n<pre><code>usage: valgrind-ci [-h] [--version] [--source-dir SOURCE_DIR]\n                   [--output-dir OUTPUT_DIR] [--summary] [--number-of-errors]\n                   [--lines-before LINES_BEFORE] [--lines-after LINES_AFTER]\n                   [--abort-on-errors]\n                   xml_file\n\npositional arguments:\n  xml_file              Valgrind XML file name\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --source-dir SOURCE_DIR\n                        specifies the source directory\n  --output-dir OUTPUT_DIR\n                        directory where the HTML report will be generated\n  --summary             print a summary of errors\n  --number-of-errors    print the total number of errors found by Valgrind\n  --lines-before LINES_BEFORE\n                        number of code lines to display in the HTML report\n                        before the error line (default to 3)\n  --lines-after LINES_AFTER\n                        number of code lines to display in the HTML report\n                        after the error line (default to 3)\n  --abort-on-errors     call exit(1) if errors have been reported by Valgrind\n</code></pre>\n<h2>Advanced usage</h2>\n<p>ValgrindCI can also be used as a Python library that helps you filter and select errors programmatically.</p>\n<h3>Errors filtering</h3>\n<p>Valgrind can generate a significant amount of errors, not all of which might be relevant to your project. In that case, ValgrindCI can filter data to report only the errors that are of interest to you.</p>\n<p>For example, if you only need errors generated by the leaks that are definitely lost then you can filter the data with the method <code>filter_error_kind()</code> to report that kind of errors:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">ValgrindCI.parse</span> <span class=\"kn\">import</span> <span class=\"n\">ValgrindData</span>\n\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">ValgrindData</span><span class=\"p\">()</span>\n<span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">parse</span><span class=\"p\">(</span><span class=\"s1\">'/path/to/output_file.xml'</span><span class=\"p\">)</span>\n<span class=\"c1\"># Output the number of errors for leaks definitely lost.</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">filter_error_kind</span><span class=\"p\">(</span><span class=\"s1\">'Leak_DefinitelyLost'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">get_num_errors</span><span class=\"p\">())</span> \n</pre>\n<p>There are some other filters available to select a subset of source files or a particular line of code.</p>\n<h3>HTML report</h3>\n<p>Once errors have been filtered to suit your need, you can generate an HTML report from the instance <code>data</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">ValgrindCI.render</span> <span class=\"kn\">import</span> <span class=\"n\">HTMLRenderer</span>\n\n<span class=\"n\">renderer</span> <span class=\"o\">=</span> <span class=\"n\">HTMLRenderer</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n<span class=\"n\">renderer</span><span class=\"o\">.</span><span class=\"n\">render</span><span class=\"p\">(</span><span class=\"s1\">'html'</span><span class=\"p\">,</span> <span class=\"n\">lines_before</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">lines_after</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">)</span>\n</pre>\n<h3>Summary report</h3>\n<p>Alternatively you can print a summary report in the console:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">ValgrindCI.report</span> <span class=\"kn\">import</span> <span class=\"n\">Report</span>\n\n<span class=\"n\">report</span> <span class=\"o\">=</span> <span class=\"n\">Report</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">report</span><span class=\"o\">.</span><span class=\"n\">summary</span><span class=\"p\">())</span>\n</pre>\n<h2>Releases</h2>\n<ul>\n<li><code>v0.1.0</code>: Initial Release</li>\n</ul>\n\n          </div>"}, "last_serial": 7103492, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "6d10063aa00c91d03a5aee83d45df117", "sha256": "b528419098ff64874cc6e9ff0ada6bf9eef08180859a9fbff6c4343d0486a51c"}, "downloads": -1, "filename": "ValgrindCI-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "6d10063aa00c91d03a5aee83d45df117", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 25510, "upload_time": "2020-04-26T07:53:59", "upload_time_iso_8601": "2020-04-26T07:53:59.394076Z", "url": "https://files.pythonhosted.org/packages/df/f3/3a60f9d2d948f52a5921f6c7690c4e9f838d7a995e24b386e7e3656e2f30/ValgrindCI-0.1.0-py3-none-any.whl", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "6d10063aa00c91d03a5aee83d45df117", "sha256": "b528419098ff64874cc6e9ff0ada6bf9eef08180859a9fbff6c4343d0486a51c"}, "downloads": -1, "filename": "ValgrindCI-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "6d10063aa00c91d03a5aee83d45df117", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 25510, "upload_time": "2020-04-26T07:53:59", "upload_time_iso_8601": "2020-04-26T07:53:59.394076Z", "url": "https://files.pythonhosted.org/packages/df/f3/3a60f9d2d948f52a5921f6c7690c4e9f838d7a995e24b386e7e3656e2f30/ValgrindCI-0.1.0-py3-none-any.whl", "yanked": false}], "timestamp": "Fri May  8 03:38:12 2020"}