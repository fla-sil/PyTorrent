{"info": {"author": "Xavier Francisco", "author_email": "xavier.n.francisco@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "# homie-power-supply-node\n\n**homie-power-supply-node** is a Python package that uses homie-spec to provide a homie node implementation that can be used to create Homie-compliant messages from your power supply device.\n\nThis package has no dependencies other than **Python >=3.6** and `homie-spec`. \nOnly Linux is supported at the moment, as it uses `/sys/class/power_supply/*/uevent` to read the power supply properties.\n\n## Installation\n\nUse the package manager [pip](https://pip.pypa.io/en/stable/) to install `homie-power-supply-node`.\n\n```bash\npip install homie-power-supply-node\n```\n\n## Usage\n```python\nfrom homie_spec import Device\nfrom homie_power_supply_node import PowerSupply\n\ndesktop = Device(\n    id=\"desktop\",\n    name=\"Desktop Computer\",\n    nodes={\"battery\": PowerSupply(\"BAT0\").node(whitelist_properties=[\"capacity\"])},\n)\n\nmessages = desktop.messages()\nassert next(messages).topic == \"homie/desktop/$state\"\nassert next(messages).topic == \"homie/desktop/$name\"\nassert next(messages).topic == \"homie/desktop/$homie\"\nassert next(messages).topic == \"homie/desktop/$implementation\"\nassert next(messages).topic == \"homie/desktop/$nodes\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/$name\"\nassert msg.payload == \"BAT0\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/$type\"\nassert msg.payload == \"power-supply\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/$properties\"\nassert msg.payload == \"capacity\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/capacity/$name\"\nassert msg.payload == \"Capacity\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/capacity/$datatype\"\nassert msg.payload == \"integer\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/capacity/$unit\"\nassert msg.payload == \"%\"\n\nmsg = next(messages)\nassert msg.topic == \"homie/desktop/battery/capacity/$format\"\nassert msg.payload == \"0:100\"\n\n\nprint(\n    \"Current battery capacity: \"\n    f\"{format(desktop.getter_message('battery/capacity').payload)}%\"\n)\n\"\"\"\n```\n\n## Contributing\nPull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.\n\nPlease make sure to update tests as appropriate.\n\n## License\n[MIT](https://choosealicense.com/licenses/mit/)\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/Qu4tro/homie-power-supply-node/", "keywords": "homie,mqtt", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "homie-power-supply-node", "package_url": "https://pypi.org/project/homie-power-supply-node/", "platform": "", "project_url": "https://pypi.org/project/homie-power-supply-node/", "project_urls": {"Homepage": "https://github.com/Qu4tro/homie-power-supply-node/", "Repository": "https://github.com/Qu4tro/homie-power-supply-node/"}, "release_url": "https://pypi.org/project/homie-power-supply-node/0.1.2/", "requires_dist": ["homie-spec (>=0.4.0,<0.5.0)"], "requires_python": ">=3.6,<4.0", "summary": "homie-power-supply-node is a Python package that uses homie-spec to provide a homie node implementation that can be used to create Homie-compliant messages from your power supply device.", "version": "0.1.2", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>homie-power-supply-node</h1>\n<p><strong>homie-power-supply-node</strong> is a Python package that uses homie-spec to provide a homie node implementation that can be used to create Homie-compliant messages from your power supply device.</p>\n<p>This package has no dependencies other than <strong>Python &gt;=3.6</strong> and <code>homie-spec</code>.\nOnly Linux is supported at the moment, as it uses <code>/sys/class/power_supply/*/uevent</code> to read the power supply properties.</p>\n<h2>Installation</h2>\n<p>Use the package manager <a href=\"https://pip.pypa.io/en/stable/\" rel=\"nofollow\">pip</a> to install <code>homie-power-supply-node</code>.</p>\n<pre>pip install homie-power-supply-node\n</pre>\n<h2>Usage</h2>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">homie_spec</span> <span class=\"kn\">import</span> <span class=\"n\">Device</span>\n<span class=\"kn\">from</span> <span class=\"nn\">homie_power_supply_node</span> <span class=\"kn\">import</span> <span class=\"n\">PowerSupply</span>\n\n<span class=\"n\">desktop</span> <span class=\"o\">=</span> <span class=\"n\">Device</span><span class=\"p\">(</span>\n    <span class=\"nb\">id</span><span class=\"o\">=</span><span class=\"s2\">\"desktop\"</span><span class=\"p\">,</span>\n    <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">\"Desktop Computer\"</span><span class=\"p\">,</span>\n    <span class=\"n\">nodes</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"battery\"</span><span class=\"p\">:</span> <span class=\"n\">PowerSupply</span><span class=\"p\">(</span><span class=\"s2\">\"BAT0\"</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">node</span><span class=\"p\">(</span><span class=\"n\">whitelist_properties</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">\"capacity\"</span><span class=\"p\">])},</span>\n<span class=\"p\">)</span>\n\n<span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"n\">desktop</span><span class=\"o\">.</span><span class=\"n\">messages</span><span class=\"p\">()</span>\n<span class=\"k\">assert</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/$state\"</span>\n<span class=\"k\">assert</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/$name\"</span>\n<span class=\"k\">assert</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/$homie\"</span>\n<span class=\"k\">assert</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/$implementation\"</span>\n<span class=\"k\">assert</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/$nodes\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/$name\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"BAT0\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/$type\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"power-supply\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/$properties\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"capacity\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/capacity/$name\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"Capacity\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/capacity/$datatype\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"integer\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/capacity/$unit\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"%\"</span>\n\n<span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">messages</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s2\">\"homie/desktop/battery/capacity/$format\"</span>\n<span class=\"k\">assert</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"n\">payload</span> <span class=\"o\">==</span> <span class=\"s2\">\"0:100\"</span>\n\n\n<span class=\"nb\">print</span><span class=\"p\">(</span>\n    <span class=\"s2\">\"Current battery capacity: \"</span>\n    <span class=\"sa\">f</span><span class=\"s2\">\"</span><span class=\"si\">{</span><span class=\"nb\">format</span><span class=\"p\">(</span><span class=\"n\">desktop</span><span class=\"o\">.</span><span class=\"n\">getter_message</span><span class=\"p\">(</span><span class=\"s1\">'battery/capacity'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">payload</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"s2\">%\"</span>\n<span class=\"p\">)</span>\n<span class=\"s2\">\"\"\"</span>\n</pre>\n<h2>Contributing</h2>\n<p>Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.</p>\n<p>Please make sure to update tests as appropriate.</p>\n<h2>License</h2>\n<p><a href=\"https://choosealicense.com/licenses/mit/\" rel=\"nofollow\">MIT</a></p>\n\n          </div>"}, "last_serial": 6478750, "releases": {"0.1.2": [{"comment_text": "", "digests": {"md5": "df0acc343f7b30dbc786294c54e24d44", "sha256": "7371ea04c9b9a2ead187b6c8bc021371532150fea305ca2ef9955d14b8eb07c1"}, "downloads": -1, "filename": "homie_power_supply_node-0.1.2-py3-none-any.whl", "has_sig": false, "md5_digest": "df0acc343f7b30dbc786294c54e24d44", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 3744, "upload_time": "2020-01-18T16:44:46", "upload_time_iso_8601": "2020-01-18T16:44:46.408806Z", "url": "https://files.pythonhosted.org/packages/b7/68/1fd6b5bd98373b6aab51c750f1ace551adb6ffd24d58a1c18b28dd00de2d/homie_power_supply_node-0.1.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "bb8d4cb59a51450d297773b23b5f6102", "sha256": "ad3df175cd4751277bbe7ce14955f2856523a2df618c1bfd2aca4df012dddf85"}, "downloads": -1, "filename": "homie-power-supply-node-0.1.2.tar.gz", "has_sig": false, "md5_digest": "bb8d4cb59a51450d297773b23b5f6102", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 4249, "upload_time": "2020-01-18T16:44:44", "upload_time_iso_8601": "2020-01-18T16:44:44.442575Z", "url": "https://files.pythonhosted.org/packages/63/88/d8e0dd5eb3c5b120d40d7b2a51446ccc5aedcb9d9ea2c2a7f4989df813ff/homie-power-supply-node-0.1.2.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "df0acc343f7b30dbc786294c54e24d44", "sha256": "7371ea04c9b9a2ead187b6c8bc021371532150fea305ca2ef9955d14b8eb07c1"}, "downloads": -1, "filename": "homie_power_supply_node-0.1.2-py3-none-any.whl", "has_sig": false, "md5_digest": "df0acc343f7b30dbc786294c54e24d44", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 3744, "upload_time": "2020-01-18T16:44:46", "upload_time_iso_8601": "2020-01-18T16:44:46.408806Z", "url": "https://files.pythonhosted.org/packages/b7/68/1fd6b5bd98373b6aab51c750f1ace551adb6ffd24d58a1c18b28dd00de2d/homie_power_supply_node-0.1.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "bb8d4cb59a51450d297773b23b5f6102", "sha256": "ad3df175cd4751277bbe7ce14955f2856523a2df618c1bfd2aca4df012dddf85"}, "downloads": -1, "filename": "homie-power-supply-node-0.1.2.tar.gz", "has_sig": false, "md5_digest": "bb8d4cb59a51450d297773b23b5f6102", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 4249, "upload_time": "2020-01-18T16:44:44", "upload_time_iso_8601": "2020-01-18T16:44:44.442575Z", "url": "https://files.pythonhosted.org/packages/63/88/d8e0dd5eb3c5b120d40d7b2a51446ccc5aedcb9d9ea2c2a7f4989df813ff/homie-power-supply-node-0.1.2.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:50:42 2020"}