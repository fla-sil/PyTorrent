{"info": {"author": "Flatiron Health Data Tooling", "author_email": "data-tooling@flatiron.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: BSD License", "Operating System :: OS Independent", "Programming Language :: Python :: 3 :: Only"], "description": "# ast-refactor\n\nApply structured migrations to existing python source code easily.\n\nThis is intended to be used to migrate from older code patterns\nto modern supported ones.  \n\nFor library authors this can assist in providing migration tools so that \nusers can migrate to newer versions of your library more easily.  \n\nast-refactor *will* modify your source code if you run it, so be sure to \nrun it on a repository that doesn't have code that is not checked in.\n\n## Why?\n\nWhen dealing with large codebases it is common to encounter code that is using libraries in ways that are deprecated \n(or removed) in newer versions of those libraries.\n\nFor example you have the following code that uses an older version of pandas (<0.17)\n\n```python\ndf = pd.DataFrame({\"A\": [\"foo\", \"foo\", \"foo\", \"foo\", \"foo\",\n                          \"bar\", \"bar\", \"bar\", \"bar\"],\n                    \"B\": [\"one\", \"one\", \"one\", \"two\", \"two\",\n                          \"one\", \"one\", \"two\", \"two\"],\n                    \"C\": [\"small\", \"large\", \"large\", \"small\",\n                          \"small\", \"large\", \"small\", \"small\",\n                          \"large\"],\n                    \"D\": [1, 2, 2, 3, 3, 4, 5, 6, 7],\n                    \"E\": [2, 4, 5, 5, 6, 6, 8, 9, 9]})\n\ntable = (pd\n    .pivot_table(\n        df, \n        rows=['A', 'B'], \n        cols=['C'], \n        values='D',\n        aggfunc=np.sum)\n    .sort(\"large\")\n)       \n```\n\nThe second statement uses two pandas functions with deprecated keyword arguments.  You can obviously fix this by hand, but if you have lots of code this is tedious and error prone.\n\n`ast-refactor` provides you the tools to automatically convert that second statement into something that will work for modern versions of pandas.\n\n```python\ntable = (pd\n    .pivot_table(\n        df, \n        index=['A', 'B'], \n        columns=['C'], \n        values='D',\n        aggfunc=np.sum)\n    .sort_values(\"large\")\n)   \n```\n\nThis is intended as a tool to help library author and owners of large codebases migrate source code easily.\n\n## Usage\n\nFor detailed usage documentation see [usage docs](https://github.com/flatironhealth/ast-refactor/blob/master/doc/using.md) and \n[writing a migrator](https://github.com/flatironhealth/ast-refactor/blob/master/doc/writing_a_migrator.md) and \n\n### as a python cli\n\nThe easiest way to install this tool is using\n[pipx](https://pipxproject.github.io/pipx/).\n\n```bash\n$ pipx install \\\n    ast-refactor\n\n$ ast-refactor run some/path/or/file\n```\n\n### as a docker container\n\nAlternatively you can run it from a docker container\n\n```bash\n$ docker run \\\n    -e UID=$(id -u) \\\n    -e GID=$(id -u) \\\n    -v /some/path/or/file:/work \\\n    flatironhealth/ast-refactor \\\n    run \\\n    /work\n```\n\n## Building\n\n### locally\n\n```bash\n$ pip install .\n$ ast-refactor some/path/or/file\n```\n\n### docker\n\n```bash\ndocker build -t ast-refactor .\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/flatironhealth/ast-refactor", "keywords": "", "license": "BSD-3-Clause", "maintainer": "", "maintainer_email": "", "name": "ast-refactor", "package_url": "https://pypi.org/project/ast-refactor/", "platform": "", "project_url": "https://pypi.org/project/ast-refactor/", "project_urls": {"Homepage": "https://github.com/flatironhealth/ast-refactor"}, "release_url": "https://pypi.org/project/ast-refactor/0.1.0/", "requires_dist": null, "requires_python": ">=3.6", "summary": "Transform code using the power of the Python AST", "version": "0.1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>ast-refactor</h1>\n<p>Apply structured migrations to existing python source code easily.</p>\n<p>This is intended to be used to migrate from older code patterns\nto modern supported ones.</p>\n<p>For library authors this can assist in providing migration tools so that\nusers can migrate to newer versions of your library more easily.</p>\n<p>ast-refactor <em>will</em> modify your source code if you run it, so be sure to\nrun it on a repository that doesn't have code that is not checked in.</p>\n<h2>Why?</h2>\n<p>When dealing with large codebases it is common to encounter code that is using libraries in ways that are deprecated\n(or removed) in newer versions of those libraries.</p>\n<p>For example you have the following code that uses an older version of pandas (&lt;0.17)</p>\n<pre><span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">({</span><span class=\"s2\">\"A\"</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"foo\"</span><span class=\"p\">,</span> <span class=\"s2\">\"foo\"</span><span class=\"p\">,</span> <span class=\"s2\">\"foo\"</span><span class=\"p\">,</span> <span class=\"s2\">\"foo\"</span><span class=\"p\">,</span> <span class=\"s2\">\"foo\"</span><span class=\"p\">,</span>\n                          <span class=\"s2\">\"bar\"</span><span class=\"p\">,</span> <span class=\"s2\">\"bar\"</span><span class=\"p\">,</span> <span class=\"s2\">\"bar\"</span><span class=\"p\">,</span> <span class=\"s2\">\"bar\"</span><span class=\"p\">],</span>\n                    <span class=\"s2\">\"B\"</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"one\"</span><span class=\"p\">,</span> <span class=\"s2\">\"one\"</span><span class=\"p\">,</span> <span class=\"s2\">\"one\"</span><span class=\"p\">,</span> <span class=\"s2\">\"two\"</span><span class=\"p\">,</span> <span class=\"s2\">\"two\"</span><span class=\"p\">,</span>\n                          <span class=\"s2\">\"one\"</span><span class=\"p\">,</span> <span class=\"s2\">\"one\"</span><span class=\"p\">,</span> <span class=\"s2\">\"two\"</span><span class=\"p\">,</span> <span class=\"s2\">\"two\"</span><span class=\"p\">],</span>\n                    <span class=\"s2\">\"C\"</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"small\"</span><span class=\"p\">,</span> <span class=\"s2\">\"large\"</span><span class=\"p\">,</span> <span class=\"s2\">\"large\"</span><span class=\"p\">,</span> <span class=\"s2\">\"small\"</span><span class=\"p\">,</span>\n                          <span class=\"s2\">\"small\"</span><span class=\"p\">,</span> <span class=\"s2\">\"large\"</span><span class=\"p\">,</span> <span class=\"s2\">\"small\"</span><span class=\"p\">,</span> <span class=\"s2\">\"small\"</span><span class=\"p\">,</span>\n                          <span class=\"s2\">\"large\"</span><span class=\"p\">],</span>\n                    <span class=\"s2\">\"D\"</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">],</span>\n                    <span class=\"s2\">\"E\"</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">]})</span>\n\n<span class=\"n\">table</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">pd</span>\n    <span class=\"o\">.</span><span class=\"n\">pivot_table</span><span class=\"p\">(</span>\n        <span class=\"n\">df</span><span class=\"p\">,</span> \n        <span class=\"n\">rows</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'A'</span><span class=\"p\">,</span> <span class=\"s1\">'B'</span><span class=\"p\">],</span> \n        <span class=\"n\">cols</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'C'</span><span class=\"p\">],</span> \n        <span class=\"n\">values</span><span class=\"o\">=</span><span class=\"s1\">'D'</span><span class=\"p\">,</span>\n        <span class=\"n\">aggfunc</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">)</span>\n    <span class=\"o\">.</span><span class=\"n\">sort</span><span class=\"p\">(</span><span class=\"s2\">\"large\"</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>       \n</pre>\n<p>The second statement uses two pandas functions with deprecated keyword arguments.  You can obviously fix this by hand, but if you have lots of code this is tedious and error prone.</p>\n<p><code>ast-refactor</code> provides you the tools to automatically convert that second statement into something that will work for modern versions of pandas.</p>\n<pre><span class=\"n\">table</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">pd</span>\n    <span class=\"o\">.</span><span class=\"n\">pivot_table</span><span class=\"p\">(</span>\n        <span class=\"n\">df</span><span class=\"p\">,</span> \n        <span class=\"n\">index</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'A'</span><span class=\"p\">,</span> <span class=\"s1\">'B'</span><span class=\"p\">],</span> \n        <span class=\"n\">columns</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'C'</span><span class=\"p\">],</span> \n        <span class=\"n\">values</span><span class=\"o\">=</span><span class=\"s1\">'D'</span><span class=\"p\">,</span>\n        <span class=\"n\">aggfunc</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">)</span>\n    <span class=\"o\">.</span><span class=\"n\">sort_values</span><span class=\"p\">(</span><span class=\"s2\">\"large\"</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>   \n</pre>\n<p>This is intended as a tool to help library author and owners of large codebases migrate source code easily.</p>\n<h2>Usage</h2>\n<p>For detailed usage documentation see <a href=\"https://github.com/flatironhealth/ast-refactor/blob/master/doc/using.md\" rel=\"nofollow\">usage docs</a> and\n<a href=\"https://github.com/flatironhealth/ast-refactor/blob/master/doc/writing_a_migrator.md\" rel=\"nofollow\">writing a migrator</a> and</p>\n<h3>as a python cli</h3>\n<p>The easiest way to install this tool is using\n<a href=\"https://pipxproject.github.io/pipx/\" rel=\"nofollow\">pipx</a>.</p>\n<pre>$ pipx install <span class=\"se\">\\</span>\n    ast-refactor\n\n$ ast-refactor run some/path/or/file\n</pre>\n<h3>as a docker container</h3>\n<p>Alternatively you can run it from a docker container</p>\n<pre>$ docker run <span class=\"se\">\\</span>\n    -e <span class=\"nv\">UID</span><span class=\"o\">=</span><span class=\"k\">$(</span>id -u<span class=\"k\">)</span> <span class=\"se\">\\</span>\n    -e <span class=\"nv\">GID</span><span class=\"o\">=</span><span class=\"k\">$(</span>id -u<span class=\"k\">)</span> <span class=\"se\">\\</span>\n    -v /some/path/or/file:/work <span class=\"se\">\\</span>\n    flatironhealth/ast-refactor <span class=\"se\">\\</span>\n    run <span class=\"se\">\\</span>\n    /work\n</pre>\n<h2>Building</h2>\n<h3>locally</h3>\n<pre>$ pip install .\n$ ast-refactor some/path/or/file\n</pre>\n<h3>docker</h3>\n<pre>docker build -t ast-refactor .\n</pre>\n\n          </div>"}, "last_serial": 6335224, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "90b81e41932b466d4c15f3f0767376d3", "sha256": "729722b83e9af55a7b0b99f8f01abd4357b5ec5842cbe615d74ce32326cfa301"}, "downloads": -1, "filename": "ast-refactor-0.1.0.tar.gz", "has_sig": true, "md5_digest": "90b81e41932b466d4c15f3f0767376d3", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 7512, "upload_time": "2019-12-19T21:02:33", "upload_time_iso_8601": "2019-12-19T21:02:33.331433Z", "url": "https://files.pythonhosted.org/packages/02/03/a5b219d1b248d409da3cb914a3d71c7a75196f0aabc82f36fac50ee0b411/ast-refactor-0.1.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "90b81e41932b466d4c15f3f0767376d3", "sha256": "729722b83e9af55a7b0b99f8f01abd4357b5ec5842cbe615d74ce32326cfa301"}, "downloads": -1, "filename": "ast-refactor-0.1.0.tar.gz", "has_sig": true, "md5_digest": "90b81e41932b466d4c15f3f0767376d3", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 7512, "upload_time": "2019-12-19T21:02:33", "upload_time_iso_8601": "2019-12-19T21:02:33.331433Z", "url": "https://files.pythonhosted.org/packages/02/03/a5b219d1b248d409da3cb914a3d71c7a75196f0aabc82f36fac50ee0b411/ast-refactor-0.1.0.tar.gz", "yanked": false}], "timestamp": "Thu May  7 18:16:50 2020"}