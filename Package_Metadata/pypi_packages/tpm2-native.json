{"info": {"author": "Mete Balci", "author_email": "metebalci@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Environment :: Console", "License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Topic :: Utilities"], "description": "# tpm2-native\n\nThis is a collection of tools for playing with TPM v2 modules natively e.g. through SPI. The main purpose is to learn how TPM v2 works by interacting with a TPM. \n\nI do all my testing on a Raspberry Pi 4 with an [Infineon OPTIGA TPM SLM 9670 Iridium TPM2.0 Evaluation Board](https://www.infineon.com/cms/en/product/evaluation-boards/iridium-slm-9670-tpm2.0/). All the [examples](#Examples) below are also from this platform.\n\n# Install\n\nSimply install with `pip install tpm2-native`. This will install all utilities that can be called natively. All utilities have names starting with `tpm2_`, utilities are simply the command names e.g. tpm2_Startup.\n\n# Supported Commands\n\nThe section names are the same as in [Trusted Platform Module Library Part 3: Commands Family 2.0 Level 00 Revision 01.38](https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.38.pdf).\n\n## Start-up\n\nAll commands in this section in the spec. are implemented.\n\n- Startup*\n- Shutdown*\n\n## Testing\n\nAll commands in this section in the spec. are implemented.\n\n- SelfTest*\n- IncrementalSelfTest*\n- GetTestResult\n\n## Random Number Generator\n\nAll commands in this section in the spec. are implemented.\n\n- GetRandom\n- StirRandom\n\n## Capability Commands\n\n- GetCapability (still under development)\n\n# References\n\n- [TPM 2.0 Library Specification](https://trustedcomputinggroup.org/resource/tpm-library-specification/)\n- [Infineon Embedded Linux TPM Toolbox 2 (ELTT2) for TPM 2.0](https://github.com/Infineon/eltt2)\n- [Infineon Iridium SLM 9670 TPM2.0](https://www.infineon.com/cms/en/product/evaluation-boards/iridium-slm-9670-tpm2.0/)\n\n# Examples\n\nStartup:\n\n```\n$ tpm2_Startup clear\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x144 [TPM_CC_Startup]\nreq: 80 01 00 00 00 0c 00 00 01 44 00 00\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n```\n\nShutdown:\n\n```\n $ tpm2_Shutdown clear\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x145 [TPM_CC_Shutdown]\nreq: 80 01 00 00 00 0c 00 00 01 45 00 00\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n```\n\nIncrementalSelfTest:\n\n```\n $ tpm2_IncrementalSelfTest no_sessions AES\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0x10 [16]\n        commandCode: 0x142 [TPM_CC_IncrementalSelfTest]\nreq: 80 01 00 00 00 10 00 00 01 42 00 00 00 01 00 06\nres: 80 01 00 00 00 22 00 00 00 00 00 00 00 0a 00 01 00 14 00 15 00 16 00 18 00 19 00 1a 00 20 00 22 00 23\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x22 [34]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n           toDoList:\n                     TPM_ALG_RSA\n                     TPM_ALG_RSASSA\n                     TPM_ALG_RSAES\n                     TPM_ALG_RSAPSS\n                     TPM_ALG_ECDSA\n                     TPM_ALG_ECDH\n                     TPM_ALG_ECDAA\n                     TPM_ALG_KDF1_SP800_56A\n                     TPM_ALG_KDF1_SP800_108\n                     TPM_ALG_ECC\n```\n\nNote: toDoList is not the algorithms to be tested. The algorithms sent are to be tested. toDoList is the algorithms that has not been tested yet. For example, if I run above with RSA, then toDoList will not contain RSA.\n\nSelfTest:\n\n```\n$ tpm2_SelfTest no_sessions yes\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xb [11]\n        commandCode: 0x143 [TPM_CC_SelfTest]\nreq: 80 01 00 00 00 0b 00 00 01 43 01\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n```\n\nGetTestResult:\n\n```\n$ tpm2_GetTestResult\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xa [10]\n        commandCode: 0x17c [TPM_CC_GetTestResult]\nreq: 80 01 00 00 00 0a 00 00 01 7c\nres: 80 01 00 00 00 1a 00 00 00 00 00 0a 00 06 01 0b 00 00 00 00 0e b8 00 00 01 53\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x1a [26]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n        outDataSize: 0xa [10]\n            outData: 00 06 01 0b 00 00 00 00 0e b8\n         testResult: 0x0 [TPM_RC_SUCCESS]\n```\n\nGetRandom:\n\n```\n$ tpm2_GetRandom 16\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x17b [TPM_CC_GetRandom]\nreq: 80 01 00 00 00 0c 00 00 01 7b 00 10\nres: 80 01 00 00 00 1c 00 00 00 00 00 10 7d 17 16 5a e5 16 1a c4 9a 56 f6 5c 9f 4d bd be\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x1c [28]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n    randomBytesSize: 0x10 [16]\n        randomBytes: 7d 17 16 5a e5 16 1a c4 9a 56 f6 5c 9f 4d bd be\n```\n\nStirRandom: \n\n```\n$ dd if=/dev/random of=indata count=128 bs=1\n$ tpm2_StirRandom no_sessions indata\n        len(inData): 0x80 [128]\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0x8c [140]\n        commandCode: 0x146 [TPM_CC_StirRandom]\nreq: 80 01 00 00 00 8c 00 00 01 46 00 80 3b a9 73 cb c5 ac bc 89 ac 2a 5c b2 c1 b5 cd 32 c7 1e d1 de 12 ea f5 54 ea 43 b4 82 6f 19 ba 99 65 07 c6 20 c4 2e 30 cc d7 d3 0d 02 63 e3 56 77 73 0d b9 f2 c2 5b 9c 0e 46 77 18 d7 c8 d8 4f 27 a4 5e 2b 64 31 b0 b7 62 d2 26 6d db 97 8b 50 27 36 0f 79 8d 4f 95 04 c5 00 65 af 35 ab 40 2d c6 36 c7 04 94 1b fd 92 48 dc d3 9e 19 fa 31 48 ea 21 da 08 73 0d c6 82 77 b9 32 27 2e 35 7a 2a 07\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n```\n\nGetCapability:\n\n```\n```\n\nTestParms:\n\n``\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/metebalci/tpm2-native", "keywords": "tpm,tpm2", "license": "GPLv3", "maintainer": "", "maintainer_email": "", "name": "tpm2-native", "package_url": "https://pypi.org/project/tpm2-native/", "platform": "", "project_url": "https://pypi.org/project/tpm2-native/", "project_urls": {"Homepage": "https://github.com/metebalci/tpm2-native"}, "release_url": "https://pypi.org/project/tpm2-native/6/", "requires_dist": null, "requires_python": "", "summary": "collection of tools for playing with TPM v2 modules natively e.g. through SPI", "version": "6", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>tpm2-native</h1>\n<p>This is a collection of tools for playing with TPM v2 modules natively e.g. through SPI. The main purpose is to learn how TPM v2 works by interacting with a TPM.</p>\n<p>I do all my testing on a Raspberry Pi 4 with an <a href=\"https://www.infineon.com/cms/en/product/evaluation-boards/iridium-slm-9670-tpm2.0/\" rel=\"nofollow\">Infineon OPTIGA TPM SLM 9670 Iridium TPM2.0 Evaluation Board</a>. All the <a href=\"#Examples\" rel=\"nofollow\">examples</a> below are also from this platform.</p>\n<h1>Install</h1>\n<p>Simply install with <code>pip install tpm2-native</code>. This will install all utilities that can be called natively. All utilities have names starting with <code>tpm2_</code>, utilities are simply the command names e.g. tpm2_Startup.</p>\n<h1>Supported Commands</h1>\n<p>The section names are the same as in <a href=\"https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.38.pdf\" rel=\"nofollow\">Trusted Platform Module Library Part 3: Commands Family 2.0 Level 00 Revision 01.38</a>.</p>\n<h2>Start-up</h2>\n<p>All commands in this section in the spec. are implemented.</p>\n<ul>\n<li>Startup*</li>\n<li>Shutdown*</li>\n</ul>\n<h2>Testing</h2>\n<p>All commands in this section in the spec. are implemented.</p>\n<ul>\n<li>SelfTest*</li>\n<li>IncrementalSelfTest*</li>\n<li>GetTestResult</li>\n</ul>\n<h2>Random Number Generator</h2>\n<p>All commands in this section in the spec. are implemented.</p>\n<ul>\n<li>GetRandom</li>\n<li>StirRandom</li>\n</ul>\n<h2>Capability Commands</h2>\n<ul>\n<li>GetCapability (still under development)</li>\n</ul>\n<h1>References</h1>\n<ul>\n<li><a href=\"https://trustedcomputinggroup.org/resource/tpm-library-specification/\" rel=\"nofollow\">TPM 2.0 Library Specification</a></li>\n<li><a href=\"https://github.com/Infineon/eltt2\" rel=\"nofollow\">Infineon Embedded Linux TPM Toolbox 2 (ELTT2) for TPM 2.0</a></li>\n<li><a href=\"https://www.infineon.com/cms/en/product/evaluation-boards/iridium-slm-9670-tpm2.0/\" rel=\"nofollow\">Infineon Iridium SLM 9670 TPM2.0</a></li>\n</ul>\n<h1>Examples</h1>\n<p>Startup:</p>\n<pre><code>$ tpm2_Startup clear\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x144 [TPM_CC_Startup]\nreq: 80 01 00 00 00 0c 00 00 01 44 00 00\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n</code></pre>\n<p>Shutdown:</p>\n<pre><code> $ tpm2_Shutdown clear\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x145 [TPM_CC_Shutdown]\nreq: 80 01 00 00 00 0c 00 00 01 45 00 00\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n</code></pre>\n<p>IncrementalSelfTest:</p>\n<pre><code> $ tpm2_IncrementalSelfTest no_sessions AES\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0x10 [16]\n        commandCode: 0x142 [TPM_CC_IncrementalSelfTest]\nreq: 80 01 00 00 00 10 00 00 01 42 00 00 00 01 00 06\nres: 80 01 00 00 00 22 00 00 00 00 00 00 00 0a 00 01 00 14 00 15 00 16 00 18 00 19 00 1a 00 20 00 22 00 23\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x22 [34]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n           toDoList:\n                     TPM_ALG_RSA\n                     TPM_ALG_RSASSA\n                     TPM_ALG_RSAES\n                     TPM_ALG_RSAPSS\n                     TPM_ALG_ECDSA\n                     TPM_ALG_ECDH\n                     TPM_ALG_ECDAA\n                     TPM_ALG_KDF1_SP800_56A\n                     TPM_ALG_KDF1_SP800_108\n                     TPM_ALG_ECC\n</code></pre>\n<p>Note: toDoList is not the algorithms to be tested. The algorithms sent are to be tested. toDoList is the algorithms that has not been tested yet. For example, if I run above with RSA, then toDoList will not contain RSA.</p>\n<p>SelfTest:</p>\n<pre><code>$ tpm2_SelfTest no_sessions yes\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xb [11]\n        commandCode: 0x143 [TPM_CC_SelfTest]\nreq: 80 01 00 00 00 0b 00 00 01 43 01\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n</code></pre>\n<p>GetTestResult:</p>\n<pre><code>$ tpm2_GetTestResult\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xa [10]\n        commandCode: 0x17c [TPM_CC_GetTestResult]\nreq: 80 01 00 00 00 0a 00 00 01 7c\nres: 80 01 00 00 00 1a 00 00 00 00 00 0a 00 06 01 0b 00 00 00 00 0e b8 00 00 01 53\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x1a [26]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n        outDataSize: 0xa [10]\n            outData: 00 06 01 0b 00 00 00 00 0e b8\n         testResult: 0x0 [TPM_RC_SUCCESS]\n</code></pre>\n<p>GetRandom:</p>\n<pre><code>$ tpm2_GetRandom 16\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0xc [12]\n        commandCode: 0x17b [TPM_CC_GetRandom]\nreq: 80 01 00 00 00 0c 00 00 01 7b 00 10\nres: 80 01 00 00 00 1c 00 00 00 00 00 10 7d 17 16 5a e5 16 1a c4 9a 56 f6 5c 9f 4d bd be\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0x1c [28]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n    randomBytesSize: 0x10 [16]\n        randomBytes: 7d 17 16 5a e5 16 1a c4 9a 56 f6 5c 9f 4d bd be\n</code></pre>\n<p>StirRandom:</p>\n<pre><code>$ dd if=/dev/random of=indata count=128 bs=1\n$ tpm2_StirRandom no_sessions indata\n        len(inData): 0x80 [128]\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n        requestSize: 0x8c [140]\n        commandCode: 0x146 [TPM_CC_StirRandom]\nreq: 80 01 00 00 00 8c 00 00 01 46 00 80 3b a9 73 cb c5 ac bc 89 ac 2a 5c b2 c1 b5 cd 32 c7 1e d1 de 12 ea f5 54 ea 43 b4 82 6f 19 ba 99 65 07 c6 20 c4 2e 30 cc d7 d3 0d 02 63 e3 56 77 73 0d b9 f2 c2 5b 9c 0e 46 77 18 d7 c8 d8 4f 27 a4 5e 2b 64 31 b0 b7 62 d2 26 6d db 97 8b 50 27 36 0f 79 8d 4f 95 04 c5 00 65 af 35 ab 40 2d c6 36 c7 04 94 1b fd 92 48 dc d3 9e 19 fa 31 48 ea 21 da 08 73 0d c6 82 77 b9 32 27 2e 35 7a 2a 07\nres: 80 01 00 00 00 0a 00 00 00 00\n                tag: 0x8001 [TPM_ST_NO_SESSIONS]\n       responseSize: 0xa [10]\n       responseCode: 0x0 [TPM_RC_SUCCESS]\n</code></pre>\n<p>GetCapability:</p>\n<pre><code></code></pre>\n<p>TestParms:</p>\n<p>``</p>\n<pre><code></code></pre>\n\n          </div>"}, "last_serial": 6729584, "releases": {"2": [{"comment_text": "", "digests": {"md5": "d878295aa4b8b02fc9790bdd9c4e0e66", "sha256": "7977376005a0ed7a517e9a81e9363c004476e02b1bfbe2798cab7034824dd9e9"}, "downloads": -1, "filename": "tpm2-native-2.tar.gz", "has_sig": false, "md5_digest": "d878295aa4b8b02fc9790bdd9c4e0e66", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3610, "upload_time": "2020-02-26T17:43:39", "upload_time_iso_8601": "2020-02-26T17:43:39.092016Z", "url": "https://files.pythonhosted.org/packages/bc/63/1f0fa2eaf5e7d28f28a36a3c644225505032b3640af6c9a3014f8f012e4f/tpm2-native-2.tar.gz", "yanked": false}], "3": [{"comment_text": "", "digests": {"md5": "7107dfee7dee120efcf34f83d4db8a3c", "sha256": "ed93ad217d055cb4c2e069398a9949b8cfa739aaa2c6dc511f2e5b482498d685"}, "downloads": -1, "filename": "tpm2-native-3.tar.gz", "has_sig": false, "md5_digest": "7107dfee7dee120efcf34f83d4db8a3c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6574, "upload_time": "2020-02-26T21:51:22", "upload_time_iso_8601": "2020-02-26T21:51:22.001053Z", "url": "https://files.pythonhosted.org/packages/d7/56/f400ddb2900a68ba9f66e7d316aafb93da3f0c467337c5a1769dcf00cc30/tpm2-native-3.tar.gz", "yanked": false}], "4": [{"comment_text": "", "digests": {"md5": "2984f0911fb6813ba57965b803874997", "sha256": "995a81b9a48ea89328d135fecf645547be605cdb900e39e931d2f89d8a8d4ef2"}, "downloads": -1, "filename": "tpm2-native-4.tar.gz", "has_sig": false, "md5_digest": "2984f0911fb6813ba57965b803874997", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11726, "upload_time": "2020-02-27T22:45:39", "upload_time_iso_8601": "2020-02-27T22:45:39.361738Z", "url": "https://files.pythonhosted.org/packages/63/ce/1a9c471e9f71314f39db666364abd370cb3807bf2d52164017dfbd9fa067/tpm2-native-4.tar.gz", "yanked": false}], "5": [{"comment_text": "", "digests": {"md5": "fd33442649f0ee6c8a6368f3639d34cd", "sha256": "cd3c121a88f51dda0b1bb0a4ed29596b11b04164d9b606bb389960a1859d5d65"}, "downloads": -1, "filename": "tpm2-native-5.tar.gz", "has_sig": false, "md5_digest": "fd33442649f0ee6c8a6368f3639d34cd", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 12872, "upload_time": "2020-02-28T22:54:41", "upload_time_iso_8601": "2020-02-28T22:54:41.451413Z", "url": "https://files.pythonhosted.org/packages/b6/5f/f19097004749be427cc8d57d1c7007c7c23b32229e60f07cac8dac43f95c/tpm2-native-5.tar.gz", "yanked": false}], "6": [{"comment_text": "", "digests": {"md5": "ea62c542827ba02ec673f2a83c81ae5c", "sha256": "6143b827bc2ae3916ba10a5fa83f0fd5f5ba7089da4c321ce7c9ae515f0d39c7"}, "downloads": -1, "filename": "tpm2-native-6.tar.gz", "has_sig": false, "md5_digest": "ea62c542827ba02ec673f2a83c81ae5c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11997, "upload_time": "2020-03-01T19:12:59", "upload_time_iso_8601": "2020-03-01T19:12:59.183439Z", "url": "https://files.pythonhosted.org/packages/5a/6b/e3aecb0f56cca98e65bed6e96c29396d5af63a060e5aca648445ee4c6264/tpm2-native-6.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "ea62c542827ba02ec673f2a83c81ae5c", "sha256": "6143b827bc2ae3916ba10a5fa83f0fd5f5ba7089da4c321ce7c9ae515f0d39c7"}, "downloads": -1, "filename": "tpm2-native-6.tar.gz", "has_sig": false, "md5_digest": "ea62c542827ba02ec673f2a83c81ae5c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11997, "upload_time": "2020-03-01T19:12:59", "upload_time_iso_8601": "2020-03-01T19:12:59.183439Z", "url": "https://files.pythonhosted.org/packages/5a/6b/e3aecb0f56cca98e65bed6e96c29396d5af63a060e5aca648445ee4c6264/tpm2-native-6.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:49:13 2020"}