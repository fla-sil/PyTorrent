{"info": {"author": "Eric Florenzano", "author_email": "floguy@gmail.com", "bugtrack_url": null, "classifiers": ["Environment :: Web Environment", "Framework :: Django", "Programming Language :: Python", "Topic :: Software Development :: Libraries :: Python Modules"], "description": "Overview of django-classfaves\n-----------------------------\n\nThis app provides everything that you need to add favoriting abilities to\nyour site!  There are just a few steps that you need to go through to add\nthis functionality to your site.\n\n\nInstallation at a Glance\n========================\n\n1.  Create a favorite model that has a ``ForeignKey`` to the domain object\n    that you would like to be able to favorite or unfavorite.\n\n2.  Instantiate ``CreateFavorite``, ``DeleteFavorite``, and ``UserFavorites``\n    in one of your url configurations, and map them into your urlpatterns.\n\n3.  Integrate into your domain object's templates and views.\n\n\nInstallation Example: Arcade Site\n=================================\n\nThis installation example comes from `Radiosox`_, for which this application\nwas originally written.  The site is a free online arcade site that allows\nusers to mark certain games as their favorite ones.  They are allowed to\nun-favorite those games if they change their mind.  Finally, they are allowed\nto see a list of their favorite games.\n\nStep 1: Creating our Model\n~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nWe already have a domain object that looks a little bit like this:\n\n.. sourcecode:: python\n\n    from django.db import models\n\n    class Game(models.Model):\n        name = models.CharField(max_length=64)\n        slug = models.SlugField(max_length=64)\n        description = models.TextField(blank=True)\n        # ... there are many more fields here\n\nNow what we want to do is in that same models.py file, we will create our\nfavorite model, like shown here:\n\n.. sourcecode:: python\n\n    from classfaves.models import FavoriteBase\n\n    class GameFavorite(FavoriteBase):\n        game = models.ForeignKey(Game)\n\nWhat this does is use our ``FavoriteBase`` abstract base class, provide by\ndjango-classfaves, and ensure that it's got a link to our ``Game`` domain\nobject.  This model is equivalent to manually writing this:\n\n.. sourcecode:: python\n\n    import datetime\n    \n    from django.db import models\n    from django.contrib.auth.models import User\n\n    class GameFavorite(models.Model):\n        game = models.ForeignKey(Game)\n        user = models.ForeignKey(User)\n        date_created = models.DateTimeField(default=datetime.datetime.now)\n\nIn fact, you could write that model if you prefer.  I prefer to subclass\n``FavoriteBase``, since it's easier.\n\n\nStep 2: Attaching our Views\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nIn our ``urls.py`` file for that arcade app whose models we were using in the\nprevious step, we have something that, right now, looks like this:\n\n.. sourcecode:: python\n\n    from django.conf.urls.defaults import patterns, url\n\n    urlpatterns = patterns('arcade.views',\n        url(r'^popular/$', 'popular', name='arcade_popular'),\n        url(r'^new/$', 'new', name='arcade_new'),\n        # ... there are more URLs here\n    )\n\nWhat we want to do first is instantiate our views provided by the\ndjango-classfaves app:\n\n.. sourcecode:: python\n\n    from arcade.models import GameFavorite, Game\n    from classfaves.views import CreateFavorite, DeleteFavorite, UserFavorites\n\n    create_favorite = CreateFavorite(GameFavorite, Game)\n    delete_favorite = DeleteFavorite(GameFavorite, Game)\n    public_games = lambda qs: qs.filter(game__enabled=True)\n    user_favorites = UserFavorites(GameFavorite, Game, extra_filter=public_games)\n\nWhat this does is give us views to create, delete, and get user favorites for\nall games in the system.  You'll note that we're passing an argument named\n``extra_filter`` to ``UserFavorites`` which limits the view to only showing\ngames with ``enabled`` set to ``True``.  This can be used to limit the\n``QuerySet`` arbitrarily.  Kinda cool, huh?\n\nAnyway, the next step is to modify our ``urlpatterns`` so that it maps to these\nviews:\n\n..sourcecode:: python\n\n    urlpatterns = patterns('arcade.views',\n        url(r'^popular/$', 'popular', name='arcade_popular'),\n        url(r'^new/$', 'new', name='arcade_new'),\n        # ... vvv THE NEW URLS ARE BELOW vvv\n        url(r'^favorites/create/(?P<pk>\\d+)/$', create_favorite, name='arcade_favorite_create'),\n        url(r'^favorites/delete/(?P<pk>\\d+)/$', delete_favorite, name='arcade_favorite_delete'),\n        url(r'^favorites/list/$', user_favorites, name='arcade_my_favorites'),\n        url(r'^favorites/list/(?P<username>[a-zA-Z0-9_-]+)/$', user_favorites, name='arcade_user_favorites'),\n    )\n\nNote how we were able to give the new views proper URL names, and how we were\nable to easily place them where they logically fit in the URL structure--under\nthe URL space of the arcade app.  Also note that we've ensured to have a ``pk``\nfor the create and delete views.\n\n\nStep 3: Integration\n~~~~~~~~~~~~~~~~~~~\n\nAdmittedly, this part is the part where django-classfaves helps you out the\nleast.  Well, basically, django-classfaves doesn't help you out at all.  The\nreason for this is by design: we don't know how your app is structured or how\nyou want to use it, so we want to leave this bit completely up to you.\n\nSo here's how we did it.  First, on the page where you actually play the game,\nwe want you to be able to decide that you like it and favorite it.  We also\nwanted to make sure that you could do this while you are still playing the\ngame, so it needed to be asynchronous using JavaScript.\n\nOur first step was to modify the view function for the game playing page.\n\n..sourcecode:: python\n\n    from arcade.models import GameFavorite\n\n    def play(request, game_slug=None):\n        # ... some of our view code here\n        favorite = False\n        if request.user.is_authenticated():\n            favorite = GameFavorite.objects.filter(user=request.user,\n                game=game).count() > 0\n        context = {\n            # ... other context here\n            'favorite': favorite,\n        }\n        # ... the rest of our view code here\n\nJust a few lines of code, and we now know whether the user has a favorite on\nthat specific domain object (the game) or not.\n\nNow, in the template, we do this with the information:\n\n..sourcecode:: python\n\n    {% if user.is_authenticated %}\n        {% if favorite %}\n            <a href=\"#\" id=\"favorite_{{ game.id }}\" class=\"favorite fav unfave\">Remove as Favorite</a>\n        {% else %}\n            <a href=\"#\" id=\"favorite_{{ game.id }}\" class=\"favorite fav fave\">Add as Favorite</a>\n        {% endif %}\n    {% else %}\n        <a href=\"{% url arcade_favorite_create game.id %}\" class=\"fav\" id=\"favorite_{{ game.id }}\" class=\"favorite\">Add as Favorite</a>\n    {% endif %}\n\nIn other words, based on whether the user is authenticated and based on whether\nor not they have already favorited the game, we set some classes and urls and\nmessages on the links.\n\nWe also have a bit of JavaScript, that looks like this:\n\n..sourcecode:: javascript\n\n    var add_favorite_handlers = function(base_create, base_delete) {\n        $('a.favorite.fave').live('click', function(e) {\n            var pk = $(this).attr('id').replace('favorite_', '');\n            var url = base_create + pk + '/';\n            $.getJSON(url, function(data, textStatus) {\n                $('#favorite_' + pk).removeClass('fave').addClass('unfave').text('Remove as Favorite');\n            });\n            return false;\n        });\n        $('a.favorite.unfave').live('click', function(e) {\n            var pk = $(this).attr('id').replace('favorite_', '');\n            var url = base_delete + pk + '/';\n            $.getJSON(url, function(data, textStatus) {\n                $('#favorite_' + pk).removeClass('unfave').addClass('fave').text('Add as Favorite');\n            });\n            return false;\n        });\n    };\n\nI'm not going to go into too much detail about this JavaScript code, except to\nsay that it takes the base URL for the create and the delete pages, and turns\nlinks with certain classes into AJAX calls into the create and delete views.\n\nFinally, at the bottom of the page, we initialize this JavaScript like so:\n\n.. sourcecode:: html\n\n    <script type=\"text/javascript\">\n    $(function() {\n        add_favorite_handlers('/games/favorites/create/', '/games/favorites/delete/');\n    });\n    </script>\n\nAnd with that, we're done!  Not too bad, huh?  You can browse around `Radisox`\nand play a game to see it in action.  Look up at the top right of any game\npage to see the favorite/un-favorite button.\n\n.. _`Radiosox`: http://radiosox.com/", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "http://github.com/ericflo/django-classfaves", "keywords": "favorites,faves,django,class-based", "license": "BSD", "maintainer": null, "maintainer_email": null, "name": "django-classfaves", "package_url": "https://pypi.org/project/django-classfaves/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/django-classfaves/", "project_urls": {"Download": "UNKNOWN", "Homepage": "http://github.com/ericflo/django-classfaves"}, "release_url": "https://pypi.org/project/django-classfaves/0.1/", "requires_dist": null, "requires_python": null, "summary": "A different approach to favorites in Django", "version": "0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            Overview of django-classfaves<br>-----------------------------<br><br>This app provides everything that you need to add favoriting abilities to<br>your site!  There are just a few steps that you need to go through to add<br>this functionality to your site.<br><br><br>Installation at a Glance<br>========================<br><br>1.  Create a favorite model that has a ``ForeignKey`` to the domain object<br>    that you would like to be able to favorite or unfavorite.<br><br>2.  Instantiate ``CreateFavorite``, ``DeleteFavorite``, and ``UserFavorites``<br>    in one of your url configurations, and map them into your urlpatterns.<br><br>3.  Integrate into your domain object's templates and views.<br><br><br>Installation Example: Arcade Site<br>=================================<br><br>This installation example comes from `Radiosox`_, for which this application<br>was originally written.  The site is a free online arcade site that allows<br>users to mark certain games as their favorite ones.  They are allowed to<br>un-favorite those games if they change their mind.  Finally, they are allowed<br>to see a list of their favorite games.<br><br>Step 1: Creating our Model<br>~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>We already have a domain object that looks a little bit like this:<br><br>.. sourcecode:: python<br><br>    from django.db import models<br><br>    class Game(models.Model):<br>        name = models.CharField(max_length=64)<br>        slug = models.SlugField(max_length=64)<br>        description = models.TextField(blank=True)<br>        # ... there are many more fields here<br><br>Now what we want to do is in that same models.py file, we will create our<br>favorite model, like shown here:<br><br>.. sourcecode:: python<br><br>    from classfaves.models import FavoriteBase<br><br>    class GameFavorite(FavoriteBase):<br>        game = models.ForeignKey(Game)<br><br>What this does is use our ``FavoriteBase`` abstract base class, provide by<br>django-classfaves, and ensure that it's got a link to our ``Game`` domain<br>object.  This model is equivalent to manually writing this:<br><br>.. sourcecode:: python<br><br>    import datetime<br>    <br>    from django.db import models<br>    from django.contrib.auth.models import User<br><br>    class GameFavorite(models.Model):<br>        game = models.ForeignKey(Game)<br>        user = models.ForeignKey(User)<br>        date_created = models.DateTimeField(default=datetime.datetime.now)<br><br>In fact, you could write that model if you prefer.  I prefer to subclass<br>``FavoriteBase``, since it's easier.<br><br><br>Step 2: Attaching our Views<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>In our ``urls.py`` file for that arcade app whose models we were using in the<br>previous step, we have something that, right now, looks like this:<br><br>.. sourcecode:: python<br><br>    from django.conf.urls.defaults import patterns, url<br><br>    urlpatterns = patterns('arcade.views',<br>        url(r'^popular/$', 'popular', name='arcade_popular'),<br>        url(r'^new/$', 'new', name='arcade_new'),<br>        # ... there are more URLs here<br>    )<br><br>What we want to do first is instantiate our views provided by the<br>django-classfaves app:<br><br>.. sourcecode:: python<br><br>    from arcade.models import GameFavorite, Game<br>    from classfaves.views import CreateFavorite, DeleteFavorite, UserFavorites<br><br>    create_favorite = CreateFavorite(GameFavorite, Game)<br>    delete_favorite = DeleteFavorite(GameFavorite, Game)<br>    public_games = lambda qs: qs.filter(game__enabled=True)<br>    user_favorites = UserFavorites(GameFavorite, Game, extra_filter=public_games)<br><br>What this does is give us views to create, delete, and get user favorites for<br>all games in the system.  You'll note that we're passing an argument named<br>``extra_filter`` to ``UserFavorites`` which limits the view to only showing<br>games with ``enabled`` set to ``True``.  This can be used to limit the<br>``QuerySet`` arbitrarily.  Kinda cool, huh?<br><br>Anyway, the next step is to modify our ``urlpatterns`` so that it maps to these<br>views:<br><br>..sourcecode:: python<br><br>    urlpatterns = patterns('arcade.views',<br>        url(r'^popular/$', 'popular', name='arcade_popular'),<br>        url(r'^new/$', 'new', name='arcade_new'),<br>        # ... vvv THE NEW URLS ARE BELOW vvv<br>        url(r'^favorites/create/(?P&lt;pk&gt;\\d+)/$', create_favorite, name='arcade_favorite_create'),<br>        url(r'^favorites/delete/(?P&lt;pk&gt;\\d+)/$', delete_favorite, name='arcade_favorite_delete'),<br>        url(r'^favorites/list/$', user_favorites, name='arcade_my_favorites'),<br>        url(r'^favorites/list/(?P&lt;username&gt;[a-zA-Z0-9_-]+)/$', user_favorites, name='arcade_user_favorites'),<br>    )<br><br>Note how we were able to give the new views proper URL names, and how we were<br>able to easily place them where they logically fit in the URL structure--under<br>the URL space of the arcade app.  Also note that we've ensured to have a ``pk``<br>for the create and delete views.<br><br><br>Step 3: Integration<br>~~~~~~~~~~~~~~~~~~~<br><br>Admittedly, this part is the part where django-classfaves helps you out the<br>least.  Well, basically, django-classfaves doesn't help you out at all.  The<br>reason for this is by design: we don't know how your app is structured or how<br>you want to use it, so we want to leave this bit completely up to you.<br><br>So here's how we did it.  First, on the page where you actually play the game,<br>we want you to be able to decide that you like it and favorite it.  We also<br>wanted to make sure that you could do this while you are still playing the<br>game, so it needed to be asynchronous using JavaScript.<br><br>Our first step was to modify the view function for the game playing page.<br><br>..sourcecode:: python<br><br>    from arcade.models import GameFavorite<br><br>    def play(request, game_slug=None):<br>        # ... some of our view code here<br>        favorite = False<br>        if request.user.is_authenticated():<br>            favorite = GameFavorite.objects.filter(user=request.user,<br>                game=game).count() &gt; 0<br>        context = {<br>            # ... other context here<br>            'favorite': favorite,<br>        }<br>        # ... the rest of our view code here<br><br>Just a few lines of code, and we now know whether the user has a favorite on<br>that specific domain object (the game) or not.<br><br>Now, in the template, we do this with the information:<br><br>..sourcecode:: python<br><br>    {% if user.is_authenticated %}<br>        {% if favorite %}<br>            &lt;a href=\"#\" id=\"favorite_{{ game.id }}\" class=\"favorite fav unfave\"&gt;Remove as Favorite&lt;/a&gt;<br>        {% else %}<br>            &lt;a href=\"#\" id=\"favorite_{{ game.id }}\" class=\"favorite fav fave\"&gt;Add as Favorite&lt;/a&gt;<br>        {% endif %}<br>    {% else %}<br>        &lt;a href=\"{% url arcade_favorite_create game.id %}\" class=\"fav\" id=\"favorite_{{ game.id }}\" class=\"favorite\"&gt;Add as Favorite&lt;/a&gt;<br>    {% endif %}<br><br>In other words, based on whether the user is authenticated and based on whether<br>or not they have already favorited the game, we set some classes and urls and<br>messages on the links.<br><br>We also have a bit of JavaScript, that looks like this:<br><br>..sourcecode:: javascript<br><br>    var add_favorite_handlers = function(base_create, base_delete) {<br>        $('a.favorite.fave').live('click', function(e) {<br>            var pk = $(this).attr('id').replace('favorite_', '');<br>            var url = base_create + pk + '/';<br>            $.getJSON(url, function(data, textStatus) {<br>                $('#favorite_' + pk).removeClass('fave').addClass('unfave').text('Remove as Favorite');<br>            });<br>            return false;<br>        });<br>        $('a.favorite.unfave').live('click', function(e) {<br>            var pk = $(this).attr('id').replace('favorite_', '');<br>            var url = base_delete + pk + '/';<br>            $.getJSON(url, function(data, textStatus) {<br>                $('#favorite_' + pk).removeClass('unfave').addClass('fave').text('Add as Favorite');<br>            });<br>            return false;<br>        });<br>    };<br><br>I'm not going to go into too much detail about this JavaScript code, except to<br>say that it takes the base URL for the create and the delete pages, and turns<br>links with certain classes into AJAX calls into the create and delete views.<br><br>Finally, at the bottom of the page, we initialize this JavaScript like so:<br><br>.. sourcecode:: html<br><br>    &lt;script type=\"text/javascript\"&gt;<br>    $(function() {<br>        add_favorite_handlers('/games/favorites/create/', '/games/favorites/delete/');<br>    });<br>    &lt;/script&gt;<br><br>And with that, we're done!  Not too bad, huh?  You can browse around `Radisox`<br>and play a game to see it in action.  Look up at the top right of any game<br>page to see the favorite/un-favorite button.<br><br>.. _`Radiosox`: http://radiosox.com/\n          </div>"}, "last_serial": 122991, "releases": {"0.1": []}, "urls": [], "timestamp": "Fri May  8 00:37:07 2020"}