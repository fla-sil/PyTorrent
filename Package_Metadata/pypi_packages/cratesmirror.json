{"info": {"author": "Knight", "author_email": "anonymousknight96@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Environment :: Console", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5"], "description": "CratesMirror\n============\n\n.. image:: https://img.shields.io/pypi/v/cratesmirror.svg\n    :target: https://pypi.python.org/pypi/cratesmirror\n\nAbout\n=====\n\nDownload all crates on `crates.io <https://crates.io>`__\n\nRequirement\n============\n\n- Python >= 2.7.9\n-  `requests <https://pypi.python.org/pypi/requests/>`__\n-  `GitPython <https://pypi.python.org/pypi/GitPython/>`__\n- At least 4G free disk space for hosting local crates\n\nInstallation\n============\n\n::\n\n    # pip install cratesmirror\n\nUsage\n======\n\n.. code-block:: bash\n\n    $ cratesmirror -h\n\n    usage: cratesmirror [-h] [-i INDEX] [-w CRATES] [-d DBPATH] [-f LOGFILE]\n                        [-c CHECKDB] [-v]\n\n    optional arguments:\n      -h, --help            show this help message and exit\n      -i, --index INDEX     registry index directory (default: /srv/git/index)\n      -w, --crates CRATES   crates directory (default: /srv/www/crates)\n      -d, --dbpath DBPATH   database file path (default: None)\n      -f, --logfile LOGFILE\n                            log file path (default: None)\n      -c, --checkdb CHECKDB\n                            check database for missing crates (default: False)\n      -v, --verbose\n\n    Available environment variables: HTTP_PROXY, HTTPS_PROXY, CRATES_DL, CRATES_API\n\n\n    Examples:\n    # Download all crates only\n    $ cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n    # Find out missing crates, then update the repository\n    $ cratesmirror --checkdb -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n    # Update repo and commit custom settings\n    $ CRATES_DL='https://crates.mirrors.ustc.edu.cn/api/v1/crates' \\\n          cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n    # Using proxy\n    $ HTTPS_PROXY='https://127.0.0.1:8081' \\\n          cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n\nOr use it in script\n\n.. code-block:: python\n\n    from cratesmirror import CratesMirror\n\n    indexdir = '/srv/git/index'\n    cratesdir = '/srv/www/crates'\n    config = {'dl': 'https://crates.mirrors.ustc.edu.cn/api/v1/crates',\n              'api': 'https://crates.io'}\n    # By default, it will be saved at os.getcwd()/crates.db\n    dbpath = '/var/lib/cratesmirror/crates.db'\n\n    with CratesMirror(indexdir, cratesdir, config=config, dbpath=dbpath) as mirror:\n        mirror.update_repo()\n\n    # with proxy\n    proxies = {\n      \"http\": \"http://10.10.1.10:3128\",\n      \"https\": \"http://10.10.1.10:1080\",\n    }\n    with CratesMirror(indexdir, cratesdir, config=config, proxy=proxies, dbpath=dbpath) as mirror:\n        mirror.update_repo()\n\nNote\n======\n\n- By default, the script will:\n    - assume that registry index directory is located at :code:`/srv/git/index`, and crates are saved at :code:`/srv/www/crates`\n    - save downloaded crate as :code:`<CratesDir>/{name}/{name}-{version}.crate`\n    - save the database file at :code:`os.getcwd()/crates.db`\n- If the environment variable :code:`CRATES_DL` or :code:`CRATES_API` is set, its value will be saved at :code:`<IndexDir>/config.json` and the changes will be committed automatically.\n- After the first run, all you need to do is to run this script periodically using crontab-like tools or systemd.timers to sync with upstream.\n\n\n.. :changelog:\n\nChangeLog\n---------------\n\n1.1.3\n+++++++++++\n\n**Bugfix**\n\n- Pick up all new crates in the modified index file, not only the latest\n\n1.1.2\n+++++++++++\n\n**Bugfix**\n\n- Replace None with default value in :code:`<RegistryDir>/config.json`\n\n1.1.1\n+++++++++++\n\n**Miscellaneous**\n\n- Add changelog\n\n1.1.0\n++++++++++++++++++\n\n**Improvement**\n\n- Always download crates using multithreading\n\n1.0.4\n++++++++++++++++++\n\n**Feature**\n\n- Add -c/--checkdb option, enable users to check database for missing crates\n\n1.0.3\n++++++++++++++++++\n\n**Improvement**\n\n- When <CratesDir> is empty, download all crates in a multithreaded way\n\n1.0.2\n++++++++++++++++++\n\n- Naive crawler", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/ustclug/LUG-crates_mirror", "keywords": null, "license": "MIT", "maintainer": null, "maintainer_email": null, "name": "cratesmirror", "package_url": "https://pypi.org/project/cratesmirror/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/cratesmirror/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/ustclug/LUG-crates_mirror"}, "release_url": "https://pypi.org/project/cratesmirror/1.1.3/", "requires_dist": null, "requires_python": null, "summary": "Download all crates on https://crates.io", "version": "1.1.3", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"cratesmirror\">\n<h2>CratesMirror</h2>\n<a href=\"https://pypi.python.org/pypi/cratesmirror\" rel=\"nofollow\"><img alt=\"https://img.shields.io/pypi/v/cratesmirror.svg\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/32fe8d27faf84d65f1b2876c708a11869f890335/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6372617465736d6972726f722e737667\"></a>\n</div>\n<div id=\"about\">\n<h2>About</h2>\n<p>Download all crates on <a href=\"https://crates.io\" rel=\"nofollow\">crates.io</a></p>\n</div>\n<div id=\"requirement\">\n<h2>Requirement</h2>\n<ul>\n<li>Python &gt;= 2.7.9</li>\n<li><a href=\"https://pypi.python.org/pypi/requests/\" rel=\"nofollow\">requests</a></li>\n<li><a href=\"https://pypi.python.org/pypi/GitPython/\" rel=\"nofollow\">GitPython</a></li>\n<li>At least 4G free disk space for hosting local crates</li>\n</ul>\n</div>\n<div id=\"installation\">\n<h2>Installation</h2>\n<pre># pip install cratesmirror\n</pre>\n</div>\n<div id=\"usage\">\n<h2>Usage</h2>\n<pre>$ cratesmirror -h\n\nusage: cratesmirror <span class=\"o\">[</span>-h<span class=\"o\">]</span> <span class=\"o\">[</span>-i INDEX<span class=\"o\">]</span> <span class=\"o\">[</span>-w CRATES<span class=\"o\">]</span> <span class=\"o\">[</span>-d DBPATH<span class=\"o\">]</span> <span class=\"o\">[</span>-f LOGFILE<span class=\"o\">]</span>\n                    <span class=\"o\">[</span>-c CHECKDB<span class=\"o\">]</span> <span class=\"o\">[</span>-v<span class=\"o\">]</span>\n\noptional arguments:\n  -h, --help            show this <span class=\"nb\">help</span> message and <span class=\"nb\">exit</span>\n  -i, --index INDEX     registry index directory <span class=\"o\">(</span>default: /srv/git/index<span class=\"o\">)</span>\n  -w, --crates CRATES   crates directory <span class=\"o\">(</span>default: /srv/www/crates<span class=\"o\">)</span>\n  -d, --dbpath DBPATH   database file path <span class=\"o\">(</span>default: None<span class=\"o\">)</span>\n  -f, --logfile LOGFILE\n                        log file path <span class=\"o\">(</span>default: None<span class=\"o\">)</span>\n  -c, --checkdb CHECKDB\n                        check database <span class=\"k\">for</span> missing crates <span class=\"o\">(</span>default: False<span class=\"o\">)</span>\n  -v, --verbose\n\nAvailable environment variables: HTTP_PROXY, HTTPS_PROXY, CRATES_DL, CRATES_API\n\n\nExamples:\n<span class=\"c1\"># Download all crates only\n</span>$ cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n<span class=\"c1\"># Find out missing crates, then update the repository\n</span>$ cratesmirror --checkdb -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n<span class=\"c1\"># Update repo and commit custom settings\n</span>$ <span class=\"nv\">CRATES_DL</span><span class=\"o\">=</span><span class=\"s1\">'https://crates.mirrors.ustc.edu.cn/api/v1/crates'</span> <span class=\"se\">\\\n</span>      cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n\n<span class=\"c1\"># Using proxy\n</span>$ <span class=\"nv\">HTTPS_PROXY</span><span class=\"o\">=</span><span class=\"s1\">'https://127.0.0.1:8081'</span> <span class=\"se\">\\\n</span>      cratesmirror -d /var/lib/crates/crates.db -f /var/log/crates/debug.log\n</pre>\n<p>Or use it in script</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cratesmirror</span> <span class=\"kn\">import</span> <span class=\"n\">CratesMirror</span>\n\n<span class=\"n\">indexdir</span> <span class=\"o\">=</span> <span class=\"s1\">'/srv/git/index'</span>\n<span class=\"n\">cratesdir</span> <span class=\"o\">=</span> <span class=\"s1\">'/srv/www/crates'</span>\n<span class=\"n\">config</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'dl'</span><span class=\"p\">:</span> <span class=\"s1\">'https://crates.mirrors.ustc.edu.cn/api/v1/crates'</span><span class=\"p\">,</span>\n          <span class=\"s1\">'api'</span><span class=\"p\">:</span> <span class=\"s1\">'https://crates.io'</span><span class=\"p\">}</span>\n<span class=\"c1\"># By default, it will be saved at os.getcwd()/crates.db</span>\n<span class=\"n\">dbpath</span> <span class=\"o\">=</span> <span class=\"s1\">'/var/lib/cratesmirror/crates.db'</span>\n\n<span class=\"k\">with</span> <span class=\"n\">CratesMirror</span><span class=\"p\">(</span><span class=\"n\">indexdir</span><span class=\"p\">,</span> <span class=\"n\">cratesdir</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">=</span><span class=\"n\">config</span><span class=\"p\">,</span> <span class=\"n\">dbpath</span><span class=\"o\">=</span><span class=\"n\">dbpath</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">mirror</span><span class=\"p\">:</span>\n    <span class=\"n\">mirror</span><span class=\"o\">.</span><span class=\"n\">update_repo</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># with proxy</span>\n<span class=\"n\">proxies</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"s2\">\"http\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://10.10.1.10:3128\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"https\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://10.10.1.10:1080\"</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n<span class=\"k\">with</span> <span class=\"n\">CratesMirror</span><span class=\"p\">(</span><span class=\"n\">indexdir</span><span class=\"p\">,</span> <span class=\"n\">cratesdir</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">=</span><span class=\"n\">config</span><span class=\"p\">,</span> <span class=\"n\">proxy</span><span class=\"o\">=</span><span class=\"n\">proxies</span><span class=\"p\">,</span> <span class=\"n\">dbpath</span><span class=\"o\">=</span><span class=\"n\">dbpath</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">mirror</span><span class=\"p\">:</span>\n    <span class=\"n\">mirror</span><span class=\"o\">.</span><span class=\"n\">update_repo</span><span class=\"p\">()</span>\n</pre>\n</div>\n<div id=\"note\">\n<h2>Note</h2>\n<ul>\n<li><dl>\n<dt>By default, the script will:</dt>\n<dd><ul>\n<li>assume that registry index directory is located at <code>/srv/git/index</code>, and crates are saved at <code>/srv/www/crates</code></li>\n<li>save downloaded crate as <code>&lt;CratesDir&gt;/{name}/{name}-{version}.crate</code></li>\n<li>save the database file at <code>os.getcwd()/crates.db</code></li>\n</ul>\n</dd>\n</dl>\n</li>\n<li>If the environment variable <code>CRATES_DL</code> or <code>CRATES_API</code> is set, its value will be saved at <code>&lt;IndexDir&gt;/config.json</code> and the changes will be committed automatically.</li>\n<li>After the first run, all you need to do is to run this script periodically using crontab-like tools or systemd.timers to sync with upstream.</li>\n</ul>\n<div id=\"changelog\">\n<h3>ChangeLog</h3>\n<div id=\"id1\">\n<h4>1.1.3</h4>\n<p><strong>Bugfix</strong></p>\n<ul>\n<li>Pick up all new crates in the modified index file, not only the latest</li>\n</ul>\n</div>\n<div id=\"id2\">\n<h4>1.1.2</h4>\n<p><strong>Bugfix</strong></p>\n<ul>\n<li>Replace None with default value in <code>&lt;RegistryDir&gt;/config.json</code></li>\n</ul>\n</div>\n<div id=\"id3\">\n<h4>1.1.1</h4>\n<p><strong>Miscellaneous</strong></p>\n<ul>\n<li>Add changelog</li>\n</ul>\n</div>\n<div id=\"id4\">\n<h4>1.1.0</h4>\n<p><strong>Improvement</strong></p>\n<ul>\n<li>Always download crates using multithreading</li>\n</ul>\n</div>\n<div id=\"id5\">\n<h4>1.0.4</h4>\n<p><strong>Feature</strong></p>\n<ul>\n<li>Add -c/\u2013checkdb option, enable users to check database for missing crates</li>\n</ul>\n</div>\n<div id=\"id6\">\n<h4>1.0.3</h4>\n<p><strong>Improvement</strong></p>\n<ul>\n<li>When &lt;CratesDir&gt; is empty, download all crates in a multithreaded way</li>\n</ul>\n</div>\n<div id=\"id7\">\n<h4>1.0.2</h4>\n<ul>\n<li>Naive crawler</li>\n</ul>\n</div>\n</div>\n</div>\n\n          </div>"}, "last_serial": 2063357, "releases": {"1.0.2": [{"comment_text": "", "digests": {"md5": "1c7c03315c5d93819ddb6e5aa4038df9", "sha256": "84ae2fe35f4c0dde5f3f11c4b186931597fc88922e5c9bffd481686d1bf9f42c"}, "downloads": -1, "filename": "cratesmirror-1.0.2.tar.gz", "has_sig": false, "md5_digest": "1c7c03315c5d93819ddb6e5aa4038df9", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7652, "upload_time": "2016-01-23T15:17:54", "upload_time_iso_8601": "2016-01-23T15:17:54.870436Z", "url": "https://files.pythonhosted.org/packages/27/71/9007b6812276be60d2f083562ad26d800c8dabc430032c697db97de6af3c/cratesmirror-1.0.2.tar.gz", "yanked": false}], "1.0.3": [{"comment_text": "", "digests": {"md5": "7abb6d42aac1d4c3fafbf5d3063cd427", "sha256": "ceb8f260d55a4d21c70059231c4dba1c2491560effd17fa40e3c81971f4dfa11"}, "downloads": -1, "filename": "cratesmirror-1.0.3.tar.gz", "has_sig": false, "md5_digest": "7abb6d42aac1d4c3fafbf5d3063cd427", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7599, "upload_time": "2016-01-23T15:44:07", "upload_time_iso_8601": "2016-01-23T15:44:07.987744Z", "url": "https://files.pythonhosted.org/packages/31/be/1a6497b6b2ee7d511deefd041f1bd4f1ffc0d3335a03d286ef952aaf1590/cratesmirror-1.0.3.tar.gz", "yanked": false}], "1.0.4": [{"comment_text": "", "digests": {"md5": "b4b0a09caf131b484d4665e7277fb5a6", "sha256": "b35ea2512558d6f7a16997b2ec455dfcce1b2330576fffa486c968ea5d6a427f"}, "downloads": -1, "filename": "cratesmirror-1.0.4.tar.gz", "has_sig": false, "md5_digest": "b4b0a09caf131b484d4665e7277fb5a6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 8390, "upload_time": "2016-03-28T04:27:44", "upload_time_iso_8601": "2016-03-28T04:27:44.274410Z", "url": "https://files.pythonhosted.org/packages/62/fc/9ef8a79f1726194bcfa2483fbe24688f8a91309c5d35789f562b5638bf7c/cratesmirror-1.0.4.tar.gz", "yanked": false}], "1.1.0": [{"comment_text": "", "digests": {"md5": "c3bc0cc23d217ee73510b4abfc07dcef", "sha256": "5e4c525aac0ce2f9214e8f03648b1526ab1eee5bce081b4222a7c837d88353e2"}, "downloads": -1, "filename": "cratesmirror-1.1.0.tar.gz", "has_sig": false, "md5_digest": "c3bc0cc23d217ee73510b4abfc07dcef", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 10443, "upload_time": "2016-04-03T01:40:43", "upload_time_iso_8601": "2016-04-03T01:40:43.414624Z", "url": "https://files.pythonhosted.org/packages/6c/bc/2b719c888414a513e89081cf675aba8890d31001b72be62ab19b40f8d936/cratesmirror-1.1.0.tar.gz", "yanked": false}], "1.1.1": [{"comment_text": "", "digests": {"md5": "f9945d194d38e7ce53dcd4865cb25f6f", "sha256": "6b7c80860b75b1065354c39662d2fd8eb9a8a4379dc756cad09a8339fdc17252"}, "downloads": -1, "filename": "cratesmirror-1.1.1.tar.gz", "has_sig": false, "md5_digest": "f9945d194d38e7ce53dcd4865cb25f6f", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11066, "upload_time": "2016-04-03T06:13:14", "upload_time_iso_8601": "2016-04-03T06:13:14.549067Z", "url": "https://files.pythonhosted.org/packages/59/22/f55786dcdcc29a8069e3e12abf9865a047587c94d7a9edd0516a74a9f172/cratesmirror-1.1.1.tar.gz", "yanked": false}], "1.1.2": [{"comment_text": "", "digests": {"md5": "8b48c901f51782f143fd10c54cb39c6f", "sha256": "b206e2cf3e8bc9797c65304a4b5a2a6c7d8fa133ea62db342a688e2a19c438de"}, "downloads": -1, "filename": "cratesmirror-1.1.2.tar.gz", "has_sig": false, "md5_digest": "8b48c901f51782f143fd10c54cb39c6f", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11160, "upload_time": "2016-04-03T10:32:39", "upload_time_iso_8601": "2016-04-03T10:32:39.562810Z", "url": "https://files.pythonhosted.org/packages/bf/a2/a7ef9deb528d6e9c41a4118c4e5840214c252a4dee268bb752d95bd91a1f/cratesmirror-1.1.2.tar.gz", "yanked": false}], "1.1.3": [{"comment_text": "", "digests": {"md5": "ceb8c11b4021e25ced0c581500642ea2", "sha256": "a7afe8fba0c13d1cc9fb93fa0da9e50d8feda3337709b6337ce640e8ae4d780b"}, "downloads": -1, "filename": "cratesmirror-1.1.3.tar.gz", "has_sig": false, "md5_digest": "ceb8c11b4021e25ced0c581500642ea2", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11379, "upload_time": "2016-04-14T08:49:22", "upload_time_iso_8601": "2016-04-14T08:49:22.911494Z", "url": "https://files.pythonhosted.org/packages/ca/09/3f196abf4f7fa54bb6e0c3beaa2081cf0dbbb4708f94f54fd3edd361c091/cratesmirror-1.1.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "ceb8c11b4021e25ced0c581500642ea2", "sha256": "a7afe8fba0c13d1cc9fb93fa0da9e50d8feda3337709b6337ce640e8ae4d780b"}, "downloads": -1, "filename": "cratesmirror-1.1.3.tar.gz", "has_sig": false, "md5_digest": "ceb8c11b4021e25ced0c581500642ea2", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 11379, "upload_time": "2016-04-14T08:49:22", "upload_time_iso_8601": "2016-04-14T08:49:22.911494Z", "url": "https://files.pythonhosted.org/packages/ca/09/3f196abf4f7fa54bb6e0c3beaa2081cf0dbbb4708f94f54fd3edd361c091/cratesmirror-1.1.3.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:42:27 2020"}