{"info": {"author": "Tom Christie", "author_email": "tom@tomchristie.com", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Environment :: Web Environment", "Intended Audience :: Developers", "License :: OSI Approved :: BSD License", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Internet :: WWW/HTTP"], "description": "# Broadcaster\n\nBroadcaster helps you develop realtime streaming functionality in by providing\na simple broadcast API onto a number of different backend services.\n\nIt currently supports [Redis PUB/SUB](https://redis.io/topics/pubsub), [Apache Kafka](https://kafka.apache.org/), and [Postgres LISTEN/NOTIFY](https://www.postgresql.org/docs/current/sql-notify.html), plus a simple in-memory backend, that you can use for local development or during testing.\n\n<img src=\"https://raw.githubusercontent.com/encode/broadcaster/master/docs/demo.gif\" alt='WebSockets Demo'>\n\nHere's a complete example of the backend code for a simple websocket chat app:\n\n**app.py**\n\n```python\n# Requires: `starlette`, `uvicorn`, `jinja2`\n# Run with `uvicorn example:app`\nfrom broadcaster import Broadcast\nfrom starlette.applications import Starlette\nfrom starlette.concurrency import run_until_first_complete\nfrom starlette.routing import Route, WebSocketRoute\nfrom starlette.templating import Jinja2Templates\n\n\nbroadcast = Broadcast(\"redis://localhost:6379\")\ntemplates = Jinja2Templates(\"templates\")\n\n\nasync def homepage(request):\n    template = \"index.html\"\n    context = {\"request\": request}\n    return templates.TemplateResponse(template, context)\n\n\nasync def chatroom_ws(websocket):\n    await websocket.accept()\n    await run_until_first_complete(\n        (chatroom_ws_receiver, {\"websocket\": websocket}),\n        (chatroom_ws_sender, {\"websocket\": websocket}),\n    )\n\n\nasync def chatroom_ws_receiver(websocket):\n    async for message in websocket.iter_text():\n        await broadcast.publish(channel=\"chatroom\", message=message)\n\n\nasync def chatroom_ws_sender(websocket):\n    async with broadcast.subscribe(channel=\"chatroom\") as subscriber:\n        async for event in subscriber:\n            await websocket.send_text(event.message)\n\n\nroutes = [\n    Route(\"/\", homepage),\n    WebSocketRoute(\"/\", chatroom_ws, name='chatroom_ws'),\n]\n\n\napp = Starlette(\n    routes=routes, on_startup=[broadcast.connect], on_shutdown=[broadcast.disconnect],\n)\n```\n\nThe HTML template for the front end [is available here](https://github.com/encode/broadcaster/blob/master/templates/index.html), and is adapted from [Pieter Noordhuis's PUB/SUB demo](https://gist.github.com/pietern/348262).\n\n\n## Installation\n\n* `pip install broadcaster`\n* `pip install broadcaster[redis]`\n* `pip install broadcaster[postgres]`\n* `pip install broadcaster[kafka]`\n\n## Available backends\n\n* `Broadcast('memory://')`\n* `Broadcast(\"redis://localhost:6379\")`\n* `Broadcast(\"postgres://localhost:5432/hostedapi\")`\n* `Broadcast(\"kafka://localhost:9092\")`\n\n## Where next?\n\nAt the moment `broadcaster` is in Alpha, and should be considered a working design document.\n\nThe API should be considered subject to change. If you *do* want to use Broadcaster in its current\nstate, make sure to strictly pin your requirements to `broadcaster==0.2.0`.\n\nTo be more capable we'd really want to add some additional backends, provide API support for reading recent event history from persistent stores, and provide a serialization/deserialization API...\n\n* Serialization / deserialization to support broadcasting structured data.\n* Backends for Redis Streams, Apache Kafka, and RabbitMQ.\n* Add support for `subscribe('chatroom', history=100)` for backends which provide persistence. (Redis Streams, Apache Kafka) This will allow applications to subscribe to channel updates, while also being given an initial window onto the most recent events. We *might* also want to support some basic paging operations, to allow applications to scan back in the event history.\n* Support for pattern subscribes in backends that support it.\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/encode/broadcaster", "keywords": "", "license": "BSD", "maintainer": "", "maintainer_email": "", "name": "broadcaster", "package_url": "https://pypi.org/project/broadcaster/", "platform": "", "project_url": "https://pypi.org/project/broadcaster/", "project_urls": {"Homepage": "https://github.com/encode/broadcaster"}, "release_url": "https://pypi.org/project/broadcaster/0.2.0/", "requires_dist": ["aiokafka ; extra == 'kafka'", "asyncpg ; extra == 'postgres'", "asyncio-redis ; extra == 'redis'"], "requires_python": ">=3.7", "summary": "Simple broadcast channels.", "version": "0.2.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Broadcaster</h1>\n<p>Broadcaster helps you develop realtime streaming functionality in by providing\na simple broadcast API onto a number of different backend services.</p>\n<p>It currently supports <a href=\"https://redis.io/topics/pubsub\" rel=\"nofollow\">Redis PUB/SUB</a>, <a href=\"https://kafka.apache.org/\" rel=\"nofollow\">Apache Kafka</a>, and <a href=\"https://www.postgresql.org/docs/current/sql-notify.html\" rel=\"nofollow\">Postgres LISTEN/NOTIFY</a>, plus a simple in-memory backend, that you can use for local development or during testing.</p>\n<img alt=\"WebSockets Demo\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/5e86722b302326df7c5a9dd51f0e8b9709a0fdc7/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f656e636f64652f62726f61646361737465722f6d61737465722f646f63732f64656d6f2e676966\">\n<p>Here's a complete example of the backend code for a simple websocket chat app:</p>\n<p><strong>app.py</strong></p>\n<pre><span class=\"c1\"># Requires: `starlette`, `uvicorn`, `jinja2`</span>\n<span class=\"c1\"># Run with `uvicorn example:app`</span>\n<span class=\"kn\">from</span> <span class=\"nn\">broadcaster</span> <span class=\"kn\">import</span> <span class=\"n\">Broadcast</span>\n<span class=\"kn\">from</span> <span class=\"nn\">starlette.applications</span> <span class=\"kn\">import</span> <span class=\"n\">Starlette</span>\n<span class=\"kn\">from</span> <span class=\"nn\">starlette.concurrency</span> <span class=\"kn\">import</span> <span class=\"n\">run_until_first_complete</span>\n<span class=\"kn\">from</span> <span class=\"nn\">starlette.routing</span> <span class=\"kn\">import</span> <span class=\"n\">Route</span><span class=\"p\">,</span> <span class=\"n\">WebSocketRoute</span>\n<span class=\"kn\">from</span> <span class=\"nn\">starlette.templating</span> <span class=\"kn\">import</span> <span class=\"n\">Jinja2Templates</span>\n\n\n<span class=\"n\">broadcast</span> <span class=\"o\">=</span> <span class=\"n\">Broadcast</span><span class=\"p\">(</span><span class=\"s2\">\"redis://localhost:6379\"</span><span class=\"p\">)</span>\n<span class=\"n\">templates</span> <span class=\"o\">=</span> <span class=\"n\">Jinja2Templates</span><span class=\"p\">(</span><span class=\"s2\">\"templates\"</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">async</span> <span class=\"k\">def</span> <span class=\"nf\">homepage</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"n\">template</span> <span class=\"o\">=</span> <span class=\"s2\">\"index.html\"</span>\n    <span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s2\">\"request\"</span><span class=\"p\">:</span> <span class=\"n\">request</span><span class=\"p\">}</span>\n    <span class=\"k\">return</span> <span class=\"n\">templates</span><span class=\"o\">.</span><span class=\"n\">TemplateResponse</span><span class=\"p\">(</span><span class=\"n\">template</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">async</span> <span class=\"k\">def</span> <span class=\"nf\">chatroom_ws</span><span class=\"p\">(</span><span class=\"n\">websocket</span><span class=\"p\">):</span>\n    <span class=\"k\">await</span> <span class=\"n\">websocket</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n    <span class=\"k\">await</span> <span class=\"n\">run_until_first_complete</span><span class=\"p\">(</span>\n        <span class=\"p\">(</span><span class=\"n\">chatroom_ws_receiver</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"s2\">\"websocket\"</span><span class=\"p\">:</span> <span class=\"n\">websocket</span><span class=\"p\">}),</span>\n        <span class=\"p\">(</span><span class=\"n\">chatroom_ws_sender</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"s2\">\"websocket\"</span><span class=\"p\">:</span> <span class=\"n\">websocket</span><span class=\"p\">}),</span>\n    <span class=\"p\">)</span>\n\n\n<span class=\"k\">async</span> <span class=\"k\">def</span> <span class=\"nf\">chatroom_ws_receiver</span><span class=\"p\">(</span><span class=\"n\">websocket</span><span class=\"p\">):</span>\n    <span class=\"k\">async</span> <span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"ow\">in</span> <span class=\"n\">websocket</span><span class=\"o\">.</span><span class=\"n\">iter_text</span><span class=\"p\">():</span>\n        <span class=\"k\">await</span> <span class=\"n\">broadcast</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">(</span><span class=\"n\">channel</span><span class=\"o\">=</span><span class=\"s2\">\"chatroom\"</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">async</span> <span class=\"k\">def</span> <span class=\"nf\">chatroom_ws_sender</span><span class=\"p\">(</span><span class=\"n\">websocket</span><span class=\"p\">):</span>\n    <span class=\"k\">async</span> <span class=\"k\">with</span> <span class=\"n\">broadcast</span><span class=\"o\">.</span><span class=\"n\">subscribe</span><span class=\"p\">(</span><span class=\"n\">channel</span><span class=\"o\">=</span><span class=\"s2\">\"chatroom\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">subscriber</span><span class=\"p\">:</span>\n        <span class=\"k\">async</span> <span class=\"k\">for</span> <span class=\"n\">event</span> <span class=\"ow\">in</span> <span class=\"n\">subscriber</span><span class=\"p\">:</span>\n            <span class=\"k\">await</span> <span class=\"n\">websocket</span><span class=\"o\">.</span><span class=\"n\">send_text</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">routes</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">Route</span><span class=\"p\">(</span><span class=\"s2\">\"/\"</span><span class=\"p\">,</span> <span class=\"n\">homepage</span><span class=\"p\">),</span>\n    <span class=\"n\">WebSocketRoute</span><span class=\"p\">(</span><span class=\"s2\">\"/\"</span><span class=\"p\">,</span> <span class=\"n\">chatroom_ws</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'chatroom_ws'</span><span class=\"p\">),</span>\n<span class=\"p\">]</span>\n\n\n<span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">Starlette</span><span class=\"p\">(</span>\n    <span class=\"n\">routes</span><span class=\"o\">=</span><span class=\"n\">routes</span><span class=\"p\">,</span> <span class=\"n\">on_startup</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">broadcast</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">],</span> <span class=\"n\">on_shutdown</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">broadcast</span><span class=\"o\">.</span><span class=\"n\">disconnect</span><span class=\"p\">],</span>\n<span class=\"p\">)</span>\n</pre>\n<p>The HTML template for the front end <a href=\"https://github.com/encode/broadcaster/blob/master/templates/index.html\" rel=\"nofollow\">is available here</a>, and is adapted from <a href=\"https://gist.github.com/pietern/348262\" rel=\"nofollow\">Pieter Noordhuis's PUB/SUB demo</a>.</p>\n<h2>Installation</h2>\n<ul>\n<li><code>pip install broadcaster</code></li>\n<li><code>pip install broadcaster[redis]</code></li>\n<li><code>pip install broadcaster[postgres]</code></li>\n<li><code>pip install broadcaster[kafka]</code></li>\n</ul>\n<h2>Available backends</h2>\n<ul>\n<li><code>Broadcast('memory://')</code></li>\n<li><code>Broadcast(\"redis://localhost:6379\")</code></li>\n<li><code>Broadcast(\"postgres://localhost:5432/hostedapi\")</code></li>\n<li><code>Broadcast(\"kafka://localhost:9092\")</code></li>\n</ul>\n<h2>Where next?</h2>\n<p>At the moment <code>broadcaster</code> is in Alpha, and should be considered a working design document.</p>\n<p>The API should be considered subject to change. If you <em>do</em> want to use Broadcaster in its current\nstate, make sure to strictly pin your requirements to <code>broadcaster==0.2.0</code>.</p>\n<p>To be more capable we'd really want to add some additional backends, provide API support for reading recent event history from persistent stores, and provide a serialization/deserialization API...</p>\n<ul>\n<li>Serialization / deserialization to support broadcasting structured data.</li>\n<li>Backends for Redis Streams, Apache Kafka, and RabbitMQ.</li>\n<li>Add support for <code>subscribe('chatroom', history=100)</code> for backends which provide persistence. (Redis Streams, Apache Kafka) This will allow applications to subscribe to channel updates, while also being given an initial window onto the most recent events. We <em>might</em> also want to support some basic paging operations, to allow applications to scan back in the event history.</li>\n<li>Support for pattern subscribes in backends that support it.</li>\n</ul>\n\n          </div>"}, "last_serial": 6703231, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "ea119d8f3032897d5d6c2ffdb03c268b", "sha256": "824fdbae50b1bf86ce3500c97ef6986060614a193013b85c0684309a0aa119eb"}, "downloads": -1, "filename": "broadcaster-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "ea119d8f3032897d5d6c2ffdb03c268b", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 5835, "upload_time": "2020-02-20T16:15:01", "upload_time_iso_8601": "2020-02-20T16:15:01.122538Z", "url": "https://files.pythonhosted.org/packages/d5/5f/a6a523059241a76144edbc370685e3783bd6e289dfd677813dab144244d2/broadcaster-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "2ba4b00bb28aac26bb62a436213f7078", "sha256": "301d2d573d335a10fc7d7c26245dbd5ef0039c1d7b8064c0480b6a510cc75b4d"}, "downloads": -1, "filename": "broadcaster-0.1.0.tar.gz", "has_sig": false, "md5_digest": "2ba4b00bb28aac26bb62a436213f7078", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 4430, "upload_time": "2020-02-20T16:15:03", "upload_time_iso_8601": "2020-02-20T16:15:03.720837Z", "url": "https://files.pythonhosted.org/packages/d2/49/381ad0f6df89d4ce49d861917b1fef3ca0141213ae5059997dca4d788a61/broadcaster-0.1.0.tar.gz", "yanked": false}], "0.2.0": [{"comment_text": "", "digests": {"md5": "197e9bc53f933d40f5051531ece524a8", "sha256": "50f93d1af7e9097a87ef3b2da269b4b4c5630ec080dc5c7f941ef314291937b1"}, "downloads": -1, "filename": "broadcaster-0.2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "197e9bc53f933d40f5051531ece524a8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 6996, "upload_time": "2020-02-26T12:24:35", "upload_time_iso_8601": "2020-02-26T12:24:35.696139Z", "url": "https://files.pythonhosted.org/packages/a8/28/500ebd98ca2cc8f70626bb3521fc3afed88c0d0c8a739630ccb5ec7ca472/broadcaster-0.2.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "acd5c174716cac7a26f3685ed1df86bd", "sha256": "72056f9b77b091dd4bbad4d7484bd0e6835c3443d4564d0bbf41190c29c606c6"}, "downloads": -1, "filename": "broadcaster-0.2.0.tar.gz", "has_sig": false, "md5_digest": "acd5c174716cac7a26f3685ed1df86bd", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 5297, "upload_time": "2020-02-26T12:24:37", "upload_time_iso_8601": "2020-02-26T12:24:37.344399Z", "url": "https://files.pythonhosted.org/packages/ca/8b/eb664eeae1187c9943ccb7cbfec0883b15a18db04b6028a748505581ca72/broadcaster-0.2.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "197e9bc53f933d40f5051531ece524a8", "sha256": "50f93d1af7e9097a87ef3b2da269b4b4c5630ec080dc5c7f941ef314291937b1"}, "downloads": -1, "filename": "broadcaster-0.2.0-py3-none-any.whl", "has_sig": false, "md5_digest": "197e9bc53f933d40f5051531ece524a8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 6996, "upload_time": "2020-02-26T12:24:35", "upload_time_iso_8601": "2020-02-26T12:24:35.696139Z", "url": "https://files.pythonhosted.org/packages/a8/28/500ebd98ca2cc8f70626bb3521fc3afed88c0d0c8a739630ccb5ec7ca472/broadcaster-0.2.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "acd5c174716cac7a26f3685ed1df86bd", "sha256": "72056f9b77b091dd4bbad4d7484bd0e6835c3443d4564d0bbf41190c29c606c6"}, "downloads": -1, "filename": "broadcaster-0.2.0.tar.gz", "has_sig": false, "md5_digest": "acd5c174716cac7a26f3685ed1df86bd", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 5297, "upload_time": "2020-02-26T12:24:37", "upload_time_iso_8601": "2020-02-26T12:24:37.344399Z", "url": "https://files.pythonhosted.org/packages/ca/8b/eb664eeae1187c9943ccb7cbfec0883b15a18db04b6028a748505581ca72/broadcaster-0.2.0.tar.gz", "yanked": false}], "timestamp": "Thu May  7 22:36:17 2020"}