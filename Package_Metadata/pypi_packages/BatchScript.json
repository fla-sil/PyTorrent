{"info": {"author": "TaylorHere", "author_email": "taylorherelee@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3"], "description": "BatchScript\n\n\u4f7f\u7528\u591a\u8fdb\u7a0b+\u7ebf\u7a0b\u6c60+\u961f\u5217\u8fd0\u884c\u4f60\u7684\u65b9\u6cd5\n\n~~~python\nfrom master import Master\nfrom worker import Worker\nimport helper \nimport os\n\nclass Config():\n\n\tMaxWorkerSize = os.cpu_count() - 1  #worker\u6570\u91cf\n\n\tMaxThreadPoolSize = 1024  #\u6bcf\u4e2aworker\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f\n\n\tThreadQueueWaitTimeout = 0.01  #worker\u5728job\u961f\u5217\u4e0a\u83b7\u53d6\u6570\u636e\u7684\u8d85\u65f6, \u8d85\u65f6\u540e\u4f1a\u7acb\u5373\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4\n\n\tWorkerGetBatchSize = MaxThreadPoolSize  #\u989d\u5b9a\u6279\u5927\u5c0f, \u5982\u679cworker\u83b7\u53d6\u6570\u636e\u65f6\u4e0d\u8d85\u65f6, \u90a3\u4e48\u5728\u83b7\u53d6\u90fd\u8fd9\u4e2a\u6570\u91cf\u540e\u4fbf\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4\n\n\tJobsResultsQueueNum = MaxWorkerSize #jobs \u548c results \u961f\u5217\u5bf9\u7684\u6570\u91cf, \u8be5\u6570\u91cf\u5982\u679c\u5c0f\u4e8eworker\u6570\u91cf, \u5219\u6700\u540e\u4e00\u5bf9\u4f1a\u88ab\u672a\u5206\u914d\u7684worker\u5171\u7528, \u5171\u7528\u961f\u5217\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9501\u64cd\u4f5c\u589e\u52a0\n\n\tResultsBatch = True #\u5c06\u4e00\u4e2abatch\u7684\u6240\u6709result\u5f53\u4f5c\u4e00\u4e2aresult\u653e\u5165result \u961f\u5217\u4e2d\n\nmaster = Master(func=helper.sleep, config=Config())\nmaster.start()\nfor i in range(1000):\n    master.job_put(0.01)\n\nwhile True:\n    print(master.result().get())\n~~~\n\n\u94fe\u63a5\u591a\u4e2a master\n~~~python\nfrom master import Master\nfrom worker import Worker\nimport helper \n\nmaster = Master(func=helper.sleep)\nmaster.start()\n\nfor i in range(1000):\n    master.job_put(0.01)\n\nanother_master = Master(func=print, connection=master)#\u8be5master\u4f1a\u5c06connection\u7684master\u7684results\u961f\u5217\u4f5c\u4e3ajobs\u961f\u5217, \u5982\u679c\u8be5master\u7684\u961f\u5217\u5bf9\u6bd4\u94fe\u63a5master\u7684\u961f\u5217\u5bf9\u6570\u91cf\u5c11, \u4f1a\u9020\u6210\u94fe\u63a5master\u7684result\u4e0d\u80fd\u88ab\u5168\u90e8\u6d88\u8017\nanother_master.start()\n\n~~~\n\n\u91c7\u7528 \u591a\u8fdb\u7a0b\u542f\u52a8Worker, worker\u7ef4\u62a4\u7ebf\u7a0b\u6c60\u8fd0\u884c\u51fd\u6570\u7684\u65b9\u6848\nmaster\u5185\u5efa\u548cworker\u5173\u8054\u7684\u591a\u4e2a\u4efb\u52a1\u961f\u5217\u548c\u5bf9\u5e94\u7684\u591a\u4e2a\u7ed3\u679c\u961f\u5217\nworker\u6309batch\u4ece\u4efb\u52a1\u961f\u5217\u4e2d\u83b7\u53d6\u6570\u636e\u5e76\u4f7f\u7528\u7ebf\u7a0b\u6c60\u63d0\u4ea4\u8fd0\u884c\n\u6279\u91cf\u7ed3\u675f\u540e\u5c06\u4efb\u52a1\u7ed3\u679cput\u5230\u7ed3\u679c\u961f\u5217\n\n\u4f60\u53ef\u4ee5\u5728config\u4e2d\u8c03\u6574\n~~~python\nimport os\n\nMaxWorkerSize = os.cpu_count() - 1  #worker\u6570\u91cf\n\nMaxThreadPoolSize = 1024  #\u6bcf\u4e2aworker\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f\n\nThreadQueueWaitTimeout = 0.01  #worker\u5728job\u961f\u5217\u4e0a\u83b7\u53d6\u6570\u636e\u7684\u8d85\u65f6, \u8d85\u65f6\u540e\u4f1a\u7acb\u5373\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4\n\nWorkerGetBatchSize = MaxThreadPoolSize  #\u989d\u5b9a\u6279\u5927\u5c0f, \u5982\u679cworker\u83b7\u53d6\u6570\u636e\u65f6\u4e0d\u8d85\u65f6, \u90a3\u4e48\u5728\u83b7\u53d6\u90fd\u8fd9\u4e2a\u6570\u91cf\u540e\u4fbf\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4\n\nJobsResultsQueueNum = MaxWorkerSize #jobs \u548c results \u961f\u5217\u5bf9\u7684\u6570\u91cf, \u8be5\u6570\u91cf\u5982\u679c\u5c0f\u4e8eworker\u6570\u91cf, \u5219\u6700\u540e\u4e00\u5bf9\u4f1a\u88ab\u672a\u5206\u914d\u7684worker\u5171\u7528, \u5171\u7528\u961f\u5217\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9501\u64cd\u4f5c\u589e\u52a0\n\nResultsBatch = True #\u5c06\u4e00\u4e2abatch\u7684\u6240\u6709result\u5f53\u4f5c\u4e00\u4e2aresult\u653e\u5165result \u961f\u5217\u4e2d\n~~~", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/TaylorHere/BatchScript", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "BatchScript", "package_url": "https://pypi.org/project/BatchScript/", "platform": "", "project_url": "https://pypi.org/project/BatchScript/", "project_urls": {"Homepage": "https://github.com/TaylorHere/BatchScript"}, "release_url": "https://pypi.org/project/BatchScript/0.0.6/", "requires_dist": null, "requires_python": "", "summary": "Python Master-Queue-Worker Structure multiple task framework", "version": "0.0.6", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p>BatchScript</p>\n<p>\u4f7f\u7528\u591a\u8fdb\u7a0b+\u7ebf\u7a0b\u6c60+\u961f\u5217\u8fd0\u884c\u4f60\u7684\u65b9\u6cd5</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">master</span> <span class=\"kn\">import</span> <span class=\"n\">Master</span>\n<span class=\"kn\">from</span> <span class=\"nn\">worker</span> <span class=\"kn\">import</span> <span class=\"n\">Worker</span>\n<span class=\"kn\">import</span> <span class=\"nn\">helper</span> \n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">Config</span><span class=\"p\">():</span>\n\n\t<span class=\"n\">MaxWorkerSize</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">cpu_count</span><span class=\"p\">()</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>  <span class=\"c1\">#worker\u6570\u91cf</span>\n\n\t<span class=\"n\">MaxThreadPoolSize</span> <span class=\"o\">=</span> <span class=\"mi\">1024</span>  <span class=\"c1\">#\u6bcf\u4e2aworker\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f</span>\n\n\t<span class=\"n\">ThreadQueueWaitTimeout</span> <span class=\"o\">=</span> <span class=\"mf\">0.01</span>  <span class=\"c1\">#worker\u5728job\u961f\u5217\u4e0a\u83b7\u53d6\u6570\u636e\u7684\u8d85\u65f6, \u8d85\u65f6\u540e\u4f1a\u7acb\u5373\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4</span>\n\n\t<span class=\"n\">WorkerGetBatchSize</span> <span class=\"o\">=</span> <span class=\"n\">MaxThreadPoolSize</span>  <span class=\"c1\">#\u989d\u5b9a\u6279\u5927\u5c0f, \u5982\u679cworker\u83b7\u53d6\u6570\u636e\u65f6\u4e0d\u8d85\u65f6, \u90a3\u4e48\u5728\u83b7\u53d6\u90fd\u8fd9\u4e2a\u6570\u91cf\u540e\u4fbf\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4</span>\n\n\t<span class=\"n\">JobsResultsQueueNum</span> <span class=\"o\">=</span> <span class=\"n\">MaxWorkerSize</span> <span class=\"c1\">#jobs \u548c results \u961f\u5217\u5bf9\u7684\u6570\u91cf, \u8be5\u6570\u91cf\u5982\u679c\u5c0f\u4e8eworker\u6570\u91cf, \u5219\u6700\u540e\u4e00\u5bf9\u4f1a\u88ab\u672a\u5206\u914d\u7684worker\u5171\u7528, \u5171\u7528\u961f\u5217\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9501\u64cd\u4f5c\u589e\u52a0</span>\n\n\t<span class=\"n\">ResultsBatch</span> <span class=\"o\">=</span> <span class=\"kc\">True</span> <span class=\"c1\">#\u5c06\u4e00\u4e2abatch\u7684\u6240\u6709result\u5f53\u4f5c\u4e00\u4e2aresult\u653e\u5165result \u961f\u5217\u4e2d</span>\n\n<span class=\"n\">master</span> <span class=\"o\">=</span> <span class=\"n\">Master</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"o\">=</span><span class=\"n\">helper</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">=</span><span class=\"n\">Config</span><span class=\"p\">())</span>\n<span class=\"n\">master</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1000</span><span class=\"p\">):</span>\n    <span class=\"n\">master</span><span class=\"o\">.</span><span class=\"n\">job_put</span><span class=\"p\">(</span><span class=\"mf\">0.01</span><span class=\"p\">)</span>\n\n<span class=\"k\">while</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">master</span><span class=\"o\">.</span><span class=\"n\">result</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">())</span>\n</pre>\n<p>\u94fe\u63a5\u591a\u4e2a master</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">master</span> <span class=\"kn\">import</span> <span class=\"n\">Master</span>\n<span class=\"kn\">from</span> <span class=\"nn\">worker</span> <span class=\"kn\">import</span> <span class=\"n\">Worker</span>\n<span class=\"kn\">import</span> <span class=\"nn\">helper</span> \n\n<span class=\"n\">master</span> <span class=\"o\">=</span> <span class=\"n\">Master</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"o\">=</span><span class=\"n\">helper</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">)</span>\n<span class=\"n\">master</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1000</span><span class=\"p\">):</span>\n    <span class=\"n\">master</span><span class=\"o\">.</span><span class=\"n\">job_put</span><span class=\"p\">(</span><span class=\"mf\">0.01</span><span class=\"p\">)</span>\n\n<span class=\"n\">another_master</span> <span class=\"o\">=</span> <span class=\"n\">Master</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"o\">=</span><span class=\"nb\">print</span><span class=\"p\">,</span> <span class=\"n\">connection</span><span class=\"o\">=</span><span class=\"n\">master</span><span class=\"p\">)</span><span class=\"c1\">#\u8be5master\u4f1a\u5c06connection\u7684master\u7684results\u961f\u5217\u4f5c\u4e3ajobs\u961f\u5217, \u5982\u679c\u8be5master\u7684\u961f\u5217\u5bf9\u6bd4\u94fe\u63a5master\u7684\u961f\u5217\u5bf9\u6570\u91cf\u5c11, \u4f1a\u9020\u6210\u94fe\u63a5master\u7684result\u4e0d\u80fd\u88ab\u5168\u90e8\u6d88\u8017</span>\n<span class=\"n\">another_master</span><span class=\"o\">.</span><span class=\"n\">start</span><span class=\"p\">()</span>\n</pre>\n<p>\u91c7\u7528 \u591a\u8fdb\u7a0b\u542f\u52a8Worker, worker\u7ef4\u62a4\u7ebf\u7a0b\u6c60\u8fd0\u884c\u51fd\u6570\u7684\u65b9\u6848\nmaster\u5185\u5efa\u548cworker\u5173\u8054\u7684\u591a\u4e2a\u4efb\u52a1\u961f\u5217\u548c\u5bf9\u5e94\u7684\u591a\u4e2a\u7ed3\u679c\u961f\u5217\nworker\u6309batch\u4ece\u4efb\u52a1\u961f\u5217\u4e2d\u83b7\u53d6\u6570\u636e\u5e76\u4f7f\u7528\u7ebf\u7a0b\u6c60\u63d0\u4ea4\u8fd0\u884c\n\u6279\u91cf\u7ed3\u675f\u540e\u5c06\u4efb\u52a1\u7ed3\u679cput\u5230\u7ed3\u679c\u961f\u5217</p>\n<p>\u4f60\u53ef\u4ee5\u5728config\u4e2d\u8c03\u6574</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">os</span>\n\n<span class=\"n\">MaxWorkerSize</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">cpu_count</span><span class=\"p\">()</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>  <span class=\"c1\">#worker\u6570\u91cf</span>\n\n<span class=\"n\">MaxThreadPoolSize</span> <span class=\"o\">=</span> <span class=\"mi\">1024</span>  <span class=\"c1\">#\u6bcf\u4e2aworker\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f</span>\n\n<span class=\"n\">ThreadQueueWaitTimeout</span> <span class=\"o\">=</span> <span class=\"mf\">0.01</span>  <span class=\"c1\">#worker\u5728job\u961f\u5217\u4e0a\u83b7\u53d6\u6570\u636e\u7684\u8d85\u65f6, \u8d85\u65f6\u540e\u4f1a\u7acb\u5373\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4</span>\n\n<span class=\"n\">WorkerGetBatchSize</span> <span class=\"o\">=</span> <span class=\"n\">MaxThreadPoolSize</span>  <span class=\"c1\">#\u989d\u5b9a\u6279\u5927\u5c0f, \u5982\u679cworker\u83b7\u53d6\u6570\u636e\u65f6\u4e0d\u8d85\u65f6, \u90a3\u4e48\u5728\u83b7\u53d6\u90fd\u8fd9\u4e2a\u6570\u91cf\u540e\u4fbf\u5f00\u59cb\u6279\u91cf\u7ebf\u7a0b\u63d0\u4ea4</span>\n\n<span class=\"n\">JobsResultsQueueNum</span> <span class=\"o\">=</span> <span class=\"n\">MaxWorkerSize</span> <span class=\"c1\">#jobs \u548c results \u961f\u5217\u5bf9\u7684\u6570\u91cf, \u8be5\u6570\u91cf\u5982\u679c\u5c0f\u4e8eworker\u6570\u91cf, \u5219\u6700\u540e\u4e00\u5bf9\u4f1a\u88ab\u672a\u5206\u914d\u7684worker\u5171\u7528, \u5171\u7528\u961f\u5217\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9501\u64cd\u4f5c\u589e\u52a0</span>\n\n<span class=\"n\">ResultsBatch</span> <span class=\"o\">=</span> <span class=\"kc\">True</span> <span class=\"c1\">#\u5c06\u4e00\u4e2abatch\u7684\u6240\u6709result\u5f53\u4f5c\u4e00\u4e2aresult\u653e\u5165result \u961f\u5217\u4e2d</span>\n</pre>\n\n          </div>"}, "last_serial": 6526978, "releases": {"0.0.2": [{"comment_text": "", "digests": {"md5": "b30c057b78479feef6f2750567169fe7", "sha256": "7b1707ea912c11045e079c329c7227ae1723ab2440e5338bd9ae7d98d1410250"}, "downloads": -1, "filename": "BatchScript-0.0.2.tar.gz", "has_sig": false, "md5_digest": "b30c057b78479feef6f2750567169fe7", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3692, "upload_time": "2020-01-26T10:20:39", "upload_time_iso_8601": "2020-01-26T10:20:39.992396Z", "url": "https://files.pythonhosted.org/packages/e6/4a/b82ab8bdf95b7882c57e20e3201595efac9c2bd0eb9e34628af1a0cc85ab/BatchScript-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "5336428e54f9515e8be7c29aece820df", "sha256": "e1044629069fe27fcea6107dc825d49644b019470998710bc41ddf58a1858ee2"}, "downloads": -1, "filename": "BatchScript-0.0.3.tar.gz", "has_sig": false, "md5_digest": "5336428e54f9515e8be7c29aece820df", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3759, "upload_time": "2020-01-26T13:22:56", "upload_time_iso_8601": "2020-01-26T13:22:56.748665Z", "url": "https://files.pythonhosted.org/packages/bf/82/40c27520faaad3771e185797eef272640c67b31a5e61574c9397ab90554f/BatchScript-0.0.3.tar.gz", "yanked": false}], "0.0.4": [{"comment_text": "", "digests": {"md5": "f9018fcf6e24fb1b2ca389c739e2b5f8", "sha256": "a377ecb8bf65ca36533c99a7fd4955b450fc09609cc9f7081e3717612498d5fb"}, "downloads": -1, "filename": "BatchScript-0.0.4.tar.gz", "has_sig": false, "md5_digest": "f9018fcf6e24fb1b2ca389c739e2b5f8", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3759, "upload_time": "2020-01-26T13:48:04", "upload_time_iso_8601": "2020-01-26T13:48:04.102461Z", "url": "https://files.pythonhosted.org/packages/b7/ac/cff3cf31241f7f44e9b142115d0d03723797b05e6d0551343cee5b8a3054/BatchScript-0.0.4.tar.gz", "yanked": false}], "0.0.5": [{"comment_text": "", "digests": {"md5": "b81ea745e744ce24a81c6aa1d489a0ff", "sha256": "62e52a8d25a1d379147689981251dbacf00d61b99d478e6e104b641bdc06854c"}, "downloads": -1, "filename": "BatchScript-0.0.5.tar.gz", "has_sig": false, "md5_digest": "b81ea745e744ce24a81c6aa1d489a0ff", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3903, "upload_time": "2020-01-26T16:37:57", "upload_time_iso_8601": "2020-01-26T16:37:57.489783Z", "url": "https://files.pythonhosted.org/packages/14/86/c1459c1fb1b4fbf6c7f6202559b1348be56624fff1999fbd376e90dd2c22/BatchScript-0.0.5.tar.gz", "yanked": false}], "0.0.6": [{"comment_text": "", "digests": {"md5": "aafed8b6dc09ea5fd133c21d0f1d1ff1", "sha256": "89cf1afd91fbda72bf4da1198ce4f29a45b01736cc74abeae3d75ca46a6f1396"}, "downloads": -1, "filename": "BatchScript-0.0.6.tar.gz", "has_sig": false, "md5_digest": "aafed8b6dc09ea5fd133c21d0f1d1ff1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3750, "upload_time": "2020-01-27T15:22:55", "upload_time_iso_8601": "2020-01-27T15:22:55.809742Z", "url": "https://files.pythonhosted.org/packages/6b/f6/4102c79fe8c6bbea6b4a7992a1611e01d70782ed861602811b65a5ed93fb/BatchScript-0.0.6.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "aafed8b6dc09ea5fd133c21d0f1d1ff1", "sha256": "89cf1afd91fbda72bf4da1198ce4f29a45b01736cc74abeae3d75ca46a6f1396"}, "downloads": -1, "filename": "BatchScript-0.0.6.tar.gz", "has_sig": false, "md5_digest": "aafed8b6dc09ea5fd133c21d0f1d1ff1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3750, "upload_time": "2020-01-27T15:22:55", "upload_time_iso_8601": "2020-01-27T15:22:55.809742Z", "url": "https://files.pythonhosted.org/packages/6b/f6/4102c79fe8c6bbea6b4a7992a1611e01d70782ed861602811b65a5ed93fb/BatchScript-0.0.6.tar.gz", "yanked": false}], "timestamp": "Thu May  7 18:14:44 2020"}