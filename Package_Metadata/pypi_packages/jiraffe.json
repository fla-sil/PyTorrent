{"info": {"author": "Piyush Raj <0x48piraj>", "author_email": "piyush@linuxmail.org", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: BSD License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2", "Programming Language :: Python :: 3"], "description": "# Jiraffe\n\n[![forthebadge](http://forthebadge.com/images/badges/built-with-love.svg)](http://forthebadge.com)\n[![forthebadge](http://forthebadge.com/images/badges/makes-people-smile.svg)](http://forthebadge.com)\n[![forthebadge](http://forthebadge.com/images/badges/powered-by-responsibility.svg)](http://forthebadge.com)\n\n<p align=\"center\">\n<b>Jiraffe - One stop place for exploiting all Jira instances in your proximity</b><br><br>\n<img alt=\"Jiraffe logo\" src=\"https://raw.githubusercontent.com/0x48piraj/Jiraffe/master/static/logo.png\" width=\"400\"><br>\nSee the <a href=\"#demo\">demo</a>\n</p>\n\n## Installation\n\nUse pip to install **Jiraffe**. This is the recommended way of running Jiraffe.\n\n```\n$ pip install jiraffe\n```\n\n#### Usage\n\n```\n$ py -m jiraffe\nusage: jiraffe [-h] [-t https://example-jira-instance.com]\n\n\n                                                                           /)/)\n                                                                          ( ..\\\n      ___  __      _______        __       _______   _______   _______    /'-._)\n     |\"  ||\" \\    /\"      \\      /\"\"\\     /\"     \"| /\"     \"| /\"     \"|  /#/\n     ||  |||  |  |:        |    /    \\   (: ______)(: ______)(: ______) /#/  @0x48piraj\n     |:  ||:  |  |_____/   )   /' /\\  \\   \\/    |   \\/    |   \\/    |\n  ___|  / |.  |   //      /   //  __'  \\  // ___)   // ___)   // ___)_\n /  :|_/ )/\\  |\\ |:  __   \\  /   /  \\\\  \\(:  (     (:  (     (:      \"|\n(_______/(__\\_|_)|__|  \\___)(___/    \\___)\\__/      \\__/      \\_______)\n\n\nOptions:\n  -t https://example-jira-instance.com, --target https://example-jira-instance.com\n                        Target Jira Instance URL\n  -v, --verbose         Verbose output\n  -a, --auto            Automatic mode\n\n```\n\n## Exploits for\n\n|  CVE  |  Impact  |  Description  |  Version Affected  |  Details  |\n|---|---|---|---|---|\n|  CVE-2017-9506  |  HIGH  |  The IconUriServlet of the Atlassian OAuth Plugin from version 1.3.0 before version 1.9.12 and from version 2.0.0 before version 2.0.4 allows remote attackers to access the content of internal network resources and/or perform an XSS attack via Server Side Request Forgery (SSRF).  |  Jira < 7.3.5  |  [CVE-2017-9506](https://lmgtfy.com/?q=CVE-2017-9506)  |\n|  CVE-2019-8449  |  LOW  |  The /rest/api/latest/groupuserpicker resource in Jira before version 8.4.0 allows remote attackers to enumerate usernames via an information disclosure vulnerability.  |  2.1 - 8.3.4  |  [CVE-2019-8449](https://lmgtfy.com/?q=CVE-2019-8449)  |\n|  CVE-2019-11581  |  CRITICAL  |  Atlassian JIRA Template injection vulnerability RCE  |  Jira < 7.6.14  |  [CVE-2019-11581](https://lmgtfy.com/?q=CVE-2019-11581)  |\n|  CVE-2019-8451  |  HIGH  |  Pre-authentication server side request forgery (SSRF) vulnerability found in the /plugins/servlet/gadgets/makeRequest resource.  |  Jira == 7.6.0  && Jira.7.6.0 < 7.13.9, 8.4.0  |  [CVE-2019-8451](https://lmgtfy.com/?q=CVE-2019-8451)  |\n\nMajority of the bugs stated above poses Server-Side Request Forgery (SSRF) vulnerability, where attacker can abuse a specific functionality on the server to read or update internal resources. The attacker can supply or a modify a URL which the code running on the server will read or submit data to, and by carefully selecting the URLs, the attacker may be able to read server configuration such as AWS metadata, connect to internal services like HTTP enabled databases or perform post requests towards internal services which are not intended to be exposed.\n\nCurrently, some of the common Amazon AWS credentials leak attacks are present with an additional **Custom Payload Option** for sending crafted payloads for any cloud platform (Amazon AWS, Google Cloud, etc.). For sending custom payloads, take help from [PayloadsAllTheThings &mdash; SSRF URL for Cloud Instances](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#ssrf-url-for-cloud-instances)\n\n##### URL Paths Jiraffe Currently Supports:\n```\nRoot Path: /latest/meta-data/{hostname,public-ipv4,...}\nUser Data : /latest/user-data\nAWS Credentials : /latest/meta-data/iam/security-credentials/\n```\n\nFeel free to implement more post exploitation modules for vendor specifc deployments.\n\n## Demo\n\n![Jiraffe Demo](https://raw.githubusercontent.com/0x48piraj/Jiraffe/master/static/demo.gif)\n\n## Internal Workings\n\n#### Reconnaissance &mdash; Jira version detection\n\nIf unauthenticated, one can access Confluence's landing page and retrieve version information from these places:\n\n- Login page footer.\n\n![](https://confluence.atlassian.com/confkb/files/980460833/980460769/1/1574450271730/Screen+Shot+2019-11-22+at+14.25.48.png)\n\n- Response Head AJS Tags.\n\n![](https://confluence.atlassian.com/confkb/files/980460833/980460798/1/1574450271658/Screen+Shot+2019-11-22+at+15.07.51.png)\n\n- Response Body What's New Link.\n\n![](https://confluence.atlassian.com/confkb/files/980460833/980460799/1/1574450271373/Screen+Shot+2019-11-22+at+15.10.01.png)\n\n- Response Body Confluence Help Link.\n\n![](https://confluence.atlassian.com/confkb/files/980460833/982321522/1/1576094162892/Screen+Shot+2019-12-11+at+16.55.54.png)\n\n\n## References\n\n- [RCE in Jira (CVE-2019-11581)](https://medium.com/@ruvlol/rce-in-jira-cve-2019-11581-901b845f0f)\n- [One Misconfig (JIRA) to Leak Them All- Including NASA and Hundreds of Fortune 500 Companies!](https://medium.com/@logicbomb_1/one-misconfig-jira-to-leak-them-all-including-nasa-and-hundreds-of-fortune-500-companies-a70957ef03c7)\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/0x48piraj/jiraffe", "keywords": "", "license": "BSD-3", "maintainer": "", "maintainer_email": "", "name": "jiraffe", "package_url": "https://pypi.org/project/jiraffe/", "platform": "", "project_url": "https://pypi.org/project/jiraffe/", "project_urls": {"Homepage": "https://github.com/0x48piraj/jiraffe"}, "release_url": "https://pypi.org/project/jiraffe/2.0.1/", "requires_dist": null, "requires_python": "", "summary": "One stop place for exploiting all Jira instances in your proximity.", "version": "2.0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Jiraffe</h1>\n<p><a href=\"http://forthebadge.com\" rel=\"nofollow\"><img alt=\"forthebadge\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/259c77c9bad271befde29452483ec2619ff1b9f5/687474703a2f2f666f7274686562616467652e636f6d2f696d616765732f6261646765732f6275696c742d776974682d6c6f76652e737667\"></a>\n<a href=\"http://forthebadge.com\" rel=\"nofollow\"><img alt=\"forthebadge\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/9c33e1a35c79cb37bf635d9a767d116b63b96d63/687474703a2f2f666f7274686562616467652e636f6d2f696d616765732f6261646765732f6d616b65732d70656f706c652d736d696c652e737667\"></a>\n<a href=\"http://forthebadge.com\" rel=\"nofollow\"><img alt=\"forthebadge\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/edc70367d0ff06c268feee70420579b3384377da/687474703a2f2f666f7274686562616467652e636f6d2f696d616765732f6261646765732f706f77657265642d62792d726573706f6e736962696c6974792e737667\"></a></p>\n<p align=\"center\">\n<b>Jiraffe - One stop place for exploiting all Jira instances in your proximity</b><br><br>\n<img alt=\"Jiraffe logo\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/4bbb4cf2bc7e25aec4504879c146565671fffb0d/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f30783438706972616a2f4a6972616666652f6d61737465722f7374617469632f6c6f676f2e706e67\" width=\"400\"><br>\nSee the <a href=\"#demo\" rel=\"nofollow\">demo</a>\n</p>\n<h2>Installation</h2>\n<p>Use pip to install <strong>Jiraffe</strong>. This is the recommended way of running Jiraffe.</p>\n<pre><code>$ pip install jiraffe\n</code></pre>\n<h4>Usage</h4>\n<pre><code>$ py -m jiraffe\nusage: jiraffe [-h] [-t https://example-jira-instance.com]\n\n\n                                                                           /)/)\n                                                                          ( ..\\\n      ___  __      _______        __       _______   _______   _______    /'-._)\n     |\"  ||\" \\    /\"      \\      /\"\"\\     /\"     \"| /\"     \"| /\"     \"|  /#/\n     ||  |||  |  |:        |    /    \\   (: ______)(: ______)(: ______) /#/  @0x48piraj\n     |:  ||:  |  |_____/   )   /' /\\  \\   \\/    |   \\/    |   \\/    |\n  ___|  / |.  |   //      /   //  __'  \\  // ___)   // ___)   // ___)_\n /  :|_/ )/\\  |\\ |:  __   \\  /   /  \\\\  \\(:  (     (:  (     (:      \"|\n(_______/(__\\_|_)|__|  \\___)(___/    \\___)\\__/      \\__/      \\_______)\n\n\nOptions:\n  -t https://example-jira-instance.com, --target https://example-jira-instance.com\n                        Target Jira Instance URL\n  -v, --verbose         Verbose output\n  -a, --auto            Automatic mode\n\n</code></pre>\n<h2>Exploits for</h2>\n<table>\n<thead>\n<tr>\n<th>CVE</th>\n<th>Impact</th>\n<th>Description</th>\n<th>Version Affected</th>\n<th>Details</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CVE-2017-9506</td>\n<td>HIGH</td>\n<td>The IconUriServlet of the Atlassian OAuth Plugin from version 1.3.0 before version 1.9.12 and from version 2.0.0 before version 2.0.4 allows remote attackers to access the content of internal network resources and/or perform an XSS attack via Server Side Request Forgery (SSRF).</td>\n<td>Jira &lt; 7.3.5</td>\n<td><a href=\"https://lmgtfy.com/?q=CVE-2017-9506\" rel=\"nofollow\">CVE-2017-9506</a></td>\n</tr>\n<tr>\n<td>CVE-2019-8449</td>\n<td>LOW</td>\n<td>The /rest/api/latest/groupuserpicker resource in Jira before version 8.4.0 allows remote attackers to enumerate usernames via an information disclosure vulnerability.</td>\n<td>2.1 - 8.3.4</td>\n<td><a href=\"https://lmgtfy.com/?q=CVE-2019-8449\" rel=\"nofollow\">CVE-2019-8449</a></td>\n</tr>\n<tr>\n<td>CVE-2019-11581</td>\n<td>CRITICAL</td>\n<td>Atlassian JIRA Template injection vulnerability RCE</td>\n<td>Jira &lt; 7.6.14</td>\n<td><a href=\"https://lmgtfy.com/?q=CVE-2019-11581\" rel=\"nofollow\">CVE-2019-11581</a></td>\n</tr>\n<tr>\n<td>CVE-2019-8451</td>\n<td>HIGH</td>\n<td>Pre-authentication server side request forgery (SSRF) vulnerability found in the /plugins/servlet/gadgets/makeRequest resource.</td>\n<td>Jira == 7.6.0  &amp;&amp; Jira.7.6.0 &lt; 7.13.9, 8.4.0</td>\n<td><a href=\"https://lmgtfy.com/?q=CVE-2019-8451\" rel=\"nofollow\">CVE-2019-8451</a></td>\n</tr></tbody></table>\n<p>Majority of the bugs stated above poses Server-Side Request Forgery (SSRF) vulnerability, where attacker can abuse a specific functionality on the server to read or update internal resources. The attacker can supply or a modify a URL which the code running on the server will read or submit data to, and by carefully selecting the URLs, the attacker may be able to read server configuration such as AWS metadata, connect to internal services like HTTP enabled databases or perform post requests towards internal services which are not intended to be exposed.</p>\n<p>Currently, some of the common Amazon AWS credentials leak attacks are present with an additional <strong>Custom Payload Option</strong> for sending crafted payloads for any cloud platform (Amazon AWS, Google Cloud, etc.). For sending custom payloads, take help from <a href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#ssrf-url-for-cloud-instances\" rel=\"nofollow\">PayloadsAllTheThings \u2014 SSRF URL for Cloud Instances</a></p>\n<h5>URL Paths Jiraffe Currently Supports:</h5>\n<pre><code>Root Path: /latest/meta-data/{hostname,public-ipv4,...}\nUser Data : /latest/user-data\nAWS Credentials : /latest/meta-data/iam/security-credentials/\n</code></pre>\n<p>Feel free to implement more post exploitation modules for vendor specifc deployments.</p>\n<h2>Demo</h2>\n<p><img alt=\"Jiraffe Demo\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/98c1f0cbae8730a9b92dbc45ccea21aef33d0912/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f30783438706972616a2f4a6972616666652f6d61737465722f7374617469632f64656d6f2e676966\"></p>\n<h2>Internal Workings</h2>\n<h4>Reconnaissance \u2014 Jira version detection</h4>\n<p>If unauthenticated, one can access Confluence's landing page and retrieve version information from these places:</p>\n<ul>\n<li>Login page footer.</li>\n</ul>\n<p><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/36660a564774f74a64c5f595c17e2213f7bce734/68747470733a2f2f636f6e666c75656e63652e61746c61737369616e2e636f6d2f636f6e666b622f66696c65732f3938303436303833332f3938303436303736392f312f313537343435303237313733302f53637265656e2b53686f742b323031392d31312d32322b61742b31342e32352e34382e706e67\"></p>\n<ul>\n<li>Response Head AJS Tags.</li>\n</ul>\n<p><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/16864d8f2e8b6b62fb1e2a61c77857178a39db68/68747470733a2f2f636f6e666c75656e63652e61746c61737369616e2e636f6d2f636f6e666b622f66696c65732f3938303436303833332f3938303436303739382f312f313537343435303237313635382f53637265656e2b53686f742b323031392d31312d32322b61742b31352e30372e35312e706e67\"></p>\n<ul>\n<li>Response Body What's New Link.</li>\n</ul>\n<p><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/02285154fbbffb32c4b66f96b07b833270dde7a2/68747470733a2f2f636f6e666c75656e63652e61746c61737369616e2e636f6d2f636f6e666b622f66696c65732f3938303436303833332f3938303436303739392f312f313537343435303237313337332f53637265656e2b53686f742b323031392d31312d32322b61742b31352e31302e30312e706e67\"></p>\n<ul>\n<li>Response Body Confluence Help Link.</li>\n</ul>\n<p><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/84ce3c42c24c4dd6b77c7b29654117a25689f0ba/68747470733a2f2f636f6e666c75656e63652e61746c61737369616e2e636f6d2f636f6e666b622f66696c65732f3938303436303833332f3938323332313532322f312f313537363039343136323839322f53637265656e2b53686f742b323031392d31322d31312b61742b31362e35352e35342e706e67\"></p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://medium.com/@ruvlol/rce-in-jira-cve-2019-11581-901b845f0f\" rel=\"nofollow\">RCE in Jira (CVE-2019-11581)</a></li>\n<li><a href=\"https://medium.com/@logicbomb_1/one-misconfig-jira-to-leak-them-all-including-nasa-and-hundreds-of-fortune-500-companies-a70957ef03c7\" rel=\"nofollow\">One Misconfig (JIRA) to Leak Them All- Including NASA and Hundreds of Fortune 500 Companies!</a></li>\n</ul>\n\n          </div>"}, "last_serial": 6689126, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "a256e6324193583277815dec77f1c3a1", "sha256": "26faf868a8d51602c8b1ac575286c94dbbca07e01e495d214582db1a72a5a041"}, "downloads": -1, "filename": "jiraffe-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "a256e6324193583277815dec77f1c3a1", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 8201, "upload_time": "2020-02-10T07:31:22", "upload_time_iso_8601": "2020-02-10T07:31:22.014321Z", "url": "https://files.pythonhosted.org/packages/a7/6b/e04d01b28a47c659120cff72b8858327cbe73e20e8d60ae158dd906de70d/jiraffe-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "24b675e4306f0a911607e38298308e31", "sha256": "9cdecc26bd39a41f1e13f2873d26e3e408ca5909a2d15e63449c304f828519dc"}, "downloads": -1, "filename": "jiraffe-1.0.0.tar.gz", "has_sig": false, "md5_digest": "24b675e4306f0a911607e38298308e31", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 496910, "upload_time": "2020-02-10T07:31:25", "upload_time_iso_8601": "2020-02-10T07:31:25.706968Z", "url": "https://files.pythonhosted.org/packages/bd/70/08b07dddb7e725933ed11ebba0aa20451ed109a37694dd3b6bc6dbbe6073/jiraffe-1.0.0.tar.gz", "yanked": false}], "2.0.0": [{"comment_text": "", "digests": {"md5": "5aa8bbf8d81096ce31622769d89eb4ab", "sha256": "590ed922c58ee696e46bb12afca674059bf03ea7af713fed083dfadf59e91597"}, "downloads": -1, "filename": "jiraffe-2.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "5aa8bbf8d81096ce31622769d89eb4ab", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 10691, "upload_time": "2020-02-24T15:01:12", "upload_time_iso_8601": "2020-02-24T15:01:12.637597Z", "url": "https://files.pythonhosted.org/packages/ea/be/085ce9373ec86ad9a8b6bb6d013a54b7902596512649c6f8e6081b067244/jiraffe-2.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "22b034ee6e277e38efd572e812647a21", "sha256": "2ef3f948aea0967d168739ed1edafd0f398bb51c35eac1b67791019141cdf20a"}, "downloads": -1, "filename": "jiraffe-2.0.0.tar.gz", "has_sig": false, "md5_digest": "22b034ee6e277e38efd572e812647a21", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 1347427, "upload_time": "2020-02-24T15:01:29", "upload_time_iso_8601": "2020-02-24T15:01:29.570452Z", "url": "https://files.pythonhosted.org/packages/e7/37/bbc02220dbb9684ea2e9c862e0266c59886876f2cce45e9dcc95c0e7e64b/jiraffe-2.0.0.tar.gz", "yanked": false}], "2.0.1": [{"comment_text": "", "digests": {"md5": "5cfaf5c72ab27ce3726b0a69fcee2491", "sha256": "507bca65977059e9d5f5355f48624ab0c33f0330bc7f778be5d14db9cc1ffb66"}, "downloads": -1, "filename": "jiraffe-2.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "5cfaf5c72ab27ce3726b0a69fcee2491", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 10660, "upload_time": "2020-02-24T15:08:15", "upload_time_iso_8601": "2020-02-24T15:08:15.730300Z", "url": "https://files.pythonhosted.org/packages/1e/04/96d043b4776b158359096c8efe89eec54548037c7798313ffaae8566503f/jiraffe-2.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "5cf7f5137e2992bd49b310f45d8eecc6", "sha256": "8fbcfe3539fe73ea8ae96c6bf021c754130170eeb91e04896aed12aa6cd61902"}, "downloads": -1, "filename": "jiraffe-2.0.1.tar.gz", "has_sig": false, "md5_digest": "5cf7f5137e2992bd49b310f45d8eecc6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4930729, "upload_time": "2020-02-24T15:08:39", "upload_time_iso_8601": "2020-02-24T15:08:39.578953Z", "url": "https://files.pythonhosted.org/packages/4a/95/2b3a0d97a7eb8701191fd9359ba6e4a4ce54443f0f4dc04e98c7f3ac3fe1/jiraffe-2.0.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "5cfaf5c72ab27ce3726b0a69fcee2491", "sha256": "507bca65977059e9d5f5355f48624ab0c33f0330bc7f778be5d14db9cc1ffb66"}, "downloads": -1, "filename": "jiraffe-2.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "5cfaf5c72ab27ce3726b0a69fcee2491", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 10660, "upload_time": "2020-02-24T15:08:15", "upload_time_iso_8601": "2020-02-24T15:08:15.730300Z", "url": "https://files.pythonhosted.org/packages/1e/04/96d043b4776b158359096c8efe89eec54548037c7798313ffaae8566503f/jiraffe-2.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "5cf7f5137e2992bd49b310f45d8eecc6", "sha256": "8fbcfe3539fe73ea8ae96c6bf021c754130170eeb91e04896aed12aa6cd61902"}, "downloads": -1, "filename": "jiraffe-2.0.1.tar.gz", "has_sig": false, "md5_digest": "5cf7f5137e2992bd49b310f45d8eecc6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4930729, "upload_time": "2020-02-24T15:08:39", "upload_time_iso_8601": "2020-02-24T15:08:39.578953Z", "url": "https://files.pythonhosted.org/packages/4a/95/2b3a0d97a7eb8701191fd9359ba6e4a4ce54443f0f4dc04e98c7f3ac3fe1/jiraffe-2.0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:52:33 2020"}