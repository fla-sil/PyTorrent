{"info": {"author": "Gunter Grodotzki", "author_email": "gunter@grodotzki.co.za", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# terraecs\n\n[![Build Status](https://travis-ci.org/lifeofguenter/terraecs.svg?branch=master)](https://travis-ci.org/lifeofguenter/terraecs)\n[![PyPI](https://img.shields.io/pypi/v/terraecs.svg)](https://pypi.org/project/terraecs/)\n[![License](https://img.shields.io/github/license/lifeofguenter/terraecs.svg)](LICENSE)\n\nTerraecs is a simple cli tool to run a once-off [ECS/Fargate](https://aws.amazon.com/fargate/) task that relies on a [terraformed](https://www.terraform.io/) infrastructure.\n\n_Preview release, please do not use for anything important!_\n\n## Motivation\n\n* I want to run a command (be it ror-rake, laravel-artisan, etc.) in a Fargate environment\n* I use terraform for IaC, and do not want to deviate from that\n* I also do not want to think about infrastructure when running a command, as it should be already setup via terraform\n* These once-off tasks are dirty, I want to have direct feedback on how it went (logs + exit status)\n\n## Installation\n\n```bash\n$ pip install terraecs\n```\n\n## Usage\n\nYou will need to create a Fargate task module to create a task-definition and any other supporting resources (networking/cloudwatchlogs). At a minimum the module will have to output the following:\n\n```hcl\noutput \"cluster_id\" {\n  value = \"${var.cluster_id}\"\n}\n\noutput \"subnets\" {\n  value = \"${var.subnets}\"\n}\n\noutput \"security_group_id\" {\n  value = \"${aws_security_group.main.id}\"\n}\n\noutput \"task_definition_arn\" {\n  value = \"${aws_ecs_task_definition.main.arn}\"\n}\n```\n\nTerraform 0.12 and later intentionally track only root module outputs in the state. To expose module outputs for external consumption, you must export them from the root module using an output block, which as of 0.12 can now be done for a single module all in one output:\n\n```hcl\noutput \"custom_ecs_task\" {\n  value = module.custom_ecs_task\n}\n```\n\nOnce you have applied your terraform config, pull the output into a json:\n\n```bash\n$ terraform output -json custom_ecs_task > output.json\n```\n\nNow you can use `terraecs` to run any command based off the above task-definition:\n\n```bash\n$ terraecs -f output.json run \"command\" \"arg1\" \"arg2\"\n```\n\n## Output\n\nThe output can look something like this:\n\n```bash\n\u276f AWS_PROFILE=staging terraecs -f output.json run artisan --help\n2019-04-10 08:14:01,884 botocore.credentials [INFO] Found credentials in shared credentials file: ~/.aws/credentials\n2019-04-10 08:14:03,893 root [INFO] launched task: arn:aws:ecs:eu-west-1:1111111111111:task/staging-main/4544cfd6f10e4ff0b16458666362cbd9\n2019-04-10 08:14:04,069 root [INFO] PROVISIONING\n2019-04-10 08:14:25,461 root [INFO] PENDING\n2019-04-10 08:15:51,642 root [INFO] DEPROVISIONING\n2019-04-10 08:16:13,632 root [INFO] STOPPED\nDescription:\n  Lists commands\nUsage:\n  list [options] [--] [<namespace>]\nArguments:\n  namespace            The namespace name\nOptions:\n      --raw            To output raw command list\n      --format=FORMAT  The output format (txt, xml, json, or md) [default: \"txt\"]\nHelp:\n  The list command lists all commands:\n\n    php artisan list\n\n  You can also display the commands for a specific namespace:\n\n    php artisan list test\n\n  You can also output the information in other formats by using the --format option:\n\n    php artisan list --format=xml\n\n  It's also possible to get raw list of commands (useful for embedding command runner):\n\n    php artisan list --raw\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/lifeofguenter/terraecs", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "terraecs", "package_url": "https://pypi.org/project/terraecs/", "platform": "", "project_url": "https://pypi.org/project/terraecs/", "project_urls": {"Homepage": "https://github.com/lifeofguenter/terraecs"}, "release_url": "https://pypi.org/project/terraecs/1.0.0/", "requires_dist": null, "requires_python": ">=3", "summary": "A simple Fargate after Terraform runner.", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>terraecs</h1>\n<p><a href=\"https://travis-ci.org/lifeofguenter/terraecs\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/9bcbad51ea9155f15b5b6c24dabde6a70f1f1fc7/68747470733a2f2f7472617669732d63692e6f72672f6c6966656f666775656e7465722f74657272616563732e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://pypi.org/project/terraecs/\" rel=\"nofollow\"><img alt=\"PyPI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/858ab4b34ad8f98e9ff7bbfd907d57d366cbc8ea/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f74657272616563732e737667\"></a>\n<a href=\"LICENSE\" rel=\"nofollow\"><img alt=\"License\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/4bab950561d7b6f485627fbff3564415141a153a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6c6966656f666775656e7465722f74657272616563732e737667\"></a></p>\n<p>Terraecs is a simple cli tool to run a once-off <a href=\"https://aws.amazon.com/fargate/\" rel=\"nofollow\">ECS/Fargate</a> task that relies on a <a href=\"https://www.terraform.io/\" rel=\"nofollow\">terraformed</a> infrastructure.</p>\n<p><em>Preview release, please do not use for anything important!</em></p>\n<h2>Motivation</h2>\n<ul>\n<li>I want to run a command (be it ror-rake, laravel-artisan, etc.) in a Fargate environment</li>\n<li>I use terraform for IaC, and do not want to deviate from that</li>\n<li>I also do not want to think about infrastructure when running a command, as it should be already setup via terraform</li>\n<li>These once-off tasks are dirty, I want to have direct feedback on how it went (logs + exit status)</li>\n</ul>\n<h2>Installation</h2>\n<pre>$ pip install terraecs\n</pre>\n<h2>Usage</h2>\n<p>You will need to create a Fargate task module to create a task-definition and any other supporting resources (networking/cloudwatchlogs). At a minimum the module will have to output the following:</p>\n<pre>output \"cluster_id\" {\n  value = \"${var.cluster_id}\"\n}\n\noutput \"subnets\" {\n  value = \"${var.subnets}\"\n}\n\noutput \"security_group_id\" {\n  value = \"${aws_security_group.main.id}\"\n}\n\noutput \"task_definition_arn\" {\n  value = \"${aws_ecs_task_definition.main.arn}\"\n}\n</pre>\n<p>Terraform 0.12 and later intentionally track only root module outputs in the state. To expose module outputs for external consumption, you must export them from the root module using an output block, which as of 0.12 can now be done for a single module all in one output:</p>\n<pre>output \"custom_ecs_task\" {\n  value = module.custom_ecs_task\n}\n</pre>\n<p>Once you have applied your terraform config, pull the output into a json:</p>\n<pre>$ terraform output -json custom_ecs_task &gt; output.json\n</pre>\n<p>Now you can use <code>terraecs</code> to run any command based off the above task-definition:</p>\n<pre>$ terraecs -f output.json run <span class=\"s2\">\"command\"</span> <span class=\"s2\">\"arg1\"</span> <span class=\"s2\">\"arg2\"</span>\n</pre>\n<h2>Output</h2>\n<p>The output can look something like this:</p>\n<pre>\u276f <span class=\"nv\">AWS_PROFILE</span><span class=\"o\">=</span>staging terraecs -f output.json run artisan --help\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:14:01,884 botocore.credentials <span class=\"o\">[</span>INFO<span class=\"o\">]</span> Found credentials in shared credentials file: ~/.aws/credentials\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:14:03,893 root <span class=\"o\">[</span>INFO<span class=\"o\">]</span> launched task: arn:aws:ecs:eu-west-1:1111111111111:task/staging-main/4544cfd6f10e4ff0b16458666362cbd9\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:14:04,069 root <span class=\"o\">[</span>INFO<span class=\"o\">]</span> PROVISIONING\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:14:25,461 root <span class=\"o\">[</span>INFO<span class=\"o\">]</span> PENDING\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:15:51,642 root <span class=\"o\">[</span>INFO<span class=\"o\">]</span> DEPROVISIONING\n<span class=\"m\">2019</span>-04-10 <span class=\"m\">08</span>:16:13,632 root <span class=\"o\">[</span>INFO<span class=\"o\">]</span> STOPPED\nDescription:\n  Lists commands\nUsage:\n  list <span class=\"o\">[</span>options<span class=\"o\">]</span> <span class=\"o\">[</span>--<span class=\"o\">]</span> <span class=\"o\">[</span>&lt;namespace&gt;<span class=\"o\">]</span>\nArguments:\n  namespace            The namespace name\nOptions:\n      --raw            To output raw <span class=\"nb\">command</span> list\n      --format<span class=\"o\">=</span>FORMAT  The output format <span class=\"o\">(</span>txt, xml, json, or md<span class=\"o\">)</span> <span class=\"o\">[</span>default: <span class=\"s2\">\"txt\"</span><span class=\"o\">]</span>\nHelp:\n  The list <span class=\"nb\">command</span> lists all commands:\n\n    php artisan list\n\n  You can also display the commands <span class=\"k\">for</span> a specific namespace:\n\n    php artisan list <span class=\"nb\">test</span>\n\n  You can also output the information in other formats by using the --format option:\n\n    php artisan list --format<span class=\"o\">=</span>xml\n\n  It<span class=\"err\">'</span>s also possible to get raw list of commands <span class=\"o\">(</span>useful <span class=\"k\">for</span> embedding <span class=\"nb\">command</span> runner<span class=\"o\">)</span>:\n\n    php artisan list --raw\n</pre>\n\n          </div>"}, "last_serial": 6501856, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "37ab962503e7d15a7a1a9e882ef85091", "sha256": "5ad0f47bcc42970b1b17048c146432ca2d5b5ac40e288b142df17c0e2f2481c4"}, "downloads": -1, "filename": "terraecs-0.0.1.tar.gz", "has_sig": false, "md5_digest": "37ab962503e7d15a7a1a9e882ef85091", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3", "size": 1617, "upload_time": "2019-04-09T22:45:17", "upload_time_iso_8601": "2019-04-09T22:45:17.884465Z", "url": "https://files.pythonhosted.org/packages/1c/cb/0c0536daf687821bab7b062755992bd6fe81df94fed2cfa853c53474d12b/terraecs-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "66a6daf4f0552acb02e642a88ec7edbb", "sha256": "e52951bf9a16f7eba18e982208c9a60ed703e2f776f3026de3653625fcf5a793"}, "downloads": -1, "filename": "terraecs-0.0.2.tar.gz", "has_sig": false, "md5_digest": "66a6daf4f0552acb02e642a88ec7edbb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3", "size": 3002, "upload_time": "2019-04-09T22:59:08", "upload_time_iso_8601": "2019-04-09T22:59:08.096574Z", "url": "https://files.pythonhosted.org/packages/63/b6/d3a62cd0f67e10b6d57996afa6bce69845ef191952bc973d0fb7915863be/terraecs-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "50c85ad43f83794e6d8dde65eacdfd6d", "sha256": "c80831555afb0ef694aaa23cd1c11a5b8d61317c3c4943e9191b1cadf0983160"}, "downloads": -1, "filename": "terraecs-0.0.3.tar.gz", "has_sig": false, "md5_digest": "50c85ad43f83794e6d8dde65eacdfd6d", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3", "size": 3012, "upload_time": "2019-04-09T23:41:34", "upload_time_iso_8601": "2019-04-09T23:41:34.777239Z", "url": "https://files.pythonhosted.org/packages/98/68/1212dd0c0fbd2872501d6a530a0f44d5d6d741e5b1b02ef11f0ea2b8ce0f/terraecs-0.0.3.tar.gz", "yanked": false}], "1.0.0": [{"comment_text": "", "digests": {"md5": "96aa530764e0ba881f011efc03481ecd", "sha256": "f9fa68ebc20dada5ff11938e9becdcfc516d2ea8bf977b2d996b850ce19f3dae"}, "downloads": -1, "filename": "terraecs-1.0.0.tar.gz", "has_sig": false, "md5_digest": "96aa530764e0ba881f011efc03481ecd", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3", "size": 4295, "upload_time": "2020-01-22T18:44:27", "upload_time_iso_8601": "2020-01-22T18:44:27.803522Z", "url": "https://files.pythonhosted.org/packages/06/24/dd5747d5c1068fd9d0bcf6490767d2a3203199db9cb7e18c04256244e992/terraecs-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "96aa530764e0ba881f011efc03481ecd", "sha256": "f9fa68ebc20dada5ff11938e9becdcfc516d2ea8bf977b2d996b850ce19f3dae"}, "downloads": -1, "filename": "terraecs-1.0.0.tar.gz", "has_sig": false, "md5_digest": "96aa530764e0ba881f011efc03481ecd", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3", "size": 4295, "upload_time": "2020-01-22T18:44:27", "upload_time_iso_8601": "2020-01-22T18:44:27.803522Z", "url": "https://files.pythonhosted.org/packages/06/24/dd5747d5c1068fd9d0bcf6490767d2a3203199db9cb7e18c04256244e992/terraecs-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:55:50 2020"}