{"info": {"author": "James Routley", "author_email": "jroutley@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 2 - Pre-Alpha", "Intended Audience :: Developers", "License :: OSI Approved :: Apache Software License", "Natural Language :: English", "Programming Language :: Python :: 2", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6"], "description": "===========================================\nPtolemy, an AWS DMS table mapping generator\n===========================================\n\nWrite terse AWS DMS table mappings.\n\n\nBackground\n----------\n\nAmazon Web Services provides a tool for migrating data to, from or between SQL databases. This tool is named `Database Migration Service <https://aws.amazon.com/documentation/dms/>`_ (DMS). When running DMS, users can supply a table mapping, which specifies allows the user to control what data is sent from the source database to the target database. A full list of table mapping options can be found `here <http://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TableMapping.html>`_.\n\nTable mappings are written as JSON documents, which can grow to be long and complex. ``ptolemy`` allows the user to write terse YAML ``source`` files, which can be compiled to valid JSON table mappings using the ``ptolemy`` cli tool.\n\n\nUsage\n-----\n\n.. code-block:: console\n\n  $ # Display an example source file:\n  $ cat migrate_all_tables_in_a_schema.yaml\n  selection:\n    include:\n      -\n        object-locators:\n          schema-names:\n            - Test\n          table-names:\n            - \"%\"\n  $ # Compile it to a DMS table mapping:\n  $ ptolemy migrate_all_tables_in_a_schema.yaml\n  {\n      \"rules\": [\n          {\n              \"object-locator\": {\n                  \"schema-name\": \"Test\",\n                  \"table-name\": \"%\"\n              },\n              \"rule-action\": \"include\",\n              \"rule-id\": \"1\",\n              \"rule-name\": \"1\",\n              \"rule-type\": \"selection\"\n          }\n      ]\n  }\n\n\nAPI\n---\n\n.. code-block:: console\n\n  $ ptolemy -h\n  ptolemy [-h] [-d] [-v] source\n\n  positional arguments:\n    source         path to the source file\n\n  optional arguments:\n    -h, --help     show this help message and exit\n    -d, --debug    enable debug logs\n    -v, --version  show program's version number and exit\n\n\nInstall\n-------\n\nInstall via pip (recommended):\n\n.. code-block:: console\n\n  $ pip install ptolemy\n\nInstall from source:\n\n.. code-block:: console\n\n  $ git clone git@github.com:cloudreach/ptolemy.git\n  $ cd ptolemy\n  $ make install\n\n\nLicense\n-------\n\nptolemy is licensed under the Apache Software License 2.0.\n\n\nSource Syntax\n-------------\n\nThe following sections describe the source syntax. It is intended to show users who have working knowledge of DMS JSON mapping files how to write their YAML equivalents. For an overview of the JSON mapping files, see the `documentation <http://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TableMapping.html>`_. Most items are the same as those in JSON mapping files, with the exception of ``object-locators``, which are explained in the section `Object Locators`_\n\nThe descriptions are written in pseudo-yaml, where the syntax ``( option_a|option_b )`` indicates that an item could take the value ``option_a`` or ``option_b``.\n\nFor working examples, see the `examples directory <https://github.com/cloudreach/ptolemy/tree/master/examples>`_.\n\n\nSelection Rules and Actions\n***************************\n\n.. code-block:: YAML\n\n  selection:\n    ( include|exclude ):\n      -\n        object-locators:\n          schema-names:\n            - <schema-name-1>\n          table-names:\n            - <table-name-1>\n          filters:\n            -\n              filter-type: source\n              column-name: <column-name-1>\n              filter-conditions:\n                -\n                  filter-operator: ( ste|gte|eq|between )\n                  value: <value>\n\n\nTransformation Rules and Actions\n********************************\n\n.. code-block:: YAML\n\n  transformation:\n    ( rename|remove-column|convert-lowercase|convert-uppercase|add-prefix|remove-prefix|replace-prefix|add-suffix|remove-suffix|replace-suffix ):\n      -\n        object-locators:\n          schema-names:\n            - <schema-name-1>\n          table-names:\n            - <table-name-1>\n          column-names:\n            - <column-name-1>\n        rule-target: ( schema|table|column )\n        value: <value>\n        old-value: <old-value>\n\n\nObject Locators\n***************\n\n``object-locators`` offer a powerful way to apply selection and transformation rules to large numbers of objects. The singular ``schema-name``, ``table-name`` and ``column-name`` parameters of the native JSON table mapping ``object-locator`` have been replaced by their plurals. These new parameters each accept a list of objects. The rule is then applied to each column listed, for each table listed, for each schema listed.\n\n\nMultiple Source File Compilation\n--------------------------------\n\nMultiple source files can be compiled at once with the following Bash snippet. The snippet recursively finds all YAML files under the directory ``src/``, compiles the source to a DMS mapping file, and saves it to a file with the same name and path under a directory named ``mappings/``, with the extension ``.json``.\n\n.. code-block:: bash\n\n  source_files=\"$(find src -type f -name '*.yaml')\"\n  for source_file in $source_files; do\n    source_file_without_extension=${source_file%.*}\n    source_file_with_json_extension=${source_file_without_extension}.json\n    destination_file=mappings${source_file_with_json_extension#src}\n    mkdir -p \"$(dirname $destination_file)\"\n    ptolemy $source_file > $destination_file\n  done\n\nRunning the code from the following directory:\n\n.. code-block:: console\n\n  .\n  \u2514\u2500\u2500 src\n    \u251c\u2500\u2500 db-a\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.yaml\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.yaml\n    \u2514\u2500\u2500 db-b\n        \u251c\u2500\u2500 schema-1.yaml\n        \u2514\u2500\u2500 schema-2.yaml\n\nwould result in:\n\n.. code-block:: console\n\n  .\n  \u251c\u2500\u2500 mappings\n  \u2502\u00a0\u00a0 \u251c\u2500\u2500 db-a\n  \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.json\n  \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.json\n  \u2502\u00a0\u00a0 \u2514\u2500\u2500 db-b\n  \u2502\u00a0\u00a0     \u251c\u2500\u2500 schema-1.json\n  \u2502\u00a0\u00a0     \u2514\u2500\u2500 schema-2.json\n  \u2514\u2500\u2500 src\n      \u251c\u2500\u2500 db-a\n      \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.yaml\n      \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.yaml\n      \u2514\u2500\u2500 db-b\n          \u251c\u2500\u2500 schema-1.yaml\n          \u2514\u2500\u2500 schema-2.yaml\n\n\n=======\nHistory\n=======\n\n1.0.0 (2016-11-18)\n------------------\n\n* Initial release.", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/cloudreach/ptolemy", "keywords": "ptolemy", "license": "Apache Software License 2.0", "maintainer": null, "maintainer_email": null, "name": "ptolemy", "package_url": "https://pypi.org/project/ptolemy/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/ptolemy/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/cloudreach/ptolemy"}, "release_url": "https://pypi.org/project/ptolemy/1.0.0/", "requires_dist": null, "requires_python": null, "summary": "Write terse AWS DMS table mappings.", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"ptolemy-an-aws-dms-table-mapping-generator\">\n<h2>Ptolemy, an AWS DMS table mapping generator</h2>\n<p>Write terse AWS DMS table mappings.</p>\n<div id=\"background\">\n<h3>Background</h3>\n<p>Amazon Web Services provides a tool for migrating data to, from or between SQL databases. This tool is named <a href=\"https://aws.amazon.com/documentation/dms/\" rel=\"nofollow\">Database Migration Service</a> (DMS). When running DMS, users can supply a table mapping, which specifies allows the user to control what data is sent from the source database to the target database. A full list of table mapping options can be found <a href=\"http://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TableMapping.html\" rel=\"nofollow\">here</a>.</p>\n<p>Table mappings are written as JSON documents, which can grow to be long and complex. <tt>ptolemy</tt> allows the user to write terse YAML <tt>source</tt> files, which can be compiled to valid JSON table mappings using the <tt>ptolemy</tt> cli tool.</p>\n</div>\n<div id=\"usage\">\n<h3>Usage</h3>\n<pre><span class=\"gp\">$</span> <span class=\"c1\"># Display an example source file:\n</span><span class=\"gp\">$</span><span class=\"c1\"></span> cat migrate_all_tables_in_a_schema.yaml\n<span class=\"go\">selection:\n  include:\n    -\n      object-locators:\n        schema-names:\n          - Test\n        table-names:\n          - \"%\"\n</span><span class=\"gp\">$</span> <span class=\"c1\"># Compile it to a DMS table mapping:\n</span><span class=\"gp\">$</span><span class=\"c1\"></span> ptolemy migrate_all_tables_in_a_schema.yaml\n<span class=\"go\">{\n    \"rules\": [\n        {\n            \"object-locator\": {\n                \"schema-name\": \"Test\",\n                \"table-name\": \"%\"\n            },\n            \"rule-action\": \"include\",\n            \"rule-id\": \"1\",\n            \"rule-name\": \"1\",\n            \"rule-type\": \"selection\"\n        }\n    ]\n}</span>\n</pre>\n</div>\n<div id=\"api\">\n<h3>API</h3>\n<pre><span class=\"gp\">$</span> ptolemy -h\n<span class=\"go\">ptolemy [-h] [-d] [-v] source\n\npositional arguments:\n  source         path to the source file\n\noptional arguments:\n  -h, --help     show this help message and exit\n  -d, --debug    enable debug logs\n  -v, --version  show program's version number and exit</span>\n</pre>\n</div>\n<div id=\"install\">\n<h3>Install</h3>\n<p>Install via pip (recommended):</p>\n<pre><span class=\"gp\">$</span> pip install ptolemy\n</pre>\n<p>Install from source:</p>\n<pre><span class=\"gp\">$</span> git clone git@github.com:cloudreach/ptolemy.git\n<span class=\"gp\">$</span> <span class=\"nb\">cd</span> ptolemy\n<span class=\"gp\">$</span> make install\n</pre>\n</div>\n<div id=\"license\">\n<h3>License</h3>\n<p>ptolemy is licensed under the Apache Software License 2.0.</p>\n</div>\n<div id=\"source-syntax\">\n<h3>Source Syntax</h3>\n<p>The following sections describe the source syntax. It is intended to show users who have working knowledge of DMS JSON mapping files how to write their YAML equivalents. For an overview of the JSON mapping files, see the <a href=\"http://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TableMapping.html\" rel=\"nofollow\">documentation</a>. Most items are the same as those in JSON mapping files, with the exception of <tt><span class=\"pre\">object-locators</span></tt>, which are explained in the section <a href=\"#object-locators\" rel=\"nofollow\">Object Locators</a></p>\n<p>The descriptions are written in pseudo-yaml, where the syntax <tt>( option_a|option_b )</tt> indicates that an item could take the value <tt>option_a</tt> or <tt>option_b</tt>.</p>\n<p>For working examples, see the <a href=\"https://github.com/cloudreach/ptolemy/tree/master/examples\" rel=\"nofollow\">examples directory</a>.</p>\n<div id=\"selection-rules-and-actions\">\n<h4>Selection Rules and Actions</h4>\n<pre><span class=\"nt\">selection</span><span class=\"p\">:</span>\n  <span class=\"nt\">( include|exclude )</span><span class=\"p\">:</span>\n    <span class=\"p-Indicator\">-</span>\n      <span class=\"nt\">object-locators</span><span class=\"p\">:</span>\n        <span class=\"nt\">schema-names</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">&lt;schema-name-1&gt;</span>\n        <span class=\"nt\">table-names</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">&lt;table-name-1&gt;</span>\n        <span class=\"nt\">filters</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span>\n            <span class=\"nt\">filter-type</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">source</span>\n            <span class=\"nt\">column-name</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">&lt;column-name-1&gt;</span>\n            <span class=\"nt\">filter-conditions</span><span class=\"p\">:</span>\n              <span class=\"p-Indicator\">-</span>\n                <span class=\"nt\">filter-operator</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">( ste|gte|eq|between )</span>\n                <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">&lt;value&gt;</span>\n</pre>\n</div>\n<div id=\"transformation-rules-and-actions\">\n<h4>Transformation Rules and Actions</h4>\n<pre><span class=\"nt\">transformation</span><span class=\"p\">:</span>\n  <span class=\"nt\">( rename|remove-column|convert-lowercase|convert-uppercase|add-prefix|remove-prefix|replace-prefix|add-suffix|remove-suffix|replace-suffix )</span><span class=\"p\">:</span>\n    <span class=\"p-Indicator\">-</span>\n      <span class=\"nt\">object-locators</span><span class=\"p\">:</span>\n        <span class=\"nt\">schema-names</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">&lt;schema-name-1&gt;</span>\n        <span class=\"nt\">table-names</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">&lt;table-name-1&gt;</span>\n        <span class=\"nt\">column-names</span><span class=\"p\">:</span>\n          <span class=\"p-Indicator\">-</span> <span class=\"l-Scalar-Plain\">&lt;column-name-1&gt;</span>\n      <span class=\"nt\">rule-target</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">( schema|table|column )</span>\n      <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">&lt;value&gt;</span>\n      <span class=\"nt\">old-value</span><span class=\"p\">:</span> <span class=\"l-Scalar-Plain\">&lt;old-value&gt;</span>\n</pre>\n</div>\n<div id=\"object-locators\">\n<h4>Object Locators</h4>\n<p><tt><span class=\"pre\">object-locators</span></tt> offer a powerful way to apply selection and transformation rules to large numbers of objects. The singular <tt><span class=\"pre\">schema-name</span></tt>, <tt><span class=\"pre\">table-name</span></tt> and <tt><span class=\"pre\">column-name</span></tt> parameters of the native JSON table mapping <tt><span class=\"pre\">object-locator</span></tt> have been replaced by their plurals. These new parameters each accept a list of objects. The rule is then applied to each column listed, for each table listed, for each schema listed.</p>\n</div>\n</div>\n<div id=\"multiple-source-file-compilation\">\n<h3>Multiple Source File Compilation</h3>\n<p>Multiple source files can be compiled at once with the following Bash snippet. The snippet recursively finds all YAML files under the directory <tt>src/</tt>, compiles the source to a DMS mapping file, and saves it to a file with the same name and path under a directory named <tt>mappings/</tt>, with the extension <tt>.json</tt>.</p>\n<pre><span class=\"nv\">source_files</span><span class=\"o\">=</span><span class=\"s2\">\"</span><span class=\"k\">$(</span>find src -type f -name <span class=\"s1\">'*.yaml'</span><span class=\"k\">)</span><span class=\"s2\">\"</span>\n<span class=\"k\">for</span> source_file in <span class=\"nv\">$source_files</span><span class=\"p\">;</span> <span class=\"k\">do</span>\n  <span class=\"nv\">source_file_without_extension</span><span class=\"o\">=</span><span class=\"si\">${</span><span class=\"nv\">source_file</span><span class=\"p\">%.*</span><span class=\"si\">}</span>\n  <span class=\"nv\">source_file_with_json_extension</span><span class=\"o\">=</span><span class=\"si\">${</span><span class=\"nv\">source_file_without_extension</span><span class=\"si\">}</span>.json\n  <span class=\"nv\">destination_file</span><span class=\"o\">=</span>mappings<span class=\"si\">${</span><span class=\"nv\">source_file_with_json_extension</span><span class=\"p\">#src</span><span class=\"si\">}</span>\n  mkdir -p <span class=\"s2\">\"</span><span class=\"k\">$(</span>dirname <span class=\"nv\">$destination_file</span><span class=\"k\">)</span><span class=\"s2\">\"</span>\n  ptolemy <span class=\"nv\">$source_file</span> &gt; <span class=\"nv\">$destination_file</span>\n<span class=\"k\">done</span>\n</pre>\n<p>Running the code from the following directory:</p>\n<pre><span class=\"go\">.\n\u2514\u2500\u2500 src\n  \u251c\u2500\u2500 db-a\n  \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.yaml\n  \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.yaml\n  \u2514\u2500\u2500 db-b\n      \u251c\u2500\u2500 schema-1.yaml\n      \u2514\u2500\u2500 schema-2.yaml</span>\n</pre>\n<p>would result in:</p>\n<pre><span class=\"go\">.\n\u251c\u2500\u2500 mappings\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 db-a\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.json\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.json\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 db-b\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 schema-1.json\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 schema-2.json\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 db-a\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 schema-1.yaml\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 schema-2.yaml\n    \u2514\u2500\u2500 db-b\n        \u251c\u2500\u2500 schema-1.yaml\n        \u2514\u2500\u2500 schema-2.yaml</span>\n</pre>\n</div>\n</div>\n<div id=\"history\">\n<h2>History</h2>\n<h2 id=\"id1\"><span class=\"section-subtitle\">1.0.0 (2016-11-18)</span></h2>\n<ul>\n<li>Initial release.</li>\n</ul>\n</div>\n\n          </div>"}, "last_serial": 2468805, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "fa104251520760f86885ad8bc745cef0", "sha256": "77fe5d2d656bfbcfe74b0c36f7340ac595aeae76e757da31f470522178f78db8"}, "downloads": -1, "filename": "ptolemy-1.0.0.tar.gz", "has_sig": false, "md5_digest": "fa104251520760f86885ad8bc745cef0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 14243, "upload_time": "2016-11-18T15:49:35", "upload_time_iso_8601": "2016-11-18T15:49:35.568485Z", "url": "https://files.pythonhosted.org/packages/54/ba/a821e8cd33bdab1a8a8b0c36899bdc8c7445ce48647e5c47857be9c4e650/ptolemy-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "fa104251520760f86885ad8bc745cef0", "sha256": "77fe5d2d656bfbcfe74b0c36f7340ac595aeae76e757da31f470522178f78db8"}, "downloads": -1, "filename": "ptolemy-1.0.0.tar.gz", "has_sig": false, "md5_digest": "fa104251520760f86885ad8bc745cef0", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 14243, "upload_time": "2016-11-18T15:49:35", "upload_time_iso_8601": "2016-11-18T15:49:35.568485Z", "url": "https://files.pythonhosted.org/packages/54/ba/a821e8cd33bdab1a8a8b0c36899bdc8c7445ce48647e5c47857be9c4e650/ptolemy-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:15:11 2020"}