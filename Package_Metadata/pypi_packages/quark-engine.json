{"info": {"author": "JunWei Song, KunYu Chen", "author_email": "sungboss2004@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Topic :: Security"], "description": "# Quark Engine [![HITB Armory](https://img.shields.io/badge/HITBSecConf%20Armory-AMS%202020-blue)](https://conference.hitb.org/hitbsecconf2020ams/hitb-armory/) [![Build Status](https://travis-ci.org/quark-engine/quark-engine.svg?branch=master)](https://travis-ci.org/quark-engine/quark-engine.svg?branch=master) [![codecov](https://codecov.io/gh/quark-engine/quark-engine/branch/master/graph/badge.svg)](https://codecov.io/gh/quark-engine/quark-engine) [![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://github.com/18z/quark-rules/blob/master/LICENSE) [![Python 3.7](https://img.shields.io/badge/python-3.7-blue.svg)](https://www.python.org/downloads/release/python-360/)\nAn ```Obfuscation-Neglect``` Android Malware ```Scoring System```\n\n<img src=\"https://i.imgur.com/8GwkWei.png\"/>\n\nQuark-Engine is also bundled with [BlackArch](https://blackarch.org/mobile.html).\n\n[![asciicast](https://asciinema.org/a/292752.svg)](https://asciinema.org/a/292752)\n\n### Concepts\n\nAndroid malware analysis engine is not a new story. Every antivirus company has their own secrets to build it. With curiosity, we develop a malware scoring system from the perspective of Taiwan Criminal Law in an easy but solid way. \n\nWe have an order theory of criminal which explains stages of committing a crime. For example, crime of murder consists of five stages, they are determined, conspiracy, preparation, start and practice. The latter the stage the more we\u2019re sure that the crime is practiced. \n\nAccording to the above principle, ```we developed our order theory of android malware```. We develop five stages to see if the malicious activity is being practiced. They are 1. Permission requested. 2. Native API call. 3. Certain combination of native API. 4. Calling sequence of native API. 5. APIs that handle the same register. We not only define malicious activities and their stages but also develop weights and thresholds for calculating the threat level of a malware. \n\nMalware evolved with new techniques to gain difficulties for reverse engineering. Obfuscation is one of the most commonly used techniques. In this talk, we present a Dalvik bytecode loader with the order theory of android malware to neglect certain cases of obfuscation. \n\nOur Dalvik bytecode loader consists of functionalities such as 1. Finding cross reference and calling sequence of the native API. 2. Tracing the bytecode register. The combination of these functionalities (yes, the order theory) not only can neglect obfuscation but also match perfectly to the design of our malware scoring system.\n\n### Detail Report\nThis is a how we examine a real android malware (candy corn) with one single rule (crime).\n\n```bash\n$ quark -a sample/14d9f1a92dd984d6040cc41ed06e273e.apk \\\n                 -r rules/ \\\n                 --detail\n```\n\n<img src=\"https://i.imgur.com/kh1jpsQ.png\"/>\n\n### Summary Report\nExamine with rules.\n\n```bash\nquark -a sample/14d9f1a92dd984d6040cc41ed06e273e.apk \\\n               -r rules/ \\\n               --summary\n```\n<img src=\"https://i.imgur.com/Ib01V6k.png\"/>\n\n### Installation\n\n```bash\n$ git clone https://github.com/quark-engine/quark-engine.git; cd quark-engine/quark\n$ pipenv install --skip-lock\n$ pipenv shell\n```\n\nMake sure your python version is `3.7`, or you could change it from `Pipfile` to what you have.\n\n### Usage\n\n```bash\n$ quark --help\nUsage: quark [OPTIONS]\n\n  Quark is an Obfuscation-Neglect Android Malware Scoring System\n\nOptions:\n  -s, --summary         show summary report\n  -d, --detail          show detail report\n  -a, --apk FILE        APK file  [required]\n  -r, --rule DIRECTORY  Rules folder need to be checked  [required]\n  --help                Show this message and exit.\n```\n\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/quark-engine/quark-engine", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "quark-engine", "package_url": "https://pypi.org/project/quark-engine/", "platform": "", "project_url": "https://pypi.org/project/quark-engine/", "project_urls": {"Homepage": "https://github.com/quark-engine/quark-engine"}, "release_url": "https://pypi.org/project/quark-engine/20.4/", "requires_dist": ["prettytable", "androguard (==3.4.0a1)", "tqdm", "colorama", "click"], "requires_python": ">=3.7", "summary": "An Obfuscation-Neglect Android Malware Scoring System", "version": "20.4", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Quark Engine <a href=\"https://conference.hitb.org/hitbsecconf2020ams/hitb-armory/\" rel=\"nofollow\"><img alt=\"HITB Armory\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/8b8dfef80dfc1fa72005b92203d04e3f7b766f15/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f48495442536563436f6e6625323041726d6f72792d414d53253230323032302d626c7565\"></a> <a href=\"https://travis-ci.org/quark-engine/quark-engine.svg?branch=master\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6b18eac9d03d7ddc86444a06f089cb6cf2e9b967/68747470733a2f2f7472617669732d63692e6f72672f717561726b2d656e67696e652f717561726b2d656e67696e652e7376673f6272616e63683d6d6173746572\"></a> <a href=\"https://codecov.io/gh/quark-engine/quark-engine\" rel=\"nofollow\"><img alt=\"codecov\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/1cd08073f07077b75c19f513513336b33189958c/68747470733a2f2f636f6465636f762e696f2f67682f717561726b2d656e67696e652f717561726b2d656e67696e652f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a> <a href=\"https://github.com/18z/quark-rules/blob/master/LICENSE\" rel=\"nofollow\"><img alt=\"License: GPL v3\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/8de17537dd1659a5a076ce547de301e27c839e67/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d47504c76332d626c75652e737667\"></a> <a href=\"https://www.python.org/downloads/release/python-360/\" rel=\"nofollow\"><img alt=\"Python 3.7\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/99a5180f32db379110e9948c7de1aaf8f77bf2e8/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e372d626c75652e737667\"></a></h1>\n<p>An <code>Obfuscation-Neglect</code> Android Malware <code>Scoring System</code></p>\n<img src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/3a0f74140782dde6cd27924081262c0df0a5fad4/68747470733a2f2f692e696d6775722e636f6d2f3847776b5765692e706e67\">\n<p>Quark-Engine is also bundled with <a href=\"https://blackarch.org/mobile.html\" rel=\"nofollow\">BlackArch</a>.</p>\n<p><a href=\"https://asciinema.org/a/292752\" rel=\"nofollow\"><img alt=\"asciicast\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/569b8bf41cb41ef4a5a6cb57337459744b2555ec/68747470733a2f2f61736369696e656d612e6f72672f612f3239323735322e737667\"></a></p>\n<h3>Concepts</h3>\n<p>Android malware analysis engine is not a new story. Every antivirus company has their own secrets to build it. With curiosity, we develop a malware scoring system from the perspective of Taiwan Criminal Law in an easy but solid way.</p>\n<p>We have an order theory of criminal which explains stages of committing a crime. For example, crime of murder consists of five stages, they are determined, conspiracy, preparation, start and practice. The latter the stage the more we\u2019re sure that the crime is practiced.</p>\n<p>According to the above principle, <code>we developed our order theory of android malware</code>. We develop five stages to see if the malicious activity is being practiced. They are 1. Permission requested. 2. Native API call. 3. Certain combination of native API. 4. Calling sequence of native API. 5. APIs that handle the same register. We not only define malicious activities and their stages but also develop weights and thresholds for calculating the threat level of a malware.</p>\n<p>Malware evolved with new techniques to gain difficulties for reverse engineering. Obfuscation is one of the most commonly used techniques. In this talk, we present a Dalvik bytecode loader with the order theory of android malware to neglect certain cases of obfuscation.</p>\n<p>Our Dalvik bytecode loader consists of functionalities such as 1. Finding cross reference and calling sequence of the native API. 2. Tracing the bytecode register. The combination of these functionalities (yes, the order theory) not only can neglect obfuscation but also match perfectly to the design of our malware scoring system.</p>\n<h3>Detail Report</h3>\n<p>This is a how we examine a real android malware (candy corn) with one single rule (crime).</p>\n<pre>$ quark -a sample/14d9f1a92dd984d6040cc41ed06e273e.apk <span class=\"se\">\\</span>\n                 -r rules/ <span class=\"se\">\\</span>\n                 --detail\n</pre>\n<img src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/459437df3a7045bfa412eed7611cd5570a46d339/68747470733a2f2f692e696d6775722e636f6d2f6b68316a7073512e706e67\">\n<h3>Summary Report</h3>\n<p>Examine with rules.</p>\n<pre>quark -a sample/14d9f1a92dd984d6040cc41ed06e273e.apk <span class=\"se\">\\</span>\n               -r rules/ <span class=\"se\">\\</span>\n               --summary\n</pre>\n<img src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/0cacae3181888e58494cb04c9b6e05015d304496/68747470733a2f2f692e696d6775722e636f6d2f4962303156366b2e706e67\">\n<h3>Installation</h3>\n<pre>$ git clone https://github.com/quark-engine/quark-engine.git<span class=\"p\">;</span> <span class=\"nb\">cd</span> quark-engine/quark\n$ pipenv install --skip-lock\n$ pipenv shell\n</pre>\n<p>Make sure your python version is <code>3.7</code>, or you could change it from <code>Pipfile</code> to what you have.</p>\n<h3>Usage</h3>\n<pre>$ quark --help\nUsage: quark <span class=\"o\">[</span>OPTIONS<span class=\"o\">]</span>\n\n  Quark is an Obfuscation-Neglect Android Malware Scoring System\n\nOptions:\n  -s, --summary         show summary report\n  -d, --detail          show detail report\n  -a, --apk FILE        APK file  <span class=\"o\">[</span>required<span class=\"o\">]</span>\n  -r, --rule DIRECTORY  Rules folder need to be checked  <span class=\"o\">[</span>required<span class=\"o\">]</span>\n  --help                Show this message and exit.\n</pre>\n\n          </div>"}, "last_serial": 7038384, "releases": {"20.1": [{"comment_text": "", "digests": {"md5": "6ea1e6ebc8abc104549d15b14ff36831", "sha256": "067abcba1cf007455465a4af2c86614a2ab85cf26aee38dd0fe0461b21cb928a"}, "downloads": -1, "filename": "quark_engine-20.1-py3-none-any.whl", "has_sig": false, "md5_digest": "6ea1e6ebc8abc104549d15b14ff36831", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 30470, "upload_time": "2020-04-10T05:33:27", "upload_time_iso_8601": "2020-04-10T05:33:27.313703Z", "url": "https://files.pythonhosted.org/packages/5d/56/e4ebe9e23eb1dad558440a3ab67c4be9ff2366ad54f3cec8da0b5db345e3/quark_engine-20.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "84cc58e2d23ead45e9208f434791ab23", "sha256": "e24110e36e192e384896526ee32a9cf36683ef8d23734a016a6feb8ca5e0c1b1"}, "downloads": -1, "filename": "quark-engine-20.1.tar.gz", "has_sig": false, "md5_digest": "84cc58e2d23ead45e9208f434791ab23", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 14935, "upload_time": "2020-04-10T05:33:29", "upload_time_iso_8601": "2020-04-10T05:33:29.640518Z", "url": "https://files.pythonhosted.org/packages/e2/1a/83fb1d61fa524ed0f47f07f7d972701d013f4f608e9252f820f047b3df7f/quark-engine-20.1.tar.gz", "yanked": false}], "20.4": [{"comment_text": "", "digests": {"md5": "a9751a36b42c894d75ae9d86700fa791", "sha256": "4f1f21c8d303941dfec0ff13c78ad70aea27076f52254326979614d165e262f6"}, "downloads": -1, "filename": "quark_engine-20.4-py3.7.egg", "has_sig": false, "md5_digest": "a9751a36b42c894d75ae9d86700fa791", "packagetype": "bdist_egg", "python_version": "3.7", "requires_python": ">=3.7", "size": 16936, "upload_time": "2020-04-17T07:57:06", "upload_time_iso_8601": "2020-04-17T07:57:06.379078Z", "url": "https://files.pythonhosted.org/packages/1f/ee/5574af7e375dd9b3b4f14806ccff7986e016ffc0faa828b4871796ecc6ea/quark_engine-20.4-py3.7.egg", "yanked": false}, {"comment_text": "", "digests": {"md5": "d232f1fa61a3ee1af741a70054dd4aff", "sha256": "00553e92a17e0735f99456e80b63720877941895676b5ff308104b40d2f1dd38"}, "downloads": -1, "filename": "quark_engine-20.4-py3-none-any.whl", "has_sig": false, "md5_digest": "d232f1fa61a3ee1af741a70054dd4aff", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 29937, "upload_time": "2020-04-17T07:57:03", "upload_time_iso_8601": "2020-04-17T07:57:03.706025Z", "url": "https://files.pythonhosted.org/packages/8d/b1/de6b7346f323850a0fa9c944fc36446576ca371c7019d38276192944fdcb/quark_engine-20.4-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f06843968fcecf22b6716810737d1ab6", "sha256": "03e4f083e274582722b483fcd03c70705b0d572eb448bc4f8e0ea015073f842f"}, "downloads": -1, "filename": "quark-engine-20.4.tar.gz", "has_sig": false, "md5_digest": "f06843968fcecf22b6716810737d1ab6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 14823, "upload_time": "2020-04-17T07:57:04", "upload_time_iso_8601": "2020-04-17T07:57:04.973431Z", "url": "https://files.pythonhosted.org/packages/94/77/e3c8205a48592a599a4e4c35c0f457ad02b67e35d45c22b283f4449d7785/quark-engine-20.4.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "a9751a36b42c894d75ae9d86700fa791", "sha256": "4f1f21c8d303941dfec0ff13c78ad70aea27076f52254326979614d165e262f6"}, "downloads": -1, "filename": "quark_engine-20.4-py3.7.egg", "has_sig": false, "md5_digest": "a9751a36b42c894d75ae9d86700fa791", "packagetype": "bdist_egg", "python_version": "3.7", "requires_python": ">=3.7", "size": 16936, "upload_time": "2020-04-17T07:57:06", "upload_time_iso_8601": "2020-04-17T07:57:06.379078Z", "url": "https://files.pythonhosted.org/packages/1f/ee/5574af7e375dd9b3b4f14806ccff7986e016ffc0faa828b4871796ecc6ea/quark_engine-20.4-py3.7.egg", "yanked": false}, {"comment_text": "", "digests": {"md5": "d232f1fa61a3ee1af741a70054dd4aff", "sha256": "00553e92a17e0735f99456e80b63720877941895676b5ff308104b40d2f1dd38"}, "downloads": -1, "filename": "quark_engine-20.4-py3-none-any.whl", "has_sig": false, "md5_digest": "d232f1fa61a3ee1af741a70054dd4aff", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7", "size": 29937, "upload_time": "2020-04-17T07:57:03", "upload_time_iso_8601": "2020-04-17T07:57:03.706025Z", "url": "https://files.pythonhosted.org/packages/8d/b1/de6b7346f323850a0fa9c944fc36446576ca371c7019d38276192944fdcb/quark_engine-20.4-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "f06843968fcecf22b6716810737d1ab6", "sha256": "03e4f083e274582722b483fcd03c70705b0d572eb448bc4f8e0ea015073f842f"}, "downloads": -1, "filename": "quark-engine-20.4.tar.gz", "has_sig": false, "md5_digest": "f06843968fcecf22b6716810737d1ab6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7", "size": 14823, "upload_time": "2020-04-17T07:57:04", "upload_time_iso_8601": "2020-04-17T07:57:04.973431Z", "url": "https://files.pythonhosted.org/packages/94/77/e3c8205a48592a599a4e4c35c0f457ad02b67e35d45c22b283f4449d7785/quark-engine-20.4.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:08:48 2020"}