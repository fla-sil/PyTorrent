{"info": {"author": "Reuben Thomas-Davis", "author_email": "reuben@rekon.uk", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# Airflow KubernetesPodOperatorFromDeployment\n\n[![PyPI version](https://badge.fury.io/py/airkupofrod.svg)](https://badge.fury.io/py/airkupofrod)\n[![PyPI license](https://img.shields.io/pypi/l/airkupofrod.svg)](https://pypi.python.org/pypi/airkupofrod/)\n[![PyPI pyversions](https://img.shields.io/pypi/pyversions/airkupofrod.svg)](https://pypi.python.org/pypi/airkupofrod/)\n\nOr `airkupofrod` for short, is a tiny package which does one thing - takes a deployment in your kubernetes cluster and \nturns allows you to use its pod template as a `KubernetesPodOperator` object. It does this by providing the \n`KubernetesPodOperatorFromDeployment` operator.\n\n`airkupofrod` supports 1.10.9<=airflow<2\n\n\n## Installation and usage\n\nEnsure your airflow image has the python package `airkupofrod` installed\n\n```bash\npip install airkubofrod\n```\n\nThen in your dags:\n```python\nfrom airkupofrod.operator import KubernetesPodOperatorFromDeployment\n\nmy_kupofrod_task = KubernetesPodOperatorFromDeployment(\n    deployment_labels={\"app\": \"my-app\"}, # deployment labels to lookup by\n    deployment_fields={\"metadata.name\": \"my-app-deploy-template\"}, # deployment fields to lookup by\n    deployment_namespace=\"some-ns\", # where the deployment lives\n    namespace=\"default\", # where the pod will be deployed\n    task_id=\"my-kupofrod-task\", \n    dag=dag,\n    in_cluster=True, \n) \n```\n\nYou will also need to make sure that a service account attached to your airflow pods\nhas the a role capable of listing deployments bound to it. See \n[role-binding](https://github.com/rekon-oss/airkupofrod/tree/master/role-binding) for an example of this.\n\nThis is in addition to the role bindings necessary for the `KubernetesPodOperator` to work which can be seen in the \n[airflow helm chart](https://github.com/helm/charts/blob/master/stable/airflow/templates/role.yaml) \n\n## Developing\n\n[Skaffold](https://skaffold.dev/) is used to test and develop inside kubernetes.\n\nAfter ensuring you have:\n * Skaffold\n * Helm\n * Some type of k8s cluster available\n\nRun:\n```bash\nskaffold dev --force=false --cleanup=false --status-check=false --port-forward\n```\n\nThen navigate to http://localhost:8080 and enable and trigger a run of the test deployments dag.\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/rekon-oss/airkupofrod", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "airkupofrod", "package_url": "https://pypi.org/project/airkupofrod/", "platform": "", "project_url": "https://pypi.org/project/airkupofrod/", "project_urls": {"Homepage": "https://github.com/rekon-oss/airkupofrod"}, "release_url": "https://pypi.org/project/airkupofrod/0.6.0/", "requires_dist": ["apache-airflow[kubernetes] (>=1.10)"], "requires_python": ">=3.6", "summary": "Takes a deployment in your kubernetes cluster and turns its pod template into a KubernetesPodOperator object.", "version": "0.6.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Airflow KubernetesPodOperatorFromDeployment</h1>\n<p><a href=\"https://badge.fury.io/py/airkupofrod\" rel=\"nofollow\"><img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6ef9209b26ea44936b7472fc501a4df9f4c244cf/68747470733a2f2f62616467652e667572792e696f2f70792f6169726b75706f66726f642e737667\"></a>\n<a href=\"https://pypi.python.org/pypi/airkupofrod/\" rel=\"nofollow\"><img alt=\"PyPI license\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/148631e9f2fefa3606779cad679989b8cdc54553/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f6169726b75706f66726f642e737667\"></a>\n<a href=\"https://pypi.python.org/pypi/airkupofrod/\" rel=\"nofollow\"><img alt=\"PyPI pyversions\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/afede487428b5021e175beccf9cc5c75a2b06231/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f6169726b75706f66726f642e737667\"></a></p>\n<p>Or <code>airkupofrod</code> for short, is a tiny package which does one thing - takes a deployment in your kubernetes cluster and\nturns allows you to use its pod template as a <code>KubernetesPodOperator</code> object. It does this by providing the\n<code>KubernetesPodOperatorFromDeployment</code> operator.</p>\n<p><code>airkupofrod</code> supports 1.10.9&lt;=airflow&lt;2</p>\n<h2>Installation and usage</h2>\n<p>Ensure your airflow image has the python package <code>airkupofrod</code> installed</p>\n<pre>pip install airkubofrod\n</pre>\n<p>Then in your dags:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">airkupofrod.operator</span> <span class=\"kn\">import</span> <span class=\"n\">KubernetesPodOperatorFromDeployment</span>\n\n<span class=\"n\">my_kupofrod_task</span> <span class=\"o\">=</span> <span class=\"n\">KubernetesPodOperatorFromDeployment</span><span class=\"p\">(</span>\n    <span class=\"n\">deployment_labels</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"app\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-app\"</span><span class=\"p\">},</span> <span class=\"c1\"># deployment labels to lookup by</span>\n    <span class=\"n\">deployment_fields</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">\"metadata.name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-app-deploy-template\"</span><span class=\"p\">},</span> <span class=\"c1\"># deployment fields to lookup by</span>\n    <span class=\"n\">deployment_namespace</span><span class=\"o\">=</span><span class=\"s2\">\"some-ns\"</span><span class=\"p\">,</span> <span class=\"c1\"># where the deployment lives</span>\n    <span class=\"n\">namespace</span><span class=\"o\">=</span><span class=\"s2\">\"default\"</span><span class=\"p\">,</span> <span class=\"c1\"># where the pod will be deployed</span>\n    <span class=\"n\">task_id</span><span class=\"o\">=</span><span class=\"s2\">\"my-kupofrod-task\"</span><span class=\"p\">,</span> \n    <span class=\"n\">dag</span><span class=\"o\">=</span><span class=\"n\">dag</span><span class=\"p\">,</span>\n    <span class=\"n\">in_cluster</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> \n<span class=\"p\">)</span> \n</pre>\n<p>You will also need to make sure that a service account attached to your airflow pods\nhas the a role capable of listing deployments bound to it. See\n<a href=\"https://github.com/rekon-oss/airkupofrod/tree/master/role-binding\" rel=\"nofollow\">role-binding</a> for an example of this.</p>\n<p>This is in addition to the role bindings necessary for the <code>KubernetesPodOperator</code> to work which can be seen in the\n<a href=\"https://github.com/helm/charts/blob/master/stable/airflow/templates/role.yaml\" rel=\"nofollow\">airflow helm chart</a></p>\n<h2>Developing</h2>\n<p><a href=\"https://skaffold.dev/\" rel=\"nofollow\">Skaffold</a> is used to test and develop inside kubernetes.</p>\n<p>After ensuring you have:</p>\n<ul>\n<li>Skaffold</li>\n<li>Helm</li>\n<li>Some type of k8s cluster available</li>\n</ul>\n<p>Run:</p>\n<pre>skaffold dev --force<span class=\"o\">=</span><span class=\"nb\">false</span> --cleanup<span class=\"o\">=</span><span class=\"nb\">false</span> --status-check<span class=\"o\">=</span><span class=\"nb\">false</span> --port-forward\n</pre>\n<p>Then navigate to <a href=\"http://localhost:8080\" rel=\"nofollow\">http://localhost:8080</a> and enable and trigger a run of the test deployments dag.</p>\n\n          </div>"}, "last_serial": 7012994, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "bbc8e0b5a945e74e26421f7cb08d2e6e", "sha256": "96a9aaff2015e7a2fb81c26f8aacbeeeda861a20bf7006b3415a490537d3db7b"}, "downloads": -1, "filename": "airkupofrod-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "bbc8e0b5a945e74e26421f7cb08d2e6e", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 9084, "upload_time": "2020-04-12T12:00:53", "upload_time_iso_8601": "2020-04-12T12:00:53.141177Z", "url": "https://files.pythonhosted.org/packages/43/fe/b39eef3b17eed0921048fc0a13dfbeffedc00832c895bacf5f7cb79cd0fd/airkupofrod-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "c543b6271646a8889160823d3cf93492", "sha256": "40c7859edf9b300787867bde1d9c109ed057fc2aa6d7b4760e8f1647da6b3bb2"}, "downloads": -1, "filename": "airkupofrod-0.1.0.tar.gz", "has_sig": false, "md5_digest": "c543b6271646a8889160823d3cf93492", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 7017, "upload_time": "2020-04-12T12:00:55", "upload_time_iso_8601": "2020-04-12T12:00:55.018033Z", "url": "https://files.pythonhosted.org/packages/fb/36/b260fcd285d4252f3454c4fcf7a2b1f3043e3a55fc9c726c8b83996522c9/airkupofrod-0.1.0.tar.gz", "yanked": false}], "0.1.2": [{"comment_text": "", "digests": {"md5": "7d0afc8c27cfdfd3481af52e4e260114", "sha256": "0ce0c32f7f99f09dc363824c7e2ec20d65eb5d090ffffcacd83e56a6c7ce602f"}, "downloads": -1, "filename": "airkupofrod-0.1.2-py3-none-any.whl", "has_sig": false, "md5_digest": "7d0afc8c27cfdfd3481af52e4e260114", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 9364, "upload_time": "2020-04-12T12:28:27", "upload_time_iso_8601": "2020-04-12T12:28:27.310955Z", "url": "https://files.pythonhosted.org/packages/5d/2a/fb38a1ad5348e083cfa7a3209342298c0607b67e4ecec6f79f1b7fb41eb8/airkupofrod-0.1.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "137b7d3baee97de9473ebac35a5a84a5", "sha256": "10f8afc8bae514f1b66c96774c80733e1ae70533a5820d0ef3f23fe74194b8fc"}, "downloads": -1, "filename": "airkupofrod-0.1.2.tar.gz", "has_sig": false, "md5_digest": "137b7d3baee97de9473ebac35a5a84a5", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 7373, "upload_time": "2020-04-12T12:28:28", "upload_time_iso_8601": "2020-04-12T12:28:28.390904Z", "url": "https://files.pythonhosted.org/packages/61/0f/433f315cbf63ed8b0b1b3e0fde6d8b17cab3556f74868ced00a6e5a9f2a4/airkupofrod-0.1.2.tar.gz", "yanked": false}], "0.6.0": [{"comment_text": "", "digests": {"md5": "369600daf6a0ba4309177ecd5161a000", "sha256": "db58e4dc9d816c6d2ec6ec18e22da31eecdff4afec20a3f5e5d999c576fa6a11"}, "downloads": -1, "filename": "airkupofrod-0.6.0-py3-none-any.whl", "has_sig": false, "md5_digest": "369600daf6a0ba4309177ecd5161a000", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 11304, "upload_time": "2020-04-13T21:44:20", "upload_time_iso_8601": "2020-04-13T21:44:20.234999Z", "url": "https://files.pythonhosted.org/packages/17/4d/0cb2a5a4c283c5cee7d9cb85de88ab3a77c923d428f1cffc92eafe0b78a2/airkupofrod-0.6.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "d768adbcf2de72a05cac4040529692a9", "sha256": "4947c77a7b0595a9239f585ea7d4bfbd5e8f1cdf5c8b812c4c4a254ea2f8f940"}, "downloads": -1, "filename": "airkupofrod-0.6.0.tar.gz", "has_sig": false, "md5_digest": "d768adbcf2de72a05cac4040529692a9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 24568, "upload_time": "2020-04-13T21:44:20", "upload_time_iso_8601": "2020-04-13T21:44:20.989703Z", "url": "https://files.pythonhosted.org/packages/8f/0b/871a2d2440385174e2f56e763d1f64b2840f358ad29ce03737d9938c0e14/airkupofrod-0.6.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "369600daf6a0ba4309177ecd5161a000", "sha256": "db58e4dc9d816c6d2ec6ec18e22da31eecdff4afec20a3f5e5d999c576fa6a11"}, "downloads": -1, "filename": "airkupofrod-0.6.0-py3-none-any.whl", "has_sig": false, "md5_digest": "369600daf6a0ba4309177ecd5161a000", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 11304, "upload_time": "2020-04-13T21:44:20", "upload_time_iso_8601": "2020-04-13T21:44:20.234999Z", "url": "https://files.pythonhosted.org/packages/17/4d/0cb2a5a4c283c5cee7d9cb85de88ab3a77c923d428f1cffc92eafe0b78a2/airkupofrod-0.6.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "d768adbcf2de72a05cac4040529692a9", "sha256": "4947c77a7b0595a9239f585ea7d4bfbd5e8f1cdf5c8b812c4c4a254ea2f8f940"}, "downloads": -1, "filename": "airkupofrod-0.6.0.tar.gz", "has_sig": false, "md5_digest": "d768adbcf2de72a05cac4040529692a9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 24568, "upload_time": "2020-04-13T21:44:20", "upload_time_iso_8601": "2020-04-13T21:44:20.989703Z", "url": "https://files.pythonhosted.org/packages/8f/0b/871a2d2440385174e2f56e763d1f64b2840f358ad29ce03737d9938c0e14/airkupofrod-0.6.0.tar.gz", "yanked": false}], "timestamp": "Thu May  7 16:20:28 2020"}