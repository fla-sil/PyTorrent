{"info": {"author": "\"Joakim Rishaug\"", "author_email": "\"joakimrishaug@notmyrealemail.com\"", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Intended Audience :: Developers", "License :: OSI Approved :: Apache Software License", "Natural Language :: English", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "<!--\n\n#################################################\n### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###\n#################################################\n# file to edit: index.ipynb\n# command to build the docs after a change: nbdev_build_docs\n\n-->\n\n# online_triplet_loss\n\n> PyTorch conversion of the excellent post on the [same topic in Tensorflow](https://omoindrot.github.io/triplet-loss). Simply an implementation of a triple loss with online mining of candidate triplets used in semi-supervised learning.\n\n\n## Install\n\n`pip install online_triplet_loss`\n\nThen import with:\n`from online_triplet_loss.losses import *`\n\nPS: Requires Pytorch version 1.1.0 or above to use.\n\n## How to use\n\nIn these examples I use a really large margin, since the embedding space is so small. A more realistic margins seems to be between `0.1 and 2.0`\n<div class=\"codecell\" markdown=\"1\">\n<div class=\"input_area\" markdown=\"1\">\n\n```\nfrom torch import nn\nimport torch\n\nmodel = nn.Embedding(10, 10)\n```\n\n</div>\n\n</div>\n<div class=\"codecell\" markdown=\"1\">\n<div class=\"input_area\" markdown=\"1\">\n\n```\n#from online_triplet_loss.losses import *\nlabels = torch.randint(high=10, size=(5,)) # our five labels\n\nembeddings = model(labels)\nprint('Labels:', labels)\nprint('Embeddings:', embeddings)\nloss = batch_hard_triplet_loss(labels, embeddings, margin=100)\nprint('Loss:', loss)\nloss.backward()\n```\n\n</div>\n<div class=\"output_area\" markdown=\"1\">\n\n    Labels: tensor([6, 1, 3, 6, 6])\n    Embeddings: tensor([[-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500],\n            [ 1.0757, -0.8420, -0.7630, -0.0746,  1.1545,  0.4017,  0.5587,  1.7947,\n              0.1992, -2.2288],\n            [ 0.2646,  1.2383,  0.1949,  0.5743, -0.8460, -0.9929, -2.0350,  0.2095,\n              0.2129, -0.4855],\n            [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500],\n            [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500]], grad_fn=<EmbeddingBackward>)\n    Loss: tensor(95.1271, grad_fn=<MeanBackward0>)\n\n\n</div>\n\n</div>\n<div class=\"codecell\" markdown=\"1\">\n<div class=\"input_area\" markdown=\"1\">\n\n```\n#from online_triplet_loss.losses import *\nembeddings = model(labels)\nprint('Labels:', labels)\nprint('Embeddings:', embeddings)\nloss, fraction_pos = batch_all_triplet_loss(labels, embeddings, squared=False, margin=100)\nprint('Loss:', loss)\nloss.backward()\n```\n\n</div>\n<div class=\"output_area\" markdown=\"1\">\n\n    Labels: tensor([6, 1, 3, 6, 6])\n    Embeddings: tensor([[-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500],\n            [ 1.0757, -0.8420, -0.7630, -0.0746,  1.1545,  0.4017,  0.5587,  1.7947,\n              0.1992, -2.2288],\n            [ 0.2646,  1.2383,  0.1949,  0.5743, -0.8460, -0.9929, -2.0350,  0.2095,\n              0.2129, -0.4855],\n            [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500],\n            [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n              0.0180, -0.4500]], grad_fn=<EmbeddingBackward>)\n    tensor(94.9947, grad_fn=<DivBackward0>) tensor(1.)\n    Loss: tensor(94.9947, grad_fn=<DivBackward0>)\n\n\n</div>\n\n</div>\n\n## References\n* [Triplet Loss and Online Triplet Mining in Tensorflow](https://github.com/omoindrot/tensorflow-triplet-loss)\n* [Facenet paper](https://arxiv.org/abs/1503.03832)\n* [adambielski's nice implementation](https://github.com/adambielski/siamese-triplet) (unfortunately context switches between CPU / GPU)\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/NegatioN/OnlineMiningTripletLoss", "keywords": "pytorch loss online triplet mining", "license": "Apache Software License 2.0", "maintainer": "", "maintainer_email": "", "name": "online-triplet-loss", "package_url": "https://pypi.org/project/online-triplet-loss/", "platform": "", "project_url": "https://pypi.org/project/online-triplet-loss/", "project_urls": {"Homepage": "https://github.com/NegatioN/OnlineMiningTripletLoss"}, "release_url": "https://pypi.org/project/online-triplet-loss/0.0.4/", "requires_dist": ["numpy (>=1.15.4)", "torch (>=1.1.0)"], "requires_python": ">=3.6", "summary": "\"Online mining triplet losses for Pytorch\"", "version": "0.0.4", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>online_triplet_loss</h1>\n<blockquote>\n<p>PyTorch conversion of the excellent post on the <a href=\"https://omoindrot.github.io/triplet-loss\" rel=\"nofollow\">same topic in Tensorflow</a>. Simply an implementation of a triple loss with online mining of candidate triplets used in semi-supervised learning.</p>\n</blockquote>\n<h2>Install</h2>\n<p><code>pip install online_triplet_loss</code></p>\n<p>Then import with:\n<code>from online_triplet_loss.losses import *</code></p>\n<p>PS: Requires Pytorch version 1.1.0 or above to use.</p>\n<h2>How to use</h2>\n<p>In these examples I use a really large margin, since the embedding space is so small. A more realistic margins seems to be between <code>0.1 and 2.0</code></p>\n<div>\n<div>\n<pre><code>from torch import nn\nimport torch\n\nmodel = nn.Embedding(10, 10)\n</code></pre>\n</div>\n</div>\n<div>\n<div>\n<pre><code>#from online_triplet_loss.losses import *\nlabels = torch.randint(high=10, size=(5,)) # our five labels\n\nembeddings = model(labels)\nprint('Labels:', labels)\nprint('Embeddings:', embeddings)\nloss = batch_hard_triplet_loss(labels, embeddings, margin=100)\nprint('Loss:', loss)\nloss.backward()\n</code></pre>\n</div>\n<div>\n<pre><code>Labels: tensor([6, 1, 3, 6, 6])\nEmbeddings: tensor([[-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500],\n        [ 1.0757, -0.8420, -0.7630, -0.0746,  1.1545,  0.4017,  0.5587,  1.7947,\n          0.1992, -2.2288],\n        [ 0.2646,  1.2383,  0.1949,  0.5743, -0.8460, -0.9929, -2.0350,  0.2095,\n          0.2129, -0.4855],\n        [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500],\n        [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500]], grad_fn=&lt;EmbeddingBackward&gt;)\nLoss: tensor(95.1271, grad_fn=&lt;MeanBackward0&gt;)\n</code></pre>\n</div>\n</div>\n<div>\n<div>\n<pre><code>#from online_triplet_loss.losses import *\nembeddings = model(labels)\nprint('Labels:', labels)\nprint('Embeddings:', embeddings)\nloss, fraction_pos = batch_all_triplet_loss(labels, embeddings, squared=False, margin=100)\nprint('Loss:', loss)\nloss.backward()\n</code></pre>\n</div>\n<div>\n<pre><code>Labels: tensor([6, 1, 3, 6, 6])\nEmbeddings: tensor([[-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500],\n        [ 1.0757, -0.8420, -0.7630, -0.0746,  1.1545,  0.4017,  0.5587,  1.7947,\n          0.1992, -2.2288],\n        [ 0.2646,  1.2383,  0.1949,  0.5743, -0.8460, -0.9929, -2.0350,  0.2095,\n          0.2129, -0.4855],\n        [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500],\n        [-1.1335,  0.3364, -3.0174, -0.8732, -0.9301,  1.3619,  0.3746,  0.0457,\n          0.0180, -0.4500]], grad_fn=&lt;EmbeddingBackward&gt;)\ntensor(94.9947, grad_fn=&lt;DivBackward0&gt;) tensor(1.)\nLoss: tensor(94.9947, grad_fn=&lt;DivBackward0&gt;)\n</code></pre>\n</div>\n</div>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://github.com/omoindrot/tensorflow-triplet-loss\" rel=\"nofollow\">Triplet Loss and Online Triplet Mining in Tensorflow</a></li>\n<li><a href=\"https://arxiv.org/abs/1503.03832\" rel=\"nofollow\">Facenet paper</a></li>\n<li><a href=\"https://github.com/adambielski/siamese-triplet\" rel=\"nofollow\">adambielski's nice implementation</a> (unfortunately context switches between CPU / GPU)</li>\n</ul>\n\n          </div>"}, "last_serial": 6495861, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "e5e89761eb1962fdbd5d8e5d805e4194", "sha256": "3822e1214adf97e5a811a611cc1cda631c60ef5ea7bd75d1ca7b7c4274251fb8"}, "downloads": -1, "filename": "online_triplet_loss-0.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "e5e89761eb1962fdbd5d8e5d805e4194", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6440, "upload_time": "2020-01-12T16:21:19", "upload_time_iso_8601": "2020-01-12T16:21:19.500770Z", "url": "https://files.pythonhosted.org/packages/69/4c/72292ddea3e837035895309044e6f35ebce37140843f9f8e81f767dc3620/online_triplet_loss-0.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "6626e05833dfa8238b9d64fe73be033a", "sha256": "46cd6c998feba3d6c68adb4c155531eaa2a056d6d9ab56357998337fdaa13c03"}, "downloads": -1, "filename": "online_triplet_loss-0.0.1.tar.gz", "has_sig": false, "md5_digest": "6626e05833dfa8238b9d64fe73be033a", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 5335, "upload_time": "2020-01-12T16:21:22", "upload_time_iso_8601": "2020-01-12T16:21:22.098173Z", "url": "https://files.pythonhosted.org/packages/4a/61/04f6ad5a3edd7e34f8f799f871d53741d7714f67b705a8969e388be9f08b/online_triplet_loss-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "b829a7f1f279ce59635074f914a9689f", "sha256": "93f294c7161fb9744f08a12612f5f8d3213ff3af7902b2702884d3ed226df2aa"}, "downloads": -1, "filename": "online_triplet_loss-0.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "b829a7f1f279ce59635074f914a9689f", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6484, "upload_time": "2020-01-12T16:29:57", "upload_time_iso_8601": "2020-01-12T16:29:57.021366Z", "url": "https://files.pythonhosted.org/packages/2b/01/47b6108e9cb61e7934f5dea1542d42d9dd556d0c65f24ec173e6bc4cb133/online_triplet_loss-0.0.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "3bf1505d1bc22773e267b12f99da6f0e", "sha256": "d232cf33da603fc9d8f16a2d75746f5ab0f7fd8ceb5c9a402f1a02aa6a52d6c1"}, "downloads": -1, "filename": "online_triplet_loss-0.0.2.tar.gz", "has_sig": false, "md5_digest": "3bf1505d1bc22773e267b12f99da6f0e", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 5382, "upload_time": "2020-01-12T16:29:58", "upload_time_iso_8601": "2020-01-12T16:29:58.503577Z", "url": "https://files.pythonhosted.org/packages/10/f8/5f14caec53fce6b2cea047f405c6ac591fc23823159f61cd40a50d903009/online_triplet_loss-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "dcfd4076d66beb3a596918c8d16e018c", "sha256": "dc85e7fa12fe81cd6cbb76c32a3963ce6c01fd1fad852c72edf58f3df0193f76"}, "downloads": -1, "filename": "online_triplet_loss-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "dcfd4076d66beb3a596918c8d16e018c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6492, "upload_time": "2020-01-21T18:54:16", "upload_time_iso_8601": "2020-01-21T18:54:16.947897Z", "url": "https://files.pythonhosted.org/packages/76/0b/00883cbee0f06a4ad8e67a17a90c1f3cb93c8adf12428c0885c2706d4b03/online_triplet_loss-0.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "90799b98e67d07c22f378846a1c4829c", "sha256": "7180209bfd58defb5ea085f0734f13508a36d1590c03225fdf249471df6a7eaa"}, "downloads": -1, "filename": "online_triplet_loss-0.0.3.tar.gz", "has_sig": false, "md5_digest": "90799b98e67d07c22f378846a1c4829c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 5383, "upload_time": "2020-01-21T18:54:18", "upload_time_iso_8601": "2020-01-21T18:54:18.902779Z", "url": "https://files.pythonhosted.org/packages/f7/0d/71c1637bb90b87935d9a0f9f581e94ce308e53a370a25e6b18678fb10a15/online_triplet_loss-0.0.3.tar.gz", "yanked": false}], "0.0.4": [{"comment_text": "", "digests": {"md5": "6a5008e91a302ab37dbf29d4bb5bdae5", "sha256": "93427665d1bcb1efe02aa15facc9a3c928ae17301cc09746a2e1e5b3709e85b8"}, "downloads": -1, "filename": "online_triplet_loss-0.0.4-py3-none-any.whl", "has_sig": false, "md5_digest": "6a5008e91a302ab37dbf29d4bb5bdae5", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6466, "upload_time": "2020-01-21T19:21:52", "upload_time_iso_8601": "2020-01-21T19:21:52.242211Z", "url": "https://files.pythonhosted.org/packages/21/f1/054a1228eb7d9d12ea98fa2d0d52ad9698c72af002d1ac1ee1016897e62c/online_triplet_loss-0.0.4-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "67f80e05fd515743a4612b201d8bf60a", "sha256": "1e5a253d417655ac6c6c80ef489af7ace557c98e164720d4e4fa6ad234dbadfb"}, "downloads": -1, "filename": "online_triplet_loss-0.0.4.tar.gz", "has_sig": false, "md5_digest": "67f80e05fd515743a4612b201d8bf60a", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 5365, "upload_time": "2020-01-21T19:21:54", "upload_time_iso_8601": "2020-01-21T19:21:54.098043Z", "url": "https://files.pythonhosted.org/packages/f1/fd/d3c3e787a955ef39e574f702dcfa9d855087711c56dbbc98d91d45ad61b5/online_triplet_loss-0.0.4.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "6a5008e91a302ab37dbf29d4bb5bdae5", "sha256": "93427665d1bcb1efe02aa15facc9a3c928ae17301cc09746a2e1e5b3709e85b8"}, "downloads": -1, "filename": "online_triplet_loss-0.0.4-py3-none-any.whl", "has_sig": false, "md5_digest": "6a5008e91a302ab37dbf29d4bb5bdae5", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6466, "upload_time": "2020-01-21T19:21:52", "upload_time_iso_8601": "2020-01-21T19:21:52.242211Z", "url": "https://files.pythonhosted.org/packages/21/f1/054a1228eb7d9d12ea98fa2d0d52ad9698c72af002d1ac1ee1016897e62c/online_triplet_loss-0.0.4-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "67f80e05fd515743a4612b201d8bf60a", "sha256": "1e5a253d417655ac6c6c80ef489af7ace557c98e164720d4e4fa6ad234dbadfb"}, "downloads": -1, "filename": "online_triplet_loss-0.0.4.tar.gz", "has_sig": false, "md5_digest": "67f80e05fd515743a4612b201d8bf60a", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 5365, "upload_time": "2020-01-21T19:21:54", "upload_time_iso_8601": "2020-01-21T19:21:54.098043Z", "url": "https://files.pythonhosted.org/packages/f1/fd/d3c3e787a955ef39e574f702dcfa9d855087711c56dbbc98d91d45ad61b5/online_triplet_loss-0.0.4.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:03:52 2020"}