{"info": {"author": "Christian Heimes", "author_email": "christian@python.org", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Developers", "License :: OSI Approved :: Python Software Foundation License", "Natural Language :: English", "Programming Language :: Python", "Programming Language :: Python :: 2", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Text Processing :: Markup :: XML"], "description": "===================================================\ndefusedxml -- defusing XML bombs and other exploits\n===================================================\n\n.. image:: https://img.shields.io/pypi/v/defusedxml.svg\n    :target: https://pypi.org/project/defusedxml/\n    :alt: Latest Version\n\n.. image:: https://img.shields.io/pypi/pyversions/defusedxml.svg\n    :target: https://pypi.org/project/defusedxml/\n    :alt: Supported Python versions\n\n.. image:: https://travis-ci.org/tiran/defusedxml.svg?branch=master\n    :target: https://travis-ci.org/tiran/defusedxml\n    :alt: Travis CI\n\n.. image:: https://codecov.io/github/tiran/defusedxml/coverage.svg?branch=master\n    :target: https://codecov.io/github/tiran/defusedxml?branch=master\n    :alt: codecov\n\n.. image:: https://img.shields.io/pypi/dm/defusedxml.svg\n    :target: https://pypistats.org/packages/defusedxml\n    :alt: PyPI downloads\n\n.. image:: https://img.shields.io/badge/code%20style-black-000000.svg\n    :target: https://github.com/ambv/black\n    :alt: Code style: black\n\n..\n\n    \"It's just XML, what could probably go wrong?\"\n\nChristian Heimes <christian@python.org>\n\nSynopsis\n========\n\nThe results of an attack on a vulnerable XML library can be fairly dramatic.\nWith just a few hundred **Bytes** of XML data an attacker can occupy several\n**Gigabytes** of memory within **seconds**. An attacker can also keep\nCPUs busy for a long time with a small to medium size request. Under some\ncircumstances it is even possible to access local files on your\nserver, to circumvent a firewall, or to abuse services to rebound attacks to\nthird parties.\n\nThe attacks use and abuse less common features of XML and its parsers. The\nmajority of developers are unacquainted with features such as processing\ninstructions and entity expansions that XML inherited from SGML. At best\nthey know about ``<!DOCTYPE>`` from experience with HTML but they are not\naware that a document type definition (DTD) can generate an HTTP request\nor load a file from the file system.\n\nNone of the issues is new. They have been known for a long time. Billion\nlaughs was first reported in 2003. Nevertheless some XML libraries and\napplications are still vulnerable and even heavy users of XML are\nsurprised by these features. It's hard to say whom to blame for the\nsituation. It's too short sighted to shift all blame on XML parsers and\nXML libraries for using insecure default settings. After all they\nproperly implement XML specifications. Application developers must not rely\nthat a library is always configured for security and potential harmful data\nby default.\n\n\n.. contents:: Table of Contents\n   :depth: 2\n\n\nAttack vectors\n==============\n\nbillion laughs / exponential entity expansion\n---------------------------------------------\n\nThe `Billion Laughs`_ attack -- also known as exponential entity expansion --\nuses multiple levels of nested entities. The original example uses 9 levels\nof 10 expansions in each level to expand the string ``lol`` to a string of\n3 * 10 :sup:`9` bytes, hence the name \"billion laughs\". The resulting string\noccupies 3 GB (2.79 GiB) of memory; intermediate strings require additional\nmemory. Because most parsers don't cache the intermediate step for every\nexpansion it is repeated over and over again. It increases the CPU load even\nmore.\n\nAn XML document of just a few hundred bytes can disrupt all services on a\nmachine within seconds.\n\nExample XML::\n\n    <!DOCTYPE xmlbomb [\n    <!ENTITY a \"1234567890\" >\n    <!ENTITY b \"&a;&a;&a;&a;&a;&a;&a;&a;\">\n    <!ENTITY c \"&b;&b;&b;&b;&b;&b;&b;&b;\">\n    <!ENTITY d \"&c;&c;&c;&c;&c;&c;&c;&c;\">\n    ]>\n    <bomb>&d;</bomb>\n\n\nquadratic blowup entity expansion\n---------------------------------\n\nA quadratic blowup attack is similar to a `Billion Laughs`_ attack; it abuses\nentity expansion, too. Instead of nested entities it repeats one large entity\nwith a couple of thousand chars over and over again. The attack isn't as\nefficient as the exponential case but it avoids triggering countermeasures of\nparsers against heavily nested entities. Some parsers limit the depth and\nbreadth of a single entity but not the total amount of expanded text\nthroughout an entire XML document.\n\nA medium-sized XML document with a couple of hundred kilobytes can require a\ncouple of hundred MB to several GB of memory. When the attack is combined\nwith some level of nested expansion an attacker is able to achieve a higher\nratio of success.\n\n::\n\n    <!DOCTYPE bomb [\n    <!ENTITY a \"xxxxxxx... a couple of ten thousand chars\">\n    ]>\n    <bomb>&a;&a;&a;... repeat</bomb>\n\n\nexternal entity expansion (remote)\n----------------------------------\n\nEntity declarations can contain more than just text for replacement. They can\nalso point to external resources by public identifiers or system identifiers.\nSystem identifiers are standard URIs. When the URI is a URL (e.g. a\n``http://`` locator) some parsers download the resource from the remote\nlocation and embed them into the XML document verbatim.\n\nSimple example of a parsed external entity::\n\n    <!DOCTYPE external [\n    <!ENTITY ee SYSTEM \"http://www.python.org/some.xml\">\n    ]>\n    <root>&ee;</root>\n\nThe case of parsed external entities works only for valid XML content. The\nXML standard also supports unparsed external entities with a\n``NData declaration``.\n\nExternal entity expansion opens the door to plenty of exploits. An attacker\ncan abuse a vulnerable XML library and application to rebound and forward\nnetwork requests with the IP address of the server. It highly depends\non the parser and the application what kind of exploit is possible. For\nexample:\n\n* An attacker can circumvent firewalls and gain access to restricted\n  resources as all the requests are made from an internal and trustworthy\n  IP address, not from the outside.\n* An attacker can abuse a service to attack, spy on or DoS your servers but\n  also third party services. The attack is disguised with the IP address of\n  the server and the attacker is able to utilize the high bandwidth of a big\n  machine.\n* An attacker can exhaust additional resources on the machine, e.g. with\n  requests to a service that doesn't respond or responds with very large\n  files.\n* An attacker may gain knowledge, when, how often and from which IP address\n  an XML document is accessed.\n* An attacker could send mail from inside your network if the URL handler\n  supports ``smtp://`` URIs.\n\n\nexternal entity expansion (local file)\n--------------------------------------\n\nExternal entities with references to local files are a sub-case of external\nentity expansion. It's listed as an extra attack because it deserves extra\nattention. Some XML libraries such as lxml disable network access by default\nbut still allow entity expansion with local file access by default. Local\nfiles are either referenced with a ``file://`` URL or by a file path (either\nrelative or absolute).\n\nAn attacker may be able to access and download all files that can be read by\nthe application process. This may include critical configuration files, too.\n\n::\n\n    <!DOCTYPE external [\n    <!ENTITY ee SYSTEM \"file:///PATH/TO/simple.xml\">\n    ]>\n    <root>&ee;</root>\n\n\nDTD retrieval\n-------------\n\nThis case is similar to external entity expansion, too. Some XML libraries\nlike Python's xml.dom.pulldom retrieve document type definitions from remote\nor local locations. Several attack scenarios from the external entity case\napply to this issue as well.\n\n::\n\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n      \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n    <html>\n        <head/>\n        <body>text</body>\n    </html>\n\n\nPython XML Libraries\n====================\n\n.. csv-table:: vulnerabilities and features\n   :header: \"kind\", \"sax\", \"etree\", \"minidom\", \"pulldom\", \"xmlrpc\", \"lxml\", \"genshi\"\n   :widths: 24, 7, 8, 8, 7, 8, 8, 8\n   :stub-columns: 0\n\n   \"billion laughs\", \"**True**\", \"**True**\", \"**True**\", \"**True**\", \"**True**\", \"False (1)\", \"False (5)\"\n   \"quadratic blowup\", \"**True**\", \"**True**\", \"**True**\", \"**True**\", \"**True**\", \"**True**\", \"False (5)\"\n   \"external entity expansion (remote)\", \"**True**\", \"False (3)\", \"False (4)\", \"**True**\", \"false\", \"False (1)\", \"False (5)\"\n   \"external entity expansion (local file)\", \"**True**\", \"False (3)\", \"False (4)\", \"**True**\", \"false\", \"**True**\", \"False (5)\"\n   \"DTD retrieval\", \"**True**\", \"False\", \"False\", \"**True**\", \"false\", \"False (1)\", \"False\"\n   \"gzip bomb\", \"False\", \"False\", \"False\", \"False\", \"**True**\", \"**partly** (2)\", \"False\"\n   \"xpath support (7)\", \"False\", \"False\", \"False\", \"False\", \"False\", \"**True**\", \"False\"\n   \"xsl(t) support (7)\", \"False\", \"False\", \"False\", \"False\", \"False\", \"**True**\", \"False\"\n   \"xinclude support (7)\", \"False\", \"**True** (6)\", \"False\", \"False\", \"False\", \"**True** (6)\", \"**True**\"\n   \"C library\", \"expat\", \"expat\", \"expat\", \"expat\", \"expat\", \"libxml2\", \"expat\"\n\n1. Lxml is protected against billion laughs attacks and doesn't do network\n   lookups by default.\n2. libxml2 and lxml are not directly vulnerable to gzip decompression bombs\n   but they don't protect you against them either.\n3. xml.etree doesn't expand entities and raises a ParserError when an entity\n   occurs.\n4. minidom doesn't expand entities and simply returns the unexpanded entity\n   verbatim.\n5. genshi.input of genshi 0.6 doesn't support entity expansion and raises a\n   ParserError when an entity occurs.\n6. Library has (limited) XInclude support but requires an additional step to\n   process inclusion.\n7. These are features but they may introduce exploitable holes, see\n   `Other things to consider`_\n\n\nSettings in standard library\n----------------------------\n\n\nxml.sax.handler Features\n........................\n\nfeature_external_ges (http://xml.org/sax/features/external-general-entities)\n  disables external entity expansion\n\nfeature_external_pes (http://xml.org/sax/features/external-parameter-entities)\n  the option is ignored and doesn't modify any functionality\n\nDOM xml.dom.xmlbuilder.Options\n..............................\n\nexternal_parameter_entities\n  ignored\n\nexternal_general_entities\n  ignored\n\nexternal_dtd_subset\n  ignored\n\nentities\n  unsure\n\n\ndefusedxml\n==========\n\nThe `defusedxml package`_ (`defusedxml on PyPI`_)\ncontains several Python-only workarounds and fixes\nfor denial of service and other vulnerabilities in Python's XML libraries.\nIn order to benefit from the protection you just have to import and use the\nlisted functions / classes from the right defusedxml module instead of the\noriginal module. Merely `defusedxml.xmlrpc`_ is implemented as monkey patch.\n\nInstead of::\n\n   >>> from xml.etree.ElementTree import parse\n   >>> et = parse(xmlfile)\n\nalter code to::\n\n   >>> from defusedxml.ElementTree import parse\n   >>> et = parse(xmlfile)\n\nAdditionally the package has an **untested** function to monkey patch\nall stdlib modules with ``defusedxml.defuse_stdlib()``.\n\nAll functions and parser classes accept three additional keyword arguments.\nThey return either the same objects as the original functions or compatible\nsubclasses.\n\nforbid_dtd (default: False)\n  disallow XML with a ``<!DOCTYPE>`` processing instruction and raise a\n  *DTDForbidden* exception when a DTD processing instruction is found.\n\nforbid_entities (default: True)\n  disallow XML with ``<!ENTITY>`` declarations inside the DTD and raise an\n  *EntitiesForbidden* exception when an entity is declared.\n\nforbid_external (default: True)\n  disallow any access to remote or local resources in external entities\n  or DTD and raising an *ExternalReferenceForbidden* exception when a DTD\n  or entity references an external resource.\n\n\ndefusedxml (package)\n--------------------\n\nDefusedXmlException, DTDForbidden, EntitiesForbidden,\nExternalReferenceForbidden, NotSupportedError\n\ndefuse_stdlib() (*experimental*)\n\n\ndefusedxml.cElementTree\n-----------------------\n\nparse(), iterparse(), fromstring(), XMLParser\n\n\ndefusedxml.ElementTree\n-----------------------\n\nparse(), iterparse(), fromstring(), XMLParser\n\n\ndefusedxml.expatreader\n----------------------\n\ncreate_parser(), DefusedExpatParser\n\n\ndefusedxml.sax\n--------------\n\nparse(), parseString(), make_parser()\n\n\ndefusedxml.expatbuilder\n-----------------------\n\nparse(), parseString(), DefusedExpatBuilder, DefusedExpatBuilderNS\n\n\ndefusedxml.minidom\n------------------\n\nparse(), parseString()\n\n\ndefusedxml.pulldom\n------------------\n\nparse(), parseString()\n\n\ndefusedxml.xmlrpc\n-----------------\n\nThe fix is implemented as monkey patch for the stdlib's xmlrpc package (3.x)\nor xmlrpclib module (2.x). The function `monkey_patch()` enables the fixes,\n`unmonkey_patch()` removes the patch and puts the code in its former state.\n\nThe monkey patch protects against XML related attacks as well as\ndecompression bombs and excessively large requests or responses. The default\nsetting is 30 MB for requests, responses and gzip decompression. You can\nmodify the default by changing the module variable `MAX_DATA`. A value of\n`-1` disables the limit.\n\n\ndefusedxml.lxml\n---------------\n\n**DEPRECATED** The module is deprecated and will be removed in a future\nrelease.\n\nThe module acts as an *example* how you could protect code that uses\nlxml.etree. It implements a custom Element class that filters out\nEntity instances, a custom parser factory and a thread local storage for\nparser instances. It also has a check_docinfo() function which inspects\na tree for internal or external DTDs and entity declarations. In order to\ncheck for entities lxml > 3.0 is required.\n\nparse(), fromstring()\nRestrictedElement, GlobalParserTLS, getDefaultParser(), check_docinfo()\n\n\ndefusedexpat\n============\n\nThe `defusedexpat package`_ (`defusedexpat on PyPI`_)\ncomes with binary extensions and a\n`modified expat`_ library instead of the standard `expat parser`_. It's\nbasically a stand-alone version of the patches for Python's standard\nlibrary C extensions.\n\nModifications in expat\n----------------------\n\nnew definitions::\n\n  XML_BOMB_PROTECTION\n  XML_DEFAULT_MAX_ENTITY_INDIRECTIONS\n  XML_DEFAULT_MAX_ENTITY_EXPANSIONS\n  XML_DEFAULT_RESET_DTD\n\nnew XML_FeatureEnum members::\n\n  XML_FEATURE_MAX_ENTITY_INDIRECTIONS\n  XML_FEATURE_MAX_ENTITY_EXPANSIONS\n  XML_FEATURE_IGNORE_DTD\n\nnew XML_Error members::\n\n  XML_ERROR_ENTITY_INDIRECTIONS\n  XML_ERROR_ENTITY_EXPANSION\n\nnew API functions::\n\n  int XML_GetFeature(XML_Parser parser,\n                     enum XML_FeatureEnum feature,\n                     long *value);\n  int XML_SetFeature(XML_Parser parser,\n                     enum XML_FeatureEnum feature,\n                     long value);\n  int XML_GetFeatureDefault(enum XML_FeatureEnum feature,\n                            long *value);\n  int XML_SetFeatureDefault(enum XML_FeatureEnum feature,\n                            long value);\n\nXML_FEATURE_MAX_ENTITY_INDIRECTIONS\n   Limit the amount of indirections that are allowed to occur during the\n   expansion of a nested entity. A counter starts when an entity reference\n   is encountered. It resets after the entity is fully expanded. The limit\n   protects the parser against exponential entity expansion attacks (aka\n   billion laughs attack). When the limit is exceeded the parser stops and\n   fails with `XML_ERROR_ENTITY_INDIRECTIONS`.\n   A value of 0 disables the protection.\n\n   Supported range\n     0 .. UINT_MAX\n   Default\n     40\n\nXML_FEATURE_MAX_ENTITY_EXPANSIONS\n   Limit the total length of all entity expansions throughout the entire\n   document. The lengths of all entities are accumulated in a parser variable.\n   The setting protects against quadratic blowup attacks (lots of expansions\n   of a large entity declaration). When the sum of all entities exceeds\n   the limit, the parser stops and fails with `XML_ERROR_ENTITY_EXPANSION`.\n   A value of 0 disables the protection.\n\n   Supported range\n     0 .. UINT_MAX\n   Default\n     8 MiB\n\nXML_FEATURE_RESET_DTD\n   Reset all DTD information after the <!DOCTYPE> block has been parsed. When\n   the flag is set (default: false) all DTD information after the\n   endDoctypeDeclHandler has been called. The flag can be set inside the\n   endDoctypeDeclHandler. Without DTD information any entity reference in\n   the document body leads to `XML_ERROR_UNDEFINED_ENTITY`.\n\n   Supported range\n     0, 1\n   Default\n     0\n\n\nHow to avoid XML vulnerabilities\n================================\n\nBest practices\n--------------\n\n* Don't allow DTDs\n* Don't expand entities\n* Don't resolve externals\n* Limit parse depth\n* Limit total input size\n* Limit parse time\n* Favor a SAX or iterparse-like parser for potential large data\n* Validate and properly quote arguments to XSL transformations and\n  XPath queries\n* Don't use XPath expression from untrusted sources\n* Don't apply XSL transformations that come untrusted sources\n\n(based on Brad Hill's `Attacking XML Security`_)\n\n\nOther things to consider\n========================\n\nXML, XML parsers and processing libraries have more features and possible\nissue that could lead to DoS vulnerabilities or security exploits in\napplications. I have compiled an incomplete list of theoretical issues that\nneed further research and more attention. The list is deliberately pessimistic\nand a bit paranoid, too. It contains things that might go wrong under daffy\ncircumstances.\n\n\nattribute blowup / hash collision attack\n----------------------------------------\n\nXML parsers may use an algorithm with quadratic runtime O(n :sup:`2`) to\nhandle attributes and namespaces. If it uses hash tables (dictionaries) to\nstore attributes and namespaces the implementation may be vulnerable to\nhash collision attacks, thus reducing the performance to O(n :sup:`2`) again.\nIn either case an attacker is able to forge a denial of service attack with\nan XML document that contains thousands upon thousands of attributes in\na single node.\n\nI haven't researched yet if expat, pyexpat or libxml2 are vulnerable.\n\n\ndecompression bomb\n------------------\n\nThe issue of decompression bombs (aka `ZIP bomb`_) apply to all XML libraries\nthat can parse compressed XML stream like gzipped HTTP streams or LZMA-ed\nfiles. For an attacker it can reduce the amount of transmitted data by three\nmagnitudes or more. Gzip is able to compress 1 GiB zeros to roughly 1 MB,\nlzma is even better::\n\n    $ dd if=/dev/zero bs=1M count=1024 | gzip > zeros.gz\n    $ dd if=/dev/zero bs=1M count=1024 | lzma -z > zeros.xy\n    $ ls -sh zeros.*\n    1020K zeros.gz\n     148K zeros.xy\n\nNone of Python's standard XML libraries decompress streams except for\n``xmlrpclib``. The module is vulnerable <https://bugs.python.org/issue16043>\nto decompression bombs.\n\nlxml can load and process compressed data through libxml2 transparently.\nlibxml2 can handle even very large blobs of compressed data efficiently\nwithout using too much memory. But it doesn't protect applications from\ndecompression bombs. A carefully written SAX or iterparse-like approach can\nbe safe.\n\n\nProcessing Instruction\n----------------------\n\n`PI`_'s like::\n\n  <?xml-stylesheet type=\"text/xsl\" href=\"style.xsl\"?>\n\nmay impose more threats for XML processing. It depends if and how a\nprocessor handles processing instructions. The issue of URL retrieval with\nnetwork or local file access apply to processing instructions, too.\n\n\nOther DTD features\n------------------\n\n`DTD`_ has more features like ``<!NOTATION>``. I haven't researched how\nthese features may be a security threat.\n\n\nXPath\n-----\n\nXPath statements may introduce DoS vulnerabilities. Code should never execute\nqueries from untrusted sources. An attacker may also be able to create an XML\ndocument that makes certain XPath queries costly or resource hungry.\n\n\nXPath injection attacks\n-----------------------\n\nXPath injeciton attacks pretty much work like SQL injection attacks.\nArguments to XPath queries must be quoted and validated properly, especially\nwhen they are taken from the user. The page `Avoid the dangers of XPath injection`_\nlist some ramifications of XPath injections.\n\nPython's standard library doesn't have XPath support. Lxml supports\nparameterized XPath queries which does proper quoting. You just have to use\nits xpath() method correctly::\n\n   # DON'T\n   >>> tree.xpath(\"/tag[@id='%s']\" % value)\n\n   # instead do\n   >>> tree.xpath(\"/tag[@id=$tagid]\", tagid=name)\n\n\nXInclude\n--------\n\n`XML Inclusion`_ is another way to load and include external files::\n\n   <root xmlns:xi=\"http://www.w3.org/2001/XInclude\">\n     <xi:include href=\"filename.txt\" parse=\"text\" />\n   </root>\n\nThis feature should be disabled when XML files from an untrusted source are\nprocessed. Some Python XML libraries and libxml2 support XInclude but don't\nhave an option to sandbox inclusion and limit it to allowed directories.\n\n\nXMLSchema location\n------------------\n\nA validating XML parser may download schema files from the information in a\n``xsi:schemaLocation`` attribute.\n\n::\n\n  <ead xmlns=\"urn:isbn:1-931666-22-9\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"urn:isbn:1-931666-22-9 http://www.loc.gov/ead/ead.xsd\">\n  </ead>\n\n\nXSL Transformation\n------------------\n\nYou should keep in mind that XSLT is a Turing complete language. Never\nprocess XSLT code from unknown or untrusted source! XSLT processors may\nallow you to interact with external resources in ways you can't even imagine.\nSome processors even support extensions that allow read/write access to file\nsystem, access to JRE objects or scripting with Jython.\n\nExample from `Attacking XML Security`_ for Xalan-J::\n\n    <xsl:stylesheet version=\"1.0\"\n     xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n     xmlns:rt=\"http://xml.apache.org/xalan/java/java.lang.Runtime\"\n     xmlns:ob=\"http://xml.apache.org/xalan/java/java.lang.Object\"\n     exclude-result-prefixes= \"rt ob\">\n     <xsl:template match=\"/\">\n       <xsl:variable name=\"runtimeObject\" select=\"rt:getRuntime()\"/>\n       <xsl:variable name=\"command\"\n         select=\"rt:exec($runtimeObject, &apos;c:\\Windows\\system32\\cmd.exe&apos;)\"/>\n       <xsl:variable name=\"commandAsString\" select=\"ob:toString($command)\"/>\n       <xsl:value-of select=\"$commandAsString\"/>\n     </xsl:template>\n    </xsl:stylesheet>\n\n\nRelated CVEs\n============\n\nCVE-2013-1664\n  Unrestricted entity expansion induces DoS vulnerabilities in Python XML\n  libraries (XML bomb)\n\nCVE-2013-1665\n  External entity expansion in Python XML libraries inflicts potential\n  security flaws and DoS vulnerabilities\n\n\nOther languages / frameworks\n=============================\n\nSeveral other programming languages and frameworks are vulnerable as well. A\ncouple of them are affected by the fact that libxml2 up to 2.9.0 has no\nprotection against quadratic blowup attacks. Most of them have potential\ndangerous default settings for entity expansion and external entities, too.\n\nPerl\n----\n\nPerl's XML::Simple is vulnerable to quadratic entity expansion and external\nentity expansion (both local and remote).\n\n\nRuby\n----\n\nRuby's REXML document parser is vulnerable to entity expansion attacks\n(both quadratic and exponential) but it doesn't do external entity\nexpansion by default. In order to counteract entity expansion you have to\ndisable the feature::\n\n  REXML::Document.entity_expansion_limit = 0\n\nlibxml-ruby and hpricot don't expand entities in their default configuration.\n\n\nPHP\n---\n\nPHP's SimpleXML API is vulnerable to quadratic entity expansion and loads\nentities from local and remote resources. The option ``LIBXML_NONET`` disables\nnetwork access but still allows local file access. ``LIBXML_NOENT`` seems to\nhave no effect on entity expansion in PHP 5.4.6.\n\n\nC# / .NET / Mono\n----------------\n\nInformation in `XML DoS and Defenses (MSDN)`_ suggest that .NET is\nvulnerable with its default settings. The article contains code snippets\nhow to create a secure XML reader::\n\n  XmlReaderSettings settings = new XmlReaderSettings();\n  settings.ProhibitDtd = false;\n  settings.MaxCharactersFromEntities = 1024;\n  settings.XmlResolver = null;\n  XmlReader reader = XmlReader.Create(stream, settings);\n\n\nJava\n----\n\nUntested. The documentation of Xerces and its `Xerces SecurityMananger`_\nsounds like Xerces is also vulnerable to billion laugh attacks with its\ndefault settings. It also does entity resolving when an\n``org.xml.sax.EntityResolver`` is configured. I'm not yet sure about the\ndefault setting here.\n\nJava specialists suggest to have a custom builder factory::\n\n  DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();\n  builderFactory.setXIncludeAware(False);\n  builderFactory.setExpandEntityReferences(False);\n  builderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, True);\n  # either\n  builderFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", True);\n  # or if you need DTDs\n  builderFactory.setFeature(\"http://xml.org/sax/features/external-general-entities\", False);\n  builderFactory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", False);\n  builderFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", False);\n  builderFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-dtd-grammar\", False);\n\n\nTODO\n====\n\n* DOM: Use xml.dom.xmlbuilder options for entity handling\n* SAX: take feature_external_ges and feature_external_pes (?) into account\n* test experimental monkey patching of stdlib modules\n* improve documentation\n\n\nLicense\n=======\n\nCopyright (c) 2013-2017 by Christian Heimes <christian@python.org>\n\nLicensed to PSF under a Contributor Agreement.\n\nSee https://www.python.org/psf/license for licensing details.\n\n\nAcknowledgements\n================\n\nBrett Cannon (Python Core developer)\n  review and code cleanup\n\nAntoine Pitrou (Python Core developer)\n  code review\n\nAaron Patterson, Ben Murphy and Michael Koziarski (Ruby community)\n  Many thanks to Aaron, Ben and Michael from the Ruby community for their\n  report and assistance.\n\nThierry Carrez (OpenStack)\n  Many thanks to Thierry for his report to the Python Security Response\n  Team on behalf of the OpenStack security team.\n\nCarl Meyer (Django)\n  Many thanks to Carl for his report to PSRT on behalf of the Django security\n  team.\n\nDaniel Veillard (libxml2)\n  Many thanks to Daniel for his insight and assistance with libxml2.\n\nsemantics GmbH (https://www.semantics.de/)\n  Many thanks to my employer semantics for letting me work on the issue\n  during working hours as part of semantics's open source initiative.\n\n\nReferences\n==========\n\n* `XML DoS and Defenses (MSDN)`_\n* `Billion Laughs`_ on Wikipedia\n* `ZIP bomb`_ on Wikipedia\n* `Configure SAX parsers for secure processing`_\n* `Testing for XML Injection`_\n\n.. _defusedxml package: https://github.com/tiran/defusedxml\n.. _defusedxml on PyPI: https://pypi.python.org/pypi/defusedxml\n.. _defusedexpat package: https://github.com/tiran/defusedexpat\n.. _defusedexpat on PyPI: https://pypi.python.org/pypi/defusedexpat\n.. _modified expat: https://github.com/tiran/expat\n.. _expat parser: http://expat.sourceforge.net/\n.. _Attacking XML Security: https://www.isecpartners.com/media/12976/iSEC-HILL-Attacking-XML-Security-bh07.pdf\n.. _Billion Laughs: https://en.wikipedia.org/wiki/Billion_laughs\n.. _XML DoS and Defenses (MSDN): https://msdn.microsoft.com/en-us/magazine/ee335713.aspx\n.. _ZIP bomb: https://en.wikipedia.org/wiki/Zip_bomb\n.. _DTD: https://en.wikipedia.org/wiki/Document_Type_Definition\n.. _PI: https://en.wikipedia.org/wiki/Processing_Instruction\n.. _Avoid the dangers of XPath injection: http://www.ibm.com/developerworks/xml/library/x-xpathinjection/index.html\n.. _Configure SAX parsers for secure processing: http://www.ibm.com/developerworks/xml/library/x-tipcfsx/index.html\n.. _Testing for XML Injection: https://www.owasp.org/index.php/Testing_for_XML_Injection_(OWASP-DV-008)\n.. _Xerces SecurityMananger: https://xerces.apache.org/xerces2-j/javadocs/xerces2/org/apache/xerces/util/SecurityManager.html\n.. _XML Inclusion: https://www.w3.org/TR/xinclude/#include_element\n\nChangelog\n=========\n\ndefusedxml 0.6.0\n----------------\n\n*Release date: 17-Apr-2019*\n\n- Increase test coverage.\n- Add badges to README.\n\n\ndefusedxml 0.6.0rc1\n-------------------\n\n*Release date: 14-Apr-2019*\n\n- Test on Python 3.7 stable and 3.8-dev\n- Drop support for Python 3.4\n- No longer pass *html* argument to XMLParse. It has been deprecated and\n  ignored for a long time. The DefusedXMLParser still takes a html argument.\n  A deprecation warning is issued when the argument is False and a TypeError\n  when it's True.\n- defusedxml now fails early when pyexpat stdlib module is not available or\n  broken.\n- defusedxml.ElementTree.__all__ now lists ParseError as public attribute.\n- The defusedxml.ElementTree and defusedxml.cElementTree modules had a typo\n  and used XMLParse instead of XMLParser as an alias for DefusedXMLParser.\n  Both the old and fixed name are now available.\n\n\ndefusedxml 0.5.0\n----------------\n\n*Release date: 07-Feb-2017*\n\n- No changes\n\n\ndefusedxml 0.5.0.rc1\n--------------------\n\n*Release date: 28-Jan-2017*\n\n- Add compatibility with Python 3.6\n- Drop support for Python 2.6, 3.1, 3.2, 3.3\n- Fix lxml tests (XMLSyntaxError: Detected an entity reference loop)\n\n\ndefusedxml 0.4.1\n----------------\n\n*Release date: 28-Mar-2013*\n\n- Add more demo exploits, e.g. python_external.py and Xalan XSLT demos.\n- Improved documentation.\n\n\ndefusedxml 0.4\n--------------\n\n*Release date: 25-Feb-2013*\n\n- As per http://seclists.org/oss-sec/2013/q1/340 please REJECT\n  CVE-2013-0278, CVE-2013-0279 and CVE-2013-0280 and use CVE-2013-1664,\n  CVE-2013-1665 for OpenStack/etc.\n- Add missing parser_list argument to sax.make_parser(). The argument is\n  ignored, though. (thanks to Florian Apolloner)\n- Add demo exploit for external entity attack on Python's SAX parser, XML-RPC\n  and WebDAV.\n\n\ndefusedxml 0.3\n--------------\n\n*Release date: 19-Feb-2013*\n\n- Improve documentation\n\n\ndefusedxml 0.2\n--------------\n\n*Release date: 15-Feb-2013*\n\n- Rename ExternalEntitiesForbidden to ExternalReferenceForbidden\n- Rename defusedxml.lxml.check_dtd() to check_docinfo()\n- Unify argument names in callbacks\n- Add arguments and formatted representation to exceptions\n- Add forbid_external argument to all functions and classes\n- More tests\n- LOTS of documentation\n- Add example code for other languages (Ruby, Perl, PHP) and parsers (Genshi)\n- Add protection against XML and gzip attacks to xmlrpclib\n\ndefusedxml 0.1\n--------------\n\n*Release date: 08-Feb-2013*\n\n- Initial and internal release for PSRT review\n\n\n", "description_content_type": "", "docs_url": null, "download_url": "https://pypi.python.org/pypi/defusedxml", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/tiran/defusedxml", "keywords": "xml bomb DoS", "license": "PSFL", "maintainer": "Christian Heimes", "maintainer_email": "christian@python.org", "name": "defusedxml", "package_url": "https://pypi.org/project/defusedxml/", "platform": "all", "project_url": "https://pypi.org/project/defusedxml/", "project_urls": {"Download": "https://pypi.python.org/pypi/defusedxml", "Homepage": "https://github.com/tiran/defusedxml"}, "release_url": "https://pypi.org/project/defusedxml/0.6.0/", "requires_dist": null, "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "summary": "XML bomb protection for Python stdlib modules", "version": "0.6.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <a href=\"https://pypi.org/project/defusedxml/\" rel=\"nofollow\"><img alt=\"Latest Version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/513c9752df486c51b8b92b536173ce22c09b7852/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f64656675736564786d6c2e737667\"></a>\n<a href=\"https://pypi.org/project/defusedxml/\" rel=\"nofollow\"><img alt=\"Supported Python versions\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6b0498a9e9a4d25f5cd6a5f11918c8b2157c4cc5/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f64656675736564786d6c2e737667\"></a>\n<a href=\"https://travis-ci.org/tiran/defusedxml\" rel=\"nofollow\"><img alt=\"Travis CI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/5208d7e60b56a10bb970e4ffc1df1d5e1169c923/68747470733a2f2f7472617669732d63692e6f72672f746972616e2f64656675736564786d6c2e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://codecov.io/github/tiran/defusedxml?branch=master\" rel=\"nofollow\"><img alt=\"codecov\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/62ab2b8936f87a1186cd9bc03c44086cae450b58/68747470733a2f2f636f6465636f762e696f2f6769746875622f746972616e2f64656675736564786d6c2f636f7665726167652e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://pypistats.org/packages/defusedxml\" rel=\"nofollow\"><img alt=\"PyPI downloads\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/039bb7d49cce77f74a552845096d02c29d166975/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f64656675736564786d6c2e737667\"></a>\n<a href=\"https://github.com/ambv/black\" rel=\"nofollow\"><img alt=\"Code style: black\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/fbfdc7754183ecf079bc71ddeabaf88f6cbc5c00/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c61636b2d3030303030302e737667\"></a>\n<blockquote>\n\u201cIt\u2019s just XML, what could probably go wrong?\u201d</blockquote>\n<p>Christian Heimes &lt;<a href=\"mailto:christian%40python.org\">christian<span>@</span>python<span>.</span>org</a>&gt;</p>\n<div id=\"synopsis\">\n<h2><a href=\"#id2\" rel=\"nofollow\">Synopsis</a></h2>\n<p>The results of an attack on a vulnerable XML library can be fairly dramatic.\nWith just a few hundred <strong>Bytes</strong> of XML data an attacker can occupy several\n<strong>Gigabytes</strong> of memory within <strong>seconds</strong>. An attacker can also keep\nCPUs busy for a long time with a small to medium size request. Under some\ncircumstances it is even possible to access local files on your\nserver, to circumvent a firewall, or to abuse services to rebound attacks to\nthird parties.</p>\n<p>The attacks use and abuse less common features of XML and its parsers. The\nmajority of developers are unacquainted with features such as processing\ninstructions and entity expansions that XML inherited from SGML. At best\nthey know about <tt>&lt;!DOCTYPE&gt;</tt> from experience with HTML but they are not\naware that a document type definition (DTD) can generate an HTTP request\nor load a file from the file system.</p>\n<p>None of the issues is new. They have been known for a long time. Billion\nlaughs was first reported in 2003. Nevertheless some XML libraries and\napplications are still vulnerable and even heavy users of XML are\nsurprised by these features. It\u2019s hard to say whom to blame for the\nsituation. It\u2019s too short sighted to shift all blame on XML parsers and\nXML libraries for using insecure default settings. After all they\nproperly implement XML specifications. Application developers must not rely\nthat a library is always configured for security and potential harmful data\nby default.</p>\n<div id=\"table-of-contents\">\n<p>Table of Contents</p>\n<ul>\n<li><a href=\"#synopsis\" id=\"id2\" rel=\"nofollow\">Synopsis</a></li>\n<li><a href=\"#attack-vectors\" id=\"id3\" rel=\"nofollow\">Attack vectors</a><ul>\n<li><a href=\"#billion-laughs-exponential-entity-expansion\" id=\"id4\" rel=\"nofollow\">billion laughs / exponential entity expansion</a></li>\n<li><a href=\"#quadratic-blowup-entity-expansion\" id=\"id5\" rel=\"nofollow\">quadratic blowup entity expansion</a></li>\n<li><a href=\"#external-entity-expansion-remote\" id=\"id6\" rel=\"nofollow\">external entity expansion (remote)</a></li>\n<li><a href=\"#external-entity-expansion-local-file\" id=\"id7\" rel=\"nofollow\">external entity expansion (local file)</a></li>\n<li><a href=\"#dtd-retrieval\" id=\"id8\" rel=\"nofollow\">DTD retrieval</a></li>\n</ul>\n</li>\n<li><a href=\"#python-xml-libraries\" id=\"id9\" rel=\"nofollow\">Python XML Libraries</a><ul>\n<li><a href=\"#settings-in-standard-library\" id=\"id10\" rel=\"nofollow\">Settings in standard library</a></li>\n</ul>\n</li>\n<li><a href=\"#defusedxml\" id=\"id11\" rel=\"nofollow\">defusedxml</a><ul>\n<li><a href=\"#defusedxml-package\" id=\"id12\" rel=\"nofollow\">defusedxml (package)</a></li>\n<li><a href=\"#defusedxml-celementtree\" id=\"id13\" rel=\"nofollow\">defusedxml.cElementTree</a></li>\n<li><a href=\"#defusedxml-elementtree\" id=\"id14\" rel=\"nofollow\">defusedxml.ElementTree</a></li>\n<li><a href=\"#defusedxml-expatreader\" id=\"id15\" rel=\"nofollow\">defusedxml.expatreader</a></li>\n<li><a href=\"#defusedxml-sax\" id=\"id16\" rel=\"nofollow\">defusedxml.sax</a></li>\n<li><a href=\"#defusedxml-expatbuilder\" id=\"id17\" rel=\"nofollow\">defusedxml.expatbuilder</a></li>\n<li><a href=\"#defusedxml-minidom\" id=\"id18\" rel=\"nofollow\">defusedxml.minidom</a></li>\n<li><a href=\"#defusedxml-pulldom\" id=\"id19\" rel=\"nofollow\">defusedxml.pulldom</a></li>\n<li><a href=\"#defusedxml-xmlrpc\" id=\"id20\" rel=\"nofollow\">defusedxml.xmlrpc</a></li>\n<li><a href=\"#defusedxml-lxml\" id=\"id21\" rel=\"nofollow\">defusedxml.lxml</a></li>\n</ul>\n</li>\n<li><a href=\"#defusedexpat\" id=\"id22\" rel=\"nofollow\">defusedexpat</a><ul>\n<li><a href=\"#modifications-in-expat\" id=\"id23\" rel=\"nofollow\">Modifications in expat</a></li>\n</ul>\n</li>\n<li><a href=\"#how-to-avoid-xml-vulnerabilities\" id=\"id24\" rel=\"nofollow\">How to avoid XML vulnerabilities</a></li>\n<li><a href=\"#other-things-to-consider\" id=\"id25\" rel=\"nofollow\">Other things to consider</a><ul>\n<li><a href=\"#attribute-blowup-hash-collision-attack\" id=\"id26\" rel=\"nofollow\">attribute blowup / hash collision attack</a></li>\n<li><a href=\"#decompression-bomb\" id=\"id27\" rel=\"nofollow\">decompression bomb</a></li>\n<li><a href=\"#processing-instruction\" id=\"id28\" rel=\"nofollow\">Processing Instruction</a></li>\n<li><a href=\"#other-dtd-features\" id=\"id29\" rel=\"nofollow\">Other DTD features</a></li>\n<li><a href=\"#xpath\" id=\"id30\" rel=\"nofollow\">XPath</a></li>\n<li><a href=\"#xpath-injection-attacks\" id=\"id31\" rel=\"nofollow\">XPath injection attacks</a></li>\n<li><a href=\"#xinclude\" id=\"id32\" rel=\"nofollow\">XInclude</a></li>\n<li><a href=\"#xmlschema-location\" id=\"id33\" rel=\"nofollow\">XMLSchema location</a></li>\n<li><a href=\"#xsl-transformation\" id=\"id34\" rel=\"nofollow\">XSL Transformation</a></li>\n</ul>\n</li>\n<li><a href=\"#related-cves\" id=\"id35\" rel=\"nofollow\">Related CVEs</a></li>\n<li><a href=\"#other-languages-frameworks\" id=\"id36\" rel=\"nofollow\">Other languages / frameworks</a><ul>\n<li><a href=\"#perl\" id=\"id37\" rel=\"nofollow\">Perl</a></li>\n<li><a href=\"#ruby\" id=\"id38\" rel=\"nofollow\">Ruby</a></li>\n<li><a href=\"#php\" id=\"id39\" rel=\"nofollow\">PHP</a></li>\n<li><a href=\"#c-net-mono\" id=\"id40\" rel=\"nofollow\">C# / .NET / Mono</a></li>\n<li><a href=\"#java\" id=\"id41\" rel=\"nofollow\">Java</a></li>\n</ul>\n</li>\n<li><a href=\"#todo\" id=\"id42\" rel=\"nofollow\">TODO</a></li>\n<li><a href=\"#license\" id=\"id43\" rel=\"nofollow\">License</a></li>\n<li><a href=\"#acknowledgements\" id=\"id44\" rel=\"nofollow\">Acknowledgements</a></li>\n<li><a href=\"#references\" id=\"id45\" rel=\"nofollow\">References</a></li>\n<li><a href=\"#changelog\" id=\"id46\" rel=\"nofollow\">Changelog</a><ul>\n<li><a href=\"#defusedxml-0-6-0\" id=\"id47\" rel=\"nofollow\">defusedxml 0.6.0</a></li>\n<li><a href=\"#defusedxml-0-6-0rc1\" id=\"id48\" rel=\"nofollow\">defusedxml 0.6.0rc1</a></li>\n<li><a href=\"#defusedxml-0-5-0\" id=\"id49\" rel=\"nofollow\">defusedxml 0.5.0</a></li>\n<li><a href=\"#defusedxml-0-5-0-rc1\" id=\"id50\" rel=\"nofollow\">defusedxml 0.5.0.rc1</a></li>\n<li><a href=\"#defusedxml-0-4-1\" id=\"id51\" rel=\"nofollow\">defusedxml 0.4.1</a></li>\n<li><a href=\"#defusedxml-0-4\" id=\"id52\" rel=\"nofollow\">defusedxml 0.4</a></li>\n<li><a href=\"#defusedxml-0-3\" id=\"id53\" rel=\"nofollow\">defusedxml 0.3</a></li>\n<li><a href=\"#defusedxml-0-2\" id=\"id54\" rel=\"nofollow\">defusedxml 0.2</a></li>\n<li><a href=\"#defusedxml-0-1\" id=\"id55\" rel=\"nofollow\">defusedxml 0.1</a></li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n<div id=\"attack-vectors\">\n<h2><a href=\"#id3\" rel=\"nofollow\">Attack vectors</a></h2>\n<div id=\"billion-laughs-exponential-entity-expansion\">\n<h3><a href=\"#id4\" rel=\"nofollow\">billion laughs / exponential entity expansion</a></h3>\n<p>The <a href=\"https://en.wikipedia.org/wiki/Billion_laughs\" rel=\"nofollow\">Billion Laughs</a> attack \u2013 also known as exponential entity expansion \u2013\nuses multiple levels of nested entities. The original example uses 9 levels\nof 10 expansions in each level to expand the string <tt>lol</tt> to a string of\n3 * 10 <sup>9</sup> bytes, hence the name \u201cbillion laughs\u201d. The resulting string\noccupies 3 GB (2.79 GiB) of memory; intermediate strings require additional\nmemory. Because most parsers don\u2019t cache the intermediate step for every\nexpansion it is repeated over and over again. It increases the CPU load even\nmore.</p>\n<p>An XML document of just a few hundred bytes can disrupt all services on a\nmachine within seconds.</p>\n<p>Example XML:</p>\n<pre>&lt;!DOCTYPE xmlbomb [\n&lt;!ENTITY a \"1234567890\" &gt;\n&lt;!ENTITY b \"&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;\"&gt;\n&lt;!ENTITY c \"&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;\"&gt;\n&lt;!ENTITY d \"&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;\"&gt;\n]&gt;\n&lt;bomb&gt;&amp;d;&lt;/bomb&gt;\n</pre>\n</div>\n<div id=\"quadratic-blowup-entity-expansion\">\n<h3><a href=\"#id5\" rel=\"nofollow\">quadratic blowup entity expansion</a></h3>\n<p>A quadratic blowup attack is similar to a <a href=\"https://en.wikipedia.org/wiki/Billion_laughs\" rel=\"nofollow\">Billion Laughs</a> attack; it abuses\nentity expansion, too. Instead of nested entities it repeats one large entity\nwith a couple of thousand chars over and over again. The attack isn\u2019t as\nefficient as the exponential case but it avoids triggering countermeasures of\nparsers against heavily nested entities. Some parsers limit the depth and\nbreadth of a single entity but not the total amount of expanded text\nthroughout an entire XML document.</p>\n<p>A medium-sized XML document with a couple of hundred kilobytes can require a\ncouple of hundred MB to several GB of memory. When the attack is combined\nwith some level of nested expansion an attacker is able to achieve a higher\nratio of success.</p>\n<pre>&lt;!DOCTYPE bomb [\n&lt;!ENTITY a \"xxxxxxx... a couple of ten thousand chars\"&gt;\n]&gt;\n&lt;bomb&gt;&amp;a;&amp;a;&amp;a;... repeat&lt;/bomb&gt;\n</pre>\n</div>\n<div id=\"external-entity-expansion-remote\">\n<h3><a href=\"#id6\" rel=\"nofollow\">external entity expansion (remote)</a></h3>\n<p>Entity declarations can contain more than just text for replacement. They can\nalso point to external resources by public identifiers or system identifiers.\nSystem identifiers are standard URIs. When the URI is a URL (e.g. a\n<tt><span class=\"pre\">http://</span></tt> locator) some parsers download the resource from the remote\nlocation and embed them into the XML document verbatim.</p>\n<p>Simple example of a parsed external entity:</p>\n<pre>&lt;!DOCTYPE external [\n&lt;!ENTITY ee SYSTEM \"http://www.python.org/some.xml\"&gt;\n]&gt;\n&lt;root&gt;&amp;ee;&lt;/root&gt;\n</pre>\n<p>The case of parsed external entities works only for valid XML content. The\nXML standard also supports unparsed external entities with a\n<tt>NData declaration</tt>.</p>\n<p>External entity expansion opens the door to plenty of exploits. An attacker\ncan abuse a vulnerable XML library and application to rebound and forward\nnetwork requests with the IP address of the server. It highly depends\non the parser and the application what kind of exploit is possible. For\nexample:</p>\n<ul>\n<li>An attacker can circumvent firewalls and gain access to restricted\nresources as all the requests are made from an internal and trustworthy\nIP address, not from the outside.</li>\n<li>An attacker can abuse a service to attack, spy on or DoS your servers but\nalso third party services. The attack is disguised with the IP address of\nthe server and the attacker is able to utilize the high bandwidth of a big\nmachine.</li>\n<li>An attacker can exhaust additional resources on the machine, e.g. with\nrequests to a service that doesn\u2019t respond or responds with very large\nfiles.</li>\n<li>An attacker may gain knowledge, when, how often and from which IP address\nan XML document is accessed.</li>\n<li>An attacker could send mail from inside your network if the URL handler\nsupports <tt><span class=\"pre\">smtp://</span></tt> URIs.</li>\n</ul>\n</div>\n<div id=\"external-entity-expansion-local-file\">\n<h3><a href=\"#id7\" rel=\"nofollow\">external entity expansion (local file)</a></h3>\n<p>External entities with references to local files are a sub-case of external\nentity expansion. It\u2019s listed as an extra attack because it deserves extra\nattention. Some XML libraries such as lxml disable network access by default\nbut still allow entity expansion with local file access by default. Local\nfiles are either referenced with a <tt><span class=\"pre\">file://</span></tt> URL or by a file path (either\nrelative or absolute).</p>\n<p>An attacker may be able to access and download all files that can be read by\nthe application process. This may include critical configuration files, too.</p>\n<pre>&lt;!DOCTYPE external [\n&lt;!ENTITY ee SYSTEM \"file:///PATH/TO/simple.xml\"&gt;\n]&gt;\n&lt;root&gt;&amp;ee;&lt;/root&gt;\n</pre>\n</div>\n<div id=\"dtd-retrieval\">\n<h3><a href=\"#id8\" rel=\"nofollow\">DTD retrieval</a></h3>\n<p>This case is similar to external entity expansion, too. Some XML libraries\nlike Python\u2019s xml.dom.pulldom retrieve document type definitions from remote\nor local locations. Several attack scenarios from the external entity case\napply to this issue as well.</p>\n<pre>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html&gt;\n    &lt;head/&gt;\n    &lt;body&gt;text&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n</div>\n</div>\n<div id=\"python-xml-libraries\">\n<h2><a href=\"#id9\" rel=\"nofollow\">Python XML Libraries</a></h2>\n<table>\n<caption>vulnerabilities and features</caption>\n<colgroup>\n<col>\n<col>\n<col>\n<col>\n<col>\n<col>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr><th>kind</th>\n<th>sax</th>\n<th>etree</th>\n<th>minidom</th>\n<th>pulldom</th>\n<th>xmlrpc</th>\n<th>lxml</th>\n<th>genshi</th>\n</tr>\n</thead>\n<tbody>\n<tr><td>billion laughs</td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td>False (1)</td>\n<td>False (5)</td>\n</tr>\n<tr><td>quadratic blowup</td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td><strong>True</strong></td>\n<td>False (5)</td>\n</tr>\n<tr><td>external entity expansion (remote)</td>\n<td><strong>True</strong></td>\n<td>False (3)</td>\n<td>False (4)</td>\n<td><strong>True</strong></td>\n<td>false</td>\n<td>False (1)</td>\n<td>False (5)</td>\n</tr>\n<tr><td>external entity expansion (local file)</td>\n<td><strong>True</strong></td>\n<td>False (3)</td>\n<td>False (4)</td>\n<td><strong>True</strong></td>\n<td>false</td>\n<td><strong>True</strong></td>\n<td>False (5)</td>\n</tr>\n<tr><td>DTD retrieval</td>\n<td><strong>True</strong></td>\n<td>False</td>\n<td>False</td>\n<td><strong>True</strong></td>\n<td>false</td>\n<td>False (1)</td>\n<td>False</td>\n</tr>\n<tr><td>gzip bomb</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td><strong>True</strong></td>\n<td><strong>partly</strong> (2)</td>\n<td>False</td>\n</tr>\n<tr><td>xpath support (7)</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td><strong>True</strong></td>\n<td>False</td>\n</tr>\n<tr><td>xsl(t) support (7)</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td><strong>True</strong></td>\n<td>False</td>\n</tr>\n<tr><td>xinclude support (7)</td>\n<td>False</td>\n<td><strong>True</strong> (6)</td>\n<td>False</td>\n<td>False</td>\n<td>False</td>\n<td><strong>True</strong> (6)</td>\n<td><strong>True</strong></td>\n</tr>\n<tr><td>C library</td>\n<td>expat</td>\n<td>expat</td>\n<td>expat</td>\n<td>expat</td>\n<td>expat</td>\n<td>libxml2</td>\n<td>expat</td>\n</tr>\n</tbody>\n</table>\n<ol>\n<li>Lxml is protected against billion laughs attacks and doesn\u2019t do network\nlookups by default.</li>\n<li>libxml2 and lxml are not directly vulnerable to gzip decompression bombs\nbut they don\u2019t protect you against them either.</li>\n<li>xml.etree doesn\u2019t expand entities and raises a ParserError when an entity\noccurs.</li>\n<li>minidom doesn\u2019t expand entities and simply returns the unexpanded entity\nverbatim.</li>\n<li>genshi.input of genshi 0.6 doesn\u2019t support entity expansion and raises a\nParserError when an entity occurs.</li>\n<li>Library has (limited) XInclude support but requires an additional step to\nprocess inclusion.</li>\n<li>These are features but they may introduce exploitable holes, see\n<a href=\"#other-things-to-consider\" rel=\"nofollow\">Other things to consider</a></li>\n</ol>\n<div id=\"settings-in-standard-library\">\n<h3><a href=\"#id10\" rel=\"nofollow\">Settings in standard library</a></h3>\n<div id=\"xml-sax-handler-features\">\n<h4>xml.sax.handler Features</h4>\n<dl>\n<dt>feature_external_ges (<a href=\"http://xml.org/sax/features/external-general-entities\" rel=\"nofollow\">http://xml.org/sax/features/external-general-entities</a>)</dt>\n<dd>disables external entity expansion</dd>\n<dt>feature_external_pes (<a href=\"http://xml.org/sax/features/external-parameter-entities\" rel=\"nofollow\">http://xml.org/sax/features/external-parameter-entities</a>)</dt>\n<dd>the option is ignored and doesn\u2019t modify any functionality</dd>\n</dl>\n</div>\n<div id=\"dom-xml-dom-xmlbuilder-options\">\n<h4>DOM xml.dom.xmlbuilder.Options</h4>\n<dl>\n<dt>external_parameter_entities</dt>\n<dd>ignored</dd>\n<dt>external_general_entities</dt>\n<dd>ignored</dd>\n<dt>external_dtd_subset</dt>\n<dd>ignored</dd>\n<dt>entities</dt>\n<dd>unsure</dd>\n</dl>\n</div>\n</div>\n</div>\n<div id=\"defusedxml\">\n<h2><a href=\"#id11\" rel=\"nofollow\">defusedxml</a></h2>\n<p>The <a href=\"https://github.com/tiran/defusedxml\" rel=\"nofollow\">defusedxml package</a> (<a href=\"https://pypi.python.org/pypi/defusedxml\" rel=\"nofollow\">defusedxml on PyPI</a>)\ncontains several Python-only workarounds and fixes\nfor denial of service and other vulnerabilities in Python\u2019s XML libraries.\nIn order to benefit from the protection you just have to import and use the\nlisted functions / classes from the right defusedxml module instead of the\noriginal module. Merely <a href=\"#defusedxml-xmlrpc\" rel=\"nofollow\">defusedxml.xmlrpc</a> is implemented as monkey patch.</p>\n<p>Instead of:</p>\n<pre>&gt;&gt;&gt; from xml.etree.ElementTree import parse\n&gt;&gt;&gt; et = parse(xmlfile)\n</pre>\n<p>alter code to:</p>\n<pre>&gt;&gt;&gt; from defusedxml.ElementTree import parse\n&gt;&gt;&gt; et = parse(xmlfile)\n</pre>\n<p>Additionally the package has an <strong>untested</strong> function to monkey patch\nall stdlib modules with <tt>defusedxml.defuse_stdlib()</tt>.</p>\n<p>All functions and parser classes accept three additional keyword arguments.\nThey return either the same objects as the original functions or compatible\nsubclasses.</p>\n<dl>\n<dt>forbid_dtd (default: False)</dt>\n<dd>disallow XML with a <tt>&lt;!DOCTYPE&gt;</tt> processing instruction and raise a\n<em>DTDForbidden</em> exception when a DTD processing instruction is found.</dd>\n<dt>forbid_entities (default: True)</dt>\n<dd>disallow XML with <tt>&lt;!ENTITY&gt;</tt> declarations inside the DTD and raise an\n<em>EntitiesForbidden</em> exception when an entity is declared.</dd>\n<dt>forbid_external (default: True)</dt>\n<dd>disallow any access to remote or local resources in external entities\nor DTD and raising an <em>ExternalReferenceForbidden</em> exception when a DTD\nor entity references an external resource.</dd>\n</dl>\n<div id=\"defusedxml-package\">\n<h3><a href=\"#id12\" rel=\"nofollow\">defusedxml (package)</a></h3>\n<p>DefusedXmlException, DTDForbidden, EntitiesForbidden,\nExternalReferenceForbidden, NotSupportedError</p>\n<p>defuse_stdlib() (<em>experimental</em>)</p>\n</div>\n<div id=\"defusedxml-celementtree\">\n<h3><a href=\"#id13\" rel=\"nofollow\">defusedxml.cElementTree</a></h3>\n<p>parse(), iterparse(), fromstring(), XMLParser</p>\n</div>\n<div id=\"defusedxml-elementtree\">\n<h3><a href=\"#id14\" rel=\"nofollow\">defusedxml.ElementTree</a></h3>\n<p>parse(), iterparse(), fromstring(), XMLParser</p>\n</div>\n<div id=\"defusedxml-expatreader\">\n<h3><a href=\"#id15\" rel=\"nofollow\">defusedxml.expatreader</a></h3>\n<p>create_parser(), DefusedExpatParser</p>\n</div>\n<div id=\"defusedxml-sax\">\n<h3><a href=\"#id16\" rel=\"nofollow\">defusedxml.sax</a></h3>\n<p>parse(), parseString(), make_parser()</p>\n</div>\n<div id=\"defusedxml-expatbuilder\">\n<h3><a href=\"#id17\" rel=\"nofollow\">defusedxml.expatbuilder</a></h3>\n<p>parse(), parseString(), DefusedExpatBuilder, DefusedExpatBuilderNS</p>\n</div>\n<div id=\"defusedxml-minidom\">\n<h3><a href=\"#id18\" rel=\"nofollow\">defusedxml.minidom</a></h3>\n<p>parse(), parseString()</p>\n</div>\n<div id=\"defusedxml-pulldom\">\n<h3><a href=\"#id19\" rel=\"nofollow\">defusedxml.pulldom</a></h3>\n<p>parse(), parseString()</p>\n</div>\n<div id=\"defusedxml-xmlrpc\">\n<h3><a href=\"#id20\" rel=\"nofollow\">defusedxml.xmlrpc</a></h3>\n<p>The fix is implemented as monkey patch for the stdlib\u2019s xmlrpc package (3.x)\nor xmlrpclib module (2.x). The function <cite>monkey_patch()</cite> enables the fixes,\n<cite>unmonkey_patch()</cite> removes the patch and puts the code in its former state.</p>\n<p>The monkey patch protects against XML related attacks as well as\ndecompression bombs and excessively large requests or responses. The default\nsetting is 30 MB for requests, responses and gzip decompression. You can\nmodify the default by changing the module variable <cite>MAX_DATA</cite>. A value of\n<cite>-1</cite> disables the limit.</p>\n</div>\n<div id=\"defusedxml-lxml\">\n<h3><a href=\"#id21\" rel=\"nofollow\">defusedxml.lxml</a></h3>\n<p><strong>DEPRECATED</strong> The module is deprecated and will be removed in a future\nrelease.</p>\n<p>The module acts as an <em>example</em> how you could protect code that uses\nlxml.etree. It implements a custom Element class that filters out\nEntity instances, a custom parser factory and a thread local storage for\nparser instances. It also has a check_docinfo() function which inspects\na tree for internal or external DTDs and entity declarations. In order to\ncheck for entities lxml &gt; 3.0 is required.</p>\n<p>parse(), fromstring()\nRestrictedElement, GlobalParserTLS, getDefaultParser(), check_docinfo()</p>\n</div>\n</div>\n<div id=\"defusedexpat\">\n<h2><a href=\"#id22\" rel=\"nofollow\">defusedexpat</a></h2>\n<p>The <a href=\"https://github.com/tiran/defusedexpat\" rel=\"nofollow\">defusedexpat package</a> (<a href=\"https://pypi.python.org/pypi/defusedexpat\" rel=\"nofollow\">defusedexpat on PyPI</a>)\ncomes with binary extensions and a\n<a href=\"https://github.com/tiran/expat\" rel=\"nofollow\">modified expat</a> library instead of the standard <a href=\"http://expat.sourceforge.net/\" rel=\"nofollow\">expat parser</a>. It\u2019s\nbasically a stand-alone version of the patches for Python\u2019s standard\nlibrary C extensions.</p>\n<div id=\"modifications-in-expat\">\n<h3><a href=\"#id23\" rel=\"nofollow\">Modifications in expat</a></h3>\n<p>new definitions:</p>\n<pre>XML_BOMB_PROTECTION\nXML_DEFAULT_MAX_ENTITY_INDIRECTIONS\nXML_DEFAULT_MAX_ENTITY_EXPANSIONS\nXML_DEFAULT_RESET_DTD\n</pre>\n<p>new XML_FeatureEnum members:</p>\n<pre>XML_FEATURE_MAX_ENTITY_INDIRECTIONS\nXML_FEATURE_MAX_ENTITY_EXPANSIONS\nXML_FEATURE_IGNORE_DTD\n</pre>\n<p>new XML_Error members:</p>\n<pre>XML_ERROR_ENTITY_INDIRECTIONS\nXML_ERROR_ENTITY_EXPANSION\n</pre>\n<p>new API functions:</p>\n<pre>int XML_GetFeature(XML_Parser parser,\n                   enum XML_FeatureEnum feature,\n                   long *value);\nint XML_SetFeature(XML_Parser parser,\n                   enum XML_FeatureEnum feature,\n                   long value);\nint XML_GetFeatureDefault(enum XML_FeatureEnum feature,\n                          long *value);\nint XML_SetFeatureDefault(enum XML_FeatureEnum feature,\n                          long value);\n</pre>\n<dl>\n<dt>XML_FEATURE_MAX_ENTITY_INDIRECTIONS</dt>\n<dd><p>Limit the amount of indirections that are allowed to occur during the\nexpansion of a nested entity. A counter starts when an entity reference\nis encountered. It resets after the entity is fully expanded. The limit\nprotects the parser against exponential entity expansion attacks (aka\nbillion laughs attack). When the limit is exceeded the parser stops and\nfails with <cite>XML_ERROR_ENTITY_INDIRECTIONS</cite>.\nA value of 0 disables the protection.</p>\n<dl>\n<dt>Supported range</dt>\n<dd>0 .. UINT_MAX</dd>\n<dt>Default</dt>\n<dd>40</dd>\n</dl>\n</dd>\n<dt>XML_FEATURE_MAX_ENTITY_EXPANSIONS</dt>\n<dd><p>Limit the total length of all entity expansions throughout the entire\ndocument. The lengths of all entities are accumulated in a parser variable.\nThe setting protects against quadratic blowup attacks (lots of expansions\nof a large entity declaration). When the sum of all entities exceeds\nthe limit, the parser stops and fails with <cite>XML_ERROR_ENTITY_EXPANSION</cite>.\nA value of 0 disables the protection.</p>\n<dl>\n<dt>Supported range</dt>\n<dd>0 .. UINT_MAX</dd>\n<dt>Default</dt>\n<dd>8 MiB</dd>\n</dl>\n</dd>\n<dt>XML_FEATURE_RESET_DTD</dt>\n<dd><p>Reset all DTD information after the &lt;!DOCTYPE&gt; block has been parsed. When\nthe flag is set (default: false) all DTD information after the\nendDoctypeDeclHandler has been called. The flag can be set inside the\nendDoctypeDeclHandler. Without DTD information any entity reference in\nthe document body leads to <cite>XML_ERROR_UNDEFINED_ENTITY</cite>.</p>\n<dl>\n<dt>Supported range</dt>\n<dd>0, 1</dd>\n<dt>Default</dt>\n<dd>0</dd>\n</dl>\n</dd>\n</dl>\n</div>\n</div>\n<div id=\"how-to-avoid-xml-vulnerabilities\">\n<h2><a href=\"#id24\" rel=\"nofollow\">How to avoid XML vulnerabilities</a></h2>\n<h2 id=\"best-practices\"><span class=\"section-subtitle\">Best practices</span></h2>\n<ul>\n<li>Don\u2019t allow DTDs</li>\n<li>Don\u2019t expand entities</li>\n<li>Don\u2019t resolve externals</li>\n<li>Limit parse depth</li>\n<li>Limit total input size</li>\n<li>Limit parse time</li>\n<li>Favor a SAX or iterparse-like parser for potential large data</li>\n<li>Validate and properly quote arguments to XSL transformations and\nXPath queries</li>\n<li>Don\u2019t use XPath expression from untrusted sources</li>\n<li>Don\u2019t apply XSL transformations that come untrusted sources</li>\n</ul>\n<p>(based on Brad Hill\u2019s <a href=\"https://www.isecpartners.com/media/12976/iSEC-HILL-Attacking-XML-Security-bh07.pdf\" rel=\"nofollow\">Attacking XML Security</a>)</p>\n</div>\n<div id=\"other-things-to-consider\">\n<h2><a href=\"#id25\" rel=\"nofollow\">Other things to consider</a></h2>\n<p>XML, XML parsers and processing libraries have more features and possible\nissue that could lead to DoS vulnerabilities or security exploits in\napplications. I have compiled an incomplete list of theoretical issues that\nneed further research and more attention. The list is deliberately pessimistic\nand a bit paranoid, too. It contains things that might go wrong under daffy\ncircumstances.</p>\n<div id=\"attribute-blowup-hash-collision-attack\">\n<h3><a href=\"#id26\" rel=\"nofollow\">attribute blowup / hash collision attack</a></h3>\n<p>XML parsers may use an algorithm with quadratic runtime O(n <sup>2</sup>) to\nhandle attributes and namespaces. If it uses hash tables (dictionaries) to\nstore attributes and namespaces the implementation may be vulnerable to\nhash collision attacks, thus reducing the performance to O(n <sup>2</sup>) again.\nIn either case an attacker is able to forge a denial of service attack with\nan XML document that contains thousands upon thousands of attributes in\na single node.</p>\n<p>I haven\u2019t researched yet if expat, pyexpat or libxml2 are vulnerable.</p>\n</div>\n<div id=\"decompression-bomb\">\n<h3><a href=\"#id27\" rel=\"nofollow\">decompression bomb</a></h3>\n<p>The issue of decompression bombs (aka <a href=\"https://en.wikipedia.org/wiki/Zip_bomb\" rel=\"nofollow\">ZIP bomb</a>) apply to all XML libraries\nthat can parse compressed XML stream like gzipped HTTP streams or LZMA-ed\nfiles. For an attacker it can reduce the amount of transmitted data by three\nmagnitudes or more. Gzip is able to compress 1 GiB zeros to roughly 1 MB,\nlzma is even better:</p>\n<pre>$ dd if=/dev/zero bs=1M count=1024 | gzip &gt; zeros.gz\n$ dd if=/dev/zero bs=1M count=1024 | lzma -z &gt; zeros.xy\n$ ls -sh zeros.*\n1020K zeros.gz\n 148K zeros.xy\n</pre>\n<p>None of Python\u2019s standard XML libraries decompress streams except for\n<tt>xmlrpclib</tt>. The module is vulnerable &lt;<a href=\"https://bugs.python.org/issue16043\" rel=\"nofollow\">https://bugs.python.org/issue16043</a>&gt;\nto decompression bombs.</p>\n<p>lxml can load and process compressed data through libxml2 transparently.\nlibxml2 can handle even very large blobs of compressed data efficiently\nwithout using too much memory. But it doesn\u2019t protect applications from\ndecompression bombs. A carefully written SAX or iterparse-like approach can\nbe safe.</p>\n</div>\n<div id=\"processing-instruction\">\n<h3><a href=\"#id28\" rel=\"nofollow\">Processing Instruction</a></h3>\n<p><a href=\"https://en.wikipedia.org/wiki/Processing_Instruction\" rel=\"nofollow\">PI</a>\u2019s like:</p>\n<pre>&lt;?xml-stylesheet type=\"text/xsl\" href=\"style.xsl\"?&gt;\n</pre>\n<p>may impose more threats for XML processing. It depends if and how a\nprocessor handles processing instructions. The issue of URL retrieval with\nnetwork or local file access apply to processing instructions, too.</p>\n</div>\n<div id=\"other-dtd-features\">\n<h3><a href=\"#id29\" rel=\"nofollow\">Other DTD features</a></h3>\n<p><a href=\"https://en.wikipedia.org/wiki/Document_Type_Definition\" rel=\"nofollow\">DTD</a> has more features like <tt>&lt;!NOTATION&gt;</tt>. I haven\u2019t researched how\nthese features may be a security threat.</p>\n</div>\n<div id=\"xpath\">\n<h3><a href=\"#id30\" rel=\"nofollow\">XPath</a></h3>\n<p>XPath statements may introduce DoS vulnerabilities. Code should never execute\nqueries from untrusted sources. An attacker may also be able to create an XML\ndocument that makes certain XPath queries costly or resource hungry.</p>\n</div>\n<div id=\"xpath-injection-attacks\">\n<h3><a href=\"#id31\" rel=\"nofollow\">XPath injection attacks</a></h3>\n<p>XPath injeciton attacks pretty much work like SQL injection attacks.\nArguments to XPath queries must be quoted and validated properly, especially\nwhen they are taken from the user. The page <a href=\"http://www.ibm.com/developerworks/xml/library/x-xpathinjection/index.html\" rel=\"nofollow\">Avoid the dangers of XPath injection</a>\nlist some ramifications of XPath injections.</p>\n<p>Python\u2019s standard library doesn\u2019t have XPath support. Lxml supports\nparameterized XPath queries which does proper quoting. You just have to use\nits xpath() method correctly:</p>\n<pre># DON'T\n&gt;&gt;&gt; tree.xpath(\"/tag[@id='%s']\" % value)\n\n# instead do\n&gt;&gt;&gt; tree.xpath(\"/tag[@id=$tagid]\", tagid=name)\n</pre>\n</div>\n<div id=\"xinclude\">\n<h3><a href=\"#id32\" rel=\"nofollow\">XInclude</a></h3>\n<p><a href=\"https://www.w3.org/TR/xinclude/#include_element\" rel=\"nofollow\">XML Inclusion</a> is another way to load and include external files:</p>\n<pre>&lt;root xmlns:xi=\"http://www.w3.org/2001/XInclude\"&gt;\n  &lt;xi:include href=\"filename.txt\" parse=\"text\" /&gt;\n&lt;/root&gt;\n</pre>\n<p>This feature should be disabled when XML files from an untrusted source are\nprocessed. Some Python XML libraries and libxml2 support XInclude but don\u2019t\nhave an option to sandbox inclusion and limit it to allowed directories.</p>\n</div>\n<div id=\"xmlschema-location\">\n<h3><a href=\"#id33\" rel=\"nofollow\">XMLSchema location</a></h3>\n<p>A validating XML parser may download schema files from the information in a\n<tt>xsi:schemaLocation</tt> attribute.</p>\n<pre>&lt;ead xmlns=\"urn:isbn:1-931666-22-9\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xsi:schemaLocation=\"urn:isbn:1-931666-22-9 http://www.loc.gov/ead/ead.xsd\"&gt;\n&lt;/ead&gt;\n</pre>\n</div>\n<div id=\"xsl-transformation\">\n<h3><a href=\"#id34\" rel=\"nofollow\">XSL Transformation</a></h3>\n<p>You should keep in mind that XSLT is a Turing complete language. Never\nprocess XSLT code from unknown or untrusted source! XSLT processors may\nallow you to interact with external resources in ways you can\u2019t even imagine.\nSome processors even support extensions that allow read/write access to file\nsystem, access to JRE objects or scripting with Jython.</p>\n<p>Example from <a href=\"https://www.isecpartners.com/media/12976/iSEC-HILL-Attacking-XML-Security-bh07.pdf\" rel=\"nofollow\">Attacking XML Security</a> for Xalan-J:</p>\n<pre>&lt;xsl:stylesheet version=\"1.0\"\n xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n xmlns:rt=\"http://xml.apache.org/xalan/java/java.lang.Runtime\"\n xmlns:ob=\"http://xml.apache.org/xalan/java/java.lang.Object\"\n exclude-result-prefixes= \"rt ob\"&gt;\n &lt;xsl:template match=\"/\"&gt;\n   &lt;xsl:variable name=\"runtimeObject\" select=\"rt:getRuntime()\"/&gt;\n   &lt;xsl:variable name=\"command\"\n     select=\"rt:exec($runtimeObject, &amp;apos;c:\\Windows\\system32\\cmd.exe&amp;apos;)\"/&gt;\n   &lt;xsl:variable name=\"commandAsString\" select=\"ob:toString($command)\"/&gt;\n   &lt;xsl:value-of select=\"$commandAsString\"/&gt;\n &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</pre>\n</div>\n</div>\n<div id=\"related-cves\">\n<h2><a href=\"#id35\" rel=\"nofollow\">Related CVEs</a></h2>\n<dl>\n<dt>CVE-2013-1664</dt>\n<dd>Unrestricted entity expansion induces DoS vulnerabilities in Python XML\nlibraries (XML bomb)</dd>\n<dt>CVE-2013-1665</dt>\n<dd>External entity expansion in Python XML libraries inflicts potential\nsecurity flaws and DoS vulnerabilities</dd>\n</dl>\n</div>\n<div id=\"other-languages-frameworks\">\n<h2><a href=\"#id36\" rel=\"nofollow\">Other languages / frameworks</a></h2>\n<p>Several other programming languages and frameworks are vulnerable as well. A\ncouple of them are affected by the fact that libxml2 up to 2.9.0 has no\nprotection against quadratic blowup attacks. Most of them have potential\ndangerous default settings for entity expansion and external entities, too.</p>\n<div id=\"perl\">\n<h3><a href=\"#id37\" rel=\"nofollow\">Perl</a></h3>\n<p>Perl\u2019s XML::Simple is vulnerable to quadratic entity expansion and external\nentity expansion (both local and remote).</p>\n</div>\n<div id=\"ruby\">\n<h3><a href=\"#id38\" rel=\"nofollow\">Ruby</a></h3>\n<p>Ruby\u2019s REXML document parser is vulnerable to entity expansion attacks\n(both quadratic and exponential) but it doesn\u2019t do external entity\nexpansion by default. In order to counteract entity expansion you have to\ndisable the feature:</p>\n<pre>REXML::Document.entity_expansion_limit = 0\n</pre>\n<p>libxml-ruby and hpricot don\u2019t expand entities in their default configuration.</p>\n</div>\n<div id=\"php\">\n<h3><a href=\"#id39\" rel=\"nofollow\">PHP</a></h3>\n<p>PHP\u2019s SimpleXML API is vulnerable to quadratic entity expansion and loads\nentities from local and remote resources. The option <tt>LIBXML_NONET</tt> disables\nnetwork access but still allows local file access. <tt>LIBXML_NOENT</tt> seems to\nhave no effect on entity expansion in PHP 5.4.6.</p>\n</div>\n<div id=\"c-net-mono\">\n<h3><a href=\"#id40\" rel=\"nofollow\">C# / .NET / Mono</a></h3>\n<p>Information in <a href=\"https://msdn.microsoft.com/en-us/magazine/ee335713.aspx\" rel=\"nofollow\">XML DoS and Defenses (MSDN)</a> suggest that .NET is\nvulnerable with its default settings. The article contains code snippets\nhow to create a secure XML reader:</p>\n<pre>XmlReaderSettings settings = new XmlReaderSettings();\nsettings.ProhibitDtd = false;\nsettings.MaxCharactersFromEntities = 1024;\nsettings.XmlResolver = null;\nXmlReader reader = XmlReader.Create(stream, settings);\n</pre>\n</div>\n<div id=\"java\">\n<h3><a href=\"#id41\" rel=\"nofollow\">Java</a></h3>\n<p>Untested. The documentation of Xerces and its <a href=\"https://xerces.apache.org/xerces2-j/javadocs/xerces2/org/apache/xerces/util/SecurityManager.html\" rel=\"nofollow\">Xerces SecurityMananger</a>\nsounds like Xerces is also vulnerable to billion laugh attacks with its\ndefault settings. It also does entity resolving when an\n<tt>org.xml.sax.EntityResolver</tt> is configured. I\u2019m not yet sure about the\ndefault setting here.</p>\n<p>Java specialists suggest to have a custom builder factory:</p>\n<pre>DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();\nbuilderFactory.setXIncludeAware(False);\nbuilderFactory.setExpandEntityReferences(False);\nbuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, True);\n# either\nbuilderFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", True);\n# or if you need DTDs\nbuilderFactory.setFeature(\"http://xml.org/sax/features/external-general-entities\", False);\nbuilderFactory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", False);\nbuilderFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", False);\nbuilderFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-dtd-grammar\", False);\n</pre>\n</div>\n</div>\n<div id=\"todo\">\n<h2><a href=\"#id42\" rel=\"nofollow\">TODO</a></h2>\n<ul>\n<li>DOM: Use xml.dom.xmlbuilder options for entity handling</li>\n<li>SAX: take feature_external_ges and feature_external_pes (?) into account</li>\n<li>test experimental monkey patching of stdlib modules</li>\n<li>improve documentation</li>\n</ul>\n</div>\n<div id=\"license\">\n<h2><a href=\"#id43\" rel=\"nofollow\">License</a></h2>\n<p>Copyright (c) 2013-2017 by Christian Heimes &lt;<a href=\"mailto:christian%40python.org\">christian<span>@</span>python<span>.</span>org</a>&gt;</p>\n<p>Licensed to PSF under a Contributor Agreement.</p>\n<p>See <a href=\"https://www.python.org/psf/license\" rel=\"nofollow\">https://www.python.org/psf/license</a> for licensing details.</p>\n</div>\n<div id=\"acknowledgements\">\n<h2><a href=\"#id44\" rel=\"nofollow\">Acknowledgements</a></h2>\n<dl>\n<dt>Brett Cannon (Python Core developer)</dt>\n<dd>review and code cleanup</dd>\n<dt>Antoine Pitrou (Python Core developer)</dt>\n<dd>code review</dd>\n<dt>Aaron Patterson, Ben Murphy and Michael Koziarski (Ruby community)</dt>\n<dd>Many thanks to Aaron, Ben and Michael from the Ruby community for their\nreport and assistance.</dd>\n<dt>Thierry Carrez (OpenStack)</dt>\n<dd>Many thanks to Thierry for his report to the Python Security Response\nTeam on behalf of the OpenStack security team.</dd>\n<dt>Carl Meyer (Django)</dt>\n<dd>Many thanks to Carl for his report to PSRT on behalf of the Django security\nteam.</dd>\n<dt>Daniel Veillard (libxml2)</dt>\n<dd>Many thanks to Daniel for his insight and assistance with libxml2.</dd>\n<dt>semantics GmbH (<a href=\"https://www.semantics.de/\" rel=\"nofollow\">https://www.semantics.de/</a>)</dt>\n<dd>Many thanks to my employer semantics for letting me work on the issue\nduring working hours as part of semantics\u2019s open source initiative.</dd>\n</dl>\n</div>\n<div id=\"references\">\n<h2><a href=\"#id45\" rel=\"nofollow\">References</a></h2>\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/magazine/ee335713.aspx\" rel=\"nofollow\">XML DoS and Defenses (MSDN)</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Billion_laughs\" rel=\"nofollow\">Billion Laughs</a> on Wikipedia</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Zip_bomb\" rel=\"nofollow\">ZIP bomb</a> on Wikipedia</li>\n<li><a href=\"http://www.ibm.com/developerworks/xml/library/x-tipcfsx/index.html\" rel=\"nofollow\">Configure SAX parsers for secure processing</a></li>\n<li><a href=\"https://www.owasp.org/index.php/Testing_for_XML_Injection_(OWASP-DV-008)\" rel=\"nofollow\">Testing for XML Injection</a></li>\n</ul>\n</div>\n<div id=\"changelog\">\n<h2><a href=\"#id46\" rel=\"nofollow\">Changelog</a></h2>\n<div id=\"defusedxml-0-6-0\">\n<h3><a href=\"#id47\" rel=\"nofollow\">defusedxml 0.6.0</a></h3>\n<p><em>Release date: 17-Apr-2019</em></p>\n<ul>\n<li>Increase test coverage.</li>\n<li>Add badges to README.</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-6-0rc1\">\n<h3><a href=\"#id48\" rel=\"nofollow\">defusedxml 0.6.0rc1</a></h3>\n<p><em>Release date: 14-Apr-2019</em></p>\n<ul>\n<li>Test on Python 3.7 stable and 3.8-dev</li>\n<li>Drop support for Python 3.4</li>\n<li>No longer pass <em>html</em> argument to XMLParse. It has been deprecated and\nignored for a long time. The DefusedXMLParser still takes a html argument.\nA deprecation warning is issued when the argument is False and a TypeError\nwhen it\u2019s True.</li>\n<li>defusedxml now fails early when pyexpat stdlib module is not available or\nbroken.</li>\n<li>defusedxml.ElementTree.__all__ now lists ParseError as public attribute.</li>\n<li>The defusedxml.ElementTree and defusedxml.cElementTree modules had a typo\nand used XMLParse instead of XMLParser as an alias for DefusedXMLParser.\nBoth the old and fixed name are now available.</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-5-0\">\n<h3><a href=\"#id49\" rel=\"nofollow\">defusedxml 0.5.0</a></h3>\n<p><em>Release date: 07-Feb-2017</em></p>\n<ul>\n<li>No changes</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-5-0-rc1\">\n<h3><a href=\"#id50\" rel=\"nofollow\">defusedxml 0.5.0.rc1</a></h3>\n<p><em>Release date: 28-Jan-2017</em></p>\n<ul>\n<li>Add compatibility with Python 3.6</li>\n<li>Drop support for Python 2.6, 3.1, 3.2, 3.3</li>\n<li>Fix lxml tests (XMLSyntaxError: Detected an entity reference loop)</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-4-1\">\n<h3><a href=\"#id51\" rel=\"nofollow\">defusedxml 0.4.1</a></h3>\n<p><em>Release date: 28-Mar-2013</em></p>\n<ul>\n<li>Add more demo exploits, e.g. python_external.py and Xalan XSLT demos.</li>\n<li>Improved documentation.</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-4\">\n<h3><a href=\"#id52\" rel=\"nofollow\">defusedxml 0.4</a></h3>\n<p><em>Release date: 25-Feb-2013</em></p>\n<ul>\n<li>As per <a href=\"http://seclists.org/oss-sec/2013/q1/340\" rel=\"nofollow\">http://seclists.org/oss-sec/2013/q1/340</a> please REJECT\nCVE-2013-0278, CVE-2013-0279 and CVE-2013-0280 and use CVE-2013-1664,\nCVE-2013-1665 for OpenStack/etc.</li>\n<li>Add missing parser_list argument to sax.make_parser(). The argument is\nignored, though. (thanks to Florian Apolloner)</li>\n<li>Add demo exploit for external entity attack on Python\u2019s SAX parser, XML-RPC\nand WebDAV.</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-3\">\n<h3><a href=\"#id53\" rel=\"nofollow\">defusedxml 0.3</a></h3>\n<p><em>Release date: 19-Feb-2013</em></p>\n<ul>\n<li>Improve documentation</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-2\">\n<h3><a href=\"#id54\" rel=\"nofollow\">defusedxml 0.2</a></h3>\n<p><em>Release date: 15-Feb-2013</em></p>\n<ul>\n<li>Rename ExternalEntitiesForbidden to ExternalReferenceForbidden</li>\n<li>Rename defusedxml.lxml.check_dtd() to check_docinfo()</li>\n<li>Unify argument names in callbacks</li>\n<li>Add arguments and formatted representation to exceptions</li>\n<li>Add forbid_external argument to all functions and classes</li>\n<li>More tests</li>\n<li>LOTS of documentation</li>\n<li>Add example code for other languages (Ruby, Perl, PHP) and parsers (Genshi)</li>\n<li>Add protection against XML and gzip attacks to xmlrpclib</li>\n</ul>\n</div>\n<div id=\"defusedxml-0-1\">\n<h3><a href=\"#id55\" rel=\"nofollow\">defusedxml 0.1</a></h3>\n<p><em>Release date: 08-Feb-2013</em></p>\n<ul>\n<li>Initial and internal release for PSRT review</li>\n</ul>\n</div>\n</div>\n\n          </div>"}, "last_serial": 7168026, "releases": {"0.3": [{"comment_text": "", "digests": {"md5": "0d3f8ea5a1bc2c4221ac2d7fc320ae8b", "sha256": "b7e655a01dba57a86fc996aa9b0d10a3d25bdc90a0fc89149125d5fff9a3f469"}, "downloads": -1, "filename": "defusedxml-0.3.tar.gz", "has_sig": true, "md5_digest": "0d3f8ea5a1bc2c4221ac2d7fc320ae8b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 46558, "upload_time": "2013-02-19T15:05:02", "upload_time_iso_8601": "2013-02-19T15:05:02.856156Z", "url": "https://files.pythonhosted.org/packages/b0/11/cb91fd91d878fc993a43236622e29b7bec93bcc3be29b78a0fcd5c87ff38/defusedxml-0.3.tar.gz", "yanked": false}, {"comment_text": "", "digests": {"md5": "ea0eca7e804d5a05c57efd00c3e1ce69", "sha256": "3fb72845179ee44bf4de8eb8863f13fc9140aa1517fc38bd5d89ec41a10e40e0"}, "downloads": -1, "filename": "defusedxml-0.3.zip", "has_sig": true, "md5_digest": "ea0eca7e804d5a05c57efd00c3e1ce69", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 58518, "upload_time": "2013-02-19T15:05:05", "upload_time_iso_8601": "2013-02-19T15:05:05.900986Z", "url": "https://files.pythonhosted.org/packages/e5/f9/e3e703e3141fd4ba1047384015b8d90f924677ce6fabcb03dcd202b738ff/defusedxml-0.3.zip", "yanked": false}], "0.4": [{"comment_text": "", "digests": {"md5": "09873c31ce773d48b8a4759571655a2c", "sha256": "51445f028ed7bd793a1cd2f57b86f071d2072db52cb99e8025107d1c9e2e55d4"}, "downloads": -1, "filename": "defusedxml-0.4.tar.gz", "has_sig": true, "md5_digest": "09873c31ce773d48b8a4759571655a2c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 48324, "upload_time": "2013-02-25T11:09:51", "upload_time_iso_8601": "2013-02-25T11:09:51.057522Z", "url": "https://files.pythonhosted.org/packages/2d/8c/08f34d5d900f1292f5d9b935bfa98a02e1fd6623a51916babda4e0ddb3ab/defusedxml-0.4.tar.gz", "yanked": false}, {"comment_text": "", "digests": {"md5": "c0eaf24125abbdb0c45da13fd87782f1", "sha256": "91418368c30c8dc383c11ccd627a275dea8b8275108541152bb9210c3ac128ec"}, "downloads": -1, "filename": "defusedxml-0.4.zip", "has_sig": true, "md5_digest": "c0eaf24125abbdb0c45da13fd87782f1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 61238, "upload_time": "2013-02-25T11:09:58", "upload_time_iso_8601": "2013-02-25T11:09:58.210285Z", "url": "https://files.pythonhosted.org/packages/7a/4c/a342faf53e7a6db7307b2daa9be6cdbdd701c28d6578e1632e234b888e5e/defusedxml-0.4.zip", "yanked": false}], "0.4.1": [{"comment_text": "", "digests": {"md5": "230a5eff64f878b392478e30376d673a", "sha256": "cd551d5a518b745407635bb85116eb813818ecaf182e773c35b36239fc3f2478"}, "downloads": -1, "filename": "defusedxml-0.4.1.tar.gz", "has_sig": true, "md5_digest": "230a5eff64f878b392478e30376d673a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 48889, "upload_time": "2013-03-28T11:24:21", "upload_time_iso_8601": "2013-03-28T11:24:21.251049Z", "url": "https://files.pythonhosted.org/packages/09/3b/b1afa9649f48517d027e99413fec54f387f648c90156b3cf6451c8cd45f9/defusedxml-0.4.1.tar.gz", "yanked": false}, {"comment_text": "", "digests": {"md5": "a2b7b92d06e5c24d299302f17d21d2b3", "sha256": "1f7e2f6546caba6a52bcd6a6087df60c1cc63cdbc0d9ca3e5d517adcb5823d0c"}, "downloads": -1, "filename": "defusedxml-0.4.1.zip", "has_sig": true, "md5_digest": "a2b7b92d06e5c24d299302f17d21d2b3", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 62003, "upload_time": "2013-03-28T11:24:18", "upload_time_iso_8601": "2013-03-28T11:24:18.442944Z", "url": "https://files.pythonhosted.org/packages/7e/2e/c4262962c776cea315e1ebc8883a58e672064c561da84f4b937cd69219dc/defusedxml-0.4.1.zip", "yanked": false}], "0.5.0": [{"comment_text": "", "digests": {"md5": "37b51c8903a7c7e5060b5773b1694199", "sha256": "702a91ade2968a82beb0db1e0766a6a273f33d4616a6ce8cde475d8e09853b20"}, "downloads": -1, "filename": "defusedxml-0.5.0-py2.py3-none-any.whl", "has_sig": true, "md5_digest": "37b51c8903a7c7e5060b5773b1694199", "packagetype": "bdist_wheel", "python_version": "2.7", "requires_python": null, "size": 33717, "upload_time": "2017-02-09T14:20:10", "upload_time_iso_8601": "2017-02-09T14:20:10.092507Z", "url": "https://files.pythonhosted.org/packages/87/1c/17f3e3935a913dfe2a5ca85fa5ccbef366bfd82eb318b1f75dadbf0affca/defusedxml-0.5.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "7ff1501366c6d1dcd2de8514dc2b755e", "sha256": "24d7f2f94f7f3cb6061acb215685e5125fbcdc40a857eff9de22518820b0a4f4"}, "downloads": -1, "filename": "defusedxml-0.5.0.tar.gz", "has_sig": true, "md5_digest": "7ff1501366c6d1dcd2de8514dc2b755e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 60405, "upload_time": "2017-02-09T14:20:13", "upload_time_iso_8601": "2017-02-09T14:20:13.792385Z", "url": "https://files.pythonhosted.org/packages/74/ba/4ba4e89e21b5a2e267d80736ea674609a0a33cc4435a6d748ef04f1f9374/defusedxml-0.5.0.tar.gz", "yanked": false}], "0.5.0rc1": [{"comment_text": "", "digests": {"md5": "a5a5c5a36fd3ae73650090efd139178c", "sha256": "3fd7a1d9f30d7b9c3edbc07503c169cc18901060e06568d2d2835866b12927d3"}, "downloads": -1, "filename": "defusedxml-0.5.0rc1-py2.py3-none-any.whl", "has_sig": true, "md5_digest": "a5a5c5a36fd3ae73650090efd139178c", "packagetype": "bdist_wheel", "python_version": "2.7", "requires_python": null, "size": 33726, "upload_time": "2017-01-28T13:55:12", "upload_time_iso_8601": "2017-01-28T13:55:12.100675Z", "url": "https://files.pythonhosted.org/packages/37/bb/207c1fc22b68ed4e56cea2a042dc0e256128bad5cef25f20b388a4b55061/defusedxml-0.5.0rc1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "d64fd94318d5ca029d1258beb39021ac", "sha256": "f31b526f618e9b95dd18afb3e537769e1322e3adc47845ba8890dbd7f8949ba4"}, "downloads": -1, "filename": "defusedxml-0.5.0rc1.tar.gz", "has_sig": true, "md5_digest": "d64fd94318d5ca029d1258beb39021ac", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 60341, "upload_time": "2017-01-28T13:55:15", "upload_time_iso_8601": "2017-01-28T13:55:15.664920Z", "url": "https://files.pythonhosted.org/packages/24/a5/351a93b89fa8977abc41603ef0197b48b06e0086c249dd9920baf7129405/defusedxml-0.5.0rc1.tar.gz", "yanked": false}], "0.6.0": [{"comment_text": "", "digests": {"md5": "02efabcb521dcec66151157842090c9e", "sha256": "6687150770438374ab581bb7a1b327a847dd9c5749e396102de3fad4e8a3ef93"}, "downloads": -1, "filename": "defusedxml-0.6.0-py2.py3-none-any.whl", "has_sig": true, "md5_digest": "02efabcb521dcec66151157842090c9e", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 23690, "upload_time": "2019-04-17T21:11:02", "upload_time_iso_8601": "2019-04-17T21:11:02.771669Z", "url": "https://files.pythonhosted.org/packages/06/74/9b387472866358ebc08732de3da6dc48e44b0aacd2ddaa5cb85ab7e986a2/defusedxml-0.6.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "a59741f675c4cba649de40a99f732897", "sha256": "f684034d135af4c6cbb949b8a4d2ed61634515257a67299e5f940fbaa34377f5"}, "downloads": -1, "filename": "defusedxml-0.6.0.tar.gz", "has_sig": true, "md5_digest": "a59741f675c4cba649de40a99f732897", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 62670, "upload_time": "2019-04-17T21:11:06", "upload_time_iso_8601": "2019-04-17T21:11:06.199716Z", "url": "https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz", "yanked": false}], "0.6.0rc1": [{"comment_text": "", "digests": {"md5": "dff9883d3fb0c281308ffc12b63c2827", "sha256": "6c0b1461695877ececd6921a6a330e4392790275c5d6e88fc8ea8261445468b1"}, "downloads": -1, "filename": "defusedxml-0.6.0rc1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "dff9883d3fb0c281308ffc12b63c2827", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 23404, "upload_time": "2019-04-14T12:04:50", "upload_time_iso_8601": "2019-04-14T12:04:50.540088Z", "url": "https://files.pythonhosted.org/packages/2d/f0/428bdfb0fcb0c58711c4a488f95bf957cf9ad0923c37014f405e9582103e/defusedxml-0.6.0rc1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "93ebd1e90c8cb5340c55997171ee8c42", "sha256": "06d4515a8f8965624d6db922093eb11e77fb8f9a9ebedd1c5d6df5a0fcd0a12c"}, "downloads": -1, "filename": "defusedxml-0.6.0rc1.tar.gz", "has_sig": false, "md5_digest": "93ebd1e90c8cb5340c55997171ee8c42", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 47744, "upload_time": "2019-04-14T12:04:52", "upload_time_iso_8601": "2019-04-14T12:04:52.086128Z", "url": "https://files.pythonhosted.org/packages/44/1e/4ff0ef72609c0a1f7a4356abb75aff00501a228ba27a39d77d58ca3a1d1e/defusedxml-0.6.0rc1.tar.gz", "yanked": false}], "0.7.0rc1": [{"comment_text": "", "digests": {"md5": "124a5fa2b78ba966c5767037abfe8d1d", "sha256": "8ede8ba04cf5bf7999e1492fa77df545db83717f52c5eab625f97228ebd539bf"}, "downloads": -1, "filename": "defusedxml-0.7.0rc1-py2.py3-none-any.whl", "has_sig": true, "md5_digest": "124a5fa2b78ba966c5767037abfe8d1d", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 25395, "upload_time": "2020-05-04T21:51:34", "upload_time_iso_8601": "2020-05-04T21:51:34.043137Z", "url": "https://files.pythonhosted.org/packages/17/7f/837dffa94f8822a4c306ab3529f19d0c5f9c844ee507eee9b27f669c65e9/defusedxml-0.7.0rc1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "36c60c7c9bcd7733ca49f7f9d1f525fc", "sha256": "aa621655d72cdd30f57073893b96cd0c3831a85b08b8e4954531bdac47e3e8c8"}, "downloads": -1, "filename": "defusedxml-0.7.0rc1.tar.gz", "has_sig": true, "md5_digest": "36c60c7c9bcd7733ca49f7f9d1f525fc", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 63544, "upload_time": "2020-05-04T21:51:37", "upload_time_iso_8601": "2020-05-04T21:51:37.018572Z", "url": "https://files.pythonhosted.org/packages/0b/1f/ee6045db8376d21a70bae01567917831d56e36a1efa234ea3de68a07ff30/defusedxml-0.7.0rc1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "02efabcb521dcec66151157842090c9e", "sha256": "6687150770438374ab581bb7a1b327a847dd9c5749e396102de3fad4e8a3ef93"}, "downloads": -1, "filename": "defusedxml-0.6.0-py2.py3-none-any.whl", "has_sig": true, "md5_digest": "02efabcb521dcec66151157842090c9e", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 23690, "upload_time": "2019-04-17T21:11:02", "upload_time_iso_8601": "2019-04-17T21:11:02.771669Z", "url": "https://files.pythonhosted.org/packages/06/74/9b387472866358ebc08732de3da6dc48e44b0aacd2ddaa5cb85ab7e986a2/defusedxml-0.6.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "a59741f675c4cba649de40a99f732897", "sha256": "f684034d135af4c6cbb949b8a4d2ed61634515257a67299e5f940fbaa34377f5"}, "downloads": -1, "filename": "defusedxml-0.6.0.tar.gz", "has_sig": true, "md5_digest": "a59741f675c4cba649de40a99f732897", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*", "size": 62670, "upload_time": "2019-04-17T21:11:06", "upload_time_iso_8601": "2019-04-17T21:11:06.199716Z", "url": "https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:39:14 2020"}