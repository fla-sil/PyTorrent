{"info": {"author": "David Nielsen", "author_email": "davidnielsen@id.uff.br", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# pystuff\n\n[![GitHub version](https://badge.fury.io/gh/davidmnielsen%2Fpystuff.svg)](https://badge.fury.io/gh/davidmnielsen%2Fpystuff)  [![PyPI version](https://badge.fury.io/py/pystuff.svg)](https://badge.fury.io/py/pystuff)\n\nSome useful functions for data analysis in python.\n\n- [Introduction](#introduction)\n- [Handling time series](#handling-time-series) \n- [Periodogram](#periodogram)\n- [Principal Component Analysis (PCA)](#principal-component-analysis)\n- [Ensemble Subsampling](#ensemble-subsampling)\n- [Statistics](#statistics)\n\n## Introduction\n\n#### Installation\n```\n$ pip install pystuff\n```\n\n#### Import pystuff\n```python\n>>> import pystuff as ps\n```\n\n#### Import auxiliary packages\n```python\nimport numpy as np\nimport xarray as xr\nimport pandas as pd\nimport matplotlib.pyplot as plt\n```\n\n#### Read example data\n```python\n# ERA-Interim SST anomalies, weighted by sqrt(cos(lat))\npathfile='/work/uo1075/u241292/data/ERAI/atmo/monavg_sst_w2_anom.nc'\nds=xr.open_dataset(pathfile)\nlat=ds['lat'].values\nlon=ds['lon'].values\nmyvar=ds['sst'].values\ntime=pd.to_datetime(ds['time'].values)\n```\n\n## Handling time series\n\n```python\n# Area Average\nnasst, sasst_map = ps.getbox([0,60,280,360],lat,lon,myvar,returnmap=True)\n\n# Standardize (center=True is default)\nnasstn = ps.standardize(nasst)\n\n# Running Mean\nnasstn_rm = ps.runmean(nasstn,window=5*12)\nnasstn_rm_fill = ps.runmean(nasstn,window=5*12,fillaround=True)\n\n# Detrend (redundant with ddreg, to some extent)\n# If returnTrend=False, only detended series is returned\nnasstndt, slope, trend = ps.ddetrend(nasstn, returnTrend=True)\n\n# The trend line can also be taken from:\ntrend2 = ps.ddreg(range(len(nasst)),nasst)\n\n# Annual Mean\nannual=ps.annualmean(nasstndt)\n\n# Low-pass Lanczos Filter\ndt=12 # month\ncutoff=5 # years\nlow, low_nonan = ps.lanczos(nasstndt,dt*cutoff,returnNonan=True)\n\n# Example Plot\nfig = plt.figure(figsize=(9,4.5))\n\nax=fig.add_subplot(1,2,1)\nps.nospines(ax)\nplt.axhline(0,color='grey',ls='--')\nplt.plot(time,nasstn,'b',lw=0.2, label='Monthly NASST')\nplt.plot(time,nasstn_rm,'b',lw=2, label='5-year running mean')\nplt.plot(time,low+trend,'g',lw=2, label='5-year low-pass Lanczos filter')\nplt.plot(time,trend,'-r', lw=2, label='Trend line')\nplt.text(0.1,0.8,'Trend=%.2f std year$^{-1}$' %(float(slope)*12), color='r',\n         transform=plt.gcf().transFigure)\nplt.ylim((-2.5,2.5))\nplt.ylabel('std. units')\nplt.title('NASST')\nplt.title('a', loc='left',fontweight='bold', fontsize=14)\nps.leg(loc='lower right', fontsize=9)\n\nps.usetex(False)\nplt.tight_layout()\nplt.show()\n\nfig.savefig('/home/zmaw/u241292/scripts/python/pystuff/figs/timeseries.png')\t\t\n```\n\n![alt text](https://raw.githubusercontent.com/davidmnielsen/pystuff/master/figs/timeseries.png \"timeseries.png\")\n\n## Periodogram\n\n```python\nfig = plt.figure(figsize=(5,4.5))\n\nax=fig.add_subplot(111)\nps.nospines(ax)\n\n# Calculate yearly periodogram on monthly data (Monte Carlo with 10k iterations)\nf, psd, pctl, max5, meanRed = ps.periods(nasstndt, dt=12, nsim=10000)\n\nplt.plot(f, psd,'b', lw=2, label='NASST Power Spectrum')\nplt.plot(f,meanRed, 'r', lw=2, label='Mean of 10k Red-Noise Spectra')\nplt.plot(f,pctl[:,0], '--k', label='80% Percentile')\nplt.plot(f,pctl[:,1], '-k', label='90% Percentile')\nplt.plot(f,pctl[:,2], '--g', label='95% Percentile')\nplt.plot(f,pctl[:,3], '-g', label='99% Percentile')\nplt.xlabel('Frequency [year$^{-1}$]')\nplt.ylabel('PSD [Units$^{2}$ year]')\nplt.xlim((0,2.5))\nplt.title('Periodogram of NASST')\nplt.title('b', loc='left',fontweight='bold', fontsize=14)\nps.leg(fontsize=10, frameon=True)\n\n# Print maximum periods on graph\nfor i in range(5):\n    t=plt.text(max5[i,0],max5[i,1],'%.0f yr' %round(max5[i,2]), color='blue')\n    t.set_bbox(dict(facecolor='white', alpha=0.5, edgecolor='w'))\n\n\nplt.tight_layout()\nplt.show()\n\nfig.savefig('/home/zmaw/u241292/scripts/python/pystuff/figs/periodogram.png')\n```\n\n![alt text](https://raw.githubusercontent.com/davidmnielsen/pystuff/master/figs/periodogram.png \"periodogram.png\")\n\n## Principal Component Analysis (PCA)\n\n```python\n# Get data from any 3 grid cells\nx1=myvar[:,100,100]\nx2=myvar[:,100,200]\nx3=myvar[:,100,300]\nX=np.transpose([x1,x3,x2]) # np.shape(X) = (468, 3)\n\n# Calculate PCA\nscores, eigenvals, eigenvecs, expl, expl_acc, means, stds, north, loadings = ps.ddpca(X)\n\n# Combo-plot\nfrom matplotlib.gridspec import GridSpec\ngs = GridSpec(nrows=2, ncols=4)\nf=plt.figure(figsize=(6,6))\n\nax=f.add_subplot(gs[0, 0:2])\nps.usetex()\nps.nospines(ax)\nplt.errorbar(np.arange(1,len(expl)+1),expl,yerr=[north,north], fmt='o',color='b',markeredgecolor='b')\nfor i in range(3):\n    plt.text(i+1.2,expl[i],'$%.1f \\pm %.1f$' %(expl[i],north[i]))\nplt.xticks(np.arange(1,len(expl)+1,1))\nplt.xlim((0.5,4))\nplt.xlabel('PC')\nplt.ylabel('Explained Variance [\\%]')\nplt.text(0.6,46.5,'a',fontsize=14,fontweight='heavy')\n\nax=f.add_subplot(gs[0, 2:])\nps.nospines(ax)\nwdt=0.15\nplt.axhline(0,color='k')\nplt.bar(np.arange(3)-wdt,eigenvecs[0,:],facecolor='r',edgecolor='r',width=wdt)\nplt.bar(np.arange(3)    ,eigenvecs[1,:],facecolor='g',edgecolor='g',width=wdt)\nplt.bar(np.arange(3)+wdt,eigenvecs[2,:],facecolor='b',edgecolor='b',width=wdt)\nplt.ylabel('Eigenvector values')\nplt.xticks(np.arange(3)+0.125,['$1$','$2$','$3$'],usetex=True)\nplt.xlabel('PC')\nplt.axvline(0.625,color='lightgrey',ls='--')\nplt.axvline(1.625,color='lightgrey',ls='--')\nplt.text(0.8,0.5,'Series 1',color='r')\nplt.text(0.8,0.4,'Series 2',color='g')\nplt.text(0.8,0.3,'Series 3',color='b')\nplt.text(-0.4,0.9,'b',fontsize=14,fontweight='heavy')\n\nax1=f.add_subplot(gs[1, 1:-1])\nax1.set_xlim((-3,3)); plt.ylim((-3,3))\nax1.set(xlabel='PC1', ylabel='PC2')\nax1.axvline(0,color='k')\nax1.axhline(0,color='k')\nax1.plot(scores[:,0],scores[:,1],'o',markersize=3,\n         markeredgecolor='lightgrey',markerfacecolor='lightgrey')\nax1.text(-2.8,2.5,'c',fontsize=15,fontweight='heavy')\nax2 = ps.twinboth(ax1)\nax2.set_xlim((-1.5,1.5)); plt.ylim((-1.5,1.5))\nax2.set_xlabel('PC1 Loadings', labelpad=3)\nax2.set_ylabel('PC2 Loadings', labelpad=14)\nax2.arrow(0,0,loadings[0,0],loadings[0,1],width=0.005,color='r',lw=2)\nax2.arrow(0,0,loadings[1,0],loadings[1,1],width=0.005,color='g',lw=2)\nax2.arrow(0,0,loadings[2,0],loadings[2,1],width=0.005,color='b',lw=2)\n\nplt.tight_layout()\nplt.show()\n\nf.savefig('figs/pca.png')\n```\n![alt text](https://raw.githubusercontent.com/davidmnielsen/pystuff/master/figs/pca.png \"pca.png\")\n\n## Ensemble Subsampling\n\n```python\n# Create a fake ensemble of nsim members of red noise (preserving the lag-dt) correlation\nnsim=1000\ndt=1\nens=ps.rednoise(len(nasstndt),ps.rhoAlt(nasstndt, dt=dt), nsim=nsim)\n\n# Get Percentiles of Ensemble Spread\nspread=ensPctl(ens,pctl=[0.025,0.975])\n\n# Get the best 5% ensemble members, based on correlation\nbestens, ensmean, nmembers = bestEns(ens,nasstndt,pctl=0.95)\n\n\n# Plot\nf=plt.figure(figsize=(8,6))\n\nax=f.add_subplot(2,1,1)\nps.nospines(ax)\nplt.plot(time, ens,'lightgrey', lw=0.5)\n# plt.fill_between(time, spread[:,0],spread[:,1],facecolor='k',alpha=0.1,label='2 std')\nplt.plot(time, ens[:,1],'lightgrey', lw=1, label='All 10k Ensemble Members')\nplt.plot(time, ens[:,1],'r', lw=0.5, label='Member 1')\nplt.plot(time, np.nanmean(ens,axis=1),'k', lw=2, label='Full Ensemble Mean')\nplt.plot(time, nasstndt,'b',lw=1,label='NASST')\nplt.ylim((-6,6))\nplt.ylabel('s.d.')\nplt.title('Full Ensemble (10k Members)')\nps.leg(loc='upper right', frameon=True)\n\nax=f.add_subplot(2,1,2)\nps.nospines(ax)\nplt.plot(time,bestens[:,0],'lightgrey', label='Best 5\\% of Ensemble (50 members)')\nplt.plot(time,bestens,'lightgrey')\nplt.plot(time,ensmean,'k', lw=2, label='Best Ensemble Mean')\nplt.plot(time,nasstndt,'b',lw=1,label='NASST')\nplt.plot(time,low,'g',lw=2,label='NASST low-pass filt.')\nplt.ylim((-6,6))\nplt.ylabel('s.d.')\nplt.title('Best Ensemble (50 Members)')\nps.leg(loc='upper right', frameon=True)\n\nplt.tight_layout()\nplt.show()\nf.savefig('figs/ensemeble.png')\n```\n![alt text](https://raw.githubusercontent.com/davidmnielsen/pystuff/master/figs/ensemeble.png \"ensemeble.png\")\n\n## Statistics\n\n```python\n# Annual means of monthly values\ny=ps.annualmean(x)\n\n# Autocorrelation of lag 1\nr=ps.rho(x)\n\n# Autocorrelation of lag n\nr=ps.rhoAlt(x,dt=n)\n\n# Rednoise time series\nred=ps.rednoise(length, lag-1 correlation, nsim)\n\n# Value of percentile\nx95=getPercentile(x,pctl=0.95)\n\n# Multiple Linear Regression (Uncertainties based on t-test)\nX = [x1, x2, ... xn]\nfitted, lo, up, r2, r2adj, [coefs] = ps.mlr(X, y, stds=2, returnCoefs=False, printSummary=False)\n\n# Multiple Linear Regression (Uncertainties baed on Bootstrap)\nfitted_0, up, lo, r2adj_0, r2adj_un, [r2_0, r2_unc, coefs_0, coefs] = ps.bootsmlr(X, y, n=1000, conflev=0.95, positions='new', uncertain='Betas', details=False, printSummary=False)\n\n# Predict MLR, using coefs from the two above\npred, lo, up = ps.mlr_predict(X,coefs,stds=2)\n\n# Residuals frmo MLR\nres = ps.mlr_res(X, y)\n\n# Histogram\nbinlims, x_count = ps.ddhist(x,vmin,vmax,binsize, zeronan=True, density=False)\n\n# Order (sort ascending) x and y based on values of x\nxo, yo = ps.order(x,y)\n\n# Horizontal divergence\ndiv = ps.hdivg(u,v,lat,lon,regulargrid=True)\n\n# Vorticity (vertical component of relative vorticity)\nvor = ps.hcurl(u,v,lat,lon,regulargrid=True)\n```\n## Non-pystuff, though nice to copy-and-paste too\n\n```python\n# Save regular grid NetCDF (with Xarray)\nnewds = xr.Dataset(data_vars={'lat'  : (\"lat\", lat),\n                              'lon'  : (\"lon\", lon,\n                              'time' : (\"time\", time),\n                              'slp' : ([\"time\",\"lat\",\"lon\"], slp)})\nnewds['lon'].attrs  = {'standard_name' :'longitude','long_name':'longitude','units': 'degrees_east'   ,'axis': 'X'}\nnewds['lat'].attrs  = {'standard_name' :'latitude' ,'long_name':'latitude' ,'units': 'degrees_north'  ,'axis': 'Y'}\nnewds['time'].attrs = {'standard_name' :'time'     ,'long_name':'time'     ,'units': 'year of January','axis': 'T'}\nnewds['slp'].attrs  = {'standard_name' : 'slp', 'shortname': 'slp', 'units': 'hPa'}\nnewds.to_netcdf('slp.nc') \n\n# Save curvilinear grid (e.g. MPIOM) NetCDF\nnewds = xr.Dataset(data_vars={'lat' : ([\"y\",\"x\"], lat),\n                              'lon' : ([\"y\",\"x\"], lon),\n                              'time' : (\"time\", time,\n                              'dist': ([\"time\",\"y\",\"x\"], dist)})\nnewds['lon'].attrs = {'standard_name':'lon', 'long_name':'longitude','units':'degrees_east', '_CoordinateAxisType':'Lon'}\nnewds['lat'].attrs = {'standard_name':'lat', 'long_name':'latitude' ,'units':'degrees_north','_CoordinateAxisType':'Lat'}\nnewds['time'].attrs = {'standard_name':'time','long_name':'time','units':'hours since 0-01-01 22:40:00','calendar':'365_day' ,'axis':'T'}\nnewds['dist'].attrs = {'standard_name':'dist','long_name':'distances from segment', 'units':'degrees','coordinates':'lon lat'}\nnewds.to_netcdf('distances_MPIOM_LR.nc') \n```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/davidmnielsen/pystuff", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "pystuff", "package_url": "https://pypi.org/project/pystuff/", "platform": "", "project_url": "https://pypi.org/project/pystuff/", "project_urls": {"Homepage": "https://github.com/davidmnielsen/pystuff"}, "release_url": "https://pypi.org/project/pystuff/0.0.6/", "requires_dist": ["numpy", "matplotlib", "xarray", "pandas", "scipy"], "requires_python": "", "summary": "Some useful functions for data analysis in python.", "version": "0.0.6", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>pystuff</h1>\n<p><a href=\"https://badge.fury.io/gh/davidmnielsen%2Fpystuff\" rel=\"nofollow\"><img alt=\"GitHub version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/f8ce397c6bcdb9894e8473ae54b1ab562949e335/68747470733a2f2f62616467652e667572792e696f2f67682f64617669646d6e69656c73656e253246707973747566662e737667\"></a>  <a href=\"https://badge.fury.io/py/pystuff\" rel=\"nofollow\"><img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/07439ba0fdede04e62f3b43b33a8c36b14cbaeae/68747470733a2f2f62616467652e667572792e696f2f70792f707973747566662e737667\"></a></p>\n<p>Some useful functions for data analysis in python.</p>\n<ul>\n<li><a href=\"#introduction\" rel=\"nofollow\">Introduction</a></li>\n<li><a href=\"#handling-time-series\" rel=\"nofollow\">Handling time series</a></li>\n<li><a href=\"#periodogram\" rel=\"nofollow\">Periodogram</a></li>\n<li><a href=\"#principal-component-analysis\" rel=\"nofollow\">Principal Component Analysis (PCA)</a></li>\n<li><a href=\"#ensemble-subsampling\" rel=\"nofollow\">Ensemble Subsampling</a></li>\n<li><a href=\"#statistics\" rel=\"nofollow\">Statistics</a></li>\n</ul>\n<h2>Introduction</h2>\n<h4>Installation</h4>\n<pre><code>$ pip install pystuff\n</code></pre>\n<h4>Import pystuff</h4>\n<pre><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"kn\">import</span> <span class=\"nn\">pystuff</span> <span class=\"k\">as</span> <span class=\"nn\">ps</span>\n</pre>\n<h4>Import auxiliary packages</h4>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">xarray</span> <span class=\"k\">as</span> <span class=\"nn\">xr</span>\n<span class=\"kn\">import</span> <span class=\"nn\">pandas</span> <span class=\"k\">as</span> <span class=\"nn\">pd</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n</pre>\n<h4>Read example data</h4>\n<pre><span class=\"c1\"># ERA-Interim SST anomalies, weighted by sqrt(cos(lat))</span>\n<span class=\"n\">pathfile</span><span class=\"o\">=</span><span class=\"s1\">'/work/uo1075/u241292/data/ERAI/atmo/monavg_sst_w2_anom.nc'</span>\n<span class=\"n\">ds</span><span class=\"o\">=</span><span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">open_dataset</span><span class=\"p\">(</span><span class=\"n\">pathfile</span><span class=\"p\">)</span>\n<span class=\"n\">lat</span><span class=\"o\">=</span><span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'lat'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">values</span>\n<span class=\"n\">lon</span><span class=\"o\">=</span><span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'lon'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">values</span>\n<span class=\"n\">myvar</span><span class=\"o\">=</span><span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'sst'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">values</span>\n<span class=\"n\">time</span><span class=\"o\">=</span><span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">to_datetime</span><span class=\"p\">(</span><span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">)</span>\n</pre>\n<h2>Handling time series</h2>\n<pre><span class=\"c1\"># Area Average</span>\n<span class=\"n\">nasst</span><span class=\"p\">,</span> <span class=\"n\">sasst_map</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">getbox</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">60</span><span class=\"p\">,</span><span class=\"mi\">280</span><span class=\"p\">,</span><span class=\"mi\">360</span><span class=\"p\">],</span><span class=\"n\">lat</span><span class=\"p\">,</span><span class=\"n\">lon</span><span class=\"p\">,</span><span class=\"n\">myvar</span><span class=\"p\">,</span><span class=\"n\">returnmap</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Standardize (center=True is default)</span>\n<span class=\"n\">nasstn</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">standardize</span><span class=\"p\">(</span><span class=\"n\">nasst</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Running Mean</span>\n<span class=\"n\">nasstn_rm</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">runmean</span><span class=\"p\">(</span><span class=\"n\">nasstn</span><span class=\"p\">,</span><span class=\"n\">window</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"o\">*</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">nasstn_rm_fill</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">runmean</span><span class=\"p\">(</span><span class=\"n\">nasstn</span><span class=\"p\">,</span><span class=\"n\">window</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"o\">*</span><span class=\"mi\">12</span><span class=\"p\">,</span><span class=\"n\">fillaround</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Detrend (redundant with ddreg, to some extent)</span>\n<span class=\"c1\"># If returnTrend=False, only detended series is returned</span>\n<span class=\"n\">nasstndt</span><span class=\"p\">,</span> <span class=\"n\">slope</span><span class=\"p\">,</span> <span class=\"n\">trend</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">ddetrend</span><span class=\"p\">(</span><span class=\"n\">nasstn</span><span class=\"p\">,</span> <span class=\"n\">returnTrend</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># The trend line can also be taken from:</span>\n<span class=\"n\">trend2</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">ddreg</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nasst</span><span class=\"p\">)),</span><span class=\"n\">nasst</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Annual Mean</span>\n<span class=\"n\">annual</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">annualmean</span><span class=\"p\">(</span><span class=\"n\">nasstndt</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Low-pass Lanczos Filter</span>\n<span class=\"n\">dt</span><span class=\"o\">=</span><span class=\"mi\">12</span> <span class=\"c1\"># month</span>\n<span class=\"n\">cutoff</span><span class=\"o\">=</span><span class=\"mi\">5</span> <span class=\"c1\"># years</span>\n<span class=\"n\">low</span><span class=\"p\">,</span> <span class=\"n\">low_nonan</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">lanczos</span><span class=\"p\">(</span><span class=\"n\">nasstndt</span><span class=\"p\">,</span><span class=\"n\">dt</span><span class=\"o\">*</span><span class=\"n\">cutoff</span><span class=\"p\">,</span><span class=\"n\">returnNonan</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Example Plot</span>\n<span class=\"n\">fig</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">,</span><span class=\"mf\">4.5</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'grey'</span><span class=\"p\">,</span><span class=\"n\">ls</span><span class=\"o\">=</span><span class=\"s1\">'--'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">nasstn</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Monthly NASST'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">nasstn_rm</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'5-year running mean'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">low</span><span class=\"o\">+</span><span class=\"n\">trend</span><span class=\"p\">,</span><span class=\"s1\">'g'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'5-year low-pass Lanczos filter'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">trend</span><span class=\"p\">,</span><span class=\"s1\">'-r'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Trend line'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span><span class=\"mf\">0.8</span><span class=\"p\">,</span><span class=\"s1\">'Trend=</span><span class=\"si\">%.2f</span><span class=\"s1\"> std year$^{-1}$'</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"nb\">float</span><span class=\"p\">(</span><span class=\"n\">slope</span><span class=\"p\">)</span><span class=\"o\">*</span><span class=\"mi\">12</span><span class=\"p\">),</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'r'</span><span class=\"p\">,</span>\n         <span class=\"n\">transform</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">gcf</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">transFigure</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mf\">2.5</span><span class=\"p\">,</span><span class=\"mf\">2.5</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'std. units'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'NASST'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'a'</span><span class=\"p\">,</span> <span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">'left'</span><span class=\"p\">,</span><span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">'bold'</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">leg</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">'lower right'</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">)</span>\n\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">usetex</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">'/home/zmaw/u241292/scripts/python/pystuff/figs/timeseries.png'</span><span class=\"p\">)</span>\t\t\n</pre>\n<p><img alt=\"alt text\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6dbdc939a1f2e4f302d411cf0adf8b3ab5c8156c/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f64617669646d6e69656c73656e2f707973747566662f6d61737465722f666967732f74696d657365726965732e706e67\"></p>\n<h2>Periodogram</h2>\n<pre><span class=\"n\">fig</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"mf\">4.5</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"mi\">111</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Calculate yearly periodogram on monthly data (Monte Carlo with 10k iterations)</span>\n<span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">psd</span><span class=\"p\">,</span> <span class=\"n\">pctl</span><span class=\"p\">,</span> <span class=\"n\">max5</span><span class=\"p\">,</span> <span class=\"n\">meanRed</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">periods</span><span class=\"p\">(</span><span class=\"n\">nasstndt</span><span class=\"p\">,</span> <span class=\"n\">dt</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">nsim</span><span class=\"o\">=</span><span class=\"mi\">10000</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">psd</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'NASST Power Spectrum'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span><span class=\"n\">meanRed</span><span class=\"p\">,</span> <span class=\"s1\">'r'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Mean of 10k Red-Noise Spectra'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"p\">[:,</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"s1\">'--k'</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'80% Percentile'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"p\">[:,</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s1\">'-k'</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'90% Percentile'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"p\">[:,</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"s1\">'--g'</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'95% Percentile'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"p\">[:,</span><span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"s1\">'-g'</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'99% Percentile'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlabel</span><span class=\"p\">(</span><span class=\"s1\">'Frequency [year$^{-1}$]'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'PSD [Units$^</span><span class=\"si\">{2}</span><span class=\"s1\">$ year]'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlim</span><span class=\"p\">((</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mf\">2.5</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'Periodogram of NASST'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'b'</span><span class=\"p\">,</span> <span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">'left'</span><span class=\"p\">,</span><span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">'bold'</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">leg</span><span class=\"p\">(</span><span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">frameon</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Print maximum periods on graph</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">):</span>\n    <span class=\"n\">t</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">max5</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"n\">max5</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"s1\">'</span><span class=\"si\">%.0f</span><span class=\"s1\"> yr'</span> <span class=\"o\">%</span><span class=\"nb\">round</span><span class=\"p\">(</span><span class=\"n\">max5</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">]),</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'blue'</span><span class=\"p\">)</span>\n    <span class=\"n\">t</span><span class=\"o\">.</span><span class=\"n\">set_bbox</span><span class=\"p\">(</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">'white'</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">'w'</span><span class=\"p\">))</span>\n\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">'/home/zmaw/u241292/scripts/python/pystuff/figs/periodogram.png'</span><span class=\"p\">)</span>\n</pre>\n<p><img alt=\"alt text\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/e3057492d3bdb57501e80545494b57ee0c38eca1/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f64617669646d6e69656c73656e2f707973747566662f6d61737465722f666967732f706572696f646f6772616d2e706e67\"></p>\n<h2>Principal Component Analysis (PCA)</h2>\n<pre><span class=\"c1\"># Get data from any 3 grid cells</span>\n<span class=\"n\">x1</span><span class=\"o\">=</span><span class=\"n\">myvar</span><span class=\"p\">[:,</span><span class=\"mi\">100</span><span class=\"p\">,</span><span class=\"mi\">100</span><span class=\"p\">]</span>\n<span class=\"n\">x2</span><span class=\"o\">=</span><span class=\"n\">myvar</span><span class=\"p\">[:,</span><span class=\"mi\">100</span><span class=\"p\">,</span><span class=\"mi\">200</span><span class=\"p\">]</span>\n<span class=\"n\">x3</span><span class=\"o\">=</span><span class=\"n\">myvar</span><span class=\"p\">[:,</span><span class=\"mi\">100</span><span class=\"p\">,</span><span class=\"mi\">300</span><span class=\"p\">]</span>\n<span class=\"n\">X</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">transpose</span><span class=\"p\">([</span><span class=\"n\">x1</span><span class=\"p\">,</span><span class=\"n\">x3</span><span class=\"p\">,</span><span class=\"n\">x2</span><span class=\"p\">])</span> <span class=\"c1\"># np.shape(X) = (468, 3)</span>\n\n<span class=\"c1\"># Calculate PCA</span>\n<span class=\"n\">scores</span><span class=\"p\">,</span> <span class=\"n\">eigenvals</span><span class=\"p\">,</span> <span class=\"n\">eigenvecs</span><span class=\"p\">,</span> <span class=\"n\">expl</span><span class=\"p\">,</span> <span class=\"n\">expl_acc</span><span class=\"p\">,</span> <span class=\"n\">means</span><span class=\"p\">,</span> <span class=\"n\">stds</span><span class=\"p\">,</span> <span class=\"n\">north</span><span class=\"p\">,</span> <span class=\"n\">loadings</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">ddpca</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Combo-plot</span>\n<span class=\"kn\">from</span> <span class=\"nn\">matplotlib.gridspec</span> <span class=\"kn\">import</span> <span class=\"n\">GridSpec</span>\n<span class=\"n\">gs</span> <span class=\"o\">=</span> <span class=\"n\">GridSpec</span><span class=\"p\">(</span><span class=\"n\">nrows</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">ncols</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">)</span>\n<span class=\"n\">f</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"n\">gs</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">usetex</span><span class=\"p\">()</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">errorbar</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">expl</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">),</span><span class=\"n\">expl</span><span class=\"p\">,</span><span class=\"n\">yerr</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">north</span><span class=\"p\">,</span><span class=\"n\">north</span><span class=\"p\">],</span> <span class=\"n\">fmt</span><span class=\"o\">=</span><span class=\"s1\">'o'</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">markeredgecolor</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">):</span>\n    <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"mf\">1.2</span><span class=\"p\">,</span><span class=\"n\">expl</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span><span class=\"s1\">'$</span><span class=\"si\">%.1f</span><span class=\"s1\"> \\pm </span><span class=\"si\">%.1f</span><span class=\"s1\">$'</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">expl</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span><span class=\"n\">north</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xticks</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">expl</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlim</span><span class=\"p\">((</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlabel</span><span class=\"p\">(</span><span class=\"s1\">'PC'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'Explained Variance [\\%]'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.6</span><span class=\"p\">,</span><span class=\"mf\">46.5</span><span class=\"p\">,</span><span class=\"s1\">'a'</span><span class=\"p\">,</span><span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span><span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">'heavy'</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"n\">gs</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">:])</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n<span class=\"n\">wdt</span><span class=\"o\">=</span><span class=\"mf\">0.15</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'k'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">)</span><span class=\"o\">-</span><span class=\"n\">wdt</span><span class=\"p\">,</span><span class=\"n\">eigenvecs</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,:],</span><span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">'r'</span><span class=\"p\">,</span><span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">'r'</span><span class=\"p\">,</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">wdt</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">)</span>    <span class=\"p\">,</span><span class=\"n\">eigenvecs</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,:],</span><span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">'g'</span><span class=\"p\">,</span><span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">'g'</span><span class=\"p\">,</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">wdt</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"n\">wdt</span><span class=\"p\">,</span><span class=\"n\">eigenvecs</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,:],</span><span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">wdt</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'Eigenvector values'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xticks</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"mf\">0.125</span><span class=\"p\">,[</span><span class=\"s1\">'$1$'</span><span class=\"p\">,</span><span class=\"s1\">'$2$'</span><span class=\"p\">,</span><span class=\"s1\">'$3$'</span><span class=\"p\">],</span><span class=\"n\">usetex</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlabel</span><span class=\"p\">(</span><span class=\"s1\">'PC'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"mf\">0.625</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span><span class=\"n\">ls</span><span class=\"o\">=</span><span class=\"s1\">'--'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"mf\">1.625</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span><span class=\"n\">ls</span><span class=\"o\">=</span><span class=\"s1\">'--'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.8</span><span class=\"p\">,</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"s1\">'Series 1'</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'r'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.8</span><span class=\"p\">,</span><span class=\"mf\">0.4</span><span class=\"p\">,</span><span class=\"s1\">'Series 2'</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'g'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.8</span><span class=\"p\">,</span><span class=\"mf\">0.3</span><span class=\"p\">,</span><span class=\"s1\">'Series 3'</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.4</span><span class=\"p\">,</span><span class=\"mf\">0.9</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span><span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">'heavy'</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax1</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"n\">gs</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">));</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"n\">xlabel</span><span class=\"o\">=</span><span class=\"s1\">'PC1'</span><span class=\"p\">,</span> <span class=\"n\">ylabel</span><span class=\"o\">=</span><span class=\"s1\">'PC2'</span><span class=\"p\">)</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'k'</span><span class=\"p\">)</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'k'</span><span class=\"p\">)</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">scores</span><span class=\"p\">[:,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"n\">scores</span><span class=\"p\">[:,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"s1\">'o'</span><span class=\"p\">,</span><span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span>\n         <span class=\"n\">markeredgecolor</span><span class=\"o\">=</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span><span class=\"n\">markerfacecolor</span><span class=\"o\">=</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">)</span>\n<span class=\"n\">ax1</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">2.8</span><span class=\"p\">,</span><span class=\"mf\">2.5</span><span class=\"p\">,</span><span class=\"s1\">'c'</span><span class=\"p\">,</span><span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">15</span><span class=\"p\">,</span><span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">'heavy'</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">twinboth</span><span class=\"p\">(</span><span class=\"n\">ax1</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mf\">1.5</span><span class=\"p\">,</span><span class=\"mf\">1.5</span><span class=\"p\">));</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mf\">1.5</span><span class=\"p\">,</span><span class=\"mf\">1.5</span><span class=\"p\">))</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">'PC1 Loadings'</span><span class=\"p\">,</span> <span class=\"n\">labelpad</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">'PC2 Loadings'</span><span class=\"p\">,</span> <span class=\"n\">labelpad</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">arrow</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"mf\">0.005</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'r'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">arrow</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"mf\">0.005</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'g'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">arrow</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"n\">loadings</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"mf\">0.005</span><span class=\"p\">,</span><span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">'figs/pca.png'</span><span class=\"p\">)</span>\n</pre>\n<p><img alt=\"alt text\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/79b05db53fd677b701bcbd5b75e58779a3179f44/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f64617669646d6e69656c73656e2f707973747566662f6d61737465722f666967732f7063612e706e67\"></p>\n<h2>Ensemble Subsampling</h2>\n<pre><span class=\"c1\"># Create a fake ensemble of nsim members of red noise (preserving the lag-dt) correlation</span>\n<span class=\"n\">nsim</span><span class=\"o\">=</span><span class=\"mi\">1000</span>\n<span class=\"n\">dt</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">ens</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">rednoise</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nasstndt</span><span class=\"p\">),</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">rhoAlt</span><span class=\"p\">(</span><span class=\"n\">nasstndt</span><span class=\"p\">,</span> <span class=\"n\">dt</span><span class=\"o\">=</span><span class=\"n\">dt</span><span class=\"p\">),</span> <span class=\"n\">nsim</span><span class=\"o\">=</span><span class=\"n\">nsim</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Get Percentiles of Ensemble Spread</span>\n<span class=\"n\">spread</span><span class=\"o\">=</span><span class=\"n\">ensPctl</span><span class=\"p\">(</span><span class=\"n\">ens</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mf\">0.025</span><span class=\"p\">,</span><span class=\"mf\">0.975</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Get the best 5% ensemble members, based on correlation</span>\n<span class=\"n\">bestens</span><span class=\"p\">,</span> <span class=\"n\">ensmean</span><span class=\"p\">,</span> <span class=\"n\">nmembers</span> <span class=\"o\">=</span> <span class=\"n\">bestEns</span><span class=\"p\">(</span><span class=\"n\">ens</span><span class=\"p\">,</span><span class=\"n\">nasstndt</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"o\">=</span><span class=\"mf\">0.95</span><span class=\"p\">)</span>\n\n\n<span class=\"c1\"># Plot</span>\n<span class=\"n\">f</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">8</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">ens</span><span class=\"p\">,</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"c1\"># plt.fill_between(time, spread[:,0],spread[:,1],facecolor='k',alpha=0.1,label='2 std')</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">ens</span><span class=\"p\">[:,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'All 10k Ensemble Members'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">ens</span><span class=\"p\">[:,</span><span class=\"mi\">1</span><span class=\"p\">],</span><span class=\"s1\">'r'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Member 1'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nanmean</span><span class=\"p\">(</span><span class=\"n\">ens</span><span class=\"p\">,</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">),</span><span class=\"s1\">'k'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Full Ensemble Mean'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">nasstndt</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'NASST'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'s.d.'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'Full Ensemble (10k Members)'</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">leg</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">'upper right'</span><span class=\"p\">,</span> <span class=\"n\">frameon</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">add_subplot</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">nospines</span><span class=\"p\">(</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">bestens</span><span class=\"p\">[:,</span><span class=\"mi\">0</span><span class=\"p\">],</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Best 5\\</span><span class=\"si\">% o</span><span class=\"s1\">f Ensemble (50 members)'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">bestens</span><span class=\"p\">,</span><span class=\"s1\">'lightgrey'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">ensmean</span><span class=\"p\">,</span><span class=\"s1\">'k'</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'Best Ensemble Mean'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">nasstndt</span><span class=\"p\">,</span><span class=\"s1\">'b'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'NASST'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span><span class=\"n\">low</span><span class=\"p\">,</span><span class=\"s1\">'g'</span><span class=\"p\">,</span><span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">'NASST low-pass filt.'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylim</span><span class=\"p\">((</span><span class=\"o\">-</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s1\">'s.d.'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'Best Ensemble (50 Members)'</span><span class=\"p\">)</span>\n<span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">leg</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">'upper right'</span><span class=\"p\">,</span> <span class=\"n\">frameon</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">'figs/ensemeble.png'</span><span class=\"p\">)</span>\n</pre>\n<p><img alt=\"alt text\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c70d21aa52b4292e0309dba3d1c0999182947722/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f64617669646d6e69656c73656e2f707973747566662f6d61737465722f666967732f656e73656d65626c652e706e67\"></p>\n<h2>Statistics</h2>\n<pre><span class=\"c1\"># Annual means of monthly values</span>\n<span class=\"n\">y</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">annualmean</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Autocorrelation of lag 1</span>\n<span class=\"n\">r</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">rho</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Autocorrelation of lag n</span>\n<span class=\"n\">r</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">rhoAlt</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">dt</span><span class=\"o\">=</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Rednoise time series</span>\n<span class=\"n\">red</span><span class=\"o\">=</span><span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">rednoise</span><span class=\"p\">(</span><span class=\"n\">length</span><span class=\"p\">,</span> <span class=\"n\">lag</span><span class=\"o\">-</span><span class=\"mi\">1</span> <span class=\"n\">correlation</span><span class=\"p\">,</span> <span class=\"n\">nsim</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Value of percentile</span>\n<span class=\"n\">x95</span><span class=\"o\">=</span><span class=\"n\">getPercentile</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">pctl</span><span class=\"o\">=</span><span class=\"mf\">0.95</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Multiple Linear Regression (Uncertainties based on t-test)</span>\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">x1</span><span class=\"p\">,</span> <span class=\"n\">x2</span><span class=\"p\">,</span> <span class=\"o\">...</span> <span class=\"n\">xn</span><span class=\"p\">]</span>\n<span class=\"n\">fitted</span><span class=\"p\">,</span> <span class=\"n\">lo</span><span class=\"p\">,</span> <span class=\"n\">up</span><span class=\"p\">,</span> <span class=\"n\">r2</span><span class=\"p\">,</span> <span class=\"n\">r2adj</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">coefs</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">mlr</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">stds</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">returnCoefs</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">printSummary</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Multiple Linear Regression (Uncertainties baed on Bootstrap)</span>\n<span class=\"n\">fitted_0</span><span class=\"p\">,</span> <span class=\"n\">up</span><span class=\"p\">,</span> <span class=\"n\">lo</span><span class=\"p\">,</span> <span class=\"n\">r2adj_0</span><span class=\"p\">,</span> <span class=\"n\">r2adj_un</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">r2_0</span><span class=\"p\">,</span> <span class=\"n\">r2_unc</span><span class=\"p\">,</span> <span class=\"n\">coefs_0</span><span class=\"p\">,</span> <span class=\"n\">coefs</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">bootsmlr</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"n\">conflev</span><span class=\"o\">=</span><span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"n\">positions</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">uncertain</span><span class=\"o\">=</span><span class=\"s1\">'Betas'</span><span class=\"p\">,</span> <span class=\"n\">details</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">printSummary</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Predict MLR, using coefs from the two above</span>\n<span class=\"n\">pred</span><span class=\"p\">,</span> <span class=\"n\">lo</span><span class=\"p\">,</span> <span class=\"n\">up</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">mlr_predict</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span><span class=\"n\">coefs</span><span class=\"p\">,</span><span class=\"n\">stds</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Residuals frmo MLR</span>\n<span class=\"n\">res</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">mlr_res</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Histogram</span>\n<span class=\"n\">binlims</span><span class=\"p\">,</span> <span class=\"n\">x_count</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">ddhist</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">vmin</span><span class=\"p\">,</span><span class=\"n\">vmax</span><span class=\"p\">,</span><span class=\"n\">binsize</span><span class=\"p\">,</span> <span class=\"n\">zeronan</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Order (sort ascending) x and y based on values of x</span>\n<span class=\"n\">xo</span><span class=\"p\">,</span> <span class=\"n\">yo</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">order</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">y</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Horizontal divergence</span>\n<span class=\"n\">div</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">hdivg</span><span class=\"p\">(</span><span class=\"n\">u</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">,</span><span class=\"n\">lat</span><span class=\"p\">,</span><span class=\"n\">lon</span><span class=\"p\">,</span><span class=\"n\">regulargrid</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Vorticity (vertical component of relative vorticity)</span>\n<span class=\"n\">vor</span> <span class=\"o\">=</span> <span class=\"n\">ps</span><span class=\"o\">.</span><span class=\"n\">hcurl</span><span class=\"p\">(</span><span class=\"n\">u</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">,</span><span class=\"n\">lat</span><span class=\"p\">,</span><span class=\"n\">lon</span><span class=\"p\">,</span><span class=\"n\">regulargrid</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n</pre>\n<h2>Non-pystuff, though nice to copy-and-paste too</h2>\n<pre><span class=\"c1\"># Save regular grid NetCDF (with Xarray)</span>\n<span class=\"n\">newds</span> <span class=\"o\">=</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">Dataset</span><span class=\"p\">(</span><span class=\"n\">data_vars</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">'lat'</span>  <span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"s2\">\"lat\"</span><span class=\"p\">,</span> <span class=\"n\">lat</span><span class=\"p\">),</span>\n                              <span class=\"s1\">'lon'</span>  <span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"s2\">\"lon\"</span><span class=\"p\">,</span> <span class=\"n\">lon</span><span class=\"p\">,</span>\n                              <span class=\"s1\">'time'</span> <span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"s2\">\"time\"</span><span class=\"p\">,</span> <span class=\"n\">time</span><span class=\"p\">),</span>\n                              <span class=\"s1\">'slp'</span> <span class=\"p\">:</span> <span class=\"p\">([</span><span class=\"s2\">\"time\"</span><span class=\"p\">,</span><span class=\"s2\">\"lat\"</span><span class=\"p\">,</span><span class=\"s2\">\"lon\"</span><span class=\"p\">],</span> <span class=\"n\">slp</span><span class=\"p\">)})</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'lon'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span>  <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span> <span class=\"p\">:</span><span class=\"s1\">'longitude'</span><span class=\"p\">,</span><span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'longitude'</span><span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span> <span class=\"s1\">'degrees_east'</span>   <span class=\"p\">,</span><span class=\"s1\">'axis'</span><span class=\"p\">:</span> <span class=\"s1\">'X'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'lat'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span>  <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span> <span class=\"p\">:</span><span class=\"s1\">'latitude'</span> <span class=\"p\">,</span><span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'latitude'</span> <span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span> <span class=\"s1\">'degrees_north'</span>  <span class=\"p\">,</span><span class=\"s1\">'axis'</span><span class=\"p\">:</span> <span class=\"s1\">'Y'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span> <span class=\"p\">:</span><span class=\"s1\">'time'</span>     <span class=\"p\">,</span><span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'time'</span>     <span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span> <span class=\"s1\">'year of January'</span><span class=\"p\">,</span><span class=\"s1\">'axis'</span><span class=\"p\">:</span> <span class=\"s1\">'T'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'slp'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span>  <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span> <span class=\"p\">:</span> <span class=\"s1\">'slp'</span><span class=\"p\">,</span> <span class=\"s1\">'shortname'</span><span class=\"p\">:</span> <span class=\"s1\">'slp'</span><span class=\"p\">,</span> <span class=\"s1\">'units'</span><span class=\"p\">:</span> <span class=\"s1\">'hPa'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"o\">.</span><span class=\"n\">to_netcdf</span><span class=\"p\">(</span><span class=\"s1\">'slp.nc'</span><span class=\"p\">)</span> \n\n<span class=\"c1\"># Save curvilinear grid (e.g. MPIOM) NetCDF</span>\n<span class=\"n\">newds</span> <span class=\"o\">=</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">Dataset</span><span class=\"p\">(</span><span class=\"n\">data_vars</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">'lat'</span> <span class=\"p\">:</span> <span class=\"p\">([</span><span class=\"s2\">\"y\"</span><span class=\"p\">,</span><span class=\"s2\">\"x\"</span><span class=\"p\">],</span> <span class=\"n\">lat</span><span class=\"p\">),</span>\n                              <span class=\"s1\">'lon'</span> <span class=\"p\">:</span> <span class=\"p\">([</span><span class=\"s2\">\"y\"</span><span class=\"p\">,</span><span class=\"s2\">\"x\"</span><span class=\"p\">],</span> <span class=\"n\">lon</span><span class=\"p\">),</span>\n                              <span class=\"s1\">'time'</span> <span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"s2\">\"time\"</span><span class=\"p\">,</span> <span class=\"n\">time</span><span class=\"p\">,</span>\n                              <span class=\"s1\">'dist'</span><span class=\"p\">:</span> <span class=\"p\">([</span><span class=\"s2\">\"time\"</span><span class=\"p\">,</span><span class=\"s2\">\"y\"</span><span class=\"p\">,</span><span class=\"s2\">\"x\"</span><span class=\"p\">],</span> <span class=\"n\">dist</span><span class=\"p\">)})</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'lon'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span><span class=\"p\">:</span><span class=\"s1\">'lon'</span><span class=\"p\">,</span> <span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'longitude'</span><span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span><span class=\"s1\">'degrees_east'</span><span class=\"p\">,</span> <span class=\"s1\">'_CoordinateAxisType'</span><span class=\"p\">:</span><span class=\"s1\">'Lon'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'lat'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span><span class=\"p\">:</span><span class=\"s1\">'lat'</span><span class=\"p\">,</span> <span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'latitude'</span> <span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span><span class=\"s1\">'degrees_north'</span><span class=\"p\">,</span><span class=\"s1\">'_CoordinateAxisType'</span><span class=\"p\">:</span><span class=\"s1\">'Lat'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span><span class=\"p\">:</span><span class=\"s1\">'time'</span><span class=\"p\">,</span><span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'time'</span><span class=\"p\">,</span><span class=\"s1\">'units'</span><span class=\"p\">:</span><span class=\"s1\">'hours since 0-01-01 22:40:00'</span><span class=\"p\">,</span><span class=\"s1\">'calendar'</span><span class=\"p\">:</span><span class=\"s1\">'365_day'</span> <span class=\"p\">,</span><span class=\"s1\">'axis'</span><span class=\"p\">:</span><span class=\"s1\">'T'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"p\">[</span><span class=\"s1\">'dist'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">attrs</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'standard_name'</span><span class=\"p\">:</span><span class=\"s1\">'dist'</span><span class=\"p\">,</span><span class=\"s1\">'long_name'</span><span class=\"p\">:</span><span class=\"s1\">'distances from segment'</span><span class=\"p\">,</span> <span class=\"s1\">'units'</span><span class=\"p\">:</span><span class=\"s1\">'degrees'</span><span class=\"p\">,</span><span class=\"s1\">'coordinates'</span><span class=\"p\">:</span><span class=\"s1\">'lon lat'</span><span class=\"p\">}</span>\n<span class=\"n\">newds</span><span class=\"o\">.</span><span class=\"n\">to_netcdf</span><span class=\"p\">(</span><span class=\"s1\">'distances_MPIOM_LR.nc'</span><span class=\"p\">)</span> \n</pre>\n\n          </div>"}, "last_serial": 6182260, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "88dd883b7a9d53f93462340fbe1a95ec", "sha256": "051c18fc2b9edff54f62909a50e1f22000d3a1df144ac0bebcd25fe7b1094d26"}, "downloads": -1, "filename": "pystuff-0.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "88dd883b7a9d53f93462340fbe1a95ec", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 4918, "upload_time": "2019-11-22T16:31:00", "upload_time_iso_8601": "2019-11-22T16:31:00.114881Z", "url": "https://files.pythonhosted.org/packages/c0/4b/fd6869946580fc514d44a2ef8e41bb90ef45f55ec9db41e7a14b1a40b6d4/pystuff-0.0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "1117089de4010ade7c7373dfe171bc77", "sha256": "8f03814fcb1c042b6d27df4608e42ec904e023adc07f382c7988af6045db5f78"}, "downloads": -1, "filename": "pystuff-0.0.1.tar.gz", "has_sig": false, "md5_digest": "1117089de4010ade7c7373dfe171bc77", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 4065, "upload_time": "2019-11-22T16:31:01", "upload_time_iso_8601": "2019-11-22T16:31:01.846784Z", "url": "https://files.pythonhosted.org/packages/a7/08/10ef4c78fc9e4234b630cea9fbcdaa2a271ae654966e8af983683e17638d/pystuff-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "0ccfd561c815cc1cabd50950952787f9", "sha256": "67e16522957115e708acf8e9397b34e8a4eff76e187e2cad8ed41cba18ddf090"}, "downloads": -1, "filename": "pystuff-0.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "0ccfd561c815cc1cabd50950952787f9", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20160, "upload_time": "2019-07-26T08:34:51", "upload_time_iso_8601": "2019-07-26T08:34:51.047709Z", "url": "https://files.pythonhosted.org/packages/3a/92/32e0a8f765c6e54fe3c5aa8e33b759a69b80ad400bfcaddc078efb340257/pystuff-0.0.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "95898fba5344afe95cc25d62460ebf3c", "sha256": "f28264af3d6fd47a86a3e1f5e6f0369088e3e32b742a262102dba0c5e0f166be"}, "downloads": -1, "filename": "pystuff-0.0.2.tar.gz", "has_sig": false, "md5_digest": "95898fba5344afe95cc25d62460ebf3c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 359924, "upload_time": "2019-07-26T08:40:39", "upload_time_iso_8601": "2019-07-26T08:40:39.987806Z", "url": "https://files.pythonhosted.org/packages/4a/51/01e51f42025bb55bda18e9432b0f43bb7269448b08c3e27b9e9360b2013a/pystuff-0.0.2.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "f975595a2f22223668fd755866a48ab5", "sha256": "e4f7ca6724fa9729d92c557032040b8a67a93dba2ba623e55e8c27134b1f4b08"}, "downloads": -1, "filename": "pystuff-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "f975595a2f22223668fd755866a48ab5", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20152, "upload_time": "2019-07-26T08:44:33", "upload_time_iso_8601": "2019-07-26T08:44:33.455057Z", "url": "https://files.pythonhosted.org/packages/26/e4/2de4a5ab006b9dcb517576aaf47c9440d49fc810acfe7564a8edc41fc876/pystuff-0.0.3-py3-none-any.whl", "yanked": false}], "0.0.4": [{"comment_text": "", "digests": {"md5": "0bdbb8bc463f524e7a69fb9b6c7ddf45", "sha256": "aceb254633774455aedf34ad7cc6d7b6f828aea5738f518cf4e0981b5edb32c3"}, "downloads": -1, "filename": "pystuff-0.0.4-py3-none-any.whl", "has_sig": false, "md5_digest": "0bdbb8bc463f524e7a69fb9b6c7ddf45", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20191, "upload_time": "2019-07-26T09:08:34", "upload_time_iso_8601": "2019-07-26T09:08:34.794698Z", "url": "https://files.pythonhosted.org/packages/15/02/4e9ac2601dbf3930c9fb97687c72da4052e14abce40fa68bb767f4212bfc/pystuff-0.0.4-py3-none-any.whl", "yanked": false}], "0.0.5": [{"comment_text": "", "digests": {"md5": "47cf996867def3bd3eb0865f3d4c92e7", "sha256": "60ded8f540c586c066b060d74154a1efbcced79f3517ecffa97c7657443bfe39"}, "downloads": -1, "filename": "pystuff-0.0.5-py3-none-any.whl", "has_sig": false, "md5_digest": "47cf996867def3bd3eb0865f3d4c92e7", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20172, "upload_time": "2019-07-26T09:29:36", "upload_time_iso_8601": "2019-07-26T09:29:36.283407Z", "url": "https://files.pythonhosted.org/packages/6a/37/564f267b21d47226dea5842ffecde5a18c37dad9248aa8a3819dfb381627/pystuff-0.0.5-py3-none-any.whl", "yanked": false}], "0.0.6": [{"comment_text": "", "digests": {"md5": "1c70b5b4f9696e3962a824d756573ddb", "sha256": "989d97ebe300f458449ce9049c74f85ebe9fe0605cbfb454a3f807c396142edb"}, "downloads": -1, "filename": "pystuff-0.0.6-py3-none-any.whl", "has_sig": false, "md5_digest": "1c70b5b4f9696e3962a824d756573ddb", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20319, "upload_time": "2019-07-26T10:00:26", "upload_time_iso_8601": "2019-07-26T10:00:26.805807Z", "url": "https://files.pythonhosted.org/packages/f4/3e/d2b604def429a840dae676249288fad32a951d050e7a84e8cc03a768f46f/pystuff-0.0.6-py3-none-any.whl", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "1c70b5b4f9696e3962a824d756573ddb", "sha256": "989d97ebe300f458449ce9049c74f85ebe9fe0605cbfb454a3f807c396142edb"}, "downloads": -1, "filename": "pystuff-0.0.6-py3-none-any.whl", "has_sig": false, "md5_digest": "1c70b5b4f9696e3962a824d756573ddb", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 20319, "upload_time": "2019-07-26T10:00:26", "upload_time_iso_8601": "2019-07-26T10:00:26.805807Z", "url": "https://files.pythonhosted.org/packages/f4/3e/d2b604def429a840dae676249288fad32a951d050e7a84e8cc03a768f46f/pystuff-0.0.6-py3-none-any.whl", "yanked": false}], "timestamp": "Fri May  8 02:55:52 2020"}