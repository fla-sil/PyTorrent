{"info": {"author": "BlueDynamics Alliance", "author_email": "dev@bluedynamics.com", "bugtrack_url": null, "classifiers": ["Environment :: Web Environment", "Programming Language :: Python", "Topic :: Internet :: WWW/HTTP :: Dynamic Content"], "description": "cone.sql\n========\n\nThis package provides SQLAlchemy integration in ``cone.app`` and basic\napplication nodes for publishing SQLAlchemy models.\n\n\nInstallation\n------------\n\nInclude ``cone.sql`` to install dependencies in your application's\n``setup.py``.\n\n\nConfigure Database and WSGI\n---------------------------\n\nAdopt your application config ini file to define database location and hook\nup the related elements to the WSGI pipeline.\n\n.. code-block:: ini\n\n    [app:my_app]\n    use = egg:cone.app#main\n\n    cone.plugins =\n        cone.sql\n\n    cone.sql.dbinit.url = sqlite:///%(here)s/var/sqlite/my_db.db\n\n    [filter:remote_addr]\n    # for use behind nginx\n    use = egg:cone.app#remote_addr\n\n    [filter:tm]\n    use = egg:repoze.tm2#tm\n    commit_veto = repoze.tm:default_commit_veto\n\n    [filter:session]\n    use = egg:cone.sql#session\n    sqlalchemy.url = sqlite:///%(here)s/var/sqlite/my_db.db\n\n    [pipeline:main]\n    pipeline =\n        remote_addr\n        egg:repoze.retry#retry\n        tm\n        session\n        my_app\n\n\nCreate Model and Nodes\n----------------------\n\nDefine the SQLAlchemy model.\n\n.. code-block:: python\n\n    from cone.sql import SQLBase\n    from cone.sql.model import GUID\n    from sqlalchemy import Column\n    from sqlalchemy import String\n\n    class MyRecord(SQLBase):\n        __tablename__ = 'my_table'\n        uid_key = Column(GUID, primary_key=True)\n        field = Column(String)\n\nDefine an application node which represents the SQL row and uses the SQLAlchemy\nmodel. The class holds a reference to the related SQLAlchemy model.\n\n.. code-block:: python\n\n    from cone.sql.model import SQLRowNode\n\n    class MyNode(SQLRowNode):\n        record_class = MyRecord\n\nDefine an application node which represents the table and acts as container for\nthe SQL row nodes. The class holds a reference to the related SQLAlchemy model\nand the related SQLRowNode.\n\n.. code-block:: python\n\n    from cone.sql.model import SQLTableNode\n\n    class MyContainer(SQLTableNode):\n        record_class = MyRecord\n        child_factory = MyNode\n\n\nPrimary key handling\n--------------------\n\nThe node name maps to the primary key of the SQLAlchemy model (currenly no\nmultiple primary keys are supported). Node names are converted to the\nprimary key data type automatically. The conversion factories are defined at\n``SQLTableNode.data_type_converters`` which can be extended by more data types\nif needed.\n\n.. code-block:: python\n\n    >>> SQLTableNode.data_type_converters\n    {<class 'sqlalchemy.sql.sqltypes.String'>: <type 'unicode'>,\n    <class 'cone.sql.model.GUID'>: <class 'uuid.UUID'>,\n    <class 'sqlalchemy.sql.sqltypes.Integer'>: <type 'int'>}\n\n\nIntegrate to the Application Model\n----------------------------------\n\nIn order to publish a SQL table node, the table node must be hooked up to the\napplication model. To hook up the at root level, register it as entry.\n\n.. code-block:: python\n\n    import cone.app\n\n    cone.app.register_entry('container', MyContainer)\n\n\nSession setup handlers\n----------------------\n\nThere exists a ``sql_session_setup`` decorator which can be used to perform\nsession setup tasks like registering SQLAlchemy event listeners.\n\n.. code-block:: python\n\n    from cone.sql import sql_session_setup\n    from sqlalchemy import event\n\n    def after_flush(session, flush_context):\n        \"\"\"Do something after flush.\n        \"\"\"\n\n    @sql_session_setup\n    def bind_session_listener(session):\n        \"\"\"SQL session setup callback.\n        \"\"\"\n        event.listen(session, 'after_flush', after_flush)\n\n\nQuery the database\n------------------\n\nQuerying the database is done via SQLAlchemy. You can acquire the session from\nrequest via ``get_session`` and perform arbitrary operations on it.\n\n.. code-block:: python\n\n    from cone.sql import get_session\n\n    session = get_session(request)\n    result = session.query(MyRecord).all()\n\n\nTODO\n----\n\n- Support multiple primary keys.\n\n\nTest coverage\n-------------\n\nSummary of the test coverage report::\n\n    lines   cov%   module\n       50   100%   cone.sql.__init__\n      186    99%   cone.sql.model\n       57   100%   cone.sql.testing\n       18   100%   cone.sql.tests\n\n\nContributors\n============\n\n- Robert Niederreiter (Author)\n\nChanges\n=======\n\n0.1 (2017-03-28)\n----------------\n\n- Initial work.\n  [rnix, 2017-18-01]\n\nLicense\n=======\n\nCopyright (c) 2017, BlueDynamics Alliance, Austria\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above copyright notice, this\n  list of conditions and the following disclaimer.\n* Redistributions in binary form must reproduce the above copyright notice, this\n  list of conditions and the following disclaimer in the documentation and/or\n  other materials provided with the distribution.\n* Neither the name of the BlueDynamics Alliance nor the names of its\n  contributors may be used to endorse or promote products derived from this\n  software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY BlueDynamics Alliance ``AS IS`` AND ANY\nEXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL BlueDynamics Alliance BE LIABLE FOR ANY\nDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/bluedynamics/cone.sql", "keywords": "node pyramid cone web", "license": "Simplified BSD", "maintainer": null, "maintainer_email": null, "name": "cone.sql", "package_url": "https://pypi.org/project/cone.sql/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/cone.sql/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/bluedynamics/cone.sql"}, "release_url": "https://pypi.org/project/cone.sql/0.1/", "requires_dist": null, "requires_python": null, "summary": "SQLAlchemy integration for cone.app", "version": "0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"cone-sql\">\n<h2>cone.sql</h2>\n<p>This package provides SQLAlchemy integration in <tt>cone.app</tt> and basic\napplication nodes for publishing SQLAlchemy models.</p>\n<div id=\"installation\">\n<h3>Installation</h3>\n<p>Include <tt>cone.sql</tt> to install dependencies in your application\u2019s\n<tt>setup.py</tt>.</p>\n</div>\n<div id=\"configure-database-and-wsgi\">\n<h3>Configure Database and WSGI</h3>\n<p>Adopt your application config ini file to define database location and hook\nup the related elements to the WSGI pipeline.</p>\n<pre><span class=\"k\">[app:my_app]</span>\n<span class=\"na\">use</span> <span class=\"o\">=</span> <span class=\"s\">egg:cone.app#main</span>\n\n<span class=\"na\">cone.plugins</span> <span class=\"o\">=</span><span class=\"s\">\n    cone.sql</span>\n\n<span class=\"na\">cone.sql.dbinit.url</span> <span class=\"o\">=</span> <span class=\"s\">sqlite:///%(here)s/var/sqlite/my_db.db</span>\n\n<span class=\"k\">[filter:remote_addr]</span>\n<span class=\"c1\"># for use behind nginx</span>\n<span class=\"na\">use</span> <span class=\"o\">=</span> <span class=\"s\">egg:cone.app#remote_addr</span>\n\n<span class=\"k\">[filter:tm]</span>\n<span class=\"na\">use</span> <span class=\"o\">=</span> <span class=\"s\">egg:repoze.tm2#tm</span>\n<span class=\"na\">commit_veto</span> <span class=\"o\">=</span> <span class=\"s\">repoze.tm:default_commit_veto</span>\n\n<span class=\"k\">[filter:session]</span>\n<span class=\"na\">use</span> <span class=\"o\">=</span> <span class=\"s\">egg:cone.sql#session</span>\n<span class=\"na\">sqlalchemy.url</span> <span class=\"o\">=</span> <span class=\"s\">sqlite:///%(here)s/var/sqlite/my_db.db</span>\n\n<span class=\"k\">[pipeline:main]</span>\n<span class=\"na\">pipeline</span> <span class=\"o\">=</span><span class=\"s\">\n    remote_addr\n    egg:repoze.retry#retry\n    tm\n    session\n    my_app</span>\n</pre>\n</div>\n<div id=\"create-model-and-nodes\">\n<h3>Create Model and Nodes</h3>\n<p>Define the SQLAlchemy model.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cone.sql</span> <span class=\"kn\">import</span> <span class=\"n\">SQLBase</span>\n<span class=\"kn\">from</span> <span class=\"nn\">cone.sql.model</span> <span class=\"kn\">import</span> <span class=\"n\">GUID</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sqlalchemy</span> <span class=\"kn\">import</span> <span class=\"n\">Column</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sqlalchemy</span> <span class=\"kn\">import</span> <span class=\"n\">String</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">MyRecord</span><span class=\"p\">(</span><span class=\"n\">SQLBase</span><span class=\"p\">):</span>\n    <span class=\"n\">__tablename__</span> <span class=\"o\">=</span> <span class=\"s1\">'my_table'</span>\n    <span class=\"n\">uid_key</span> <span class=\"o\">=</span> <span class=\"n\">Column</span><span class=\"p\">(</span><span class=\"n\">GUID</span><span class=\"p\">,</span> <span class=\"n\">primary_key</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">field</span> <span class=\"o\">=</span> <span class=\"n\">Column</span><span class=\"p\">(</span><span class=\"n\">String</span><span class=\"p\">)</span>\n</pre>\n<p>Define an application node which represents the SQL row and uses the SQLAlchemy\nmodel. The class holds a reference to the related SQLAlchemy model.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cone.sql.model</span> <span class=\"kn\">import</span> <span class=\"n\">SQLRowNode</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">MyNode</span><span class=\"p\">(</span><span class=\"n\">SQLRowNode</span><span class=\"p\">):</span>\n    <span class=\"n\">record_class</span> <span class=\"o\">=</span> <span class=\"n\">MyRecord</span>\n</pre>\n<p>Define an application node which represents the table and acts as container for\nthe SQL row nodes. The class holds a reference to the related SQLAlchemy model\nand the related SQLRowNode.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cone.sql.model</span> <span class=\"kn\">import</span> <span class=\"n\">SQLTableNode</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">MyContainer</span><span class=\"p\">(</span><span class=\"n\">SQLTableNode</span><span class=\"p\">):</span>\n    <span class=\"n\">record_class</span> <span class=\"o\">=</span> <span class=\"n\">MyRecord</span>\n    <span class=\"n\">child_factory</span> <span class=\"o\">=</span> <span class=\"n\">MyNode</span>\n</pre>\n</div>\n<div id=\"primary-key-handling\">\n<h3>Primary key handling</h3>\n<p>The node name maps to the primary key of the SQLAlchemy model (currenly no\nmultiple primary keys are supported). Node names are converted to the\nprimary key data type automatically. The conversion factories are defined at\n<tt>SQLTableNode.data_type_converters</tt> which can be extended by more data types\nif needed.</p>\n<pre><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">SQLTableNode</span><span class=\"o\">.</span><span class=\"n\">data_type_converters</span>\n<span class=\"p\">{</span><span class=\"o\">&lt;</span><span class=\"k\">class</span> <span class=\"err\">'</span><span class=\"nc\">sqlalchemy</span><span class=\"o\">.</span><span class=\"n\">sql</span><span class=\"o\">.</span><span class=\"n\">sqltypes</span><span class=\"o\">.</span><span class=\"n\">String</span><span class=\"s1\">'&gt;: &lt;type '</span><span class=\"n\">unicode</span><span class=\"s1\">'&gt;,</span>\n<span class=\"o\">&lt;</span><span class=\"k\">class</span> <span class=\"err\">'</span><span class=\"nc\">cone</span><span class=\"o\">.</span><span class=\"n\">sql</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">GUID</span><span class=\"s1\">'&gt;: &lt;class '</span><span class=\"n\">uuid</span><span class=\"o\">.</span><span class=\"n\">UUID</span><span class=\"s1\">'&gt;,</span>\n<span class=\"o\">&lt;</span><span class=\"k\">class</span> <span class=\"err\">'</span><span class=\"nc\">sqlalchemy</span><span class=\"o\">.</span><span class=\"n\">sql</span><span class=\"o\">.</span><span class=\"n\">sqltypes</span><span class=\"o\">.</span><span class=\"n\">Integer</span><span class=\"s1\">'&gt;: &lt;type '</span><span class=\"nb\">int</span><span class=\"s1\">'&gt;}</span>\n</pre>\n</div>\n<div id=\"integrate-to-the-application-model\">\n<h3>Integrate to the Application Model</h3>\n<p>In order to publish a SQL table node, the table node must be hooked up to the\napplication model. To hook up the at root level, register it as entry.</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">cone.app</span>\n\n<span class=\"n\">cone</span><span class=\"o\">.</span><span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">register_entry</span><span class=\"p\">(</span><span class=\"s1\">'container'</span><span class=\"p\">,</span> <span class=\"n\">MyContainer</span><span class=\"p\">)</span>\n</pre>\n</div>\n<div id=\"session-setup-handlers\">\n<h3>Session setup handlers</h3>\n<p>There exists a <tt>sql_session_setup</tt> decorator which can be used to perform\nsession setup tasks like registering SQLAlchemy event listeners.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cone.sql</span> <span class=\"kn\">import</span> <span class=\"n\">sql_session_setup</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sqlalchemy</span> <span class=\"kn\">import</span> <span class=\"n\">event</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">after_flush</span><span class=\"p\">(</span><span class=\"n\">session</span><span class=\"p\">,</span> <span class=\"n\">flush_context</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Do something after flush.\n    \"\"\"</span>\n\n<span class=\"nd\">@sql_session_setup</span>\n<span class=\"k\">def</span> <span class=\"nf\">bind_session_listener</span><span class=\"p\">(</span><span class=\"n\">session</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"SQL session setup callback.\n    \"\"\"</span>\n    <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">listen</span><span class=\"p\">(</span><span class=\"n\">session</span><span class=\"p\">,</span> <span class=\"s1\">'after_flush'</span><span class=\"p\">,</span> <span class=\"n\">after_flush</span><span class=\"p\">)</span>\n</pre>\n</div>\n<div id=\"query-the-database\">\n<h3>Query the database</h3>\n<p>Querying the database is done via SQLAlchemy. You can acquire the session from\nrequest via <tt>get_session</tt> and perform arbitrary operations on it.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">cone.sql</span> <span class=\"kn\">import</span> <span class=\"n\">get_session</span>\n\n<span class=\"n\">session</span> <span class=\"o\">=</span> <span class=\"n\">get_session</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n<span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">session</span><span class=\"o\">.</span><span class=\"n\">query</span><span class=\"p\">(</span><span class=\"n\">MyRecord</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">all</span><span class=\"p\">()</span>\n</pre>\n</div>\n<div id=\"todo\">\n<h3>TODO</h3>\n<ul>\n<li>Support multiple primary keys.</li>\n</ul>\n</div>\n<div id=\"test-coverage\">\n<h3>Test coverage</h3>\n<p>Summary of the test coverage report:</p>\n<pre>lines   cov%   module\n   50   100%   cone.sql.__init__\n  186    99%   cone.sql.model\n   57   100%   cone.sql.testing\n   18   100%   cone.sql.tests\n</pre>\n</div>\n</div>\n<div id=\"contributors\">\n<h2>Contributors</h2>\n<ul>\n<li>Robert Niederreiter (Author)</li>\n</ul>\n</div>\n<div id=\"changes\">\n<h2>Changes</h2>\n<h2 id=\"id1\"><span class=\"section-subtitle\">0.1 (2017-03-28)</span></h2>\n<ul>\n<li>Initial work.\n[rnix, 2017-18-01]</li>\n</ul>\n</div>\n<div id=\"license\">\n<h2>License</h2>\n<p>Copyright (c) 2017, BlueDynamics Alliance, Austria\nAll rights reserved.</p>\n<p>Redistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:</p>\n<ul>\n<li>Redistributions of source code must retain the above copyright notice, this\nlist of conditions and the following disclaimer.</li>\n<li>Redistributions in binary form must reproduce the above copyright notice, this\nlist of conditions and the following disclaimer in the documentation and/or\nother materials provided with the distribution.</li>\n<li>Neither the name of the BlueDynamics Alliance nor the names of its\ncontributors may be used to endorse or promote products derived from this\nsoftware without specific prior written permission.</li>\n</ul>\n<p>THIS SOFTWARE IS PROVIDED BY BlueDynamics Alliance <tt>AS IS</tt> AND ANY\nEXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL BlueDynamics Alliance BE LIABLE FOR ANY\nDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>\n</div>\n\n          </div>"}, "last_serial": 2736580, "releases": {"0.1": [{"comment_text": "", "digests": {"md5": "3d752ce4065e8866f2902193ccdc603e", "sha256": "aa761b7bd92b6e9fc34f8cf0d43e9e6115c80caa94ad11df6237e1386865c363"}, "downloads": -1, "filename": "cone.sql-0.1.tar.gz", "has_sig": false, "md5_digest": "3d752ce4065e8866f2902193ccdc603e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13293, "upload_time": "2017-03-28T16:00:28", "upload_time_iso_8601": "2017-03-28T16:00:28.785162Z", "url": "https://files.pythonhosted.org/packages/aa/4d/6fda4a39bc32d6476dffc2c584c19011907e50b678a0a477a447bd13b274/cone.sql-0.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3d752ce4065e8866f2902193ccdc603e", "sha256": "aa761b7bd92b6e9fc34f8cf0d43e9e6115c80caa94ad11df6237e1386865c363"}, "downloads": -1, "filename": "cone.sql-0.1.tar.gz", "has_sig": false, "md5_digest": "3d752ce4065e8866f2902193ccdc603e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13293, "upload_time": "2017-03-28T16:00:28", "upload_time_iso_8601": "2017-03-28T16:00:28.785162Z", "url": "https://files.pythonhosted.org/packages/aa/4d/6fda4a39bc32d6476dffc2c584c19011907e50b678a0a477a447bd13b274/cone.sql-0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:44:01 2020"}