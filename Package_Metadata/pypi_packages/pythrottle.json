{"info": {"author": "Flus Flas", "author_email": "aflusflas@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Software Development :: Libraries"], "description": "pythrottle\n==========\n\n|pypi version| |python versions| |pipeline status| |coverage report| |docs|\n\n.. |pipeline status| image:: https://travis-ci.com/flusflas/pythrottle.svg?branch=master\n   :target: https://travis-ci.com/github/flusflas/pythrottle\n.. |coverage report| image:: https://codecov.io/gh/flusflas/pythrottle/branch/master/graph/badge.svg\n   :target: https://codecov.io/gh/flusflas/pythrottle\n.. |python versions| image:: https://img.shields.io/pypi/pyversions/pythrottle.svg\n   :target: https://pypi.org/project/pythrottle/\n.. |pypi version| image:: https://img.shields.io/pypi/v/pythrottle.svg\n   :target: https://pypi.org/project/pythrottle/\n.. |docs| image:: https://readthedocs.org/projects/pythrottle/badge/?version=latest\n   :target: https://pythrottle.readthedocs.io/en/latest/\n\nThis project offers some convenient tools for throttling and controlling\nthe execution timing of functions or iterative blocks of Python code.\n\nKey Features\n------------\n\n-  Simple and time-accurate loop iterations.\n-  Support for synchronous and asynchronous programming.\n-  Rate limiting consecutive function calls.\n-  Rate measurement for loops.\n\nInstallation\n------------\n\n.. code:: console\n\n    $ pip install pythrottle\n\nGetting started\n---------------\n\nThrottle\n~~~~~~~~\n\nA basic use for throttling the execution of a code block is using\n``Throttle.loop()`` (or ``Throttle.aloop()`` for asynchronous mode).\nThis will allow execution of the code every ``1 / rate`` seconds:\n\n.. code:: python\n\n    from throttle import Throttle\n\n    rate = 2.0     # Target rate\n    t = Throttle(interval=(1 / rate))\n\n    for i in t.loop():\n        # Do something\n        print(f\"Iteration {i}\")\n\nThe next example code records a 15-seconds video file from the default\nvideo source at an accurate frame rate of 24 fps using\n`OpenCV <https://opencv-python-tutroals.readthedocs.io/en/latest/>`__.\n\n.. code:: python\n\n    import cv2\n    from throttle import Throttle\n\n    rate = 24.0             # Target frame rate\n    cap = cv2.VideoCapture(0)\n    out = cv2.VideoWriter('output.avi', cv2.VideoWriter_fourcc(*'XVID'),\n                          rate, (640, 480))\n\n    t = Throttle(interval=(1 / rate))\n\n    for _ in t.loop(duration=15.0):\n        ret, frame = cap.read()    # Frame capture\n        out.write(frame)           # Save frame to output file\n\n        # Display the resulting frame\n        cv2.imshow('frame', frame)\n        if cv2.waitKey(1) & 0xFF == ord('q'):\n            break\n\nIf you simply\n`sleep() <https://docs.python.org/3/library/time.html?highlight=time%20sleep#time.sleep>`__\nfor ``1 / 24`` seconds between frame capture, there would be a\ndifference between the capture rate and the output video rate because of\nthe time required for frame capture. If you also add image processing\n(motion detection, text overlay...), the delay could cause the output to\nbe completely out of sync.\n\nThrottle decorators\n~~~~~~~~~~~~~~~~~~~\n\nYou can also use ``throttle.throttle()`` and ``throttle.athrottle()``\ndecorators to limit the number of calls to a function. In the next\nexample, the function ``hello()`` is decorated to rate-limit the\n``/throttled`` endpoint, using a\n`Flask <https://palletsprojects.com/p/flask/>`__ server. Only 2 requests\nwill be served every 5 seconds.\n\n.. code:: python\n\n    from flask import Flask\n    from throttle import throttle\n\n    app = Flask(__name__)\n\n    @app.route(\"/throttled\")\n    @throttle(limit=2, interval=5, on_fail=(\"Limit reached :(\", 429))\n    def hello():\n        return \"Hi, Throttle!\"\n\n    if __name__ == '__main__':\n        app.run()\n\nDecorators can be nested to create more complex throttling rules.\n\nRate Meter\n~~~~~~~~~~\n\n``RateMeter`` class is useful for measuring the rate of an iterative\ncode taking into account only the last few seconds, so the measured\nvalue is kept updated.\n\nThe next code block prints the execution rate of a loop that starts\nlooping at 10 ips (iterations per second) and decreases up to 5 ips. In\neach iteration, the rate is displayed and updated taking into account\nthe iterations history of the last 2 seconds.\n\n.. code:: python\n\n    import time\n    from rate_meter import RateMeter\n\n    rate_meter = RateMeter(interval=2.0)\n\n    for i in range(100):\n        rate_meter.update()\n        measured_rate = rate_meter.rate()\n        print(f\"Rate: {rate_meter.rate()}\")\n        time.sleep(0.1 + i * 0.001)\n\nLicense\n-------\n\nDistributed under the terms of the `MIT License <LICENSE>`__.", "description_content_type": "text/x-rst", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/flusflas/pythrottle", "keywords": "throttle,throttling,time,timing,rate", "license": "", "maintainer": "", "maintainer_email": "", "name": "pythrottle", "package_url": "https://pypi.org/project/pythrottle/", "platform": "", "project_url": "https://pypi.org/project/pythrottle/", "project_urls": {"Homepage": "https://github.com/flusflas/pythrottle"}, "release_url": "https://pypi.org/project/pythrottle/0.1.1/", "requires_dist": null, "requires_python": ">=3.6", "summary": "Set of tools for throttling and controlling the execution timing of Python code.", "version": "0.1.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p><a href=\"https://pypi.org/project/pythrottle/\" rel=\"nofollow\"><img alt=\"pypi version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/7bdc1ef23f6b40053f5402157489afa6d1dd98e9/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f70797468726f74746c652e737667\"></a> <a href=\"https://pypi.org/project/pythrottle/\" rel=\"nofollow\"><img alt=\"python versions\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/088fc169bb1749ec81337334cdeeaadbb39e6eb7/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f70797468726f74746c652e737667\"></a> <a href=\"https://travis-ci.com/github/flusflas/pythrottle\" rel=\"nofollow\"><img alt=\"pipeline status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ef234c1c4852379af68215f8895ee9aae63c85dd/68747470733a2f2f7472617669732d63692e636f6d2f666c7573666c61732f70797468726f74746c652e7376673f6272616e63683d6d6173746572\"></a> <a href=\"https://codecov.io/gh/flusflas/pythrottle\" rel=\"nofollow\"><img alt=\"coverage report\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/23fe3089584f457db0debc920040c95863ff97cf/68747470733a2f2f636f6465636f762e696f2f67682f666c7573666c61732f70797468726f74746c652f6272616e63682f6d61737465722f67726170682f62616467652e737667\"></a> <a href=\"https://pythrottle.readthedocs.io/en/latest/\" rel=\"nofollow\"><img alt=\"docs\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b22a21b8c888b922c11c13bbf30665dd5775f60c/68747470733a2f2f72656164746865646f63732e6f72672f70726f6a656374732f70797468726f74746c652f62616467652f3f76657273696f6e3d6c6174657374\"></a></p>\n<p>This project offers some convenient tools for throttling and controlling\nthe execution timing of functions or iterative blocks of Python code.</p>\n<div id=\"key-features\">\n<h2>Key Features</h2>\n<ul>\n<li>Simple and time-accurate loop iterations.</li>\n<li>Support for synchronous and asynchronous programming.</li>\n<li>Rate limiting consecutive function calls.</li>\n<li>Rate measurement for loops.</li>\n</ul>\n</div>\n<div id=\"installation\">\n<h2>Installation</h2>\n<pre><span class=\"gp\">$</span> pip install pythrottle\n</pre>\n</div>\n<div id=\"getting-started\">\n<h2>Getting started</h2>\n<div id=\"throttle\">\n<h3>Throttle</h3>\n<p>A basic use for throttling the execution of a code block is using\n<tt>Throttle.loop()</tt> (or <tt>Throttle.aloop()</tt> for asynchronous mode).\nThis will allow execution of the code every <tt>1 / rate</tt> seconds:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">throttle</span> <span class=\"kn\">import</span> <span class=\"n\">Throttle</span>\n\n<span class=\"n\">rate</span> <span class=\"o\">=</span> <span class=\"mf\">2.0</span>     <span class=\"c1\"># Target rate</span>\n<span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">Throttle</span><span class=\"p\">(</span><span class=\"n\">interval</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">/</span> <span class=\"n\">rate</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">t</span><span class=\"o\">.</span><span class=\"n\">loop</span><span class=\"p\">():</span>\n    <span class=\"c1\"># Do something</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Iteration </span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n</pre>\n<p>The next example code records a 15-seconds video file from the default\nvideo source at an accurate frame rate of 24 fps using\n<a href=\"https://opencv-python-tutroals.readthedocs.io/en/latest/\" rel=\"nofollow\">OpenCV</a>.</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">cv2</span>\n<span class=\"kn\">from</span> <span class=\"nn\">throttle</span> <span class=\"kn\">import</span> <span class=\"n\">Throttle</span>\n\n<span class=\"n\">rate</span> <span class=\"o\">=</span> <span class=\"mf\">24.0</span>             <span class=\"c1\"># Target frame rate</span>\n<span class=\"n\">cap</span> <span class=\"o\">=</span> <span class=\"n\">cv2</span><span class=\"o\">.</span><span class=\"n\">VideoCapture</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">out</span> <span class=\"o\">=</span> <span class=\"n\">cv2</span><span class=\"o\">.</span><span class=\"n\">VideoWriter</span><span class=\"p\">(</span><span class=\"s1\">'output.avi'</span><span class=\"p\">,</span> <span class=\"n\">cv2</span><span class=\"o\">.</span><span class=\"n\">VideoWriter_fourcc</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"s1\">'XVID'</span><span class=\"p\">),</span>\n                      <span class=\"n\">rate</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">640</span><span class=\"p\">,</span> <span class=\"mi\">480</span><span class=\"p\">))</span>\n\n<span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">Throttle</span><span class=\"p\">(</span><span class=\"n\">interval</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">/</span> <span class=\"n\">rate</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"n\">t</span><span class=\"o\">.</span><span class=\"n\">loop</span><span class=\"p\">(</span><span class=\"n\">duration</span><span class=\"o\">=</span><span class=\"mf\">15.0</span><span class=\"p\">):</span>\n    <span class=\"n\">ret</span><span class=\"p\">,</span> <span class=\"n\">frame</span> <span class=\"o\">=</span> <span class=\"n\">cap</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span>    <span class=\"c1\"># Frame capture</span>\n    <span class=\"n\">out</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">frame</span><span class=\"p\">)</span>           <span class=\"c1\"># Save frame to output file</span>\n\n    <span class=\"c1\"># Display the resulting frame</span>\n    <span class=\"n\">cv2</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"s1\">'frame'</span><span class=\"p\">,</span> <span class=\"n\">frame</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">cv2</span><span class=\"o\">.</span><span class=\"n\">waitKey</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">&amp;</span> <span class=\"mh\">0xFF</span> <span class=\"o\">==</span> <span class=\"nb\">ord</span><span class=\"p\">(</span><span class=\"s1\">'q'</span><span class=\"p\">):</span>\n        <span class=\"k\">break</span>\n</pre>\n<p>If you simply\n<a href=\"https://docs.python.org/3/library/time.html?highlight=time%20sleep#time.sleep\" rel=\"nofollow\">sleep()</a>\nfor <tt>1 / 24</tt> seconds between frame capture, there would be a\ndifference between the capture rate and the output video rate because of\nthe time required for frame capture. If you also add image processing\n(motion detection, text overlay\u2026), the delay could cause the output to\nbe completely out of sync.</p>\n</div>\n<div id=\"throttle-decorators\">\n<h3>Throttle decorators</h3>\n<p>You can also use <tt>throttle.throttle()</tt> and <tt>throttle.athrottle()</tt>\ndecorators to limit the number of calls to a function. In the next\nexample, the function <tt>hello()</tt> is decorated to rate-limit the\n<tt>/throttled</tt> endpoint, using a\n<a href=\"https://palletsprojects.com/p/flask/\" rel=\"nofollow\">Flask</a> server. Only 2 requests\nwill be served every 5 seconds.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">flask</span> <span class=\"kn\">import</span> <span class=\"n\">Flask</span>\n<span class=\"kn\">from</span> <span class=\"nn\">throttle</span> <span class=\"kn\">import</span> <span class=\"n\">throttle</span>\n\n<span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">Flask</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n\n<span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">route</span><span class=\"p\">(</span><span class=\"s2\">\"/throttled\"</span><span class=\"p\">)</span>\n<span class=\"nd\">@throttle</span><span class=\"p\">(</span><span class=\"n\">limit</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">interval</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">on_fail</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"s2\">\"Limit reached :(\"</span><span class=\"p\">,</span> <span class=\"mi\">429</span><span class=\"p\">))</span>\n<span class=\"k\">def</span> <span class=\"nf\">hello</span><span class=\"p\">():</span>\n    <span class=\"k\">return</span> <span class=\"s2\">\"Hi, Throttle!\"</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</pre>\n<p>Decorators can be nested to create more complex throttling rules.</p>\n</div>\n<div id=\"rate-meter\">\n<h3>Rate Meter</h3>\n<p><tt>RateMeter</tt> class is useful for measuring the rate of an iterative\ncode taking into account only the last few seconds, so the measured\nvalue is kept updated.</p>\n<p>The next code block prints the execution rate of a loop that starts\nlooping at 10 ips (iterations per second) and decreases up to 5 ips. In\neach iteration, the rate is displayed and updated taking into account\nthe iterations history of the last 2 seconds.</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">time</span>\n<span class=\"kn\">from</span> <span class=\"nn\">rate_meter</span> <span class=\"kn\">import</span> <span class=\"n\">RateMeter</span>\n\n<span class=\"n\">rate_meter</span> <span class=\"o\">=</span> <span class=\"n\">RateMeter</span><span class=\"p\">(</span><span class=\"n\">interval</span><span class=\"o\">=</span><span class=\"mf\">2.0</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"p\">):</span>\n    <span class=\"n\">rate_meter</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">()</span>\n    <span class=\"n\">measured_rate</span> <span class=\"o\">=</span> <span class=\"n\">rate_meter</span><span class=\"o\">.</span><span class=\"n\">rate</span><span class=\"p\">()</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Rate: </span><span class=\"si\">{</span><span class=\"n\">rate_meter</span><span class=\"o\">.</span><span class=\"n\">rate</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n    <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">(</span><span class=\"mf\">0.1</span> <span class=\"o\">+</span> <span class=\"n\">i</span> <span class=\"o\">*</span> <span class=\"mf\">0.001</span><span class=\"p\">)</span>\n</pre>\n</div>\n</div>\n<div id=\"license\">\n<h2>License</h2>\n<p>Distributed under the terms of the <a href=\"LICENSE\" rel=\"nofollow\">MIT License</a>.</p>\n</div>\n\n          </div>"}, "last_serial": 6952399, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "a668757e492f3990fec9354f4ede5ac7", "sha256": "e3cd287fbc529317f0ff2c5edf685d921f9b323fb9fbc5ff67bd2c631ae5403c"}, "downloads": -1, "filename": "pythrottle-0.1.0.tar.gz", "has_sig": false, "md5_digest": "a668757e492f3990fec9354f4ede5ac7", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6213, "upload_time": "2020-04-04T18:32:24", "upload_time_iso_8601": "2020-04-04T18:32:24.952967Z", "url": "https://files.pythonhosted.org/packages/c0/d3/b86fe30a1c7d9a9c6ebb70c92407366aee055e46f8400ac7da3d6ec084a1/pythrottle-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "f7eeacb0fe64bc9aa0e3d12d91cb81f1", "sha256": "29e073aa0581141b986977bf9d6c859523293f3a6a06691568dc285205120594"}, "downloads": -1, "filename": "pythrottle-0.1.1.tar.gz", "has_sig": false, "md5_digest": "f7eeacb0fe64bc9aa0e3d12d91cb81f1", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6313, "upload_time": "2020-04-04T19:39:00", "upload_time_iso_8601": "2020-04-04T19:39:00.857309Z", "url": "https://files.pythonhosted.org/packages/88/c7/31e408b6ed0d84dfb8c91cc93f9cca52b2589e5380d45197a57d04cdb25e/pythrottle-0.1.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "f7eeacb0fe64bc9aa0e3d12d91cb81f1", "sha256": "29e073aa0581141b986977bf9d6c859523293f3a6a06691568dc285205120594"}, "downloads": -1, "filename": "pythrottle-0.1.1.tar.gz", "has_sig": false, "md5_digest": "f7eeacb0fe64bc9aa0e3d12d91cb81f1", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6313, "upload_time": "2020-04-04T19:39:00", "upload_time_iso_8601": "2020-04-04T19:39:00.857309Z", "url": "https://files.pythonhosted.org/packages/88/c7/31e408b6ed0d84dfb8c91cc93f9cca52b2589e5380d45197a57d04cdb25e/pythrottle-0.1.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:14:24 2020"}