{"info": {"author": "David Villa Alises", "author_email": "David.Villa@gmail.com", "bugtrack_url": null, "classifiers": ["Intended Audience :: Developers", "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.0", "Programming Language :: Python :: 3.1", "Programming Language :: Python :: 3.2", "Programming Language :: Python :: 3.3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Topic :: Software Development", "Topic :: Software Development :: Quality Assurance", "Topic :: Software Development :: Testing"], "description": "Prego is a system/integration test framework running as Python unittest testcases.\n\nPrego is a library consisting on a set of clases and hamcrest matchers usefull\nto specify shell command interactions through files, environment variables,\nnetwork ports. It provides support to run shell commands on background, send\nsignal to processes, set assertions on command stdout or stderr, etc.\n\n\nConcepts\n========\n\n**First:** a Task() is a set of assertions.\n\nThree assertion checkers are available:\n\n- task.assert_that, for single shot checking.\n- task.wait_that, for polling recurrent checking.\n- task.command, to run arbitrary shell command.\n\nSubjects (and their associated assertions):\n\n- Task(desc='', detach=False)\n\n  - command(cmd_line, stdout, stderr, expected, timeout, signal, cwd, env)\n  - running()\n  - terminated()\n\n- File(path)\n\n  - exists()\n\n- File().content\n\n  - any hamcrest string matchers (ie: contains_string)\n\n- Variable\n\n  - exists()\n  - any hamcrest string matchers (ie: contains_string)\n\n- Command\n\n  - running()\n  - exits_with(value)\n  - killed_by(signal)\n\n- Host(hostname)\n\n  - listen_port(number, proto='tcp')\n  - reachable()\n\n\nExecution model\n===============\n\n\n\ncommand\n=======\n\n\ncontext\n=======\n\nThe ``context`` is an object whose attributes may be automatically interpolated in command\nand filename paths.\n\nSome of them are set as default values for command() parameters too. If ``context.cwd`` is\nset, all commands in the same test method will use that value as CWD (Current Working\nDirectory) unless you define a different value as ``command()`` keyarg.\n\nContext attributes that defaults command() parameters are ``cwd``, ``timeout``,\n``signal`` and ``expected``.\n\n\nInterpolation\n=============\n\nAvailable interpolation variables are:\n\n- $basedir: the directory where prego is executed (relative).\n- $fullbasedir: absolute path of $basedir.\n- $testdir: the directory where the running test file is.\n- $fulltestdir: absolute path of $testdir.\n- $testfilename: the file name of the running test.\n- $tmpbase: a safe directory (per user) to put temporary files.\n- $tmp: a safe directory (per user and prego instance) to put temporary files.\n- $pid: the prego instance PID.\n\n\nExamples\n========\n\nTesting ncat\n------------\n\n::\n\n  import hamcrest\n  from prego import Task, TestCase, context as ctx, running\n  from prego.net import localhost, listen_port\n  from prego.debian import Package, installed\n\n\n  class Net(TestCase):\n      def test_netcat(self):\n          ctx.port = 2000\n          server = Task(desc='ncat server', detach=True)\n          server.assert_that(Package('nmap'), installed())\n          server.assert_that(localhost,\n                             hamcrest.is_not(listen_port(ctx.port)))\n          cmd = server.command('ncat -l -p $port')\n          server.assert_that(cmd.stdout.content,\n                             hamcrest.contains_string('bye'))\n\n          client = Task(desc='ncat client')\n          client.wait_that(server, running())\n          client.wait_that(localhost, listen_port(ctx.port))\n          client.command('ncat -c \"echo bye\" localhost $port')\n\n\nThis test may be executed using nosetest::\n\n  $ nosetests examples/netcat.py\n  .\n  ----------------------------------------------------------------------\n  Ran 1 test in 1.414s\n\n  OK\n\n\nBut prego provides a wrapper (the ``prego`` command) that has some interesting options::\n\n  $ prego -h\n  usage: prego [-h] [-c FILE] [-k] [-d] [-o] [-e] [-v] [-p] ...\n\n  positional arguments:\n    nose-args\n\n  optional arguments:\n    -h, --help            show this help message and exit\n    -c FILE, --config FILE\n                          explicit config file\n    -k, --keep-going      continue even with failed assertion or tests\n    -d, --dirty           do not remove generated files\n    -o, --stdout          print tests stdout\n    -e, --stderr          print tests stderr\n    -v, --verbose         increase log verbosity\n\n\nSame ncat test invoking ``prego``::\n\n  [II] ------  Net.test_netcat BEGIN\n  [II] [ ok ]   B.0 wait that A is running\n  [II] [ ok ]   A.0 assert that nmap package is installed\n  [II] [ ok ]   A.1 assert that localhost not port 2000/tcp to be open\n  [II] [fail]   B.1 wait that localhost port 2000/tcp to be open\n  [II] [ ok ]   B.1 wait that localhost port 2000/tcp to be open\n  [II]          A.2.out| bye\n  [II] [ ok ]   B.2 Command 'ncat -c \"echo bye\" localhost 2000' code (0:0) time 5:1.28\n  [II] [ ok ]   B.3 assert that command B.2 returncode to be 0\n  [II] [ ok ]   B.4 assert that command B.2 execution time to be a value less than <5>s\n  [II] [ OK ]   B   Task end - elapsed: 1.17s\n  [II] [ ok ]   A.2 Command 'ncat -l -p 2000' code (0:0) time 5:1.33\n  [II] [ ok ]   A.3 assert that command A.2 returncode to be 0\n  [II] [ ok ]   A.4 assert that command A.2 execution time to be a value less than <5>s\n  [II] [ ok ]   A.5 assert that File '/tmp/prego-david/26245/A.2.out' content a string containing 'bye'\n  [II] [ OK ]   A   Task end - elapsed: 1.32s\n  [II] [ OK ]  Net.test_netcat END\n  ----------------------------------------------------------------------\n  Ran 1 test in 1.396s\n\n  OK\n\n\nTesting google.com reachability\n===============================\n\n::\n\n  import hamcrest\n  from prego import TestCase, Task\n  from prego.net import Host, reachable\n\n  class GoogleTest(TestCase):\n      def test_is_reachable(self):\n          link = Task(desc=\"Is interface link up?\")\n          link.command('ip link | grep wlan0 | grep \"state UP\"')\n\n          router = Task(desc=\"Is the local router reachable?\")\n          router.command(\"ping -c2 $(ip route | grep ^default | cut -d' ' -f 3)\")\n\n          for line in file('/etc/resolv.conf'):\n              if line.startswith('nameserver'):\n                  server = line.split()[1]\n                  test = Task(desc=\"Is DNS server {0} reachable?\".format(server))\n                  test.command('ping -c 2 {0}'.format(server))\n\n          resolve = Task(desc=\"may google name be resolved?\")\n          resolve.command('host www.google.com')\n\n          ping = Task(desc=\"Is google reachable?\")\n          ping.command('ping -c 1 www.google.com')\n          ping.assert_that(Host('www.google.com'), reachable())\n          ping.assert_that(Host('www.googlewrong.com'), hamcrest.is_not(reachable()))\n\n          web = Task(desc=\"get index.html\")\n          cmd = web.command('wget http://www.google.com/webhp?hl=en -O-')\n          web.assert_that(cmd.stdout.content,\n                          hamcrest.contains_string('value=\"I\\'m Feeling Lucky\"'))\n\n.. Local Variables:\n..  coding: utf-8\n..  mode: flyspell\n..  ispell-local-dictionary: \"american\"\n.. End:\n", "description_content_type": "", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://bitbucket.org/arco_group/prego", "keywords": "", "license": "GPLv3", "maintainer": "", "maintainer_email": "", "name": "prego3", "package_url": "https://pypi.org/project/prego3/", "platform": "", "project_url": "https://pypi.org/project/prego3/", "project_urls": {"Homepage": "https://bitbucket.org/arco_group/prego"}, "release_url": "https://pypi.org/project/prego3/0.20181031/", "requires_dist": null, "requires_python": "", "summary": "System test framework over POSIX shells", "version": "0.20181031", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p>Prego is a system/integration test framework running as Python unittest testcases.</p>\n<p>Prego is a library consisting on a set of clases and hamcrest matchers usefull\nto specify shell command interactions through files, environment variables,\nnetwork ports. It provides support to run shell commands on background, send\nsignal to processes, set assertions on command stdout or stderr, etc.</p>\n<div id=\"concepts\">\n<h2>Concepts</h2>\n<p><strong>First:</strong> a Task() is a set of assertions.</p>\n<p>Three assertion checkers are available:</p>\n<ul>\n<li>task.assert_that, for single shot checking.</li>\n<li>task.wait_that, for polling recurrent checking.</li>\n<li>task.command, to run arbitrary shell command.</li>\n</ul>\n<p>Subjects (and their associated assertions):</p>\n<ul>\n<li>Task(desc=\u2019\u2019, detach=False)<ul>\n<li>command(cmd_line, stdout, stderr, expected, timeout, signal, cwd, env)</li>\n<li>running()</li>\n<li>terminated()</li>\n</ul>\n</li>\n<li>File(path)<ul>\n<li>exists()</li>\n</ul>\n</li>\n<li>File().content<ul>\n<li>any hamcrest string matchers (ie: contains_string)</li>\n</ul>\n</li>\n<li>Variable<ul>\n<li>exists()</li>\n<li>any hamcrest string matchers (ie: contains_string)</li>\n</ul>\n</li>\n<li>Command<ul>\n<li>running()</li>\n<li>exits_with(value)</li>\n<li>killed_by(signal)</li>\n</ul>\n</li>\n<li>Host(hostname)<ul>\n<li>listen_port(number, proto=\u2019tcp\u2019)</li>\n<li>reachable()</li>\n</ul>\n</li>\n</ul>\n</div>\n<div id=\"execution-model\">\n<h2>Execution model</h2>\n</div>\n<div id=\"command\">\n<h2>command</h2>\n</div>\n<div id=\"context\">\n<h2>context</h2>\n<p>The <tt>context</tt> is an object whose attributes may be automatically interpolated in command\nand filename paths.</p>\n<p>Some of them are set as default values for command() parameters too. If <tt>context.cwd</tt> is\nset, all commands in the same test method will use that value as CWD (Current Working\nDirectory) unless you define a different value as <tt>command()</tt> keyarg.</p>\n<p>Context attributes that defaults command() parameters are <tt>cwd</tt>, <tt>timeout</tt>,\n<tt>signal</tt> and <tt>expected</tt>.</p>\n</div>\n<div id=\"interpolation\">\n<h2>Interpolation</h2>\n<p>Available interpolation variables are:</p>\n<ul>\n<li>$basedir: the directory where prego is executed (relative).</li>\n<li>$fullbasedir: absolute path of $basedir.</li>\n<li>$testdir: the directory where the running test file is.</li>\n<li>$fulltestdir: absolute path of $testdir.</li>\n<li>$testfilename: the file name of the running test.</li>\n<li>$tmpbase: a safe directory (per user) to put temporary files.</li>\n<li>$tmp: a safe directory (per user and prego instance) to put temporary files.</li>\n<li>$pid: the prego instance PID.</li>\n</ul>\n</div>\n<div id=\"examples\">\n<h2>Examples</h2>\n<h2 id=\"testing-ncat\"><span class=\"section-subtitle\">Testing ncat</span></h2>\n<pre>import hamcrest\nfrom prego import Task, TestCase, context as ctx, running\nfrom prego.net import localhost, listen_port\nfrom prego.debian import Package, installed\n\n\nclass Net(TestCase):\n    def test_netcat(self):\n        ctx.port = 2000\n        server = Task(desc='ncat server', detach=True)\n        server.assert_that(Package('nmap'), installed())\n        server.assert_that(localhost,\n                           hamcrest.is_not(listen_port(ctx.port)))\n        cmd = server.command('ncat -l -p $port')\n        server.assert_that(cmd.stdout.content,\n                           hamcrest.contains_string('bye'))\n\n        client = Task(desc='ncat client')\n        client.wait_that(server, running())\n        client.wait_that(localhost, listen_port(ctx.port))\n        client.command('ncat -c \"echo bye\" localhost $port')\n</pre>\n<p>This test may be executed using nosetest:</p>\n<pre>$ nosetests examples/netcat.py\n.\n----------------------------------------------------------------------\nRan 1 test in 1.414s\n\nOK\n</pre>\n<p>But prego provides a wrapper (the <tt>prego</tt> command) that has some interesting options:</p>\n<pre>$ prego -h\nusage: prego [-h] [-c FILE] [-k] [-d] [-o] [-e] [-v] [-p] ...\n\npositional arguments:\n  nose-args\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c FILE, --config FILE\n                        explicit config file\n  -k, --keep-going      continue even with failed assertion or tests\n  -d, --dirty           do not remove generated files\n  -o, --stdout          print tests stdout\n  -e, --stderr          print tests stderr\n  -v, --verbose         increase log verbosity\n</pre>\n<p>Same ncat test invoking <tt>prego</tt>:</p>\n<pre>[II] ------  Net.test_netcat BEGIN\n[II] [ ok ]   B.0 wait that A is running\n[II] [ ok ]   A.0 assert that nmap package is installed\n[II] [ ok ]   A.1 assert that localhost not port 2000/tcp to be open\n[II] [fail]   B.1 wait that localhost port 2000/tcp to be open\n[II] [ ok ]   B.1 wait that localhost port 2000/tcp to be open\n[II]          A.2.out| bye\n[II] [ ok ]   B.2 Command 'ncat -c \"echo bye\" localhost 2000' code (0:0) time 5:1.28\n[II] [ ok ]   B.3 assert that command B.2 returncode to be 0\n[II] [ ok ]   B.4 assert that command B.2 execution time to be a value less than &lt;5&gt;s\n[II] [ OK ]   B   Task end - elapsed: 1.17s\n[II] [ ok ]   A.2 Command 'ncat -l -p 2000' code (0:0) time 5:1.33\n[II] [ ok ]   A.3 assert that command A.2 returncode to be 0\n[II] [ ok ]   A.4 assert that command A.2 execution time to be a value less than &lt;5&gt;s\n[II] [ ok ]   A.5 assert that File '/tmp/prego-david/26245/A.2.out' content a string containing 'bye'\n[II] [ OK ]   A   Task end - elapsed: 1.32s\n[II] [ OK ]  Net.test_netcat END\n----------------------------------------------------------------------\nRan 1 test in 1.396s\n\nOK\n</pre>\n</div>\n<div id=\"testing-google-com-reachability\">\n<h2>Testing google.com reachability</h2>\n<pre>import hamcrest\nfrom prego import TestCase, Task\nfrom prego.net import Host, reachable\n\nclass GoogleTest(TestCase):\n    def test_is_reachable(self):\n        link = Task(desc=\"Is interface link up?\")\n        link.command('ip link | grep wlan0 | grep \"state UP\"')\n\n        router = Task(desc=\"Is the local router reachable?\")\n        router.command(\"ping -c2 $(ip route | grep ^default | cut -d' ' -f 3)\")\n\n        for line in file('/etc/resolv.conf'):\n            if line.startswith('nameserver'):\n                server = line.split()[1]\n                test = Task(desc=\"Is DNS server {0} reachable?\".format(server))\n                test.command('ping -c 2 {0}'.format(server))\n\n        resolve = Task(desc=\"may google name be resolved?\")\n        resolve.command('host www.google.com')\n\n        ping = Task(desc=\"Is google reachable?\")\n        ping.command('ping -c 1 www.google.com')\n        ping.assert_that(Host('www.google.com'), reachable())\n        ping.assert_that(Host('www.googlewrong.com'), hamcrest.is_not(reachable()))\n\n        web = Task(desc=\"get index.html\")\n        cmd = web.command('wget http://www.google.com/webhp?hl=en -O-')\n        web.assert_that(cmd.stdout.content,\n                        hamcrest.contains_string('value=\"I\\'m Feeling Lucky\"'))\n</pre>\n</div>\n\n          </div>"}, "last_serial": 5125251, "releases": {"0.20181031": [{"comment_text": "", "digests": {"md5": "992926cfa0bb197e62d0d0dd24bf6b42", "sha256": "811a0abfb11307867c23b833275d5469e195cdad44a0ca4e2af8c6011aefa0f9"}, "downloads": -1, "filename": "prego3-0.20181031.tar.gz", "has_sig": false, "md5_digest": "992926cfa0bb197e62d0d0dd24bf6b42", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24569, "upload_time": "2019-04-10T17:51:09", "upload_time_iso_8601": "2019-04-10T17:51:09.262876Z", "url": "https://files.pythonhosted.org/packages/d7/d7/7df8dd7ebdab854c8e123c255c28962de8dc3e067b860ae545fd9ae4b6ae/prego3-0.20181031.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "992926cfa0bb197e62d0d0dd24bf6b42", "sha256": "811a0abfb11307867c23b833275d5469e195cdad44a0ca4e2af8c6011aefa0f9"}, "downloads": -1, "filename": "prego3-0.20181031.tar.gz", "has_sig": false, "md5_digest": "992926cfa0bb197e62d0d0dd24bf6b42", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24569, "upload_time": "2019-04-10T17:51:09", "upload_time_iso_8601": "2019-04-10T17:51:09.262876Z", "url": "https://files.pythonhosted.org/packages/d7/d7/7df8dd7ebdab854c8e123c255c28962de8dc3e067b860ae545fd9ae4b6ae/prego3-0.20181031.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:19:55 2020"}