{"info": {"author": "Olivier Breuleux", "author_email": "breuleux@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "\n# Coleo\n\nColeo is a minimum-effort way to create a command-line interface in Python.\n\n* Declare options where they are used.\n* Scale easily to extensive CLIs with dozens of subcommands and options.\n\n\n## Basic usage\n\nFirst, define a command line interface as follows:\n\n```python\nfrom coleo import Argument, auto_cli, default\n\ndef main():\n    # The greeting\n    greeting: Argument = default(\"Hello\")\n\n    # The name to greet\n    name: Argument = default(\"you\")\n\n    return f\"{greeting}, {name}!\"\n\nif __name__ == \"__main__\":\n    auto_cli(main)\n```\n\nThen you may run it like this on the command line:\n\n```bash\n$ python hello.py\nHello, you!\n$ python hello.py --name Luke\nHello, Luke!\n$ python hello.py --name Luke --greeting \"Happy birthday\"\nHappy birthday, Luke!\n$ python hello.py -h\nusage: hello.py [-h] [--greeting VALUE] [--name VALUE]\n\noptional arguments:\n  -h, --help        show this help message and exit\n  --greeting VALUE  The greeting\n  --name VALUE      The name to greet\n```\n\n* Any variable annotated with `Argument` will become an option.\n* You can provide a default value with `default(value)`, although you don't have to, if the argument is required.\n* If there is a comment above the variable, it will be used as documentation for the option.\n\n\n## Argument types\n\nBy default, all arguments are interpreted as strings, but you can easily give a different type to an argument:\n\n```python\ndef main():\n    # This argument will be converted to an int\n    x: Argument & int\n    # This argument will be converted to a float\n    y: Argument & float\n    return x + y\n```\n\n**Boolean flags**\n\nIf the type is bool, the option will take no argument, and the `--no-<optname>` option is added to negate the value. For example:\n\n```python\ndef main():\n    flag: Argument & bool\n    return \"yes!\" if flag else \"no!\"\n```\n\nUse it like this:\n\n```bash\n$ python script.py --flag\nyes!\n$ python script.py --no-flag\nno!\n```\n\n**Files**\n\nUse `coleo.FileType` (or `argparse.FileType`, it's the same thing) to open a file to read from or to write to:\n\n```python\ndef main():\n    grocery_list: Argument & coleo.FileType(\"r\")\n    with grocery_list as f:\n        for food in f.readlines():\n            print(f\"Gotta buy some {food}\")\n```\n\n**Config**\n\nYou can manipulate configuration files with `coleo.config` or `coleo.ConfigFile`:\n\n```python\ndef main():\n    # ConfigFile lets you read or write a configuration file\n    book: Argument & ConfigFile\n    contents = book.read()\n    contents[\"xyz\"] = \"abc\"\n    book.write(contents)\n\n    # config will read the file for you or parse the argument as JSON\n    magazine: Argument & config\n    print(magazine)\n```\n\nUse it simply like this:\n\n```bash\n$ python librarian.py --book alice.json --magazine vogue.json\n$ python librarian.py --book history.yaml --magazine gamez.toml\n$ python librarian.py --book physics.json --magazine '{\"a\": 1, \"b\": 2}'\n# etc\n```\n\nSupported extensions are `json`, `yaml` and `toml` (the latter two require installing the `pyyaml` or `toml` packages).\n\n\n**Other**\n\nAny function can be used as a \"type\" for an argument. So for example, if you want to be able to provide lists and dictionaries on the command line you can simply use `json.loads` (although `coleo.config` is usually better, because it can also read files, in various formats):\n\n```python\ndef main():\n    obj: Argument & json.loads\n    return type(obj).__name__\n```\n\n```bash\n$ python json.py --obj 1\nint\n$ python json.py --obj '\"hello\"'\nstr\n$ python json.py --obj '{\"a\": 1, \"b\": 2}'\ndict\n```\n\nIf you're feeling super feisty and care nothing about safety, you can even use `eval`:\n\n```python\ndef main():\n    obj: Argument & eval\n    return type(obj).__name__\n```\n\n```bash\n$ python eval.py --obj \"1 + 2\"\nint\n$ python eval.py --obj \"lambda x: x + 1\"\nfunction\n```\n\n\n## Customization\n\nUsing comments of the form `# [<instruction>: <args ...>]` you can customize the option parser:\n\n```python\ndef main():\n    # This argument can be given as either --greeting or -g\n    # [alias: -g]\n    greeting: Argument = default(\"Hello\")\n\n    # This argument is positional\n    # [positional]\n    name: Argument = default(\"you\")\n\n    # This argument can only be given as -n\n    # [options: -n]\n    ntimes: Argument & int = default(1)\n\n    for i in range(ntimes):\n        print(f\"{greeting}, {name}!\")\n```\n\nThe above would be used like this:\n\n```bash\n$ python hello.py Alice -g Greetings -n 2\nGreetings, Alice!\nGreetings, Alice!\n```\n\nThe following customizations are available:\n\n* `[alias: ...]` defines one or several options that are aliases for the main one. Options are separated by spaces, commas or semicolons.\n* `[options: ...]` defines one or several options for this argument, which *override* the default one. Options are separated by spaces, commas or semicolons.\n* `[positional]` defines one positional argument.\n  * `[positional: n]`: n positional arguments (a list is returned).\n  * `[positional: ?]`: one optional positional argument\n  * `[positional: *]`: zero or more positional arguments\n  * `[positional: +]`: one or more positional arguments\n\nIt is currently not possible to define multiple arguments as positional, although you can simulate it by using e.g. `[positional: 2]` on a single argument to get a pair, and then you can get the elements of the list.\n\n\n## Subcommands\n\nYou can create an interface with a hierarchy of subcommands by passing a dictionary to `auto_cli`:\n\n```python\ndef add():\n    x: Argument & int\n    y: Argument & int\n    return x + y\n\ndef mul():\n    x: Argument & int\n    y: Argument & int\n    return x * y\n\ndef pow():\n    base: Argument & int\n    exponent: Argument & int\n    return base ** exponent\n\ndef greet():\n    greeting: Argument = default(\"Hello\")\n    name: Argument = default(\"you\")\n    return f\"{greeting}, {name}!\"\n\nif __name__ == \"__main__\":\n    auto_cli({\n        \"calc\": {\n            \"__doc__\": \"Calculate something!\",\n            \"add\": add,\n            \"mul\": mul,\n            \"pow\": pow,\n        },\n        \"greet\": greet,\n    })\n```\n\nThen you may use it like this:\n\n```bash\n$ python multi.py greet --name Alice --greeting Hi\nHi, Alice!\n$ python multi.py calc add --x=3 --y=8\n11\n```\n\n\n## Sharing arguments\n\nIt is possible to share behavior and arguments between subcommands, or to split complex functionality into multiple pieces. For example, maybe multiple subcommands in your application require an API key, which can either be given on the command line or can be read from a file. This is how you would share this behavior across all subcommands:\n\n```python\nfrom coleo import Argument, auto_cli, default, tooled\n\n@tooled\ndef apikey():\n    # The API key to use\n    key: Argument = default(None)\n    if key is None:\n        # If no key parameter is given on the command line, try to read it from\n        # some standard location.\n        key = config(\"~/.config/myapp/config.json\")[\"key\"]\n    return key\n\ndef search():\n    interface = Application(apikey())\n    query: Argument\n    return interface.search(query)\n\ndef install():\n    interface = Application(apikey())\n    package: Argument\n    return interface.install(package)\n\nif __name__ == \"__main__\":\n    auto_cli({\"search\": search, \"install\": install})\n```\n\nIf a function is decorated with `@tooled` and is called from one of the main functions (or from another tooled function), Coleo will search for arguments in that function too. Thus any subcommand that calls `apikey()` will gain a `--key` option.\n\nIn addition to this, you can \"share\" arguments by defining the same argument with the same type in multiple functions. Coleo will set all of them to the same value.\n\nFor example, in the example above you could easily let the user specify the path to the file that contains the key, simply by replacing\n\n```python\nkey = config(\"~/.config/myapp/config.json\")[\"key\"]\n\n# ==>\n\nconfig_path: Argument = default(\"~/.config/myapp/config.json\")\nkey = config(config_path)[\"key\"]\n```\n\nAnd that `config_path` argument could, of course, be declared in any other function that needs to read some configuration value.\n\n\n## Non-CLI usage\n\nIt is possible to set arguments without `auto_cli` with `setvars`:\n\n```python\nfrom coleo import Argument, setvars, tooled\n\n@tooled\ndef greet():\n    greeting: Argument = default(\"Hello\")\n    name: Argument = default(\"you\")\n    return f\"{greeting} {name}!\"\n\nwith setvars(greeting=\"Hi\", name=\"Bob\"):\n    assert greet() == \"Hi bob!\"\n```\n\nNote:\n\n* With `setvars`, you *must* decorate the function with `@tooled` (this is something `auto_cli` does on your behalf).\n* `setvars` entirely bypasses the option parsing and the type annotations will not be used to wrap these values. In other words, if a variable is annotated `Argument & int` and you provide the value \"1\", it will remain a string.\n\n\n### Using with Ptera\n\nColeo is based on [Ptera](https://github.com/mila-iqia/ptera) and all of Ptera's functionality is de facto available on functions marked as `@tooled`. For example, using the example above:\n\n```python\n# Set the variables in the greet function -- it's a bit like making an object\nhibob = greet.new(greeting=\"Hi\", name=\"Bob\")\nassert hibob() == \"Hi Bob!\"\n\n# Same as above but this would also change greeting/name in any other function\n# that is called by greet, and so on recursively (a bit like dynamic scoping)\nhibob = greet.tweaking({\"greeting\": \"Hi\", \"name\": \"Bob\"})\nassert hibob() == \"Hi Bob!\"\n\n# More complex behavior\nfrom ptera import overlay\nwith overlay.tweaking({\n    \"greet(greeting='Bonjour') > name\": \"Toto\"\n}):\n    assert greet() == \"Hello you!\"\n    assert greet.new(greeting=\"Hi\")() == \"Hi you!\"\n    assert greet.new(greeting=\"Bonjour\")() == \"Bonjour toto!\"\n```\n\nRead the documentation for [Ptera](https://github.com/mila-iqia/ptera) for more information. Note that Ptera is not limited to variables tagged `Argument`, it can manipulate *any* variable in a tooled function.\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/breuleux/coleo", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "coleo", "package_url": "https://pypi.org/project/coleo/", "platform": "", "project_url": "https://pypi.org/project/coleo/", "project_urls": {"Homepage": "https://github.com/breuleux/coleo", "Repository": "https://github.com/breuleux/coleo"}, "release_url": "https://pypi.org/project/coleo/0.1.1/", "requires_dist": ["ptera (>=0.2.0,<0.3.0)"], "requires_python": ">=3.7,<4.0", "summary": "The nicest way to develop a command-line interface", "version": "0.1.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Coleo</h1>\n<p>Coleo is a minimum-effort way to create a command-line interface in Python.</p>\n<ul>\n<li>Declare options where they are used.</li>\n<li>Scale easily to extensive CLIs with dozens of subcommands and options.</li>\n</ul>\n<h2>Basic usage</h2>\n<p>First, define a command line interface as follows:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">coleo</span> <span class=\"kn\">import</span> <span class=\"n\">Argument</span><span class=\"p\">,</span> <span class=\"n\">auto_cli</span><span class=\"p\">,</span> <span class=\"n\">default</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"c1\"># The greeting</span>\n    <span class=\"n\">greeting</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># The name to greet</span>\n    <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"you\"</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">\"</span><span class=\"si\">{</span><span class=\"n\">greeting</span><span class=\"si\">}</span><span class=\"s2\">, </span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!\"</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">\"__main__\"</span><span class=\"p\">:</span>\n    <span class=\"n\">auto_cli</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">)</span>\n</pre>\n<p>Then you may run it like this on the command line:</p>\n<pre>$ python hello.py\nHello, you!\n$ python hello.py --name Luke\nHello, Luke!\n$ python hello.py --name Luke --greeting <span class=\"s2\">\"Happy birthday\"</span>\nHappy birthday, Luke!\n$ python hello.py -h\nusage: hello.py <span class=\"o\">[</span>-h<span class=\"o\">]</span> <span class=\"o\">[</span>--greeting VALUE<span class=\"o\">]</span> <span class=\"o\">[</span>--name VALUE<span class=\"o\">]</span>\n\noptional arguments:\n  -h, --help        show this <span class=\"nb\">help</span> message and <span class=\"nb\">exit</span>\n  --greeting VALUE  The greeting\n  --name VALUE      The name to greet\n</pre>\n<ul>\n<li>Any variable annotated with <code>Argument</code> will become an option.</li>\n<li>You can provide a default value with <code>default(value)</code>, although you don't have to, if the argument is required.</li>\n<li>If there is a comment above the variable, it will be used as documentation for the option.</li>\n</ul>\n<h2>Argument types</h2>\n<p>By default, all arguments are interpreted as strings, but you can easily give a different type to an argument:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"c1\"># This argument will be converted to an int</span>\n    <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"c1\"># This argument will be converted to a float</span>\n    <span class=\"n\">y</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">float</span>\n    <span class=\"k\">return</span> <span class=\"n\">x</span> <span class=\"o\">+</span> <span class=\"n\">y</span>\n</pre>\n<p><strong>Boolean flags</strong></p>\n<p>If the type is bool, the option will take no argument, and the <code>--no-&lt;optname&gt;</code> option is added to negate the value. For example:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">flag</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">bool</span>\n    <span class=\"k\">return</span> <span class=\"s2\">\"yes!\"</span> <span class=\"k\">if</span> <span class=\"n\">flag</span> <span class=\"k\">else</span> <span class=\"s2\">\"no!\"</span>\n</pre>\n<p>Use it like this:</p>\n<pre>$ python script.py --flag\nyes!\n$ python script.py --no-flag\nno!\n</pre>\n<p><strong>Files</strong></p>\n<p>Use <code>coleo.FileType</code> (or <code>argparse.FileType</code>, it's the same thing) to open a file to read from or to write to:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">grocery_list</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"n\">coleo</span><span class=\"o\">.</span><span class=\"n\">FileType</span><span class=\"p\">(</span><span class=\"s2\">\"r\"</span><span class=\"p\">)</span>\n    <span class=\"k\">with</span> <span class=\"n\">grocery_list</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n        <span class=\"k\">for</span> <span class=\"n\">food</span> <span class=\"ow\">in</span> <span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">readlines</span><span class=\"p\">():</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Gotta buy some </span><span class=\"si\">{</span><span class=\"n\">food</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n</pre>\n<p><strong>Config</strong></p>\n<p>You can manipulate configuration files with <code>coleo.config</code> or <code>coleo.ConfigFile</code>:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"c1\"># ConfigFile lets you read or write a configuration file</span>\n    <span class=\"n\">book</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"n\">ConfigFile</span>\n    <span class=\"n\">contents</span> <span class=\"o\">=</span> <span class=\"n\">book</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span>\n    <span class=\"n\">contents</span><span class=\"p\">[</span><span class=\"s2\">\"xyz\"</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">\"abc\"</span>\n    <span class=\"n\">book</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">contents</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># config will read the file for you or parse the argument as JSON</span>\n    <span class=\"n\">magazine</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"n\">config</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">magazine</span><span class=\"p\">)</span>\n</pre>\n<p>Use it simply like this:</p>\n<pre>$ python librarian.py --book alice.json --magazine vogue.json\n$ python librarian.py --book history.yaml --magazine gamez.toml\n$ python librarian.py --book physics.json --magazine <span class=\"s1\">'{\"a\": 1, \"b\": 2}'</span>\n<span class=\"c1\"># etc</span>\n</pre>\n<p>Supported extensions are <code>json</code>, <code>yaml</code> and <code>toml</code> (the latter two require installing the <code>pyyaml</code> or <code>toml</code> packages).</p>\n<p><strong>Other</strong></p>\n<p>Any function can be used as a \"type\" for an argument. So for example, if you want to be able to provide lists and dictionaries on the command line you can simply use <code>json.loads</code> (although <code>coleo.config</code> is usually better, because it can also read files, in various formats):</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">obj</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"n\">json</span><span class=\"o\">.</span><span class=\"n\">loads</span>\n    <span class=\"k\">return</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"vm\">__name__</span>\n</pre>\n<pre>$ python json.py --obj <span class=\"m\">1</span>\nint\n$ python json.py --obj <span class=\"s1\">'\"hello\"'</span>\nstr\n$ python json.py --obj <span class=\"s1\">'{\"a\": 1, \"b\": 2}'</span>\ndict\n</pre>\n<p>If you're feeling super feisty and care nothing about safety, you can even use <code>eval</code>:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">obj</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">eval</span>\n    <span class=\"k\">return</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"vm\">__name__</span>\n</pre>\n<pre>$ python eval.py --obj <span class=\"s2\">\"1 + 2\"</span>\nint\n$ python eval.py --obj <span class=\"s2\">\"lambda x: x + 1\"</span>\n<span class=\"k\">function</span>\n</pre>\n<h2>Customization</h2>\n<p>Using comments of the form <code># [&lt;instruction&gt;: &lt;args ...&gt;]</code> you can customize the option parser:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"c1\"># This argument can be given as either --greeting or -g</span>\n    <span class=\"c1\"># [alias: -g]</span>\n    <span class=\"n\">greeting</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># This argument is positional</span>\n    <span class=\"c1\"># [positional]</span>\n    <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"you\"</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># This argument can only be given as -n</span>\n    <span class=\"c1\"># [options: -n]</span>\n    <span class=\"n\">ntimes</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">ntimes</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"</span><span class=\"si\">{</span><span class=\"n\">greeting</span><span class=\"si\">}</span><span class=\"s2\">, </span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!\"</span><span class=\"p\">)</span>\n</pre>\n<p>The above would be used like this:</p>\n<pre>$ python hello.py Alice -g Greetings -n <span class=\"m\">2</span>\nGreetings, Alice!\nGreetings, Alice!\n</pre>\n<p>The following customizations are available:</p>\n<ul>\n<li><code>[alias: ...]</code> defines one or several options that are aliases for the main one. Options are separated by spaces, commas or semicolons.</li>\n<li><code>[options: ...]</code> defines one or several options for this argument, which <em>override</em> the default one. Options are separated by spaces, commas or semicolons.</li>\n<li><code>[positional]</code> defines one positional argument.\n<ul>\n<li><code>[positional: n]</code>: n positional arguments (a list is returned).</li>\n<li><code>[positional: ?]</code>: one optional positional argument</li>\n<li><code>[positional: *]</code>: zero or more positional arguments</li>\n<li><code>[positional: +]</code>: one or more positional arguments</li>\n</ul>\n</li>\n</ul>\n<p>It is currently not possible to define multiple arguments as positional, although you can simulate it by using e.g. <code>[positional: 2]</code> on a single argument to get a pair, and then you can get the elements of the list.</p>\n<h2>Subcommands</h2>\n<p>You can create an interface with a hierarchy of subcommands by passing a dictionary to <code>auto_cli</code>:</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">add</span><span class=\"p\">():</span>\n    <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"n\">y</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"k\">return</span> <span class=\"n\">x</span> <span class=\"o\">+</span> <span class=\"n\">y</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">mul</span><span class=\"p\">():</span>\n    <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"n\">y</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"k\">return</span> <span class=\"n\">x</span> <span class=\"o\">*</span> <span class=\"n\">y</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">pow</span><span class=\"p\">():</span>\n    <span class=\"n\">base</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"n\">exponent</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">&amp;</span> <span class=\"nb\">int</span>\n    <span class=\"k\">return</span> <span class=\"n\">base</span> <span class=\"o\">**</span> <span class=\"n\">exponent</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">greet</span><span class=\"p\">():</span>\n    <span class=\"n\">greeting</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n    <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"you\"</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">\"</span><span class=\"si\">{</span><span class=\"n\">greeting</span><span class=\"si\">}</span><span class=\"s2\">, </span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!\"</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">\"__main__\"</span><span class=\"p\">:</span>\n    <span class=\"n\">auto_cli</span><span class=\"p\">({</span>\n        <span class=\"s2\">\"calc\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"s2\">\"__doc__\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Calculate something!\"</span><span class=\"p\">,</span>\n            <span class=\"s2\">\"add\"</span><span class=\"p\">:</span> <span class=\"n\">add</span><span class=\"p\">,</span>\n            <span class=\"s2\">\"mul\"</span><span class=\"p\">:</span> <span class=\"n\">mul</span><span class=\"p\">,</span>\n            <span class=\"s2\">\"pow\"</span><span class=\"p\">:</span> <span class=\"nb\">pow</span><span class=\"p\">,</span>\n        <span class=\"p\">},</span>\n        <span class=\"s2\">\"greet\"</span><span class=\"p\">:</span> <span class=\"n\">greet</span><span class=\"p\">,</span>\n    <span class=\"p\">})</span>\n</pre>\n<p>Then you may use it like this:</p>\n<pre>$ python multi.py greet --name Alice --greeting Hi\nHi, Alice!\n$ python multi.py calc add --x<span class=\"o\">=</span><span class=\"m\">3</span> --y<span class=\"o\">=</span><span class=\"m\">8</span>\n<span class=\"m\">11</span>\n</pre>\n<h2>Sharing arguments</h2>\n<p>It is possible to share behavior and arguments between subcommands, or to split complex functionality into multiple pieces. For example, maybe multiple subcommands in your application require an API key, which can either be given on the command line or can be read from a file. This is how you would share this behavior across all subcommands:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">coleo</span> <span class=\"kn\">import</span> <span class=\"n\">Argument</span><span class=\"p\">,</span> <span class=\"n\">auto_cli</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"p\">,</span> <span class=\"n\">tooled</span>\n\n<span class=\"nd\">@tooled</span>\n<span class=\"k\">def</span> <span class=\"nf\">apikey</span><span class=\"p\">():</span>\n    <span class=\"c1\"># The API key to use</span>\n    <span class=\"n\">key</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"kc\">None</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">key</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"c1\"># If no key parameter is given on the command line, try to read it from</span>\n        <span class=\"c1\"># some standard location.</span>\n        <span class=\"n\">key</span> <span class=\"o\">=</span> <span class=\"n\">config</span><span class=\"p\">(</span><span class=\"s2\">\"~/.config/myapp/config.json\"</span><span class=\"p\">)[</span><span class=\"s2\">\"key\"</span><span class=\"p\">]</span>\n    <span class=\"k\">return</span> <span class=\"n\">key</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">search</span><span class=\"p\">():</span>\n    <span class=\"n\">interface</span> <span class=\"o\">=</span> <span class=\"n\">Application</span><span class=\"p\">(</span><span class=\"n\">apikey</span><span class=\"p\">())</span>\n    <span class=\"n\">query</span><span class=\"p\">:</span> <span class=\"n\">Argument</span>\n    <span class=\"k\">return</span> <span class=\"n\">interface</span><span class=\"o\">.</span><span class=\"n\">search</span><span class=\"p\">(</span><span class=\"n\">query</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">install</span><span class=\"p\">():</span>\n    <span class=\"n\">interface</span> <span class=\"o\">=</span> <span class=\"n\">Application</span><span class=\"p\">(</span><span class=\"n\">apikey</span><span class=\"p\">())</span>\n    <span class=\"n\">package</span><span class=\"p\">:</span> <span class=\"n\">Argument</span>\n    <span class=\"k\">return</span> <span class=\"n\">interface</span><span class=\"o\">.</span><span class=\"n\">install</span><span class=\"p\">(</span><span class=\"n\">package</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">\"__main__\"</span><span class=\"p\">:</span>\n    <span class=\"n\">auto_cli</span><span class=\"p\">({</span><span class=\"s2\">\"search\"</span><span class=\"p\">:</span> <span class=\"n\">search</span><span class=\"p\">,</span> <span class=\"s2\">\"install\"</span><span class=\"p\">:</span> <span class=\"n\">install</span><span class=\"p\">})</span>\n</pre>\n<p>If a function is decorated with <code>@tooled</code> and is called from one of the main functions (or from another tooled function), Coleo will search for arguments in that function too. Thus any subcommand that calls <code>apikey()</code> will gain a <code>--key</code> option.</p>\n<p>In addition to this, you can \"share\" arguments by defining the same argument with the same type in multiple functions. Coleo will set all of them to the same value.</p>\n<p>For example, in the example above you could easily let the user specify the path to the file that contains the key, simply by replacing</p>\n<pre><span class=\"n\">key</span> <span class=\"o\">=</span> <span class=\"n\">config</span><span class=\"p\">(</span><span class=\"s2\">\"~/.config/myapp/config.json\"</span><span class=\"p\">)[</span><span class=\"s2\">\"key\"</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># ==&gt;</span>\n\n<span class=\"n\">config_path</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"~/.config/myapp/config.json\"</span><span class=\"p\">)</span>\n<span class=\"n\">key</span> <span class=\"o\">=</span> <span class=\"n\">config</span><span class=\"p\">(</span><span class=\"n\">config_path</span><span class=\"p\">)[</span><span class=\"s2\">\"key\"</span><span class=\"p\">]</span>\n</pre>\n<p>And that <code>config_path</code> argument could, of course, be declared in any other function that needs to read some configuration value.</p>\n<h2>Non-CLI usage</h2>\n<p>It is possible to set arguments without <code>auto_cli</code> with <code>setvars</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">coleo</span> <span class=\"kn\">import</span> <span class=\"n\">Argument</span><span class=\"p\">,</span> <span class=\"n\">setvars</span><span class=\"p\">,</span> <span class=\"n\">tooled</span>\n\n<span class=\"nd\">@tooled</span>\n<span class=\"k\">def</span> <span class=\"nf\">greet</span><span class=\"p\">():</span>\n    <span class=\"n\">greeting</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n    <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"n\">Argument</span> <span class=\"o\">=</span> <span class=\"n\">default</span><span class=\"p\">(</span><span class=\"s2\">\"you\"</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">\"</span><span class=\"si\">{</span><span class=\"n\">greeting</span><span class=\"si\">}</span><span class=\"s2\"> </span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!\"</span>\n\n<span class=\"k\">with</span> <span class=\"n\">setvars</span><span class=\"p\">(</span><span class=\"n\">greeting</span><span class=\"o\">=</span><span class=\"s2\">\"Hi\"</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">\"Bob\"</span><span class=\"p\">):</span>\n    <span class=\"k\">assert</span> <span class=\"n\">greet</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Hi bob!\"</span>\n</pre>\n<p>Note:</p>\n<ul>\n<li>With <code>setvars</code>, you <em>must</em> decorate the function with <code>@tooled</code> (this is something <code>auto_cli</code> does on your behalf).</li>\n<li><code>setvars</code> entirely bypasses the option parsing and the type annotations will not be used to wrap these values. In other words, if a variable is annotated <code>Argument &amp; int</code> and you provide the value \"1\", it will remain a string.</li>\n</ul>\n<h3>Using with Ptera</h3>\n<p>Coleo is based on <a href=\"https://github.com/mila-iqia/ptera\" rel=\"nofollow\">Ptera</a> and all of Ptera's functionality is de facto available on functions marked as <code>@tooled</code>. For example, using the example above:</p>\n<pre><span class=\"c1\"># Set the variables in the greet function -- it's a bit like making an object</span>\n<span class=\"n\">hibob</span> <span class=\"o\">=</span> <span class=\"n\">greet</span><span class=\"o\">.</span><span class=\"n\">new</span><span class=\"p\">(</span><span class=\"n\">greeting</span><span class=\"o\">=</span><span class=\"s2\">\"Hi\"</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">\"Bob\"</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">hibob</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Hi Bob!\"</span>\n\n<span class=\"c1\"># Same as above but this would also change greeting/name in any other function</span>\n<span class=\"c1\"># that is called by greet, and so on recursively (a bit like dynamic scoping)</span>\n<span class=\"n\">hibob</span> <span class=\"o\">=</span> <span class=\"n\">greet</span><span class=\"o\">.</span><span class=\"n\">tweaking</span><span class=\"p\">({</span><span class=\"s2\">\"greeting\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Hi\"</span><span class=\"p\">,</span> <span class=\"s2\">\"name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Bob\"</span><span class=\"p\">})</span>\n<span class=\"k\">assert</span> <span class=\"n\">hibob</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Hi Bob!\"</span>\n\n<span class=\"c1\"># More complex behavior</span>\n<span class=\"kn\">from</span> <span class=\"nn\">ptera</span> <span class=\"kn\">import</span> <span class=\"n\">overlay</span>\n<span class=\"k\">with</span> <span class=\"n\">overlay</span><span class=\"o\">.</span><span class=\"n\">tweaking</span><span class=\"p\">({</span>\n    <span class=\"s2\">\"greet(greeting='Bonjour') &gt; name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Toto\"</span>\n<span class=\"p\">}):</span>\n    <span class=\"k\">assert</span> <span class=\"n\">greet</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Hello you!\"</span>\n    <span class=\"k\">assert</span> <span class=\"n\">greet</span><span class=\"o\">.</span><span class=\"n\">new</span><span class=\"p\">(</span><span class=\"n\">greeting</span><span class=\"o\">=</span><span class=\"s2\">\"Hi\"</span><span class=\"p\">)()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Hi you!\"</span>\n    <span class=\"k\">assert</span> <span class=\"n\">greet</span><span class=\"o\">.</span><span class=\"n\">new</span><span class=\"p\">(</span><span class=\"n\">greeting</span><span class=\"o\">=</span><span class=\"s2\">\"Bonjour\"</span><span class=\"p\">)()</span> <span class=\"o\">==</span> <span class=\"s2\">\"Bonjour toto!\"</span>\n</pre>\n<p>Read the documentation for <a href=\"https://github.com/mila-iqia/ptera\" rel=\"nofollow\">Ptera</a> for more information. Note that Ptera is not limited to variables tagged <code>Argument</code>, it can manipulate <em>any</em> variable in a tooled function.</p>\n\n          </div>"}, "last_serial": 6885846, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "c45d50af7ea128f202715d6a4a7d93a0", "sha256": "29c6eeb2f09f1f741d13769fbb48d039c3c767a43d85bd0122b675554eca35f0"}, "downloads": -1, "filename": "coleo-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "c45d50af7ea128f202715d6a4a7d93a0", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7,<4.0", "size": 5358, "upload_time": "2020-03-23T17:20:43", "upload_time_iso_8601": "2020-03-23T17:20:43.119430Z", "url": "https://files.pythonhosted.org/packages/e9/ed/3a436eb211f9ee352d96bc4af6fa3ce170ee1c9f7a99865f06101bc4145c/coleo-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "7dc9be3366859d3cf11460e36061929c", "sha256": "680e9e5df42192e56dabcd8ab539b21edfc8d1546e39bcb611fdf6654e63936c"}, "downloads": -1, "filename": "coleo-0.1.0.tar.gz", "has_sig": false, "md5_digest": "7dc9be3366859d3cf11460e36061929c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7,<4.0", "size": 4974, "upload_time": "2020-03-23T17:20:45", "upload_time_iso_8601": "2020-03-23T17:20:45.521822Z", "url": "https://files.pythonhosted.org/packages/12/37/1874bcf7a57a0c9e13077cce4e3d232f4e0c8cde5398619711d091c0c59c/coleo-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "4de9448bb11fad60601759832ccae6b3", "sha256": "8955f4aeab09f7cda6e37c708e4ca95d3c3f0fcc36c9dacef9798991c11efd53"}, "downloads": -1, "filename": "coleo-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "4de9448bb11fad60601759832ccae6b3", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7,<4.0", "size": 8867, "upload_time": "2020-03-25T23:59:56", "upload_time_iso_8601": "2020-03-25T23:59:56.393732Z", "url": "https://files.pythonhosted.org/packages/12/97/48249b65de88d824843c28b92717597c595ed8c1ba7b1be3d118a6a437f5/coleo-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "6515fa3778d87030099a4321c59de9c9", "sha256": "f69616e8997e825c55d70adcb05164dfb9510e324944362cc4043e665ab8e1ff"}, "downloads": -1, "filename": "coleo-0.1.1.tar.gz", "has_sig": false, "md5_digest": "6515fa3778d87030099a4321c59de9c9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7,<4.0", "size": 12380, "upload_time": "2020-03-25T23:59:57", "upload_time_iso_8601": "2020-03-25T23:59:57.924375Z", "url": "https://files.pythonhosted.org/packages/c5/03/fc82015d97fda251cfcf5cdbc501b41fb141e170e9274ee2bccd36bd2e5c/coleo-0.1.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "4de9448bb11fad60601759832ccae6b3", "sha256": "8955f4aeab09f7cda6e37c708e4ca95d3c3f0fcc36c9dacef9798991c11efd53"}, "downloads": -1, "filename": "coleo-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "4de9448bb11fad60601759832ccae6b3", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.7,<4.0", "size": 8867, "upload_time": "2020-03-25T23:59:56", "upload_time_iso_8601": "2020-03-25T23:59:56.393732Z", "url": "https://files.pythonhosted.org/packages/12/97/48249b65de88d824843c28b92717597c595ed8c1ba7b1be3d118a6a437f5/coleo-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "6515fa3778d87030099a4321c59de9c9", "sha256": "f69616e8997e825c55d70adcb05164dfb9510e324944362cc4043e665ab8e1ff"}, "downloads": -1, "filename": "coleo-0.1.1.tar.gz", "has_sig": false, "md5_digest": "6515fa3778d87030099a4321c59de9c9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.7,<4.0", "size": 12380, "upload_time": "2020-03-25T23:59:57", "upload_time_iso_8601": "2020-03-25T23:59:57.924375Z", "url": "https://files.pythonhosted.org/packages/c5/03/fc82015d97fda251cfcf5cdbc501b41fb141e170e9274ee2bccd36bd2e5c/coleo-0.1.1.tar.gz", "yanked": false}], "timestamp": "Thu May  7 22:18:04 2020"}