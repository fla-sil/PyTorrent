{"info": {"author": "Thomas Buchberger", "author_email": "t.buchberger@4teamwork.ch", "bugtrack_url": null, "classifiers": ["Framework :: Plone", "Programming Language :: Python"], "description": "Introduction\n============\n\nThis product allows migrating various user specific data associated with a\nprincipal ID (user or group) to an other principal ID. It's especially useful\nif IDs have to be renamed.\n\nCurrently the following user data can be migrated:\n\n- Users (ZODB User Manager)\n\n- User Properties (ZODB Mutable Property Provider)\n\n- Group Members\n\n- Local Roles\n\n- Dashboards\n\n- Home Folders\n\n\nInstallation\n============\n\nAdd ``ftw.usermigration`` to the list of eggs in your buildout.\nThen rerun buildout and restart your instance.\n\n\nUsage\n=====\n\nOpen ``@@user-migration`` in your browser.\n\nRegistering principal mappings\n------------------------------\n\nIf you would like to provide the principal mapping in a programmatic way\ninstead of entering it through-the-web, you can register one or more named\nadapters that implement ``IPrincipalMappingSource``.\n\nExample:\n\n.. code:: python\n\n\tclass MigrationMapping(object):\n\n\t    def __init__(self, portal, request):\n\t        self.portal = portal\n\t        self.request = request\n\n\t    def get_mapping(self):\n\t        mapping = {'old_user': 'new_user',\n\t                   'old_group': 'new_group'}\n\t        return mapping\n\nZCML:\n\n.. code:: xml\n\n    <adapter\n        factory=\"my.package.migration.MigrationMapping\"\n        provides=\"ftw.usermigration.interfaces.IPrincipalMappingSource\"\n        for=\"Products.CMFPlone.interfaces.siteroot.IPloneSiteRoot\n             zope.publisher.interfaces.browser.IBrowserRequest\"\n        name=\"ad-migration-2015\"\n    />\n\nThis will result in this mapping being selectable as a mapping source with the\nname ``ad-migration-2015`` in the ``@@user-migration`` form.\n\nRegistering pre- and post-migration hooks\n-----------------------------------------\n\nIf you want to provide your own code that runs before or after any of the\nbuilt-in migration types in ``ftw.usermigration``, you can do so by registering\nhooks that implement the ``IPreMigrationHook`` or ``IPostMigrationHook`` interface.\n\nExample:\n\n.. code:: python\n\n  class ExamplePreMigrationHook(object):\n\n      def __init__(self, portal, request):\n          self.portal = portal\n          self.request = request\n\n      def execute(self, principal_mapping, mode):\n          # ...\n          # your code here\n          # ...\n          results = {\n              'Step 1': {\n                  'moved': [('/foo', 'old', 'new')],\n                  'copied': [],\n                  'deleted': []},\n              'Step 2': {\n                  'moved': [('/bar', 'old', 'new')],\n                  'copied': [],\n                  'deleted': []},\n          }\n          return results\n\nA hook adapter's ``execute()`` method receives the ``principal_mapping`` and\n``mode`` as arguments.\n\nIts results are expected to be a dict of dicts: The outer\ndictionary allows for a hook to group several steps it executes and\nreport their results separately. The inner dictionary follows the same\nstructure as the results of the built-in migrations.\n\n\nZCML:\n\n.. code:: xml\n\n    <adapter\n        factory=\".migrations.ExamplePreMigrationHook\"\n        provides=\"ftw.usermigration.interfaces.IPreMigrationHook\"\n        for=\"Products.CMFPlone.interfaces.siteroot.IPloneSiteRoot\n             zope.publisher.interfaces.browser.IBrowserRequest\"\n        name=\"example-pre-migration-hook\"\n    />\n\n\nLinks\n=====\n\n- Main github project repository:\n  https://github.com/4teamwork/ftw.usermigration\n- Issue tracker:\n  https://github.com/4teamwork/ftw.usermigration/issues\n- Pypi: http://pypi.python.org/pypi/ftw.usermigration\n- Continuous integration: https://jenkins.4teamwork.ch/search?q=ftw.usermigration\n\n\nCopyright\n=========\n\nThis package is copyright by `4teamwork <http://www.4teamwork.ch/>`_.\n\n``ftw.usermigration`` is licensed under GNU General Public License, version 2.\n\nChangelog\n=========\n\n1.2.0 (2017-05-01)\n------------------\n\n- Implement loginnames migration step [elioschmutz]\n\n- Fix migrating users whose username is the beginning of another username [elioschmutz]\n\n- Implement group members migration [elioschmutz]\n\n- Drop Plone 4.1 support. [jone]\n\n\n1.1 (2015-04-17)\n----------------\n\n- Add option to only display a summary of the migration results.\n  [lgraf]\n\n- Add logging of detailed migration results to logfile (optional).\n  [lgraf]\n\n- Add migration for global roles (portal_role_manager).\n  [lgraf]\n\n- Add support for pre- and post-migration hooks.\n  [lgraf]\n\n- Make sure `Migrations` field always uses the CheckBoxFieldWidget.\n  [lgraf]\n\n- Use transaction.doom() for dry runs.\n  This ensures that even an accidental commit() can't result in a DB write.\n  [lgraf]\n\n- Add support for programmatically providing principal mappings\n  by registering an IPrincipalMappingSource named adapter.\n  [lgraf]\n\n- Rename `user` to `principal` where applicable:\n  Most of the operations work for groups as well as for users.\n  Therefore the mapping can contain principal IDs, not just\n  user IDs.\n  [lgraf]\n\n\n1.0 (2014-06-16)\n----------------\n\n- Initial release", "description_content_type": null, "docs_url": null, "download_url": "UNKNOWN", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/4teamwork/ftw.usermigration", "keywords": "", "license": "GPL", "maintainer": null, "maintainer_email": null, "name": "ftw.usermigration", "package_url": "https://pypi.org/project/ftw.usermigration/", "platform": "UNKNOWN", "project_url": "https://pypi.org/project/ftw.usermigration/", "project_urls": {"Download": "UNKNOWN", "Homepage": "https://github.com/4teamwork/ftw.usermigration"}, "release_url": "https://pypi.org/project/ftw.usermigration/1.2.0/", "requires_dist": null, "requires_python": null, "summary": "User migration for Plone", "version": "1.2.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"introduction\">\n<h2>Introduction</h2>\n<p>This product allows migrating various user specific data associated with a\nprincipal ID (user or group) to an other principal ID. It\u2019s especially useful\nif IDs have to be renamed.</p>\n<p>Currently the following user data can be migrated:</p>\n<ul>\n<li>Users (ZODB User Manager)</li>\n<li>User Properties (ZODB Mutable Property Provider)</li>\n<li>Group Members</li>\n<li>Local Roles</li>\n<li>Dashboards</li>\n<li>Home Folders</li>\n</ul>\n</div>\n<div id=\"installation\">\n<h2>Installation</h2>\n<p>Add <tt>ftw.usermigration</tt> to the list of eggs in your buildout.\nThen rerun buildout and restart your instance.</p>\n</div>\n<div id=\"usage\">\n<h2>Usage</h2>\n<p>Open <tt><span class=\"pre\">@@user-migration</span></tt> in your browser.</p>\n<div id=\"registering-principal-mappings\">\n<h3>Registering principal mappings</h3>\n<p>If you would like to provide the principal mapping in a programmatic way\ninstead of entering it through-the-web, you can register one or more named\nadapters that implement <tt>IPrincipalMappingSource</tt>.</p>\n<p>Example:</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">MigrationMapping</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">portal</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">portal</span> <span class=\"o\">=</span> <span class=\"n\">portal</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">request</span> <span class=\"o\">=</span> <span class=\"n\">request</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">get_mapping</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">mapping</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">'old_user'</span><span class=\"p\">:</span> <span class=\"s1\">'new_user'</span><span class=\"p\">,</span>\n                   <span class=\"s1\">'old_group'</span><span class=\"p\">:</span> <span class=\"s1\">'new_group'</span><span class=\"p\">}</span>\n        <span class=\"k\">return</span> <span class=\"n\">mapping</span>\n</pre>\n<p>ZCML:</p>\n<pre><span class=\"nt\">&lt;adapter</span>\n    <span class=\"na\">factory=</span><span class=\"s\">\"my.package.migration.MigrationMapping\"</span>\n    <span class=\"na\">provides=</span><span class=\"s\">\"ftw.usermigration.interfaces.IPrincipalMappingSource\"</span>\n    <span class=\"na\">for=</span><span class=\"s\">\"Products.CMFPlone.interfaces.siteroot.IPloneSiteRoot\n         zope.publisher.interfaces.browser.IBrowserRequest\"</span>\n    <span class=\"na\">name=</span><span class=\"s\">\"ad-migration-2015\"</span>\n<span class=\"nt\">/&gt;</span>\n</pre>\n<p>This will result in this mapping being selectable as a mapping source with the\nname <tt><span class=\"pre\">ad-migration-2015</span></tt> in the <tt><span class=\"pre\">@@user-migration</span></tt> form.</p>\n</div>\n<div id=\"registering-pre-and-post-migration-hooks\">\n<h3>Registering pre- and post-migration hooks</h3>\n<p>If you want to provide your own code that runs before or after any of the\nbuilt-in migration types in <tt>ftw.usermigration</tt>, you can do so by registering\nhooks that implement the <tt>IPreMigrationHook</tt> or <tt>IPostMigrationHook</tt> interface.</p>\n<p>Example:</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">ExamplePreMigrationHook</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">portal</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">portal</span> <span class=\"o\">=</span> <span class=\"n\">portal</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">request</span> <span class=\"o\">=</span> <span class=\"n\">request</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">execute</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">principal_mapping</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"p\">):</span>\n        <span class=\"c1\"># ...</span>\n        <span class=\"c1\"># your code here</span>\n        <span class=\"c1\"># ...</span>\n        <span class=\"n\">results</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"s1\">'Step 1'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n                <span class=\"s1\">'moved'</span><span class=\"p\">:</span> <span class=\"p\">[(</span><span class=\"s1\">'/foo'</span><span class=\"p\">,</span> <span class=\"s1\">'old'</span><span class=\"p\">,</span> <span class=\"s1\">'new'</span><span class=\"p\">)],</span>\n                <span class=\"s1\">'copied'</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n                <span class=\"s1\">'deleted'</span><span class=\"p\">:</span> <span class=\"p\">[]},</span>\n            <span class=\"s1\">'Step 2'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n                <span class=\"s1\">'moved'</span><span class=\"p\">:</span> <span class=\"p\">[(</span><span class=\"s1\">'/bar'</span><span class=\"p\">,</span> <span class=\"s1\">'old'</span><span class=\"p\">,</span> <span class=\"s1\">'new'</span><span class=\"p\">)],</span>\n                <span class=\"s1\">'copied'</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n                <span class=\"s1\">'deleted'</span><span class=\"p\">:</span> <span class=\"p\">[]},</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">return</span> <span class=\"n\">results</span>\n</pre>\n<p>A hook adapter\u2019s <tt>execute()</tt> method receives the <tt>principal_mapping</tt> and\n<tt>mode</tt> as arguments.</p>\n<p>Its results are expected to be a dict of dicts: The outer\ndictionary allows for a hook to group several steps it executes and\nreport their results separately. The inner dictionary follows the same\nstructure as the results of the built-in migrations.</p>\n<p>ZCML:</p>\n<pre><span class=\"nt\">&lt;adapter</span>\n    <span class=\"na\">factory=</span><span class=\"s\">\".migrations.ExamplePreMigrationHook\"</span>\n    <span class=\"na\">provides=</span><span class=\"s\">\"ftw.usermigration.interfaces.IPreMigrationHook\"</span>\n    <span class=\"na\">for=</span><span class=\"s\">\"Products.CMFPlone.interfaces.siteroot.IPloneSiteRoot\n         zope.publisher.interfaces.browser.IBrowserRequest\"</span>\n    <span class=\"na\">name=</span><span class=\"s\">\"example-pre-migration-hook\"</span>\n<span class=\"nt\">/&gt;</span>\n</pre>\n</div>\n</div>\n<div id=\"links\">\n<h2>Links</h2>\n<ul>\n<li>Main github project repository:\n<a href=\"https://github.com/4teamwork/ftw.usermigration\" rel=\"nofollow\">https://github.com/4teamwork/ftw.usermigration</a></li>\n<li>Issue tracker:\n<a href=\"https://github.com/4teamwork/ftw.usermigration/issues\" rel=\"nofollow\">https://github.com/4teamwork/ftw.usermigration/issues</a></li>\n<li>Pypi: <a href=\"http://pypi.python.org/pypi/ftw.usermigration\" rel=\"nofollow\">http://pypi.python.org/pypi/ftw.usermigration</a></li>\n<li>Continuous integration: <a href=\"https://jenkins.4teamwork.ch/search?q=ftw.usermigration\" rel=\"nofollow\">https://jenkins.4teamwork.ch/search?q=ftw.usermigration</a></li>\n</ul>\n</div>\n<div id=\"copyright\">\n<h2>Copyright</h2>\n<p>This package is copyright by <a href=\"http://www.4teamwork.ch/\" rel=\"nofollow\">4teamwork</a>.</p>\n<p><tt>ftw.usermigration</tt> is licensed under GNU General Public License, version 2.</p>\n</div>\n<div id=\"changelog\">\n<h2>Changelog</h2>\n<div id=\"id1\">\n<h3>1.2.0 (2017-05-01)</h3>\n<ul>\n<li>Implement loginnames migration step [elioschmutz]</li>\n<li>Fix migrating users whose username is the beginning of another username [elioschmutz]</li>\n<li>Implement group members migration [elioschmutz]</li>\n<li>Drop Plone 4.1 support. [jone]</li>\n</ul>\n</div>\n<div id=\"id2\">\n<h3>1.1 (2015-04-17)</h3>\n<ul>\n<li>Add option to only display a summary of the migration results.\n[lgraf]</li>\n<li>Add logging of detailed migration results to logfile (optional).\n[lgraf]</li>\n<li>Add migration for global roles (portal_role_manager).\n[lgraf]</li>\n<li>Add support for pre- and post-migration hooks.\n[lgraf]</li>\n<li>Make sure <cite>Migrations</cite> field always uses the CheckBoxFieldWidget.\n[lgraf]</li>\n<li>Use transaction.doom() for dry runs.\nThis ensures that even an accidental commit() can\u2019t result in a DB write.\n[lgraf]</li>\n<li>Add support for programmatically providing principal mappings\nby registering an IPrincipalMappingSource named adapter.\n[lgraf]</li>\n<li>Rename <cite>user</cite> to <cite>principal</cite> where applicable:\nMost of the operations work for groups as well as for users.\nTherefore the mapping can contain principal IDs, not just\nuser IDs.\n[lgraf]</li>\n</ul>\n</div>\n<div id=\"id3\">\n<h3>1.0 (2014-06-16)</h3>\n<ul>\n<li>Initial release</li>\n</ul>\n</div>\n</div>\n\n          </div>"}, "last_serial": 6573533, "releases": {"1.0": [{"comment_text": "", "digests": {"md5": "094fcae6765b12d09fdba39773f71521", "sha256": "e6be8505389cef5d42e0abe3077cc4b4729a4c97aa0fd6979b88b04917450acd"}, "downloads": -1, "filename": "ftw.usermigration-1.0.zip", "has_sig": false, "md5_digest": "094fcae6765b12d09fdba39773f71521", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 28251, "upload_time": "2014-06-16T12:43:38", "upload_time_iso_8601": "2014-06-16T12:43:38.402717Z", "url": "https://files.pythonhosted.org/packages/90/07/7c1c0c5e56bc610f57ca043bf0bf33c7876099af9cfbcc23f338de25366f/ftw.usermigration-1.0.zip", "yanked": false}], "1.1": [{"comment_text": "", "digests": {"md5": "c4db61dc7fc5eef10c5426c52c02866c", "sha256": "536292fb56815887d754ca8a1e2e73a4adc6baa1322a5e0c02bd52a69c0d6c6c"}, "downloads": -1, "filename": "ftw.usermigration-1.1.zip", "has_sig": false, "md5_digest": "c4db61dc7fc5eef10c5426c52c02866c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 40563, "upload_time": "2015-04-17T10:05:04", "upload_time_iso_8601": "2015-04-17T10:05:04.619954Z", "url": "https://files.pythonhosted.org/packages/16/34/2db8259de0cdc1611abc2d1419ad90b4cf26b9514dc214be0ccc277764eb/ftw.usermigration-1.1.zip", "yanked": false}], "1.2.0": [{"comment_text": "", "digests": {"md5": "01cab64e00f5f38c3394df4aec863248", "sha256": "3c14661457f7a0db0e7bcf6429c016c7e1914ce48fb4762a64de9083cbbacb96"}, "downloads": -1, "filename": "ftw.usermigration-1.2.0.zip", "has_sig": false, "md5_digest": "01cab64e00f5f38c3394df4aec863248", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 48527, "upload_time": "2017-05-01T10:16:44", "upload_time_iso_8601": "2017-05-01T10:16:44.178410Z", "url": "https://files.pythonhosted.org/packages/44/64/d38176a80aa1eb795e5a7ff1fdb0102568e044f4e320a857fbe19f41dc16/ftw.usermigration-1.2.0.zip", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "01cab64e00f5f38c3394df4aec863248", "sha256": "3c14661457f7a0db0e7bcf6429c016c7e1914ce48fb4762a64de9083cbbacb96"}, "downloads": -1, "filename": "ftw.usermigration-1.2.0.zip", "has_sig": false, "md5_digest": "01cab64e00f5f38c3394df4aec863248", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 48527, "upload_time": "2017-05-01T10:16:44", "upload_time_iso_8601": "2017-05-01T10:16:44.178410Z", "url": "https://files.pythonhosted.org/packages/44/64/d38176a80aa1eb795e5a7ff1fdb0102568e044f4e320a857fbe19f41dc16/ftw.usermigration-1.2.0.zip", "yanked": false}], "timestamp": "Fri May  8 00:59:48 2020"}