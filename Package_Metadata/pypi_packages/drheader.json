{"info": {"author": "Santander UK Security Engineering", "author_email": "", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Environment :: Console", "Intended Audience :: Developers", "Natural Language :: English", "Programming Language :: Python :: 3.7", "Topic :: Security"], "description": "[![GitHub release](https://img.shields.io/github/release/Santandersecurityresearch/DrHeader.svg)](https://GitHub.com/Santandersecurityresearch/DrHeader/releases/)\n[![GitHub commits](https://img.shields.io/github/commits-since/Santandersecurityresearch/DrHeader/v1.2.1.svg)](https://GitHub.com/Santandersecurityresearch/DrHeader/commit/)\n[![Github all releases](https://img.shields.io/github/downloads/Santandersecurityresearch/DrHeader/total.svg)](https://GitHub.com/Santandersecurityresearch/DrHeader/releases/)\n[![HitCount](http://hits.dwyl.io/Santandersecurityresearch/DrHeader.svg)](http://hits.dwyl.io/Santandersecurityresearch/DrHeader)\n[![Total alerts](https://img.shields.io/lgtm/alerts/g/Santandersecurityresearch/DrHeader.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Santandersecurityresearch/DrHeader/alerts/)\n[![Language grade: Python](https://img.shields.io/lgtm/grade/python/g/Santandersecurityresearch/DrHeader.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Santandersecurityresearch/DrHeader/context:python)\n[![MIT license](http://img.shields.io/badge/license-MIT-brightgreen.svg)](http://opensource.org/licenses/MIT)\n\n\n# Welcome to drHEADer\n\nThere are a number of HTTP headers which enhance the security of a website when used. Often ignored, or unknown, these HTTP security headers help prevent common web application vulnerabilities when used. \n\nDrHEADer helps with the audit of security headers received in response to a single request or a list of requests. \n\nWhen combined with the OWASP [Application Security Verification Standard](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md) (ASVS) 4.0, it is a useful tool to include as part of an automated CI/CD pipeline which checks for missing HTTP headers. \n\n# How Do I Install It?\n\nThis project was developed with Python 3.7.4.  \nWhilst it works with Python 2.x, End of Life (EOL) is coming so if possible, use 3.x. The easiest way to install drHEADer is to clone this repository and via a terminal window, run the following command:\n\n\n``` console\n$ python3 setup.py install --user\n```\nThis will install all the pre-requisites and you'll end up with a drheader executable.\n\n\n# How Do I Use It?\n\nThere are two ways you could use drHEADer, depending on what you want to achieve. The easiest way is using the CLI.\n\n## CLI\n\ndrHEADer can perform a single scan against a target and report back which headers are present, like so:\n\n``` console\n$ drheader scan single https://santander.co.uk\n```\n\nIf you wish to scan multiple sites, you'll need the targets in a JSON format, or a txt file, like so:\n\n``` \n          [\n            {\n              \"url\": \"https://example.com\",\n              \"params\": {\n                  \"example_parameter_key\": \"example_parameter_value\"\n              }\n            },\n            ...\n          ]\n```\n\nFor txt files, use the following command:\n\n``` console\n$ drheader scan bulk -ff targets.txt\n```\n\nThere are a number of parameters you can specify during bulk scans, these are:\n| Option            | Description                                            |\n| :---------------- | :----------------------------------------------------- |\n| -p, --post        | Use a post request to obtain headers                   |\n| --json            | Output report as json                                  |\n| --debug           | Show error messages                                    |\n| --rules FILENAME  | Use custom rule set                                    |\n| --rules-uri URL   | Use custom rule set, to download from a remote server  |\n| --merge           | Merge custom rule set on top of default set            |\n| --help            | Show this message and exit                             |\n| --junit           | Creates a junit report in `./reports/junit.xml` folder |\n\nTo save scan results, you can use the --json parameter and pipe it to [jq](https://stedolan.github.io/jq/), which is a lightweight and flexible command-line JSON processor,like so:\n\n``` console\n$ drheader scan single https://santander.co.uk --json | jq '.'\n```\n\n## In a Project\n\nIt is also possible to call drHEADer from within an existing project, and this is achieved like so:\n\n    from drheader import Drheader\n\n    # create drheader instance\n    drheader_instance = Drheader(headers={'X-XSS-Protection': '1; mode=block'}, status_code=200)\n\n    report = drheader_instance.analyze()\n    print(report)\n\n### Customize HTTP method and headers\n\nBy default, the tool uses **GET** method when making a request, but you can change that by supplying the ```method``` argument like this:\n\n    # create drheader instance\n    drheader_instance = Drheader(url=\"http://test.com\", method=\"POST\")\n\nRemember you can use any method supported by ```requests``` such as POST, PUT, GET and DELETE.\n\nAt the same time, you can customize the headers sent by the request. For that, you just have to use the ```request_headers``` argument:\n\n    # create drheader instance\n    custom_headers = {\"token\": \"1234aerhga\"}\n    drheader_instance = Drheader(url=\"http://test.com\", request_headers=custom_headers)\n\nAs we continue development on drHEADer, we will further enhance this functionality. \n\n#### Other `requests` arguments\n\nThe _verify_ argument supported by ```requests``` can be included. The default value is set to `True`.\n\n    # create drheader instance\n    drheader_instance = Drheader(url=\"http://test.com\", verify=False)\n\nOther arguments may be included in the future such as _timeout_, _allow_redirects_ or _proxies_.\n\n# How Do I Customise drHEADer Rules?\n\nDrHEADer relies on a yaml file that defines the policy it will use when auditing security headers. The file is located at `./drheader/rules.yml`, and you can customise it to fit your particular needs. Please follow this [link](RULES.md) if you want to know more.  \n\n# Notes\n\n* On ubuntu systems you may need to install libyaml-dev to avoid errors related to a missing yaml.h.\n\n## Roadmap\n\nWe have a lot of ideas for drHEADer, and will push often as a result. Some of the things you'll see shortly are:\n\n* Building on the Python library to make it easier to embed in your own projects. \n* Releasing the API, which is seperate from the core library - the API allows you to hit URLs or endpoints at scale\n* Better integration into MiTM proxies. \n\n# Who Is Behind It?\n\nDrHEADer was developed by the Santander UK Security Engineering team, who are:\n\n* David Albone\n* [Javier Dom\u00ednguez Ruiz](https://github.com/javixeneize)\n* Fernando Cabrerizo\n* [James Morris](https://github.com/actuallyjamez)\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/santandersecurityresearch/drheader", "keywords": "drheader", "license": "", "maintainer": "", "maintainer_email": "", "name": "drheader", "package_url": "https://pypi.org/project/drheader/", "platform": "", "project_url": "https://pypi.org/project/drheader/", "project_urls": {"Homepage": "https://github.com/santandersecurityresearch/drheader"}, "release_url": "https://pypi.org/project/drheader/1.2.1/", "requires_dist": ["Click (>=6.0)", "requests (==2.22.0)", "jsonschema (==3.0.2)", "jsonschema[format]", "validators (==0.13.0)", "tabulate (==0.8.3)", "pyyaml (==5.3.1)", "junit-xml (==1.9)"], "requires_python": "", "summary": "DrHEADer helps with the audit of security headers received in response to a single request or a list of requests.", "version": "1.2.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p><a href=\"https://GitHub.com/Santandersecurityresearch/DrHeader/releases/\" rel=\"nofollow\"><img alt=\"GitHub release\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/434cc5ae49bb7b2dfa200fa9598fb0f98de579f7/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f53616e74616e646572736563757269747972657365617263682f44724865616465722e737667\"></a>\n<a href=\"https://GitHub.com/Santandersecurityresearch/DrHeader/commit/\" rel=\"nofollow\"><img alt=\"GitHub commits\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/3b7530a598055c37ae6fd6f489e517936925a892/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6d6d6974732d73696e63652f53616e74616e646572736563757269747972657365617263682f44724865616465722f76312e322e312e737667\"></a>\n<a href=\"https://GitHub.com/Santandersecurityresearch/DrHeader/releases/\" rel=\"nofollow\"><img alt=\"Github all releases\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/a859e55bbbaafc8a9efa619caff340218bc5d910/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f646f776e6c6f6164732f53616e74616e646572736563757269747972657365617263682f44724865616465722f746f74616c2e737667\"></a>\n<a href=\"http://hits.dwyl.io/Santandersecurityresearch/DrHeader\" rel=\"nofollow\"><img alt=\"HitCount\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ef919578d3db3726252c5ca1267a0060ccbd35ac/687474703a2f2f686974732e6477796c2e696f2f53616e74616e646572736563757269747972657365617263682f44724865616465722e737667\"></a>\n<a href=\"https://lgtm.com/projects/g/Santandersecurityresearch/DrHeader/alerts/\" rel=\"nofollow\"><img alt=\"Total alerts\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/3dc9f8cd3e9d68cc2b641385f0a6912f568b5c8c/68747470733a2f2f696d672e736869656c64732e696f2f6c67746d2f616c657274732f672f53616e74616e646572736563757269747972657365617263682f44724865616465722e7376673f6c6f676f3d6c67746d266c6f676f57696474683d3138\"></a>\n<a href=\"https://lgtm.com/projects/g/Santandersecurityresearch/DrHeader/context:python\" rel=\"nofollow\"><img alt=\"Language grade: Python\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ad3a825865c68ca065f9992458a4f622f01d22fd/68747470733a2f2f696d672e736869656c64732e696f2f6c67746d2f67726164652f707974686f6e2f672f53616e74616e646572736563757269747972657365617263682f44724865616465722e7376673f6c6f676f3d6c67746d266c6f676f57696474683d3138\"></a>\n<a href=\"http://opensource.org/licenses/MIT\" rel=\"nofollow\"><img alt=\"MIT license\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/273c229cce783df6c95a151db83b1f00cf93b97c/687474703a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d627269676874677265656e2e737667\"></a></p>\n<h1>Welcome to drHEADer</h1>\n<p>There are a number of HTTP headers which enhance the security of a website when used. Often ignored, or unknown, these HTTP security headers help prevent common web application vulnerabilities when used.</p>\n<p>DrHEADer helps with the audit of security headers received in response to a single request or a list of requests.</p>\n<p>When combined with the OWASP <a href=\"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md\" rel=\"nofollow\">Application Security Verification Standard</a> (ASVS) 4.0, it is a useful tool to include as part of an automated CI/CD pipeline which checks for missing HTTP headers.</p>\n<h1>How Do I Install It?</h1>\n<p>This project was developed with Python 3.7.4.<br>\nWhilst it works with Python 2.x, End of Life (EOL) is coming so if possible, use 3.x. The easiest way to install drHEADer is to clone this repository and via a terminal window, run the following command:</p>\n<pre><span class=\"gp\">$</span> python3 setup.py install --user\n</pre>\n<p>This will install all the pre-requisites and you'll end up with a drheader executable.</p>\n<h1>How Do I Use It?</h1>\n<p>There are two ways you could use drHEADer, depending on what you want to achieve. The easiest way is using the CLI.</p>\n<h2>CLI</h2>\n<p>drHEADer can perform a single scan against a target and report back which headers are present, like so:</p>\n<pre><span class=\"gp\">$</span> drheader scan single https://santander.co.uk\n</pre>\n<p>If you wish to scan multiple sites, you'll need the targets in a JSON format, or a txt file, like so:</p>\n<pre><code>          [\n            {\n              \"url\": \"https://example.com\",\n              \"params\": {\n                  \"example_parameter_key\": \"example_parameter_value\"\n              }\n            },\n            ...\n          ]\n</code></pre>\n<p>For txt files, use the following command:</p>\n<pre><span class=\"gp\">$</span> drheader scan bulk -ff targets.txt\n</pre>\n<p>There are a number of parameters you can specify during bulk scans, these are:\n| Option            | Description                                            |\n| :---------------- | :----------------------------------------------------- |\n| -p, --post        | Use a post request to obtain headers                   |\n| --json            | Output report as json                                  |\n| --debug           | Show error messages                                    |\n| --rules FILENAME  | Use custom rule set                                    |\n| --rules-uri URL   | Use custom rule set, to download from a remote server  |\n| --merge           | Merge custom rule set on top of default set            |\n| --help            | Show this message and exit                             |\n| --junit           | Creates a junit report in <code>./reports/junit.xml</code> folder |</p>\n<p>To save scan results, you can use the --json parameter and pipe it to <a href=\"https://stedolan.github.io/jq/\" rel=\"nofollow\">jq</a>, which is a lightweight and flexible command-line JSON processor,like so:</p>\n<pre><span class=\"gp\">$</span> drheader scan single https://santander.co.uk --json <span class=\"p\">|</span> jq <span class=\"s1\">'.'</span>\n</pre>\n<h2>In a Project</h2>\n<p>It is also possible to call drHEADer from within an existing project, and this is achieved like so:</p>\n<pre><code>from drheader import Drheader\n\n# create drheader instance\ndrheader_instance = Drheader(headers={'X-XSS-Protection': '1; mode=block'}, status_code=200)\n\nreport = drheader_instance.analyze()\nprint(report)\n</code></pre>\n<h3>Customize HTTP method and headers</h3>\n<p>By default, the tool uses <strong>GET</strong> method when making a request, but you can change that by supplying the <code>method</code> argument like this:</p>\n<pre><code># create drheader instance\ndrheader_instance = Drheader(url=\"http://test.com\", method=\"POST\")\n</code></pre>\n<p>Remember you can use any method supported by <code>requests</code> such as POST, PUT, GET and DELETE.</p>\n<p>At the same time, you can customize the headers sent by the request. For that, you just have to use the <code>request_headers</code> argument:</p>\n<pre><code># create drheader instance\ncustom_headers = {\"token\": \"1234aerhga\"}\ndrheader_instance = Drheader(url=\"http://test.com\", request_headers=custom_headers)\n</code></pre>\n<p>As we continue development on drHEADer, we will further enhance this functionality.</p>\n<h4>Other <code>requests</code> arguments</h4>\n<p>The <em>verify</em> argument supported by <code>requests</code> can be included. The default value is set to <code>True</code>.</p>\n<pre><code># create drheader instance\ndrheader_instance = Drheader(url=\"http://test.com\", verify=False)\n</code></pre>\n<p>Other arguments may be included in the future such as <em>timeout</em>, <em>allow_redirects</em> or <em>proxies</em>.</p>\n<h1>How Do I Customise drHEADer Rules?</h1>\n<p>DrHEADer relies on a yaml file that defines the policy it will use when auditing security headers. The file is located at <code>./drheader/rules.yml</code>, and you can customise it to fit your particular needs. Please follow this <a href=\"RULES.md\" rel=\"nofollow\">link</a> if you want to know more.</p>\n<h1>Notes</h1>\n<ul>\n<li>On ubuntu systems you may need to install libyaml-dev to avoid errors related to a missing yaml.h.</li>\n</ul>\n<h2>Roadmap</h2>\n<p>We have a lot of ideas for drHEADer, and will push often as a result. Some of the things you'll see shortly are:</p>\n<ul>\n<li>Building on the Python library to make it easier to embed in your own projects.</li>\n<li>Releasing the API, which is seperate from the core library - the API allows you to hit URLs or endpoints at scale</li>\n<li>Better integration into MiTM proxies.</li>\n</ul>\n<h1>Who Is Behind It?</h1>\n<p>DrHEADer was developed by the Santander UK Security Engineering team, who are:</p>\n<ul>\n<li>David Albone</li>\n<li><a href=\"https://github.com/javixeneize\" rel=\"nofollow\">Javier Dom\u00ednguez Ruiz</a></li>\n<li>Fernando Cabrerizo</li>\n<li><a href=\"https://github.com/actuallyjamez\" rel=\"nofollow\">James Morris</a></li>\n</ul>\n\n          </div>"}, "last_serial": 7093340, "releases": {"1.1.1": [{"comment_text": "", "digests": {"md5": "bbc7a0cf61baf42f0e3f251f0d4e9197", "sha256": "23ce74c49f35e9782609457faa7c95049ca93cdc00db54f934f42c408c1fbf74"}, "downloads": -1, "filename": "drheader-1.1.1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "bbc7a0cf61baf42f0e3f251f0d4e9197", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 9824, "upload_time": "2020-04-23T15:54:46", "upload_time_iso_8601": "2020-04-23T15:54:46.615263Z", "url": "https://files.pythonhosted.org/packages/32/a6/896e8f425e8700e9a8647cad95892360ddc536a64f7a8b4ed0ef1b04953d/drheader-1.1.1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "71dbe235d38a3fb7725a03b01469a641", "sha256": "6088bd00951637ab89d5ff26a7e087c60295cccd4fd420d29a04b03d8e99eee2"}, "downloads": -1, "filename": "drheader-1.1.1.tar.gz", "has_sig": false, "md5_digest": "71dbe235d38a3fb7725a03b01469a641", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21238, "upload_time": "2020-04-23T15:54:48", "upload_time_iso_8601": "2020-04-23T15:54:48.283692Z", "url": "https://files.pythonhosted.org/packages/78/c9/0831051048de5fb2fa4a7529c7fb9537c2272c1096f8d3838458d74db7f0/drheader-1.1.1.tar.gz", "yanked": false}], "1.2.0": [{"comment_text": "", "digests": {"md5": "b9dc0fa63ec544b1b630a6aae027d17d", "sha256": "7fe6afff7be7d851dd81c5d9900ea5159fc662abc68afd98ad36ced7d0cceb7f"}, "downloads": -1, "filename": "drheader-1.2.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "b9dc0fa63ec544b1b630a6aae027d17d", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 10188, "upload_time": "2020-04-24T10:38:16", "upload_time_iso_8601": "2020-04-24T10:38:16.667444Z", "url": "https://files.pythonhosted.org/packages/11/3e/97671c9ead1b7eaddfbb7f45a694f6eb27c8ee3bd709decd2ad335e7b24d/drheader-1.2.0-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "4d76c6a120b283ad7ee24bf06e1c4f8c", "sha256": "5364375b46449af7abf6a843bd1c6447bbbe66929eb4ff80a1cceb62034f975b"}, "downloads": -1, "filename": "drheader-1.2.0.tar.gz", "has_sig": false, "md5_digest": "4d76c6a120b283ad7ee24bf06e1c4f8c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 21758, "upload_time": "2020-04-24T10:38:17", "upload_time_iso_8601": "2020-04-24T10:38:17.479938Z", "url": "https://files.pythonhosted.org/packages/9c/66/796d9a0aad5394c01b8f9da06c2f7ae7d354c17bdf7419f6d68dda897bcb/drheader-1.2.0.tar.gz", "yanked": false}], "1.2.1": [{"comment_text": "", "digests": {"md5": "17a9a11dbef1ac4bba992116aa282498", "sha256": "7da96ee00429a403359879df5fa08afbd366aff0cf20d6fb7f79add0df36a14e"}, "downloads": -1, "filename": "drheader-1.2.1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "17a9a11dbef1ac4bba992116aa282498", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 12689, "upload_time": "2020-04-24T14:10:46", "upload_time_iso_8601": "2020-04-24T14:10:46.326815Z", "url": "https://files.pythonhosted.org/packages/bd/e4/81f7a9338f70a4c126369828d5639b180e8900bddd0334259d9f7b55dfdb/drheader-1.2.1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "4b045fc2ee3abd51fcae57c42b6781bf", "sha256": "9d483728e5983705cfd6cbf4be1a77ccc6302eda929225ef92751771dcba3447"}, "downloads": -1, "filename": "drheader-1.2.1.tar.gz", "has_sig": false, "md5_digest": "4b045fc2ee3abd51fcae57c42b6781bf", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24547, "upload_time": "2020-04-24T14:10:47", "upload_time_iso_8601": "2020-04-24T14:10:47.279809Z", "url": "https://files.pythonhosted.org/packages/31/9e/3be64f521ef58bb003970a64f705e357309bca401225c62bfe06e9b71578/drheader-1.2.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "17a9a11dbef1ac4bba992116aa282498", "sha256": "7da96ee00429a403359879df5fa08afbd366aff0cf20d6fb7f79add0df36a14e"}, "downloads": -1, "filename": "drheader-1.2.1-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "17a9a11dbef1ac4bba992116aa282498", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 12689, "upload_time": "2020-04-24T14:10:46", "upload_time_iso_8601": "2020-04-24T14:10:46.326815Z", "url": "https://files.pythonhosted.org/packages/bd/e4/81f7a9338f70a4c126369828d5639b180e8900bddd0334259d9f7b55dfdb/drheader-1.2.1-py2.py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "4b045fc2ee3abd51fcae57c42b6781bf", "sha256": "9d483728e5983705cfd6cbf4be1a77ccc6302eda929225ef92751771dcba3447"}, "downloads": -1, "filename": "drheader-1.2.1.tar.gz", "has_sig": false, "md5_digest": "4b045fc2ee3abd51fcae57c42b6781bf", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 24547, "upload_time": "2020-04-24T14:10:47", "upload_time_iso_8601": "2020-04-24T14:10:47.279809Z", "url": "https://files.pythonhosted.org/packages/31/9e/3be64f521ef58bb003970a64f705e357309bca401225c62bfe06e9b71578/drheader-1.2.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:49:37 2020"}