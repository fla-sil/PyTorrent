{"info": {"author": "Aaron Mussig", "author_email": "aaronmussig@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Science/Research", "License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Natural Language :: English", "Operating System :: OS Independent", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Scientific/Engineering :: Bio-Informatics"], "description": "# PhyloDm\n[![PyPI](https://img.shields.io/pypi/v/phylodm)](https://pypi.org/project/phylodm/)\n[![codecov.io](https://codecov.io/github/aaronmussig/PhyloDM/coverage.svg?branch=master)](https://codecov.io/github/aaronmussig/PhyloDM?branch=master)\n\nEfficient calculation of pairwise phylogenetic distance matrices.\n\n## Installation\n* PyPI: `pip install phylodm`\n\n## Usage\nThe leaf nodes in the tree must have unique names, otherwise a `DuplicateIndex` exception is raised.\n\n### Python library\n\n#### Creating a phylogenetic distance matrix\nA phylogenetic distance matrix (`PDM`) object can be created from either a DendroPy tree, or a\nnewick file:\n\n```python\nimport dendropy\nfrom phylodm.pdm import PDM\n\n# Load from DendroPy\nt = dendropy.Tree.get_from_string('(A:4,(B:3,C:4):1);', 'newick')\npdm = PDM.get_from_dendropy(tree=t, method='pd')\n\n# Load from Newick\nwith open('/tmp/newick.tree', 'w') as fh:\n    fh.write('(A:4,(B:3,C:4):1);')\npdm = PDM.get_from_newick_file('/tmp/newick.tree', method='pd')\n```\n\nOnce created, a `PDM` can be cached to disk, where it can be later loaded:\n\n```python\nimport dendropy\nfrom phylodm.pdm import PDM\n\n# Create a PDM.\nt = dendropy.Tree.get_from_string('(A:4,(B:3,C:4):1);', 'newick')\npdm_a = PDM.get_from_dendropy(tree=t, method='pd')\n\n# Write to cache.\npdm_a.save_to_path('/tmp/pdm.mat')\n\n# Load from cache.\npdm_b = PDM.get_from_path('/tmp/pdm.mat')\n```\n\n#### Accessing data\nThe `PDM.as_matrix` method generates a symmetrical numpy distance matrix and returns a tuple of\nkeys in the matrix row/column order:\n```python\nimport dendropy\nfrom phylodm.pdm import PDM\n\n# Load from DendroPy\nt = dendropy.Tree.get_from_string('(A:4,(B:3,C:4):1);', 'newick')\npdm = PDM.get_from_dendropy(tree=t, method='pd')\nlabels, mat = pdm.as_matrix(normalised=False)\n\"\"\"\n/------------[4]------------ A\n+\n|          /---------[3]--------- B\n\\---[1]---+\n           \\------------[4]------------- C\n\nlabels = ('A', 'B', 'C')\nmat = [[0. 8. 9.]\n       [8. 0. 7.]\n       [9. 7. 0.]]\n\"\"\"\n\n# Retrieving a specific value\npdm.get_value('A', 'A')  # 0\npdm.get_value('A', 'C')  # 9\npdm.get_value('C', 'A')  # 9\n```\n\n#### Method\nThe method parameter can be either patristic distance (`pd`) or the count of edges between \nleaves (`node`).\n\n#### Normalisation\nIf true, the data will be returned as normalised depending on the method:\n* `pd` = sum of all edges\n* `node` = count of all edges\n\n### CLI\nThe CLI can be used to create a phylogenetic distance matrix given a newick tree, e.g.:\n\n`python -m phylodm /path/to/newick.tree pd /path/to/matrix.mat`\n\n## Performance\nTests were executed using the `scripts/perf_test/collect_data.py` script on dual AMD EPYC 7402 \nCPUs with 10 trials.\n\nThese tests demonstrate that PhyloDM is more efficient than DendroPy's\nphylogenetic distance matrix when there are over 500 taxa in the tree. If there\nare less than 500 taxa, then use DendroPy for all of the great \nfeatures it provides. \n\n![DendroPy vs. PhyloDM PDM Construction Time](docs/img/dendropy_vs_phylodm_time.png)![DendroPy vs. PhyloDM PDM Maximum Memory Usage](docs/img/denropy_vs_phylodm_memory.png)\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/aaronmussig/PhyloDM", "keywords": "phylogenetic distance matrix symmetric", "license": "GPL3", "maintainer": "", "maintainer_email": "", "name": "phylodm", "package_url": "https://pypi.org/project/phylodm/", "platform": "", "project_url": "https://pypi.org/project/phylodm/", "project_urls": {"Bug Tracker": "https://github.com/aaronmussig/PhyloDM/issues", "Documentation": "https://github.com/aaronmussig/PhyloDM", "Homepage": "https://github.com/aaronmussig/PhyloDM", "Source Code": "https://github.com/aaronmussig/PhyloDM"}, "release_url": "https://pypi.org/project/phylodm/1.0.0/", "requires_dist": ["numpy", "dendropy", "h5py", "tqdm"], "requires_python": ">=3.6", "summary": "Efficient calculation of phylogenetic distance matrices.", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>PhyloDm</h1>\n<p><a href=\"https://pypi.org/project/phylodm/\" rel=\"nofollow\"><img alt=\"PyPI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/3e9c02f2c9b1ba28b47a2a4e93cf17af7577ec52/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f7068796c6f646d\"></a>\n<a href=\"https://codecov.io/github/aaronmussig/PhyloDM?branch=master\" rel=\"nofollow\"><img alt=\"codecov.io\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/4b859ee8d46953f962fa77651f4b8ab5933df58e/68747470733a2f2f636f6465636f762e696f2f6769746875622f6161726f6e6d75737369672f5068796c6f444d2f636f7665726167652e7376673f6272616e63683d6d6173746572\"></a></p>\n<p>Efficient calculation of pairwise phylogenetic distance matrices.</p>\n<h2>Installation</h2>\n<ul>\n<li>PyPI: <code>pip install phylodm</code></li>\n</ul>\n<h2>Usage</h2>\n<p>The leaf nodes in the tree must have unique names, otherwise a <code>DuplicateIndex</code> exception is raised.</p>\n<h3>Python library</h3>\n<h4>Creating a phylogenetic distance matrix</h4>\n<p>A phylogenetic distance matrix (<code>PDM</code>) object can be created from either a DendroPy tree, or a\nnewick file:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">dendropy</span>\n<span class=\"kn\">from</span> <span class=\"nn\">phylodm.pdm</span> <span class=\"kn\">import</span> <span class=\"n\">PDM</span>\n\n<span class=\"c1\"># Load from DendroPy</span>\n<span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">dendropy</span><span class=\"o\">.</span><span class=\"n\">Tree</span><span class=\"o\">.</span><span class=\"n\">get_from_string</span><span class=\"p\">(</span><span class=\"s1\">'(A:4,(B:3,C:4):1);'</span><span class=\"p\">,</span> <span class=\"s1\">'newick'</span><span class=\"p\">)</span>\n<span class=\"n\">pdm</span> <span class=\"o\">=</span> <span class=\"n\">PDM</span><span class=\"o\">.</span><span class=\"n\">get_from_dendropy</span><span class=\"p\">(</span><span class=\"n\">tree</span><span class=\"o\">=</span><span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"s1\">'pd'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Load from Newick</span>\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">'/tmp/newick.tree'</span><span class=\"p\">,</span> <span class=\"s1\">'w'</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">fh</span><span class=\"p\">:</span>\n    <span class=\"n\">fh</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s1\">'(A:4,(B:3,C:4):1);'</span><span class=\"p\">)</span>\n<span class=\"n\">pdm</span> <span class=\"o\">=</span> <span class=\"n\">PDM</span><span class=\"o\">.</span><span class=\"n\">get_from_newick_file</span><span class=\"p\">(</span><span class=\"s1\">'/tmp/newick.tree'</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"s1\">'pd'</span><span class=\"p\">)</span>\n</pre>\n<p>Once created, a <code>PDM</code> can be cached to disk, where it can be later loaded:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">dendropy</span>\n<span class=\"kn\">from</span> <span class=\"nn\">phylodm.pdm</span> <span class=\"kn\">import</span> <span class=\"n\">PDM</span>\n\n<span class=\"c1\"># Create a PDM.</span>\n<span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">dendropy</span><span class=\"o\">.</span><span class=\"n\">Tree</span><span class=\"o\">.</span><span class=\"n\">get_from_string</span><span class=\"p\">(</span><span class=\"s1\">'(A:4,(B:3,C:4):1);'</span><span class=\"p\">,</span> <span class=\"s1\">'newick'</span><span class=\"p\">)</span>\n<span class=\"n\">pdm_a</span> <span class=\"o\">=</span> <span class=\"n\">PDM</span><span class=\"o\">.</span><span class=\"n\">get_from_dendropy</span><span class=\"p\">(</span><span class=\"n\">tree</span><span class=\"o\">=</span><span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"s1\">'pd'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Write to cache.</span>\n<span class=\"n\">pdm_a</span><span class=\"o\">.</span><span class=\"n\">save_to_path</span><span class=\"p\">(</span><span class=\"s1\">'/tmp/pdm.mat'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Load from cache.</span>\n<span class=\"n\">pdm_b</span> <span class=\"o\">=</span> <span class=\"n\">PDM</span><span class=\"o\">.</span><span class=\"n\">get_from_path</span><span class=\"p\">(</span><span class=\"s1\">'/tmp/pdm.mat'</span><span class=\"p\">)</span>\n</pre>\n<h4>Accessing data</h4>\n<p>The <code>PDM.as_matrix</code> method generates a symmetrical numpy distance matrix and returns a tuple of\nkeys in the matrix row/column order:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">dendropy</span>\n<span class=\"kn\">from</span> <span class=\"nn\">phylodm.pdm</span> <span class=\"kn\">import</span> <span class=\"n\">PDM</span>\n\n<span class=\"c1\"># Load from DendroPy</span>\n<span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">dendropy</span><span class=\"o\">.</span><span class=\"n\">Tree</span><span class=\"o\">.</span><span class=\"n\">get_from_string</span><span class=\"p\">(</span><span class=\"s1\">'(A:4,(B:3,C:4):1);'</span><span class=\"p\">,</span> <span class=\"s1\">'newick'</span><span class=\"p\">)</span>\n<span class=\"n\">pdm</span> <span class=\"o\">=</span> <span class=\"n\">PDM</span><span class=\"o\">.</span><span class=\"n\">get_from_dendropy</span><span class=\"p\">(</span><span class=\"n\">tree</span><span class=\"o\">=</span><span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"s1\">'pd'</span><span class=\"p\">)</span>\n<span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">mat</span> <span class=\"o\">=</span> <span class=\"n\">pdm</span><span class=\"o\">.</span><span class=\"n\">as_matrix</span><span class=\"p\">(</span><span class=\"n\">normalised</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">/------------[4]------------ A</span>\n<span class=\"sd\">+</span>\n<span class=\"sd\">|          /---------[3]--------- B</span>\n<span class=\"sd\">\\---[1]---+</span>\n<span class=\"sd\">           \\------------[4]------------- C</span>\n\n<span class=\"sd\">labels = ('A', 'B', 'C')</span>\n<span class=\"sd\">mat = [[0. 8. 9.]</span>\n<span class=\"sd\">       [8. 0. 7.]</span>\n<span class=\"sd\">       [9. 7. 0.]]</span>\n<span class=\"sd\">\"\"\"</span>\n\n<span class=\"c1\"># Retrieving a specific value</span>\n<span class=\"n\">pdm</span><span class=\"o\">.</span><span class=\"n\">get_value</span><span class=\"p\">(</span><span class=\"s1\">'A'</span><span class=\"p\">,</span> <span class=\"s1\">'A'</span><span class=\"p\">)</span>  <span class=\"c1\"># 0</span>\n<span class=\"n\">pdm</span><span class=\"o\">.</span><span class=\"n\">get_value</span><span class=\"p\">(</span><span class=\"s1\">'A'</span><span class=\"p\">,</span> <span class=\"s1\">'C'</span><span class=\"p\">)</span>  <span class=\"c1\"># 9</span>\n<span class=\"n\">pdm</span><span class=\"o\">.</span><span class=\"n\">get_value</span><span class=\"p\">(</span><span class=\"s1\">'C'</span><span class=\"p\">,</span> <span class=\"s1\">'A'</span><span class=\"p\">)</span>  <span class=\"c1\"># 9</span>\n</pre>\n<h4>Method</h4>\n<p>The method parameter can be either patristic distance (<code>pd</code>) or the count of edges between\nleaves (<code>node</code>).</p>\n<h4>Normalisation</h4>\n<p>If true, the data will be returned as normalised depending on the method:</p>\n<ul>\n<li><code>pd</code> = sum of all edges</li>\n<li><code>node</code> = count of all edges</li>\n</ul>\n<h3>CLI</h3>\n<p>The CLI can be used to create a phylogenetic distance matrix given a newick tree, e.g.:</p>\n<p><code>python -m phylodm /path/to/newick.tree pd /path/to/matrix.mat</code></p>\n<h2>Performance</h2>\n<p>Tests were executed using the <code>scripts/perf_test/collect_data.py</code> script on dual AMD EPYC 7402\nCPUs with 10 trials.</p>\n<p>These tests demonstrate that PhyloDM is more efficient than DendroPy's\nphylogenetic distance matrix when there are over 500 taxa in the tree. If there\nare less than 500 taxa, then use DendroPy for all of the great\nfeatures it provides.</p>\n<p><img alt=\"DendroPy vs. PhyloDM PDM Construction Time\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/009a2b5ba72a8b44fc13db863c38e3862eb3d54c/646f63732f696d672f64656e64726f70795f76735f7068796c6f646d5f74696d652e706e67\"><img alt=\"DendroPy vs. PhyloDM PDM Maximum Memory Usage\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/6545693ba784ae3cb462c91e5875b4aa6be6e22a/646f63732f696d672f64656e726f70795f76735f7068796c6f646d5f6d656d6f72792e706e67\"></p>\n\n          </div>"}, "last_serial": 6940354, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "fb38eefe706d4b8081378ea900be5383", "sha256": "0a510c17b9f83fcf38d93ea48eebe591bf62a33545fda40ebad650acbb7142b8"}, "downloads": -1, "filename": "phylodm-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "fb38eefe706d4b8081378ea900be5383", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 36890, "upload_time": "2020-04-03T02:08:08", "upload_time_iso_8601": "2020-04-03T02:08:08.447638Z", "url": "https://files.pythonhosted.org/packages/c2/0d/f660d2ccd30068c220d4460e63aa7c717401cb48459e647b3ec55fa3b5f2/phylodm-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "1fe9e5dd3e46debb3bcb016d6198ab91", "sha256": "8104f1b8599be84469cb0a0227f7c78e76029bd0b4cabedbbc9978473368e377"}, "downloads": -1, "filename": "phylodm-1.0.0.tar.gz", "has_sig": false, "md5_digest": "1fe9e5dd3e46debb3bcb016d6198ab91", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 21376, "upload_time": "2020-04-03T02:08:12", "upload_time_iso_8601": "2020-04-03T02:08:12.144815Z", "url": "https://files.pythonhosted.org/packages/1e/ef/d71342b87915aa3f6935b15c61dcb5b3d1be73f5a03c56baec0865dcb4f7/phylodm-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "fb38eefe706d4b8081378ea900be5383", "sha256": "0a510c17b9f83fcf38d93ea48eebe591bf62a33545fda40ebad650acbb7142b8"}, "downloads": -1, "filename": "phylodm-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "fb38eefe706d4b8081378ea900be5383", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 36890, "upload_time": "2020-04-03T02:08:08", "upload_time_iso_8601": "2020-04-03T02:08:08.447638Z", "url": "https://files.pythonhosted.org/packages/c2/0d/f660d2ccd30068c220d4460e63aa7c717401cb48459e647b3ec55fa3b5f2/phylodm-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "1fe9e5dd3e46debb3bcb016d6198ab91", "sha256": "8104f1b8599be84469cb0a0227f7c78e76029bd0b4cabedbbc9978473368e377"}, "downloads": -1, "filename": "phylodm-1.0.0.tar.gz", "has_sig": false, "md5_digest": "1fe9e5dd3e46debb3bcb016d6198ab91", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 21376, "upload_time": "2020-04-03T02:08:12", "upload_time_iso_8601": "2020-04-03T02:08:12.144815Z", "url": "https://files.pythonhosted.org/packages/1e/ef/d71342b87915aa3f6935b15c61dcb5b3d1be73f5a03c56baec0865dcb4f7/phylodm-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:55:14 2020"}