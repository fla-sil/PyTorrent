{"info": {"author": "Max Brenner", "author_email": "xamrennerb@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 3 - Alpha", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Topic :: Software Development :: Libraries :: Python Modules"], "description": "Application Insights for Python\n===============================\n\n.. image:: https://github.com/brennerm/python-appinsights/workflows/.github/workflows/ci.yml/badge.svg\n    :target: .github/workflows/ci.yml\n\n.. image:: https://badge.fury.io/py/appinsights.svg\n    :target: http://badge.fury.io/py/appinsights\n\n\nThis project extends the Application Insights API surface to support Python.\n`Application Insights\n<http://azure.microsoft.com/services/application-insights/>`_ is a service that\nallows developers to keep their application available, performing and\nsucceeding. This Python module will allow you to send telemetry of various kinds\n(event, trace, exception, etc.) to the Application Insights service where they\ncan be visualized in the Azure Portal. A link to the Application Insights API\ndocumentation can be found `here\n<https://brennerm.github.io/python-appinsights/>`_.\n\nThis project is not officially supported and not recommended for high load\nproduction use. The project is open source and welcomes contributions.\n\nRequirements\n------------\n\nPython >=2.7 and Python >=3.4 are currently supported by this module.\n\nInstallation\n------------\n\nTo install the latest release you can use `pip <http://www.pip-installer.org/>`_.\n\n::\n\n    $ pip install appinsights\n\nDocumentation\n-------------\n\nPlease see https://brennerm.github.io/python-appinsights/ for full documentation.\n\nUsage\n-----\n\nOnce installed, you can send telemetry to Application Insights. Here are a few samples.\n\n    **Note**: before you can send data to you will need an instrumentation key. Please see the `Getting an Application Insights Instrumentation Key <https://github.com/Microsoft/AppInsights-Home/wiki#getting-an-application-insights-instrumentation-key>`_ section for more information.\n\n**Sending a simple event telemetry item**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.track_event('Test event')\n    tc.flush()\n\n**Sending an event telemetry item with custom properties and measurements**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.track_event('Test event', { 'foo': 'bar' }, { 'baz': 42 })\n    tc.flush()\n\n**Sending a trace telemetry item with custom properties**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.track_trace('Test trace', { 'foo': 'bar' })\n    tc.flush()\n\n**Sending a metric telemetry item**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.track_metric('My Metric', 42)\n    tc.flush()\n\n**Sending an availability telemetry item**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.track_availability('My Service', 250, True, \"West Europe\")\n    tc.flush()\n\n**Sending an exception telemetry item with custom properties and measurements**\n\n.. code:: python\n\n    import sys\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    try:\n        raise Exception('blah')\n    except:\n        tc.track_exception()\n\n    try:\n        raise Exception(\"blah\")\n    except:\n        tc.track_exception(*sys.exc_info(), properties={ 'foo': 'bar' }, measurements={ 'x': 42 })\n    tc.flush()\n\n**Configuring context for a telemetry client instance**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.context.application.ver = '1.2.3'\n    tc.context.device.id = 'My current device'\n    tc.context.device.oem_name = 'Asus'\n    tc.context.device.model = 'X31A'\n    tc.context.device.type = \"Other\"\n    tc.context.user.id = 'santa@northpole.net'\n    tc.context.properties['my_property'] = 'my_value'\n    tc.track_trace('My trace with context')\n    tc.flush()\n\n**Establishing correlation between telemetry objects**\n\ncontext field called operation_id can be set to associate telemetry items.\nSince operation_id is being set as a property of telemetry client, the client shouldn't be reused in parallel threads as it might lead to concurrency issues.\n\n.. code:: python\n  \n    tc = TelemetryClient(instrumentation_key=instrumentation_key)\n    tc.context.operation.id = <operation_id>\n    tc.track_trace('Test trace')\n    tc.flush()\n\n**Configuring channel related properties**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    # flush telemetry every 30 seconds (assuming we don't hit max_queue_item_count first)\n    tc.channel.sender.send_interval_in_milliseconds = 30 * 1000\n    # flush telemetry if we have 10 or more telemetry items in our queue\n    tc.channel.queue.max_queue_length = 10\n\n**Configuring TelemetryProcessor**\n\n.. code:: python\n\n    from applicationinsights import TelemetryClient\n    def process(data, context):\n       data.properties[\"NEW_PROP\"] = \"MYPROP\"  # Add property\n       context.user.id = \"MYID\"   # Change ID\n       return True # Not filtered\n    tc = TelemetryClient('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    tc.add_telemetry_processor(process)\n\n**Basic logging configuration (first option)**\n\n.. code:: python\n\n    import logging\n    from applicationinsights.logging import enable\n\n    # set up logging\n    enable('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    # log something (this will be sent to the Application Insights service as a trace)\n    logging.info('This is a message')\n\n    # logging shutdown will cause a flush of all un-sent telemetry items\n    logging.shutdown()\n\n**Basic logging configuration (second option)**\n\n.. code:: python\n\n    import logging\n    from applicationinsights.logging import LoggingHandler\n\n    # set up logging\n    handler = LoggingHandler('<YOUR INSTRUMENTATION KEY GOES HERE>')\n    logging.basicConfig(handlers=[ handler ], format='%(levelname)s: %(message)s', level=logging.DEBUG)\n\n    # log something (this will be sent to the Application Insights service as a trace)\n    logging.debug('This is a message')\n\n    try:\n        raise Exception('Some exception')\n    except:\n        # this will send an exception to the Application Insights service\n        logging.exception('Code went boom!')\n\n    # logging shutdown will cause a flush of all un-sent telemetry items\n    # alternatively flush manually via handler.flush()\n    logging.shutdown()\n\n**Advanced logging configuration**\n\n.. code:: python\n\n    import logging\n    from applicationinsights import channel\n    from applicationinsights.logging import LoggingHandler\n\n    # set up channel with context\n    telemetry_channel = channel.TelemetryChannel()\n    telemetry_channel.context.application.ver = '1.2.3'\n    telemetry_channel.context.properties['my_property'] = 'my_value'\n\n    # set up logging\n    handler = LoggingHandler('<YOUR INSTRUMENTATION KEY GOES HERE>', telemetry_channel=telemetry_channel)\n    handler.setLevel(logging.DEBUG)\n    handler.setFormatter(logging.Formatter('%(levelname)s: %(message)s'))\n    my_logger = logging.getLogger('simple_logger')\n    my_logger.setLevel(logging.DEBUG)\n    my_logger.addHandler(handler)\n\n    # log something (this will be sent to the Application Insights service as a trace)\n    my_logger.debug('This is a message')\n\n    # logging shutdown will cause a flush of all un-sent telemetry items\n    # alternatively flush manually via handler.flush()\n    logging.shutdown()\n\n**Logging unhandled exceptions**\n\n.. code:: python\n\n    from applicationinsights.exceptions import enable\n\n    # set up exception capture\n    enable('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    # raise an exception (this will be sent to the Application Insights service as an exception telemetry object)\n    raise Exception('Boom!')\n\n    # exceptions will cause a flush of all un-sent telemetry items\n\n**Logging unhandled exceptions with context**\n\n.. code:: python\n\n    from applicationinsights import channel\n    from applicationinsights.exceptions import enable\n\n    # set up channel with context\n    telemetry_channel = channel.TelemetryChannel()\n    telemetry_channel.context.application.ver = '1.2.3'\n    telemetry_channel.context.properties['my_property'] = 'my_value'\n\n    # set up exception capture\n    enable('<YOUR INSTRUMENTATION KEY GOES HERE>', telemetry_channel=telemetry_channel)\n\n    # raise an exception (this will be sent to the Application Insights service as an exception telemetry object)\n    raise Exception('Boom!')\n\n    # exceptions will cause a flush of all un-sent telemetry items\n\n**Track dependency telemetry for HTTP requests with requests**\n\n.. code:: python\n\n    from applicationinsights.client import enable_for_requests\n    import requests\n\n    enable_for_requests('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    requests.get(\"https://www.python.org/\")\n    # a dependency telemetry will be sent to the Application Insights service\n\n**Track dependency telemetry for HTTP requests with urllib**\n\n.. code:: python\n\n    from applicationinsights.client import enable_for_urllib\n    import urllib.requests\n\n    enable_for_urllib('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    urllib.request.urlopen(\"https://www.python.org/\")\n    # a dependency telemetry will be sent to the Application Insights service\n\n**Track dependency telemetry for HTTP requests with urllib2**\n\n.. code:: python\n\n    from applicationinsights.client import enable_for_urllib2\n    import urllib2\n\n    enable_for_urllib2('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    urllib2.urlopen(\"https://www.python.org/\")\n    # a dependency telemetry will be sent to the Application Insights service\n\n\n**Track dependency telemetry for HTTP requests with urllib3**\n\n.. code:: python\n\n    from applicationinsights.client import enable_for_urllib3\n    import urllib3.requests\n\n    enable_for_urllib3('<YOUR INSTRUMENTATION KEY GOES HERE>')\n\n    urllib3.PoolManager().request(\"GET\", \"https://www.python.org/\")\n    # a dependency telemetry will be sent to the Application Insights service\n\n\n**Integrating with Flask**\n\n.. code:: python\n\n    from flask import Flask\n    from applicationinsights.flask.ext import AppInsights\n    \n    # instantiate the Flask application\n    app = Flask(__name__)\n    app.config['APPINSIGHTS_INSTRUMENTATIONKEY'] = '<YOUR INSTRUMENTATION KEY GOES HERE>'\n\n    # log requests, traces and exceptions to the Application Insights service\n    appinsights = AppInsights(app)\n\n    # define a simple route\n    @app.route('/')\n    def hello_world():\n        # the following message will be sent to the Flask log as well as Application Insights\n        app.logger.info('Hello World route was called')\n\n        return 'Hello World!'\n\n    # run the application\n    if __name__ == '__main__':\n        app.run()\n\n**Integrating with Django**\n\nPlace the following in your `settings.py` file:\n\n.. code:: python\n\n    # If on Django < 1.10\n    MIDDLEWARE_CLASSES = [\n        # ... or whatever is below for you ...\n        'django.middleware.security.SecurityMiddleware',\n        'django.contrib.sessions.middleware.SessionMiddleware',\n        'django.middleware.common.CommonMiddleware',\n        'django.middleware.csrf.CsrfViewMiddleware',\n        'django.contrib.auth.middleware.AuthenticationMiddleware',\n        'django.contrib.auth.middleware.SessionAuthenticationMiddleware',\n        'django.contrib.messages.middleware.MessageMiddleware',\n        'django.middleware.clickjacking.XFrameOptionsMiddleware',\n        # ... or whatever is above for you ...\n        'applicationinsights.django.ApplicationInsightsMiddleware',   # Add this middleware to the end\n    ]\n\n    # If on Django >= 1.10\n    MIDDLEWARE = [\n        # ... or whatever is below for you ...\n        'django.middleware.security.SecurityMiddleware',\n        'django.contrib.sessions.middleware.SessionMiddleware',\n        'django.middleware.common.CommonMiddleware',\n        'django.middleware.csrf.CsrfViewMiddleware',\n        'django.contrib.auth.middleware.AuthenticationMiddleware',\n        'django.contrib.messages.middleware.MessageMiddleware',\n        'django.middleware.clickjacking.XFrameOptionsMiddleware',\n        # ... or whatever is above for you ...\n        'applicationinsights.django.ApplicationInsightsMiddleware',   # Add this middleware to the end\n    ]\n\n    APPLICATION_INSIGHTS = {\n        # (required) Your Application Insights instrumentation key\n        'ikey': \"00000000-0000-0000-0000-000000000000\",\n        \n        # (optional) By default, request names are logged as the request method\n        # and relative path of the URL.  To log the fully-qualified view names\n        # instead, set this to True.  Defaults to False.\n        'use_view_name': True,\n        \n        # (optional) To log arguments passed into the views as custom properties,\n        # set this to True.  Defaults to False.\n        'record_view_arguments': True,\n        \n        # (optional) Exceptions are logged by default, to disable, set this to False.\n        'log_exceptions': False,\n        \n        # (optional) Events are submitted to Application Insights asynchronously.\n        # send_interval specifies how often the queue is checked for items to submit.\n        # send_time specifies how long the sender waits for new input before recycling\n        # the background thread.\n        'send_interval': 1.0, # Check every second\n        'send_time': 3.0, # Wait up to 3 seconds for an event\n        \n        # (optional, uncommon) If you must send to an endpoint other than the\n        # default endpoint, specify it here:\n        'endpoint': \"https://dc.services.visualstudio.com/v2/track\",\n    }\n\nThis will log all requests and exceptions to the instrumentation key\nspecified in the `APPLICATION_INSIGHTS` setting.  In addition, an\n`appinsights` property will be placed on each incoming `request` object in\nyour views.  This will have the following properties:\n\n* `client`: This is an instance of the `applicationinsights.TelemetryClient`\n  type, which will submit telemetry to the same instrumentation key, and\n  will parent each telemetry item to the current request.\n* `request`: This is the `applicationinsights.channel.contracts.RequestData`\n  instance for the current request.  You can modify properties on this\n  object during the handling of the current request.  It will be submitted\n  when the request has finished.\n* `context`: This is the `applicationinsights.channel.TelemetryContext`\n  object for the current ApplicationInsights sender.\n\nYou can also hook up logging to Django.  For example, to log all builtin\nDjango warnings and errors, use the following logging configuration in\n`settings.py`:\n\n.. code:: python\n\n    LOGGING = {\n        'version': 1,\n        'disable_existing_loggers': False,\n        'handlers': {\n            # The application insights handler is here\n            'appinsights': {\n                'class': 'applicationinsights.django.LoggingHandler',\n                'level': 'WARNING'\n            }\n        },\n        'loggers': {\n            'django': {\n                'handlers': ['appinsights'],\n                'level': 'WARNING',\n                'propagate': True,\n            }\n        }\n    }\n\nSee Django's `logging documentation <https://docs.djangoproject.com/en/1.11/topics/logging/>`_\nfor more information.\n\n**Integrating with other web frameworks**\n\nFor any other Python web framework that is `WSGI compliant <https://www.python.org/dev/peps/pep-0333/>`_,\nthe `WSGIApplication <https://github.com/brennerm/python-appinsights/blob/master/applicationinsights/requests/WSGIApplication.py>`_\ncan be used as a middleware to log requests to Application Insights.\n\nAdd common properties to WSGIApplication request events by passing in a dictionary to the WSGIApplication constructor:\n\n.. code:: python\n\n    from wsgiref.simple_server import make_server\n    from pyramid.config import Configurator\n    from pyramid.response import Response\n    from applicationinsights.requests import WSGIApplication\n\n    # define a simple pyramid route\n    def hello_world(request):\n        return Response('Hello World!')\n\n    # construct dictionary which contains properties to be included with every request event\n    common_properties = {\n        \"service\": \"hello_world_flask_app\",\n        \"environment\": \"production\"\n    }\n\n    if __name__ == '__main__':\n        # create a simple pyramid app\n        with Configurator() as config:\n            config.add_route('hello', '/')\n            config.add_view(hello_world, route_name='hello')\n            app = config.make_wsgi_app()\n\n            # wrap the app in the application insights request logging middleware\n            app = WSGIApplication('<YOUR INSTRUMENTATION KEY GOES HERE>', app, common_properties=common_properties)\n\n        # run the app\n        server = make_server('0.0.0.0', 6543, app)\n        server.serve_forever()", "description_content_type": "", "docs_url": null, "download_url": "https://github.com/brennerm/python-appinsights", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/brennerm/python-appinsights", "keywords": "analytics applicationinsights telemetry appinsights development", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "appinsights", "package_url": "https://pypi.org/project/appinsights/", "platform": "", "project_url": "https://pypi.org/project/appinsights/", "project_urls": {"Download": "https://github.com/brennerm/python-appinsights", "Homepage": "https://github.com/brennerm/python-appinsights"}, "release_url": "https://pypi.org/project/appinsights/0.13.0/", "requires_dist": null, "requires_python": "", "summary": "This project extends the Application Insights API surface to support Python.", "version": "0.13.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <a href=\".github/workflows/ci.yml\" rel=\"nofollow\"><img alt=\"https://github.com/brennerm/python-appinsights/workflows/.github/workflows/ci.yml/badge.svg\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/60f0c63053444c5ece3705bdf48f7cb430cf1ac8/68747470733a2f2f6769746875622e636f6d2f6272656e6e65726d2f707974686f6e2d617070696e7369676874732f776f726b666c6f77732f2e6769746875622f776f726b666c6f77732f63692e796d6c2f62616467652e737667\"></a>\n<a href=\"http://badge.fury.io/py/appinsights\" rel=\"nofollow\"><img alt=\"https://badge.fury.io/py/appinsights.svg\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/80b851bd2dc6b33294f4e31cb236b00c926fee96/68747470733a2f2f62616467652e667572792e696f2f70792f617070696e7369676874732e737667\"></a>\n<p>This project extends the Application Insights API surface to support Python.\n<a href=\"http://azure.microsoft.com/services/application-insights/\" rel=\"nofollow\">Application Insights</a> is a service that\nallows developers to keep their application available, performing and\nsucceeding. This Python module will allow you to send telemetry of various kinds\n(event, trace, exception, etc.) to the Application Insights service where they\ncan be visualized in the Azure Portal. A link to the Application Insights API\ndocumentation can be found <a href=\"https://brennerm.github.io/python-appinsights/\" rel=\"nofollow\">here</a>.</p>\n<p>This project is not officially supported and not recommended for high load\nproduction use. The project is open source and welcomes contributions.</p>\n<div id=\"requirements\">\n<h2>Requirements</h2>\n<p>Python &gt;=2.7 and Python &gt;=3.4 are currently supported by this module.</p>\n</div>\n<div id=\"installation\">\n<h2>Installation</h2>\n<p>To install the latest release you can use <a href=\"http://www.pip-installer.org/\" rel=\"nofollow\">pip</a>.</p>\n<pre>$ pip install appinsights\n</pre>\n</div>\n<div id=\"documentation\">\n<h2>Documentation</h2>\n<p>Please see <a href=\"https://brennerm.github.io/python-appinsights/\" rel=\"nofollow\">https://brennerm.github.io/python-appinsights/</a> for full documentation.</p>\n</div>\n<div id=\"usage\">\n<h2>Usage</h2>\n<p>Once installed, you can send telemetry to Application Insights. Here are a few samples.</p>\n<blockquote>\n<strong>Note</strong>: before you can send data to you will need an instrumentation key. Please see the <a href=\"https://github.com/Microsoft/AppInsights-Home/wiki#getting-an-application-insights-instrumentation-key\" rel=\"nofollow\">Getting an Application Insights Instrumentation Key</a> section for more information.</blockquote>\n<p><strong>Sending a simple event telemetry item</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_event</span><span class=\"p\">(</span><span class=\"s1\">'Test event'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Sending an event telemetry item with custom properties and measurements</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_event</span><span class=\"p\">(</span><span class=\"s1\">'Test event'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"s1\">'foo'</span><span class=\"p\">:</span> <span class=\"s1\">'bar'</span> <span class=\"p\">},</span> <span class=\"p\">{</span> <span class=\"s1\">'baz'</span><span class=\"p\">:</span> <span class=\"mi\">42</span> <span class=\"p\">})</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Sending a trace telemetry item with custom properties</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_trace</span><span class=\"p\">(</span><span class=\"s1\">'Test trace'</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"s1\">'foo'</span><span class=\"p\">:</span> <span class=\"s1\">'bar'</span> <span class=\"p\">})</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Sending a metric telemetry item</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_metric</span><span class=\"p\">(</span><span class=\"s1\">'My Metric'</span><span class=\"p\">,</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Sending an availability telemetry item</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_availability</span><span class=\"p\">(</span><span class=\"s1\">'My Service'</span><span class=\"p\">,</span> <span class=\"mi\">250</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"s2\">\"West Europe\"</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Sending an exception telemetry item with custom properties and measurements</strong></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s1\">'blah'</span><span class=\"p\">)</span>\n<span class=\"k\">except</span><span class=\"p\">:</span>\n    <span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_exception</span><span class=\"p\">()</span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s2\">\"blah\"</span><span class=\"p\">)</span>\n<span class=\"k\">except</span><span class=\"p\">:</span>\n    <span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_exception</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">(),</span> <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"p\">{</span> <span class=\"s1\">'foo'</span><span class=\"p\">:</span> <span class=\"s1\">'bar'</span> <span class=\"p\">},</span> <span class=\"n\">measurements</span><span class=\"o\">=</span><span class=\"p\">{</span> <span class=\"s1\">'x'</span><span class=\"p\">:</span> <span class=\"mi\">42</span> <span class=\"p\">})</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Configuring context for a telemetry client instance</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">application</span><span class=\"o\">.</span><span class=\"n\">ver</span> <span class=\"o\">=</span> <span class=\"s1\">'1.2.3'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">id</span> <span class=\"o\">=</span> <span class=\"s1\">'My current device'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">oem_name</span> <span class=\"o\">=</span> <span class=\"s1\">'Asus'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"s1\">'X31A'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">type</span> <span class=\"o\">=</span> <span class=\"s2\">\"Other\"</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">id</span> <span class=\"o\">=</span> <span class=\"s1\">'santa@northpole.net'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'my_property'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'my_value'</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_trace</span><span class=\"p\">(</span><span class=\"s1\">'My trace with context'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Establishing correlation between telemetry objects</strong></p>\n<p>context field called operation_id can be set to associate telemetry items.\nSince operation_id is being set as a property of telemetry client, the client shouldn\u2019t be reused in parallel threads as it might lead to concurrency issues.</p>\n<pre><span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"n\">instrumentation_key</span><span class=\"o\">=</span><span class=\"n\">instrumentation_key</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">operation</span><span class=\"o\">.</span><span class=\"n\">id</span> <span class=\"o\">=</span> <span class=\"o\">&lt;</span><span class=\"n\">operation_id</span><span class=\"o\">&gt;</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">track_trace</span><span class=\"p\">(</span><span class=\"s1\">'Test trace'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">flush</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Configuring channel related properties</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"c1\"># flush telemetry every 30 seconds (assuming we don't hit max_queue_item_count first)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">channel</span><span class=\"o\">.</span><span class=\"n\">sender</span><span class=\"o\">.</span><span class=\"n\">send_interval_in_milliseconds</span> <span class=\"o\">=</span> <span class=\"mi\">30</span> <span class=\"o\">*</span> <span class=\"mi\">1000</span>\n<span class=\"c1\"># flush telemetry if we have 10 or more telemetry items in our queue</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">channel</span><span class=\"o\">.</span><span class=\"n\">queue</span><span class=\"o\">.</span><span class=\"n\">max_queue_length</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>\n</pre>\n<p><strong>Configuring TelemetryProcessor</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">TelemetryClient</span>\n<span class=\"k\">def</span> <span class=\"nf\">process</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">):</span>\n   <span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s2\">\"NEW_PROP\"</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">\"MYPROP\"</span>  <span class=\"c1\"># Add property</span>\n   <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">id</span> <span class=\"o\">=</span> <span class=\"s2\">\"MYID\"</span>   <span class=\"c1\"># Change ID</span>\n   <span class=\"k\">return</span> <span class=\"kc\">True</span> <span class=\"c1\"># Not filtered</span>\n<span class=\"n\">tc</span> <span class=\"o\">=</span> <span class=\"n\">TelemetryClient</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">tc</span><span class=\"o\">.</span><span class=\"n\">add_telemetry_processor</span><span class=\"p\">(</span><span class=\"n\">process</span><span class=\"p\">)</span>\n</pre>\n<p><strong>Basic logging configuration (first option)</strong></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.logging</span> <span class=\"kn\">import</span> <span class=\"n\">enable</span>\n\n<span class=\"c1\"># set up logging</span>\n<span class=\"n\">enable</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># log something (this will be sent to the Application Insights service as a trace)</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s1\">'This is a message'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># logging shutdown will cause a flush of all un-sent telemetry items</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">shutdown</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Basic logging configuration (second option)</strong></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.logging</span> <span class=\"kn\">import</span> <span class=\"n\">LoggingHandler</span>\n\n<span class=\"c1\"># set up logging</span>\n<span class=\"n\">handler</span> <span class=\"o\">=</span> <span class=\"n\">LoggingHandler</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">basicConfig</span><span class=\"p\">(</span><span class=\"n\">handlers</span><span class=\"o\">=</span><span class=\"p\">[</span> <span class=\"n\">handler</span> <span class=\"p\">],</span> <span class=\"nb\">format</span><span class=\"o\">=</span><span class=\"s1\">'</span><span class=\"si\">%(levelname)s</span><span class=\"s1\">: </span><span class=\"si\">%(message)s</span><span class=\"s1\">'</span><span class=\"p\">,</span> <span class=\"n\">level</span><span class=\"o\">=</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># log something (this will be sent to the Application Insights service as a trace)</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">debug</span><span class=\"p\">(</span><span class=\"s1\">'This is a message'</span><span class=\"p\">)</span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s1\">'Some exception'</span><span class=\"p\">)</span>\n<span class=\"k\">except</span><span class=\"p\">:</span>\n    <span class=\"c1\"># this will send an exception to the Application Insights service</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">exception</span><span class=\"p\">(</span><span class=\"s1\">'Code went boom!'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># logging shutdown will cause a flush of all un-sent telemetry items</span>\n<span class=\"c1\"># alternatively flush manually via handler.flush()</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">shutdown</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Advanced logging configuration</strong></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">channel</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.logging</span> <span class=\"kn\">import</span> <span class=\"n\">LoggingHandler</span>\n\n<span class=\"c1\"># set up channel with context</span>\n<span class=\"n\">telemetry_channel</span> <span class=\"o\">=</span> <span class=\"n\">channel</span><span class=\"o\">.</span><span class=\"n\">TelemetryChannel</span><span class=\"p\">()</span>\n<span class=\"n\">telemetry_channel</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">application</span><span class=\"o\">.</span><span class=\"n\">ver</span> <span class=\"o\">=</span> <span class=\"s1\">'1.2.3'</span>\n<span class=\"n\">telemetry_channel</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'my_property'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'my_value'</span>\n\n<span class=\"c1\"># set up logging</span>\n<span class=\"n\">handler</span> <span class=\"o\">=</span> <span class=\"n\">LoggingHandler</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">,</span> <span class=\"n\">telemetry_channel</span><span class=\"o\">=</span><span class=\"n\">telemetry_channel</span><span class=\"p\">)</span>\n<span class=\"n\">handler</span><span class=\"o\">.</span><span class=\"n\">setLevel</span><span class=\"p\">(</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">)</span>\n<span class=\"n\">handler</span><span class=\"o\">.</span><span class=\"n\">setFormatter</span><span class=\"p\">(</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">Formatter</span><span class=\"p\">(</span><span class=\"s1\">'</span><span class=\"si\">%(levelname)s</span><span class=\"s1\">: </span><span class=\"si\">%(message)s</span><span class=\"s1\">'</span><span class=\"p\">))</span>\n<span class=\"n\">my_logger</span> <span class=\"o\">=</span> <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">getLogger</span><span class=\"p\">(</span><span class=\"s1\">'simple_logger'</span><span class=\"p\">)</span>\n<span class=\"n\">my_logger</span><span class=\"o\">.</span><span class=\"n\">setLevel</span><span class=\"p\">(</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">)</span>\n<span class=\"n\">my_logger</span><span class=\"o\">.</span><span class=\"n\">addHandler</span><span class=\"p\">(</span><span class=\"n\">handler</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># log something (this will be sent to the Application Insights service as a trace)</span>\n<span class=\"n\">my_logger</span><span class=\"o\">.</span><span class=\"n\">debug</span><span class=\"p\">(</span><span class=\"s1\">'This is a message'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># logging shutdown will cause a flush of all un-sent telemetry items</span>\n<span class=\"c1\"># alternatively flush manually via handler.flush()</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">shutdown</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Logging unhandled exceptions</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.exceptions</span> <span class=\"kn\">import</span> <span class=\"n\">enable</span>\n\n<span class=\"c1\"># set up exception capture</span>\n<span class=\"n\">enable</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># raise an exception (this will be sent to the Application Insights service as an exception telemetry object)</span>\n<span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s1\">'Boom!'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># exceptions will cause a flush of all un-sent telemetry items</span>\n</pre>\n<p><strong>Logging unhandled exceptions with context</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights</span> <span class=\"kn\">import</span> <span class=\"n\">channel</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.exceptions</span> <span class=\"kn\">import</span> <span class=\"n\">enable</span>\n\n<span class=\"c1\"># set up channel with context</span>\n<span class=\"n\">telemetry_channel</span> <span class=\"o\">=</span> <span class=\"n\">channel</span><span class=\"o\">.</span><span class=\"n\">TelemetryChannel</span><span class=\"p\">()</span>\n<span class=\"n\">telemetry_channel</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">application</span><span class=\"o\">.</span><span class=\"n\">ver</span> <span class=\"o\">=</span> <span class=\"s1\">'1.2.3'</span>\n<span class=\"n\">telemetry_channel</span><span class=\"o\">.</span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'my_property'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'my_value'</span>\n\n<span class=\"c1\"># set up exception capture</span>\n<span class=\"n\">enable</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">,</span> <span class=\"n\">telemetry_channel</span><span class=\"o\">=</span><span class=\"n\">telemetry_channel</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># raise an exception (this will be sent to the Application Insights service as an exception telemetry object)</span>\n<span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s1\">'Boom!'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># exceptions will cause a flush of all un-sent telemetry items</span>\n</pre>\n<p><strong>Track dependency telemetry for HTTP requests with requests</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.client</span> <span class=\"kn\">import</span> <span class=\"n\">enable_for_requests</span>\n<span class=\"kn\">import</span> <span class=\"nn\">requests</span>\n\n<span class=\"n\">enable_for_requests</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s2\">\"https://www.python.org/\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># a dependency telemetry will be sent to the Application Insights service</span>\n</pre>\n<p><strong>Track dependency telemetry for HTTP requests with urllib</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.client</span> <span class=\"kn\">import</span> <span class=\"n\">enable_for_urllib</span>\n<span class=\"kn\">import</span> <span class=\"nn\">urllib.requests</span>\n\n<span class=\"n\">enable_for_urllib</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"n\">urllib</span><span class=\"o\">.</span><span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">urlopen</span><span class=\"p\">(</span><span class=\"s2\">\"https://www.python.org/\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># a dependency telemetry will be sent to the Application Insights service</span>\n</pre>\n<p><strong>Track dependency telemetry for HTTP requests with urllib2</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.client</span> <span class=\"kn\">import</span> <span class=\"n\">enable_for_urllib2</span>\n<span class=\"kn\">import</span> <span class=\"nn\">urllib2</span>\n\n<span class=\"n\">enable_for_urllib2</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"n\">urllib2</span><span class=\"o\">.</span><span class=\"n\">urlopen</span><span class=\"p\">(</span><span class=\"s2\">\"https://www.python.org/\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># a dependency telemetry will be sent to the Application Insights service</span>\n</pre>\n<p><strong>Track dependency telemetry for HTTP requests with urllib3</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.client</span> <span class=\"kn\">import</span> <span class=\"n\">enable_for_urllib3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">urllib3.requests</span>\n\n<span class=\"n\">enable_for_urllib3</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">)</span>\n\n<span class=\"n\">urllib3</span><span class=\"o\">.</span><span class=\"n\">PoolManager</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">request</span><span class=\"p\">(</span><span class=\"s2\">\"GET\"</span><span class=\"p\">,</span> <span class=\"s2\">\"https://www.python.org/\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># a dependency telemetry will be sent to the Application Insights service</span>\n</pre>\n<p><strong>Integrating with Flask</strong></p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">flask</span> <span class=\"kn\">import</span> <span class=\"n\">Flask</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.flask.ext</span> <span class=\"kn\">import</span> <span class=\"n\">AppInsights</span>\n\n<span class=\"c1\"># instantiate the Flask application</span>\n<span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">Flask</span><span class=\"p\">(</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n<span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s1\">'APPINSIGHTS_INSTRUMENTATIONKEY'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span>\n\n<span class=\"c1\"># log requests, traces and exceptions to the Application Insights service</span>\n<span class=\"n\">appinsights</span> <span class=\"o\">=</span> <span class=\"n\">AppInsights</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># define a simple route</span>\n<span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">route</span><span class=\"p\">(</span><span class=\"s1\">'/'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">hello_world</span><span class=\"p\">():</span>\n    <span class=\"c1\"># the following message will be sent to the Flask log as well as Application Insights</span>\n    <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">logger</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s1\">'Hello World route was called'</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"s1\">'Hello World!'</span>\n\n<span class=\"c1\"># run the application</span>\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</pre>\n<p><strong>Integrating with Django</strong></p>\n<p>Place the following in your <cite>settings.py</cite> file:</p>\n<pre><span class=\"c1\"># If on Django &lt; 1.10</span>\n<span class=\"n\">MIDDLEWARE_CLASSES</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"c1\"># ... or whatever is below for you ...</span>\n    <span class=\"s1\">'django.middleware.security.SecurityMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.common.CommonMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.csrf.CsrfViewMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.auth.middleware.SessionAuthenticationMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.messages.middleware.MessageMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"c1\"># ... or whatever is above for you ...</span>\n    <span class=\"s1\">'applicationinsights.django.ApplicationInsightsMiddleware'</span><span class=\"p\">,</span>   <span class=\"c1\"># Add this middleware to the end</span>\n<span class=\"p\">]</span>\n\n<span class=\"c1\"># If on Django &gt;= 1.10</span>\n<span class=\"n\">MIDDLEWARE</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"c1\"># ... or whatever is below for you ...</span>\n    <span class=\"s1\">'django.middleware.security.SecurityMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.common.CommonMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.csrf.CsrfViewMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.contrib.messages.middleware.MessageMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class=\"p\">,</span>\n    <span class=\"c1\"># ... or whatever is above for you ...</span>\n    <span class=\"s1\">'applicationinsights.django.ApplicationInsightsMiddleware'</span><span class=\"p\">,</span>   <span class=\"c1\"># Add this middleware to the end</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">APPLICATION_INSIGHTS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"c1\"># (required) Your Application Insights instrumentation key</span>\n    <span class=\"s1\">'ikey'</span><span class=\"p\">:</span> <span class=\"s2\">\"00000000-0000-0000-0000-000000000000\"</span><span class=\"p\">,</span>\n\n    <span class=\"c1\"># (optional) By default, request names are logged as the request method</span>\n    <span class=\"c1\"># and relative path of the URL.  To log the fully-qualified view names</span>\n    <span class=\"c1\"># instead, set this to True.  Defaults to False.</span>\n    <span class=\"s1\">'use_view_name'</span><span class=\"p\">:</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n\n    <span class=\"c1\"># (optional) To log arguments passed into the views as custom properties,</span>\n    <span class=\"c1\"># set this to True.  Defaults to False.</span>\n    <span class=\"s1\">'record_view_arguments'</span><span class=\"p\">:</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n\n    <span class=\"c1\"># (optional) Exceptions are logged by default, to disable, set this to False.</span>\n    <span class=\"s1\">'log_exceptions'</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span>\n\n    <span class=\"c1\"># (optional) Events are submitted to Application Insights asynchronously.</span>\n    <span class=\"c1\"># send_interval specifies how often the queue is checked for items to submit.</span>\n    <span class=\"c1\"># send_time specifies how long the sender waits for new input before recycling</span>\n    <span class=\"c1\"># the background thread.</span>\n    <span class=\"s1\">'send_interval'</span><span class=\"p\">:</span> <span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"c1\"># Check every second</span>\n    <span class=\"s1\">'send_time'</span><span class=\"p\">:</span> <span class=\"mf\">3.0</span><span class=\"p\">,</span> <span class=\"c1\"># Wait up to 3 seconds for an event</span>\n\n    <span class=\"c1\"># (optional, uncommon) If you must send to an endpoint other than the</span>\n    <span class=\"c1\"># default endpoint, specify it here:</span>\n    <span class=\"s1\">'endpoint'</span><span class=\"p\">:</span> <span class=\"s2\">\"https://dc.services.visualstudio.com/v2/track\"</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n</pre>\n<p>This will log all requests and exceptions to the instrumentation key\nspecified in the <cite>APPLICATION_INSIGHTS</cite> setting.  In addition, an\n<cite>appinsights</cite> property will be placed on each incoming <cite>request</cite> object in\nyour views.  This will have the following properties:</p>\n<ul>\n<li><cite>client</cite>: This is an instance of the <cite>applicationinsights.TelemetryClient</cite>\ntype, which will submit telemetry to the same instrumentation key, and\nwill parent each telemetry item to the current request.</li>\n<li><cite>request</cite>: This is the <cite>applicationinsights.channel.contracts.RequestData</cite>\ninstance for the current request.  You can modify properties on this\nobject during the handling of the current request.  It will be submitted\nwhen the request has finished.</li>\n<li><cite>context</cite>: This is the <cite>applicationinsights.channel.TelemetryContext</cite>\nobject for the current ApplicationInsights sender.</li>\n</ul>\n<p>You can also hook up logging to Django.  For example, to log all builtin\nDjango warnings and errors, use the following logging configuration in\n<cite>settings.py</cite>:</p>\n<pre><span class=\"n\">LOGGING</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'version'</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n    <span class=\"s1\">'disable_existing_loggers'</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span>\n    <span class=\"s1\">'handlers'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"c1\"># The application insights handler is here</span>\n        <span class=\"s1\">'appinsights'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"s1\">'class'</span><span class=\"p\">:</span> <span class=\"s1\">'applicationinsights.django.LoggingHandler'</span><span class=\"p\">,</span>\n            <span class=\"s1\">'level'</span><span class=\"p\">:</span> <span class=\"s1\">'WARNING'</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">},</span>\n    <span class=\"s1\">'loggers'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s1\">'django'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"s1\">'handlers'</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">'appinsights'</span><span class=\"p\">],</span>\n            <span class=\"s1\">'level'</span><span class=\"p\">:</span> <span class=\"s1\">'WARNING'</span><span class=\"p\">,</span>\n            <span class=\"s1\">'propagate'</span><span class=\"p\">:</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre>\n<p>See Django\u2019s <a href=\"https://docs.djangoproject.com/en/1.11/topics/logging/\" rel=\"nofollow\">logging documentation</a>\nfor more information.</p>\n<p><strong>Integrating with other web frameworks</strong></p>\n<p>For any other Python web framework that is <a href=\"https://www.python.org/dev/peps/pep-0333/\" rel=\"nofollow\">WSGI compliant</a>,\nthe <a href=\"https://github.com/brennerm/python-appinsights/blob/master/applicationinsights/requests/WSGIApplication.py\" rel=\"nofollow\">WSGIApplication</a>\ncan be used as a middleware to log requests to Application Insights.</p>\n<p>Add common properties to WSGIApplication request events by passing in a dictionary to the WSGIApplication constructor:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">wsgiref.simple_server</span> <span class=\"kn\">import</span> <span class=\"n\">make_server</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pyramid.config</span> <span class=\"kn\">import</span> <span class=\"n\">Configurator</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pyramid.response</span> <span class=\"kn\">import</span> <span class=\"n\">Response</span>\n<span class=\"kn\">from</span> <span class=\"nn\">applicationinsights.requests</span> <span class=\"kn\">import</span> <span class=\"n\">WSGIApplication</span>\n\n<span class=\"c1\"># define a simple pyramid route</span>\n<span class=\"k\">def</span> <span class=\"nf\">hello_world</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">Response</span><span class=\"p\">(</span><span class=\"s1\">'Hello World!'</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># construct dictionary which contains properties to be included with every request event</span>\n<span class=\"n\">common_properties</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">\"service\"</span><span class=\"p\">:</span> <span class=\"s2\">\"hello_world_flask_app\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"environment\"</span><span class=\"p\">:</span> <span class=\"s2\">\"production\"</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"c1\"># create a simple pyramid app</span>\n    <span class=\"k\">with</span> <span class=\"n\">Configurator</span><span class=\"p\">()</span> <span class=\"k\">as</span> <span class=\"n\">config</span><span class=\"p\">:</span>\n        <span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">add_route</span><span class=\"p\">(</span><span class=\"s1\">'hello'</span><span class=\"p\">,</span> <span class=\"s1\">'/'</span><span class=\"p\">)</span>\n        <span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">add_view</span><span class=\"p\">(</span><span class=\"n\">hello_world</span><span class=\"p\">,</span> <span class=\"n\">route_name</span><span class=\"o\">=</span><span class=\"s1\">'hello'</span><span class=\"p\">)</span>\n        <span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">make_wsgi_app</span><span class=\"p\">()</span>\n\n        <span class=\"c1\"># wrap the app in the application insights request logging middleware</span>\n        <span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">WSGIApplication</span><span class=\"p\">(</span><span class=\"s1\">'&lt;YOUR INSTRUMENTATION KEY GOES HERE&gt;'</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">common_properties</span><span class=\"o\">=</span><span class=\"n\">common_properties</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># run the app</span>\n    <span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">make_server</span><span class=\"p\">(</span><span class=\"s1\">'0.0.0.0'</span><span class=\"p\">,</span> <span class=\"mi\">6543</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">)</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">serve_forever</span><span class=\"p\">()</span>\n</pre>\n</div>\n\n          </div>"}, "last_serial": 6946282, "releases": {"0.11.10": [{"comment_text": "", "digests": {"md5": "6ffea08230f1e48c669b1ad3da453f60", "sha256": "0d5f9ad394802f43caef847b071a637bcfd15975897a40c21ef5ae766c8b9c2b"}, "downloads": -1, "filename": "appinsights-0.11.10.tar.gz", "has_sig": false, "md5_digest": "6ffea08230f1e48c669b1ad3da453f60", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 56778, "upload_time": "2020-01-27T22:15:20", "upload_time_iso_8601": "2020-01-27T22:15:20.795960Z", "url": "https://files.pythonhosted.org/packages/82/6c/6df12865642cd4b13ae089c2596d186caa4e0493033ddba10a054382c99c/appinsights-0.11.10.tar.gz", "yanked": false}], "0.11.11": [{"comment_text": "", "digests": {"md5": "e99f05e050986027c33e17eeb9ff083a", "sha256": "c37806750313740ac898891a6caee7d156fce4099ec77c2054883fba2e714449"}, "downloads": -1, "filename": "appinsights-0.11.11.tar.gz", "has_sig": false, "md5_digest": "e99f05e050986027c33e17eeb9ff083a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 56790, "upload_time": "2020-01-27T22:23:54", "upload_time_iso_8601": "2020-01-27T22:23:54.206783Z", "url": "https://files.pythonhosted.org/packages/0d/54/aa776ab195d77709052946b4000bb097f8cafb384945544cced76f5731a3/appinsights-0.11.11.tar.gz", "yanked": false}], "0.11.12": [{"comment_text": "", "digests": {"md5": "69b63ee9c6102788d9a4d17760a8f6d1", "sha256": "01ead239ae32c6f3abfd4c25b70c57feb9d2e8b78a920230e8c02829868ec276"}, "downloads": -1, "filename": "appinsights-0.11.12.tar.gz", "has_sig": false, "md5_digest": "69b63ee9c6102788d9a4d17760a8f6d1", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 56913, "upload_time": "2020-01-30T10:04:52", "upload_time_iso_8601": "2020-01-30T10:04:52.975874Z", "url": "https://files.pythonhosted.org/packages/7c/82/03e9d5977b3b4e40fe38291fa23e4e6ffabd2e1dba7eba852a2c93ee6a19/appinsights-0.11.12.tar.gz", "yanked": false}], "0.11.13": [{"comment_text": "", "digests": {"md5": "a5fb2a6ff199a8b2ac30d44e9d031615", "sha256": "f8da0d6dcd86bd6bbc7a096ded9186d746250d09eafa8282d3eaa1cf0905f614"}, "downloads": -1, "filename": "appinsights-0.11.13.tar.gz", "has_sig": false, "md5_digest": "a5fb2a6ff199a8b2ac30d44e9d031615", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 36414, "upload_time": "2020-01-30T22:33:15", "upload_time_iso_8601": "2020-01-30T22:33:15.776373Z", "url": "https://files.pythonhosted.org/packages/3b/9f/d5b942360120148841b20613f4e4bb7ab4f72e8df55f99f51a5c7d744575/appinsights-0.11.13.tar.gz", "yanked": false}], "0.11.14": [{"comment_text": "", "digests": {"md5": "073d5d488749d14688d50e0eaf0c7975", "sha256": "bac5d8e8045a5c1173606231669597524ad637fb9e551fcab42db724cd4b21b7"}, "downloads": -1, "filename": "appinsights-0.11.14.tar.gz", "has_sig": false, "md5_digest": "073d5d488749d14688d50e0eaf0c7975", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 36471, "upload_time": "2020-02-04T21:56:48", "upload_time_iso_8601": "2020-02-04T21:56:48.663660Z", "url": "https://files.pythonhosted.org/packages/61/68/93d91ff879c7ef10159da64da462f75de485c670ca28536303c5ba17a121/appinsights-0.11.14.tar.gz", "yanked": false}], "0.11.9": [{"comment_text": "", "digests": {"md5": "82f9d2cc874e04fb764ce01e4edf7162", "sha256": "6acf9a449bffb0a1c5c478f514b8ddf0daded5b1eabd1418562cca747428e8be"}, "downloads": -1, "filename": "appinsights-0.11.9.tar.gz", "has_sig": false, "md5_digest": "82f9d2cc874e04fb764ce01e4edf7162", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 56506, "upload_time": "2020-01-27T21:20:14", "upload_time_iso_8601": "2020-01-27T21:20:14.394778Z", "url": "https://files.pythonhosted.org/packages/48/ca/86edbfe37113f9f9ac183905da71c782397bc9d6982ee5725aec00f667ec/appinsights-0.11.9.tar.gz", "yanked": false}], "0.12.0": [{"comment_text": "", "digests": {"md5": "b9eb8a8e5405996d8699eabf65e8ee8a", "sha256": "c4b632e5769919a7fb8f39460d9508dce97e7291e25def61e831d228bc774291"}, "downloads": -1, "filename": "appinsights-0.12.0.tar.gz", "has_sig": false, "md5_digest": "b9eb8a8e5405996d8699eabf65e8ee8a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 34808, "upload_time": "2020-02-25T23:02:08", "upload_time_iso_8601": "2020-02-25T23:02:08.726480Z", "url": "https://files.pythonhosted.org/packages/0a/b7/d65474d81c3ae01172c92ba8a2e770ccca9e63d78c33b003e72c9f212ddd/appinsights-0.12.0.tar.gz", "yanked": false}], "0.13.0": [{"comment_text": "", "digests": {"md5": "3a2be2adc109369eb11b066352a3d698", "sha256": "71824ce58c0e632a2808b7bbbf41969c95a33db326320fc199e62c4efeadc796"}, "downloads": -1, "filename": "appinsights-0.13.0.tar.gz", "has_sig": false, "md5_digest": "3a2be2adc109369eb11b066352a3d698", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 37724, "upload_time": "2020-04-03T20:22:31", "upload_time_iso_8601": "2020-04-03T20:22:31.738313Z", "url": "https://files.pythonhosted.org/packages/79/23/9321fcb1ba395cbaae73e59f93478f8bfc5719838589324e96f19d0edc31/appinsights-0.13.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3a2be2adc109369eb11b066352a3d698", "sha256": "71824ce58c0e632a2808b7bbbf41969c95a33db326320fc199e62c4efeadc796"}, "downloads": -1, "filename": "appinsights-0.13.0.tar.gz", "has_sig": false, "md5_digest": "3a2be2adc109369eb11b066352a3d698", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 37724, "upload_time": "2020-04-03T20:22:31", "upload_time_iso_8601": "2020-04-03T20:22:31.738313Z", "url": "https://files.pythonhosted.org/packages/79/23/9321fcb1ba395cbaae73e59f93478f8bfc5719838589324e96f19d0edc31/appinsights-0.13.0.tar.gz", "yanked": false}], "timestamp": "Thu May  7 18:17:38 2020"}