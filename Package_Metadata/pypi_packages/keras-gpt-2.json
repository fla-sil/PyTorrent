{"info": {"author": "CyberZHG", "author_email": "CyberZHG@users.noreply.github.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# Keras GPT-2\n\n[![Travis](https://travis-ci.org/CyberZHG/keras-gpt-2.svg)](https://travis-ci.org/CyberZHG/keras-gpt-2)\n[![Coverage](https://coveralls.io/repos/github/CyberZHG/keras-gpt-2/badge.svg?branch=master)](https://coveralls.io/github/CyberZHG/keras-gpt-2)\n[![Version](https://img.shields.io/pypi/v/keras-gpt-2.svg)](https://pypi.org/project/keras-gpt-2/)\n![Downloads](https://img.shields.io/pypi/dm/keras-gpt-2.svg)\n![License](https://img.shields.io/pypi/l/keras-gpt-2.svg)\n\n![](https://img.shields.io/badge/keras-tensorflow-blue.svg)\n![](https://img.shields.io/badge/keras-tf.keras-blue.svg)\n\n\\[[\u4e2d\u6587](https://github.com/CyberZHG/keras-gpt-2/blob/master/README.zh-CN.md)|[English](https://github.com/CyberZHG/keras-gpt-2/blob/master/README.md)\\]\n\nLoad pretrained weights and predict with [GPT-2](https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf).\n\n## Install\n\n```bash\npip install keras-gpt-2\n```\n\n## Demo\n\n```python\nimport os\nfrom keras_gpt_2 import load_trained_model_from_checkpoint, get_bpe_from_files, generate\n\n\nmodel_folder = 'xxx/yyy/117M'\nconfig_path = os.path.join(model_folder, 'hparams.json')\ncheckpoint_path = os.path.join(model_folder, 'model.ckpt')\nencoder_path = os.path.join(model_folder, 'encoder.json')\nvocab_path = os.path.join(model_folder, 'vocab.bpe')\n\n\nprint('Load model from checkpoint...')\nmodel = load_trained_model_from_checkpoint(config_path, checkpoint_path)\nprint('Load BPE from files...')\nbpe = get_bpe_from_files(encoder_path, vocab_path)\nprint('Generate text...')\noutput = generate(model, bpe, ['From the day forth, my arm'], length=20, top_k=1)\n\n# If you are using the 117M model and top_k equals to 1, then the result will be:\n# \"From the day forth, my arm was broken, and I was in a state of pain. I was in a state of pain,\"\nprint(output[0])\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/CyberZHG/keras-gpt-2", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "keras-gpt-2", "package_url": "https://pypi.org/project/keras-gpt-2/", "platform": "", "project_url": "https://pypi.org/project/keras-gpt-2/", "project_urls": {"Homepage": "https://github.com/CyberZHG/keras-gpt-2"}, "release_url": "https://pypi.org/project/keras-gpt-2/0.14.0/", "requires_dist": null, "requires_python": "", "summary": "GPT-2", "version": "0.14.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Keras GPT-2</h1>\n<p><a href=\"https://travis-ci.org/CyberZHG/keras-gpt-2\" rel=\"nofollow\"><img alt=\"Travis\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/e0cbc6fcf5fb3bf53b7216c156770cdf53d8c5d1/68747470733a2f2f7472617669732d63692e6f72672f43796265725a48472f6b657261732d6770742d322e737667\"></a>\n<a href=\"https://coveralls.io/github/CyberZHG/keras-gpt-2\" rel=\"nofollow\"><img alt=\"Coverage\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/90fa0f6f1db211a4e9c05ac750fc2a6331b53aa3/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f43796265725a48472f6b657261732d6770742d322f62616467652e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://pypi.org/project/keras-gpt-2/\" rel=\"nofollow\"><img alt=\"Version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/cba9631373ce51a905f55e95a4badb943f65385f/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6b657261732d6770742d322e737667\"></a>\n<img alt=\"Downloads\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/30939b3f5e1b263a0b0cc798df55a7bc41abf3d1/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f6b657261732d6770742d322e737667\">\n<img alt=\"License\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/23b61ba9d818aa97a4e60ac32903686b919406ff/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f6b657261732d6770742d322e737667\"></p>\n<p><img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/e393eea6bde0401d67d8c1037f20197db5f67415/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6b657261732d74656e736f72666c6f772d626c75652e737667\">\n<img alt=\"\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/10bcc5d5c79439ea8a8eed66fab216ba966761df/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6b657261732d74662e6b657261732d626c75652e737667\"></p>\n<p>[<a href=\"https://github.com/CyberZHG/keras-gpt-2/blob/master/README.zh-CN.md\" rel=\"nofollow\">\u4e2d\u6587</a>|<a href=\"https://github.com/CyberZHG/keras-gpt-2/blob/master/README.md\" rel=\"nofollow\">English</a>]</p>\n<p>Load pretrained weights and predict with <a href=\"https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf\" rel=\"nofollow\">GPT-2</a>.</p>\n<h2>Install</h2>\n<pre>pip install keras-gpt-2\n</pre>\n<h2>Demo</h2>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"kn\">from</span> <span class=\"nn\">keras_gpt_2</span> <span class=\"kn\">import</span> <span class=\"n\">load_trained_model_from_checkpoint</span><span class=\"p\">,</span> <span class=\"n\">get_bpe_from_files</span><span class=\"p\">,</span> <span class=\"n\">generate</span>\n\n\n<span class=\"n\">model_folder</span> <span class=\"o\">=</span> <span class=\"s1\">'xxx/yyy/117M'</span>\n<span class=\"n\">config_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">model_folder</span><span class=\"p\">,</span> <span class=\"s1\">'hparams.json'</span><span class=\"p\">)</span>\n<span class=\"n\">checkpoint_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">model_folder</span><span class=\"p\">,</span> <span class=\"s1\">'model.ckpt'</span><span class=\"p\">)</span>\n<span class=\"n\">encoder_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">model_folder</span><span class=\"p\">,</span> <span class=\"s1\">'encoder.json'</span><span class=\"p\">)</span>\n<span class=\"n\">vocab_path</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">model_folder</span><span class=\"p\">,</span> <span class=\"s1\">'vocab.bpe'</span><span class=\"p\">)</span>\n\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'Load model from checkpoint...'</span><span class=\"p\">)</span>\n<span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">load_trained_model_from_checkpoint</span><span class=\"p\">(</span><span class=\"n\">config_path</span><span class=\"p\">,</span> <span class=\"n\">checkpoint_path</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'Load BPE from files...'</span><span class=\"p\">)</span>\n<span class=\"n\">bpe</span> <span class=\"o\">=</span> <span class=\"n\">get_bpe_from_files</span><span class=\"p\">(</span><span class=\"n\">encoder_path</span><span class=\"p\">,</span> <span class=\"n\">vocab_path</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'Generate text...'</span><span class=\"p\">)</span>\n<span class=\"n\">output</span> <span class=\"o\">=</span> <span class=\"n\">generate</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">bpe</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s1\">'From the day forth, my arm'</span><span class=\"p\">],</span> <span class=\"n\">length</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">top_k</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># If you are using the 117M model and top_k equals to 1, then the result will be:</span>\n<span class=\"c1\"># \"From the day forth, my arm was broken, and I was in a state of pain. I was in a state of pain,\"</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">output</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n</pre>\n\n          </div>"}, "last_serial": 6045741, "releases": {"0.10.0": [{"comment_text": "", "digests": {"md5": "d9fe8005fcb8c8ac4490e339c220d66a", "sha256": "960fabbd4b8c5f1d8d527ebc5dd7929da5287ad39b95df4dbbe5c0a38d5ae275"}, "downloads": -1, "filename": "keras-gpt-2-0.10.0.tar.gz", "has_sig": false, "md5_digest": "d9fe8005fcb8c8ac4490e339c220d66a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7770, "upload_time": "2019-05-30T07:34:18", "upload_time_iso_8601": "2019-05-30T07:34:18.052566Z", "url": "https://files.pythonhosted.org/packages/ec/2e/51d904ca7bc413f739ed2bb468096e57e5e4441cb3c27cee665e9565ab2e/keras-gpt-2-0.10.0.tar.gz", "yanked": false}], "0.11.1": [{"comment_text": "", "digests": {"md5": "28a6df1f49b428728dea05b0c1ac6f8b", "sha256": "1e4838451666d9647a892c8d1e9ef77911f56d5eb93a2f889ae58256557cf6c1"}, "downloads": -1, "filename": "keras-gpt-2-0.11.1.tar.gz", "has_sig": false, "md5_digest": "28a6df1f49b428728dea05b0c1ac6f8b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7737, "upload_time": "2019-06-06T09:15:37", "upload_time_iso_8601": "2019-06-06T09:15:37.549016Z", "url": "https://files.pythonhosted.org/packages/c5/fd/283df924382bbb883534c42309e01dea8672db5f6de01525a238ae06752b/keras-gpt-2-0.11.1.tar.gz", "yanked": false}], "0.12.0": [{"comment_text": "", "digests": {"md5": "d0a418029faaa376768a2d9a7a7b9927", "sha256": "277a8e7b063f5758e4543c118e05f9ebe02208d73ec8a67501c6655796e39022"}, "downloads": -1, "filename": "keras-gpt-2-0.12.0.tar.gz", "has_sig": false, "md5_digest": "d0a418029faaa376768a2d9a7a7b9927", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7811, "upload_time": "2019-06-11T08:12:41", "upload_time_iso_8601": "2019-06-11T08:12:41.553189Z", "url": "https://files.pythonhosted.org/packages/8b/5c/c717769b35cdaeaa958d09643685323e0cdfcd9c3fa58524f45873775731/keras-gpt-2-0.12.0.tar.gz", "yanked": false}], "0.13.0": [{"comment_text": "", "digests": {"md5": "e932a6130cdaff54c3a2c1915d55f61c", "sha256": "e546a1c4e18ef132ab7d47eb943de5779cb76496dbab9edf09a8bde911b97bba"}, "downloads": -1, "filename": "keras-gpt-2-0.13.0.tar.gz", "has_sig": false, "md5_digest": "e932a6130cdaff54c3a2c1915d55f61c", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7782, "upload_time": "2019-08-23T05:27:24", "upload_time_iso_8601": "2019-08-23T05:27:24.868641Z", "url": "https://files.pythonhosted.org/packages/88/30/be1f99fc030dc101e2a8ca57a6641236457090860e4adc034de146b2656f/keras-gpt-2-0.13.0.tar.gz", "yanked": false}], "0.14.0": [{"comment_text": "", "digests": {"md5": "537b1a148b5e1135f4b28be226e64b2e", "sha256": "de8a417fb15581e2fddb64d1b91fbbfc571a77eafe609706decf22bad193bd71"}, "downloads": -1, "filename": "keras-gpt-2-0.14.0.tar.gz", "has_sig": false, "md5_digest": "537b1a148b5e1135f4b28be226e64b2e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7689, "upload_time": "2019-10-29T07:47:23", "upload_time_iso_8601": "2019-10-29T07:47:23.753710Z", "url": "https://files.pythonhosted.org/packages/df/19/d11eac066ffcb61ec9edd23c02e4651eaa31f1f67c167a636dd90b6142a4/keras-gpt-2-0.14.0.tar.gz", "yanked": false}], "0.3.0": [{"comment_text": "", "digests": {"md5": "18fc2872629a035861326db18ed06d71", "sha256": "0a6c247d0e12e8b1177a5b28bcbb34e3c8a577758573aae327bac723374e2b1b"}, "downloads": -1, "filename": "keras-gpt-2-0.3.0.tar.gz", "has_sig": false, "md5_digest": "18fc2872629a035861326db18ed06d71", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6505, "upload_time": "2019-02-19T09:28:56", "upload_time_iso_8601": "2019-02-19T09:28:56.205129Z", "url": "https://files.pythonhosted.org/packages/14/a6/074758bc8607b9c676d6f5df443c855f701318be8ab75facdcaa6b2b067c/keras-gpt-2-0.3.0.tar.gz", "yanked": false}], "0.4.0": [{"comment_text": "", "digests": {"md5": "09d91ac2c26e2e74f5255cad78067234", "sha256": "54d879b98918d56a310333f4ebca1366e3b07f5381093fe817cefc94903932bb"}, "downloads": -1, "filename": "keras-gpt-2-0.4.0.tar.gz", "has_sig": false, "md5_digest": "09d91ac2c26e2e74f5255cad78067234", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6607, "upload_time": "2019-03-08T10:39:49", "upload_time_iso_8601": "2019-03-08T10:39:49.904373Z", "url": "https://files.pythonhosted.org/packages/ee/b0/10c9c5a9762f74b1808e898ab5236f38f148ee5719d2adcf9202bf438bf0/keras-gpt-2-0.4.0.tar.gz", "yanked": false}], "0.5.0": [{"comment_text": "", "digests": {"md5": "fc2b7fe04dc637c9ac9708036dea5536", "sha256": "a842c0398a78bec48eb4f1a89347cb02bc6e1e508fcba8b1f8bc60ed9f3d8e07"}, "downloads": -1, "filename": "keras-gpt-2-0.5.0.tar.gz", "has_sig": false, "md5_digest": "fc2b7fe04dc637c9ac9708036dea5536", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6605, "upload_time": "2019-03-11T06:50:20", "upload_time_iso_8601": "2019-03-11T06:50:20.178143Z", "url": "https://files.pythonhosted.org/packages/96/02/b78c722fcec77dfaa2c233e09299ae269f3e3fb61fcf150d1545288dea54/keras-gpt-2-0.5.0.tar.gz", "yanked": false}], "0.6.0": [{"comment_text": "", "digests": {"md5": "dc7e826c7b45b0fd905b793aab3a30f7", "sha256": "df092e158857899f2b1dea26fd33a033470688cbc244eb36735b88481e23de17"}, "downloads": -1, "filename": "keras-gpt-2-0.6.0.tar.gz", "has_sig": false, "md5_digest": "dc7e826c7b45b0fd905b793aab3a30f7", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6644, "upload_time": "2019-03-21T12:02:04", "upload_time_iso_8601": "2019-03-21T12:02:04.573024Z", "url": "https://files.pythonhosted.org/packages/76/6e/b3a8521803944b8fb5c2221b5c55bfae60b47d11287da959bbc5f1c39670/keras-gpt-2-0.6.0.tar.gz", "yanked": false}], "0.7.0": [{"comment_text": "", "digests": {"md5": "aa74a8a39e819ad8fe69967c99f49a82", "sha256": "43fc634b998fe20fb77d96f7f6ae80758745cb1bb06cc1bf06272ed4bee22bfa"}, "downloads": -1, "filename": "keras-gpt-2-0.7.0.tar.gz", "has_sig": false, "md5_digest": "aa74a8a39e819ad8fe69967c99f49a82", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 6692, "upload_time": "2019-04-09T08:53:21", "upload_time_iso_8601": "2019-04-09T08:53:21.703477Z", "url": "https://files.pythonhosted.org/packages/ce/5d/c540b090c3555a5c9c653c19ac1b633c63249d2c2bed515bddf4b2eca43a/keras-gpt-2-0.7.0.tar.gz", "yanked": false}], "0.8.0": [{"comment_text": "", "digests": {"md5": "9086a075ec65c289bb2a9332a7c23bcc", "sha256": "504ff7be61ce37c2b252aa8f26bc0a472b4a1ba272e78f9280f16affd561ea39"}, "downloads": -1, "filename": "keras-gpt-2-0.8.0.tar.gz", "has_sig": false, "md5_digest": "9086a075ec65c289bb2a9332a7c23bcc", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7036, "upload_time": "2019-05-11T16:53:04", "upload_time_iso_8601": "2019-05-11T16:53:04.030782Z", "url": "https://files.pythonhosted.org/packages/41/45/0cbe1cc712bef761a4fd21d99e6c5967fdd46c8a0c89ed3e5264fbfff2b6/keras-gpt-2-0.8.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "537b1a148b5e1135f4b28be226e64b2e", "sha256": "de8a417fb15581e2fddb64d1b91fbbfc571a77eafe609706decf22bad193bd71"}, "downloads": -1, "filename": "keras-gpt-2-0.14.0.tar.gz", "has_sig": false, "md5_digest": "537b1a148b5e1135f4b28be226e64b2e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 7689, "upload_time": "2019-10-29T07:47:23", "upload_time_iso_8601": "2019-10-29T07:47:23.753710Z", "url": "https://files.pythonhosted.org/packages/df/19/d11eac066ffcb61ec9edd23c02e4651eaa31f1f67c167a636dd90b6142a4/keras-gpt-2-0.14.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:50:12 2020"}