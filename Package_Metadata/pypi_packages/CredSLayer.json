{"info": {"author": "ShellCode", "author_email": "shellcode33@protonmail.ch", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Operating System :: POSIX :: Linux", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "# CredSLayer\n\n![alt python_version](https://img.shields.io/badge/python-3.5+-informational.svg)\n![alt tests_coverage](https://img.shields.io/badge/tests%20coverage-94%25-success.svg)\n[![Build Status](https://travis-ci.com/ShellCode33/CredSLayer.svg?branch=master)](https://travis-ci.com/ShellCode33/CredSLayer)\n\nCredSLayer goal is to look for credentials and other useful stuff in network captures. Two modes are available, pcap scanning and active processing. The latest listens for packets on a chosen interface and dynamically extracts everything it can.\n\nHave you heard about [Pcredz](https://github.com/lgandx/PCredz) or [net-creds](https://github.com/DanMcInerney/net-creds) ? Well this tool pushes the boundaries even further by using Wireshark dissectors, it's therefore more accurate and reliable.\n\nThis tool is really helpful if you're doing IT security or if you want to scan your own network to see if anything critical is transmitted.\n\n# Features\n\nRight now, CredSLayer supports the following protocols:\n* FTP\n* SMTP / IMAP / POP3\n* Telnet\n* HTTP\n* LDAP\n* SNMP\n* MySQL / PostgreSQL\n* NTLMSSP\n* Kerberos coming soon...\n\nIt is also able to look for email addresses and credit card numbers.\n\n**Note:** To prevent false positives and performance issues, tshark (the Wireshark underlying engine) identifies protocols based on port numbers to know which dissector to use on which packets. A few protocols however have heuristic analysis to guess the protocol on different ports than the usual ones (such as HTTP). To address this issue, CredSLayer has a `--map` parameter, it enables you to map a (range of) port(s) to a specific protocol. This way you will be able to sniff credentials going to a specific service on a specific port you are aware of.  \n\n# Install\n\nYou need `tshark` installed and Python >= 3.5. On some distribution tshark in shipped within the `wireshark` package. \n\nThen simply install using :\n\n```\n$ pip install credslayer\n```\n\nI recommend you use a [virtualenv](https://docs.python.org/3/library/venv.html) to prevent conflicts.\n\n# Usage\n\n```\n$ credslayer -h\nusage: credslayer [-h] [-l INTERFACE] [-s {enable,disable}] [-f IP]\n                     [-m PORT:PROTOCOL] [--debug]\n                     [pcapfiles [pcapfiles ...]]\n\nHelps you find credentials and other interesting stuff in network captures\n\npositional arguments:\n  pcapfiles             pcap files you want to analyse.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -l INTERFACE, --listen INTERFACE\n                        start active processing on specified interface\n  -s {enable,disable}, --string-inspection {enable,disable}\n                        let you specify if you want to look for interesting\n                        strings (email addresses, credit cards, ...) in\n                        network captures. Pretty heavy on the CPU. Enabled by\n                        default on pcap files, disabled on live captures.\n  -f IP, --filter IP    only show packets involving the specified IP.\n  -m PORT:PROTOCOL, --map PORT:PROTOCOL\n                        map a port to a protocol\n  --debug               put CredSLayer and pyshark in debug mode.\n```\n\n# Get involved\n\nThanks to Wireshark dissectors, it's really easy to write new protocols support, you're welcome to contribute !\n\nContributing doesn't necessarily mean writing code. You can simply contribute by opening new issues on Github if you spot any bug or if you would like to see something added to the tool.\n\nCredSLayer automatically dispatch packets to the appropriate file, for example if a LDAP packet is received, CredSLayer will send the `LDAP` layer to the `analyse` function inside `ldap.py`.\n\nSo if you want to support a new protocol, all you have to do is create a new file **named after the layer name** you want to parse. You can find the layer name by looking at the `Protocol` column in Wireshark.\n\nThere's one exception to that. If the protocol you want to extract credentials from can be embedded in other protocol, the procedure is a bit more complex (you can look at `ntlmssp.py` and `manager.py` to understand the mechanisms involved).\n\nOtherwise, to create a simple module, there are a few things you need to know :\n- The `analyse()` function's parameter `layer` is simply the layer you want to analyse, it contains everything the Wireshark dissector were able to find. \n- The `analyse()` function's parameter `session` is a dictionary that enables you to have a context between the packets, it can keep stuff you found in a packet so you can access those variables to analyse the packets that follow.\n- The `session` has 2 attributes you must know of. The first one is `credentials_being_built`, it's the `Credentials` object you must fill when you find something interesting (username, password, hash, etc). The second attribute is `credentials_list`, it's a list of `Credentials` objects and it is automatically filled with `credentials_being_built` when the `analyse()` function returns true. But in some cases (you can find one in `http.py`), you might want to fill that list manually.   \n- You must ensure the authentication was successful before logging any credentials. The credentials being built but not validated will be automatically logged as `info` by CredSLayer's \"garbage collector\".\n- If at some point of your processing you realise the credentials being built aren't valid, you must call `session.invalidate_credentials_and_clear_session()`.    \n\nGood luck ! If you need help to understand something, feel free to contact me : shellcode33{at}protonmail.ch  \n\n# Credits\n\n* CredSLayer is based on [pyshark](https://github.com/KimiNewt/pyshark), a tshark Python wrapper\n\n* Wireshark for their [pcaps](https://wiki.wireshark.org/SampleCaptures)\n\n* [moloch](https://github.com/aol/moloch) for their [pcaps](https://github.com/aol/moloch/tree/master/tests/pcap)\n\n* [asecuritysite](https://asecuritysite.com) for their [pcaps](https://asecuritysite.com/forensics/pcap)\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/ShellCode33/CredSLayer", "keywords": "credentials security networking extraction mining wireshark tshark dissector password", "license": "", "maintainer": "", "maintainer_email": "", "name": "CredSLayer", "package_url": "https://pypi.org/project/CredSLayer/", "platform": "", "project_url": "https://pypi.org/project/CredSLayer/", "project_urls": {"Homepage": "https://github.com/ShellCode33/CredSLayer"}, "release_url": "https://pypi.org/project/CredSLayer/0.1/", "requires_dist": ["pyshark", "argparse", "argcomplete"], "requires_python": ">=3.5", "summary": "Extract credentials and other useful info from network captures", "version": "0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>CredSLayer</h1>\n<p><img alt=\"alt python_version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/864730b7120df1ec2e2b4bd54e9e3250a43a0ef6/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e352b2d696e666f726d6174696f6e616c2e737667\">\n<img alt=\"alt tests_coverage\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/15782867dba989792965b0ccb498c3b87dfb24ea/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f7465737473253230636f7665726167652d39342532352d737563636573732e737667\">\n<a href=\"https://travis-ci.com/ShellCode33/CredSLayer\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/96d91154e42d36f6d87c2e60e645a8991f0204ee/68747470733a2f2f7472617669732d63692e636f6d2f5368656c6c436f646533332f43726564534c617965722e7376673f6272616e63683d6d6173746572\"></a></p>\n<p>CredSLayer goal is to look for credentials and other useful stuff in network captures. Two modes are available, pcap scanning and active processing. The latest listens for packets on a chosen interface and dynamically extracts everything it can.</p>\n<p>Have you heard about <a href=\"https://github.com/lgandx/PCredz\" rel=\"nofollow\">Pcredz</a> or <a href=\"https://github.com/DanMcInerney/net-creds\" rel=\"nofollow\">net-creds</a> ? Well this tool pushes the boundaries even further by using Wireshark dissectors, it's therefore more accurate and reliable.</p>\n<p>This tool is really helpful if you're doing IT security or if you want to scan your own network to see if anything critical is transmitted.</p>\n<h1>Features</h1>\n<p>Right now, CredSLayer supports the following protocols:</p>\n<ul>\n<li>FTP</li>\n<li>SMTP / IMAP / POP3</li>\n<li>Telnet</li>\n<li>HTTP</li>\n<li>LDAP</li>\n<li>SNMP</li>\n<li>MySQL / PostgreSQL</li>\n<li>NTLMSSP</li>\n<li>Kerberos coming soon...</li>\n</ul>\n<p>It is also able to look for email addresses and credit card numbers.</p>\n<p><strong>Note:</strong> To prevent false positives and performance issues, tshark (the Wireshark underlying engine) identifies protocols based on port numbers to know which dissector to use on which packets. A few protocols however have heuristic analysis to guess the protocol on different ports than the usual ones (such as HTTP). To address this issue, CredSLayer has a <code>--map</code> parameter, it enables you to map a (range of) port(s) to a specific protocol. This way you will be able to sniff credentials going to a specific service on a specific port you are aware of.</p>\n<h1>Install</h1>\n<p>You need <code>tshark</code> installed and Python &gt;= 3.5. On some distribution tshark in shipped within the <code>wireshark</code> package.</p>\n<p>Then simply install using :</p>\n<pre><code>$ pip install credslayer\n</code></pre>\n<p>I recommend you use a <a href=\"https://docs.python.org/3/library/venv.html\" rel=\"nofollow\">virtualenv</a> to prevent conflicts.</p>\n<h1>Usage</h1>\n<pre><code>$ credslayer -h\nusage: credslayer [-h] [-l INTERFACE] [-s {enable,disable}] [-f IP]\n                     [-m PORT:PROTOCOL] [--debug]\n                     [pcapfiles [pcapfiles ...]]\n\nHelps you find credentials and other interesting stuff in network captures\n\npositional arguments:\n  pcapfiles             pcap files you want to analyse.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -l INTERFACE, --listen INTERFACE\n                        start active processing on specified interface\n  -s {enable,disable}, --string-inspection {enable,disable}\n                        let you specify if you want to look for interesting\n                        strings (email addresses, credit cards, ...) in\n                        network captures. Pretty heavy on the CPU. Enabled by\n                        default on pcap files, disabled on live captures.\n  -f IP, --filter IP    only show packets involving the specified IP.\n  -m PORT:PROTOCOL, --map PORT:PROTOCOL\n                        map a port to a protocol\n  --debug               put CredSLayer and pyshark in debug mode.\n</code></pre>\n<h1>Get involved</h1>\n<p>Thanks to Wireshark dissectors, it's really easy to write new protocols support, you're welcome to contribute !</p>\n<p>Contributing doesn't necessarily mean writing code. You can simply contribute by opening new issues on Github if you spot any bug or if you would like to see something added to the tool.</p>\n<p>CredSLayer automatically dispatch packets to the appropriate file, for example if a LDAP packet is received, CredSLayer will send the <code>LDAP</code> layer to the <code>analyse</code> function inside <code>ldap.py</code>.</p>\n<p>So if you want to support a new protocol, all you have to do is create a new file <strong>named after the layer name</strong> you want to parse. You can find the layer name by looking at the <code>Protocol</code> column in Wireshark.</p>\n<p>There's one exception to that. If the protocol you want to extract credentials from can be embedded in other protocol, the procedure is a bit more complex (you can look at <code>ntlmssp.py</code> and <code>manager.py</code> to understand the mechanisms involved).</p>\n<p>Otherwise, to create a simple module, there are a few things you need to know :</p>\n<ul>\n<li>The <code>analyse()</code> function's parameter <code>layer</code> is simply the layer you want to analyse, it contains everything the Wireshark dissector were able to find.</li>\n<li>The <code>analyse()</code> function's parameter <code>session</code> is a dictionary that enables you to have a context between the packets, it can keep stuff you found in a packet so you can access those variables to analyse the packets that follow.</li>\n<li>The <code>session</code> has 2 attributes you must know of. The first one is <code>credentials_being_built</code>, it's the <code>Credentials</code> object you must fill when you find something interesting (username, password, hash, etc). The second attribute is <code>credentials_list</code>, it's a list of <code>Credentials</code> objects and it is automatically filled with <code>credentials_being_built</code> when the <code>analyse()</code> function returns true. But in some cases (you can find one in <code>http.py</code>), you might want to fill that list manually.</li>\n<li>You must ensure the authentication was successful before logging any credentials. The credentials being built but not validated will be automatically logged as <code>info</code> by CredSLayer's \"garbage collector\".</li>\n<li>If at some point of your processing you realise the credentials being built aren't valid, you must call <code>session.invalidate_credentials_and_clear_session()</code>.</li>\n</ul>\n<p>Good luck ! If you need help to understand something, feel free to contact me : shellcode33{at}protonmail.ch</p>\n<h1>Credits</h1>\n<ul>\n<li>\n<p>CredSLayer is based on <a href=\"https://github.com/KimiNewt/pyshark\" rel=\"nofollow\">pyshark</a>, a tshark Python wrapper</p>\n</li>\n<li>\n<p>Wireshark for their <a href=\"https://wiki.wireshark.org/SampleCaptures\" rel=\"nofollow\">pcaps</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/aol/moloch\" rel=\"nofollow\">moloch</a> for their <a href=\"https://github.com/aol/moloch/tree/master/tests/pcap\" rel=\"nofollow\">pcaps</a></p>\n</li>\n<li>\n<p><a href=\"https://asecuritysite.com\" rel=\"nofollow\">asecuritysite</a> for their <a href=\"https://asecuritysite.com/forensics/pcap\" rel=\"nofollow\">pcaps</a></p>\n</li>\n</ul>\n\n          </div>"}, "last_serial": 6762943, "releases": {"0.1": [{"comment_text": "", "digests": {"md5": "aa3c290e9084ed87f80de6c5d06a758a", "sha256": "57075f9b16a9ef7173e698decc82770226b08cb6c4473f82656fab5c4eb8f138"}, "downloads": -1, "filename": "CredSLayer-0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "aa3c290e9084ed87f80de6c5d06a758a", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.5", "size": 35558, "upload_time": "2020-03-06T15:56:29", "upload_time_iso_8601": "2020-03-06T15:56:29.788087Z", "url": "https://files.pythonhosted.org/packages/eb/f3/0e7ec82719d3c3b04f68e2581bbc72b40c33c86861d6fe8c56b9e248f117/CredSLayer-0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "66189160926f4edc5f3f14806253cd32", "sha256": "8af30147c504ca97ef8ef53e40f5cab8d17850258df74a1a7a995563a485aa8a"}, "downloads": -1, "filename": "CredSLayer-0.1.tar.gz", "has_sig": false, "md5_digest": "66189160926f4edc5f3f14806253cd32", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.5", "size": 18252, "upload_time": "2020-03-06T15:56:32", "upload_time_iso_8601": "2020-03-06T15:56:32.011943Z", "url": "https://files.pythonhosted.org/packages/c0/12/3e4c686526de96575943ef7ff5012c6da1c0183c9a0b5bc26820d7e8a990/CredSLayer-0.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "aa3c290e9084ed87f80de6c5d06a758a", "sha256": "57075f9b16a9ef7173e698decc82770226b08cb6c4473f82656fab5c4eb8f138"}, "downloads": -1, "filename": "CredSLayer-0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "aa3c290e9084ed87f80de6c5d06a758a", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.5", "size": 35558, "upload_time": "2020-03-06T15:56:29", "upload_time_iso_8601": "2020-03-06T15:56:29.788087Z", "url": "https://files.pythonhosted.org/packages/eb/f3/0e7ec82719d3c3b04f68e2581bbc72b40c33c86861d6fe8c56b9e248f117/CredSLayer-0.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "66189160926f4edc5f3f14806253cd32", "sha256": "8af30147c504ca97ef8ef53e40f5cab8d17850258df74a1a7a995563a485aa8a"}, "downloads": -1, "filename": "CredSLayer-0.1.tar.gz", "has_sig": false, "md5_digest": "66189160926f4edc5f3f14806253cd32", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.5", "size": 18252, "upload_time": "2020-03-06T15:56:32", "upload_time_iso_8601": "2020-03-06T15:56:32.011943Z", "url": "https://files.pythonhosted.org/packages/c0/12/3e4c686526de96575943ef7ff5012c6da1c0183c9a0b5bc26820d7e8a990/CredSLayer-0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:42:21 2020"}