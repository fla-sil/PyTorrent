{"info": {"author": "HaiFeng", "author_email": "haifengat@vip.qq.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7"], "description": "# ali rocketMQ for python\n\n## \u8bf4\u660e\n\n\u5b98\u65b9so\u8def\u5f84\u8981\u52a0\u5230LD_LIBRARY_PATH\u4e2d\n\n## \u8c03\u7528\u793a\u4f8b\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n# @Author  : HaiFeng\n# @Email   : 24918700@qq.com\n# @Time    : 2019/1/16\n# @desc    : demo ali rocketmq\n\nimport sys\nimport time\nfrom py_rmq.rmq_consumer import Consumer\nfrom py_rmq.rmq_producer import Producer\nfrom py_rmq.rmq_consumer import OrderConsumer\nfrom py_rmq.rmq_producer import OrderProducer\n\ndef OnConsumer(topic: str, tag: str, key: str, id: str, deliver_time: int, body: str, reconsume_times: int, store_time: int, offset: int):\n    print(body)\n\n\nif __name__ == '__main__':\n\n    t:str = ''\n    id:str = ''\n    access:str = ''\n    secret:str = ''\n    topic:str = ''\n\n    if len(sys.argv) > 1:\n        t = sys.argv[1].lower()\n        if len(sys.argv) > 2:\n            id = sys.argv[2]\n            if len(sys.argv) > 3:\n                access = sys.argv[3]\n                if len(sys.argv) > 4:\n                    secret = sys.argv[4]\n                    if len(sys.argv) > 5:\n                        topic = sys.argv[5]\n    if t == '':\n        t = input('select consumer or producer:').lower()\n    if id == '':\n        id = input('input cid or pid:')\n    if access == '':\n        access = input('input acces key:')\n    if secret == '':\n        secret = input('input secret key:')\n    if topic == '':\n        topic = input('input topic:')\n    if t == 'consumer':\n        print('test consumer...')\n        c = Consumer(id, access, secret)\n        c.OnConsumer = OnConsumer\n        c.subscribe(topic, '*')\n        input('press enter to continue test order consumer')\n        c.close()\n\n        print('test order consumer...')\n        c = OrderConsumer(id, access, secret)\n        c.OnConsumer = OnConsumer\n        c.subscribe(topic, '*')\n        input('press enter exit')\n        c.close()\n    else:\n        tag = 'tag test'\n\n        key = time.strftime('%Y%m%d%H%M%S', time.localtime())\n\n        print('test producer...')\n        p = Producer(id, access, secret)\n        msg = input('input content: ')\n        rst = p.send_msg(topic, tag, key, msg)\n        print(f'result: {rst}')\n        print('test delive msg, delive 30s')\n        rst = p.send_msg(topic, tag, key, msg + 'delive', int(time.time() * 1000) + 30000)\n        print(f'delive msg result: {rst}')\n        p.close()\n\n        input('press enter continue test order producer')\n        p = OrderProducer(id, access, secret)\n        sharding_key = input('input sharding_key: ')\n        rst = p.send_msg(topic, tag, key, msg, sharding_key)\n        print(f'order msg result: {rst}')\n        p.close()\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/haifengat/py_rmq", "keywords": "", "license": "MIT License", "maintainer": "", "maintainer_email": "", "name": "py-rmq", "package_url": "https://pypi.org/project/py-rmq/", "platform": "x64", "project_url": "https://pypi.org/project/py-rmq/", "project_urls": {"Homepage": "https://github.com/haifengat/py_rmq"}, "release_url": "https://pypi.org/project/py-rmq/0.0.5/", "requires_dist": null, "requires_python": ">=3.6.0", "summary": "Python ali rocketMQ api", "version": "0.0.5", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>ali rocketMQ for python</h1>\n<h2>\u8bf4\u660e</h2>\n<p>\u5b98\u65b9so\u8def\u5f84\u8981\u52a0\u5230LD_LIBRARY_PATH\u4e2d</p>\n<h2>\u8c03\u7528\u793a\u4f8b</h2>\n<pre><span class=\"ch\">#!/usr/bin/env python</span>\n<span class=\"c1\"># -*- coding: utf-8 -*-</span>\n<span class=\"c1\"># @Author  : HaiFeng</span>\n<span class=\"c1\"># @Email   : 24918700@qq.com</span>\n<span class=\"c1\"># @Time    : 2019/1/16</span>\n<span class=\"c1\"># @desc    : demo ali rocketmq</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n<span class=\"kn\">import</span> <span class=\"nn\">time</span>\n<span class=\"kn\">from</span> <span class=\"nn\">py_rmq.rmq_consumer</span> <span class=\"kn\">import</span> <span class=\"n\">Consumer</span>\n<span class=\"kn\">from</span> <span class=\"nn\">py_rmq.rmq_producer</span> <span class=\"kn\">import</span> <span class=\"n\">Producer</span>\n<span class=\"kn\">from</span> <span class=\"nn\">py_rmq.rmq_consumer</span> <span class=\"kn\">import</span> <span class=\"n\">OrderConsumer</span>\n<span class=\"kn\">from</span> <span class=\"nn\">py_rmq.rmq_producer</span> <span class=\"kn\">import</span> <span class=\"n\">OrderProducer</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">OnConsumer</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">tag</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"nb\">id</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">deliver_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">body</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">reconsume_times</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">store_time</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">offset</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">body</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n\n    <span class=\"n\">t</span><span class=\"p\">:</span><span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">''</span>\n    <span class=\"nb\">id</span><span class=\"p\">:</span><span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">''</span>\n    <span class=\"n\">access</span><span class=\"p\">:</span><span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">''</span>\n    <span class=\"n\">secret</span><span class=\"p\">:</span><span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">''</span>\n    <span class=\"n\">topic</span><span class=\"p\">:</span><span class=\"nb\">str</span> <span class=\"o\">=</span> <span class=\"s1\">''</span>\n\n    <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n        <span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">2</span><span class=\"p\">:</span>\n            <span class=\"nb\">id</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">3</span><span class=\"p\">:</span>\n                <span class=\"n\">access</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span>\n                <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">4</span><span class=\"p\">:</span>\n                    <span class=\"n\">secret</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span>\n                    <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">5</span><span class=\"p\">:</span>\n                        <span class=\"n\">topic</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span>\n    <span class=\"k\">if</span> <span class=\"n\">t</span> <span class=\"o\">==</span> <span class=\"s1\">''</span><span class=\"p\">:</span>\n        <span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'select consumer or producer:'</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span>\n    <span class=\"k\">if</span> <span class=\"nb\">id</span> <span class=\"o\">==</span> <span class=\"s1\">''</span><span class=\"p\">:</span>\n        <span class=\"nb\">id</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input cid or pid:'</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">access</span> <span class=\"o\">==</span> <span class=\"s1\">''</span><span class=\"p\">:</span>\n        <span class=\"n\">access</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input acces key:'</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">secret</span> <span class=\"o\">==</span> <span class=\"s1\">''</span><span class=\"p\">:</span>\n        <span class=\"n\">secret</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input secret key:'</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">topic</span> <span class=\"o\">==</span> <span class=\"s1\">''</span><span class=\"p\">:</span>\n        <span class=\"n\">topic</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input topic:'</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">t</span> <span class=\"o\">==</span> <span class=\"s1\">'consumer'</span><span class=\"p\">:</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'test consumer...'</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">Consumer</span><span class=\"p\">(</span><span class=\"nb\">id</span><span class=\"p\">,</span> <span class=\"n\">access</span><span class=\"p\">,</span> <span class=\"n\">secret</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">OnConsumer</span> <span class=\"o\">=</span> <span class=\"n\">OnConsumer</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">subscribe</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">,</span> <span class=\"s1\">'*'</span><span class=\"p\">)</span>\n        <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'press enter to continue test order consumer'</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'test order consumer...'</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">OrderConsumer</span><span class=\"p\">(</span><span class=\"nb\">id</span><span class=\"p\">,</span> <span class=\"n\">access</span><span class=\"p\">,</span> <span class=\"n\">secret</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">OnConsumer</span> <span class=\"o\">=</span> <span class=\"n\">OnConsumer</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">subscribe</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">,</span> <span class=\"s1\">'*'</span><span class=\"p\">)</span>\n        <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'press enter exit'</span><span class=\"p\">)</span>\n        <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">tag</span> <span class=\"o\">=</span> <span class=\"s1\">'tag test'</span>\n\n        <span class=\"n\">key</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">strftime</span><span class=\"p\">(</span><span class=\"s1\">'%Y%m</span><span class=\"si\">%d</span><span class=\"s1\">%H%M%S'</span><span class=\"p\">,</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">localtime</span><span class=\"p\">())</span>\n\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'test producer...'</span><span class=\"p\">)</span>\n        <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">Producer</span><span class=\"p\">(</span><span class=\"nb\">id</span><span class=\"p\">,</span> <span class=\"n\">access</span><span class=\"p\">,</span> <span class=\"n\">secret</span><span class=\"p\">)</span>\n        <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input content: '</span><span class=\"p\">)</span>\n        <span class=\"n\">rst</span> <span class=\"o\">=</span> <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">send_msg</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">,</span> <span class=\"n\">tag</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">'result: </span><span class=\"si\">{</span><span class=\"n\">rst</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'test delive msg, delive 30s'</span><span class=\"p\">)</span>\n        <span class=\"n\">rst</span> <span class=\"o\">=</span> <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">send_msg</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">,</span> <span class=\"n\">tag</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">msg</span> <span class=\"o\">+</span> <span class=\"s1\">'delive'</span><span class=\"p\">,</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"p\">()</span> <span class=\"o\">*</span> <span class=\"mi\">1000</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">30000</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">'delive msg result: </span><span class=\"si\">{</span><span class=\"n\">rst</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n        <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n\n        <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'press enter continue test order producer'</span><span class=\"p\">)</span>\n        <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">OrderProducer</span><span class=\"p\">(</span><span class=\"nb\">id</span><span class=\"p\">,</span> <span class=\"n\">access</span><span class=\"p\">,</span> <span class=\"n\">secret</span><span class=\"p\">)</span>\n        <span class=\"n\">sharding_key</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'input sharding_key: '</span><span class=\"p\">)</span>\n        <span class=\"n\">rst</span> <span class=\"o\">=</span> <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">send_msg</span><span class=\"p\">(</span><span class=\"n\">topic</span><span class=\"p\">,</span> <span class=\"n\">tag</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"p\">,</span> <span class=\"n\">sharding_key</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">'order msg result: </span><span class=\"si\">{</span><span class=\"n\">rst</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n        <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n</pre>\n\n          </div>"}, "last_serial": 4705876, "releases": {"0.0.3": [{"comment_text": "", "digests": {"md5": "4cc36f2a18f4a1520fcd3bb7a82eef98", "sha256": "ceae6a9455cb9c422d106684bf18dcf446894559aed2c41707831904a0226552"}, "downloads": -1, "filename": "py_rmq-0.0.3.tar.gz", "has_sig": false, "md5_digest": "4cc36f2a18f4a1520fcd3bb7a82eef98", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 26871, "upload_time": "2019-01-17T01:55:59", "upload_time_iso_8601": "2019-01-17T01:55:59.897041Z", "url": "https://files.pythonhosted.org/packages/4c/1a/ab52261d208000ce10251682699035c0d0bb55cd4d914503aab6cb053863/py_rmq-0.0.3.tar.gz", "yanked": false}], "0.0.5": [{"comment_text": "", "digests": {"md5": "3b113804f4aecf788efea46e27b38bb8", "sha256": "d3a54eebb3b3c99eaf6ba3c379c8606638289a5d97fa9e2b33ef6d3f5c5f4771"}, "downloads": -1, "filename": "py_rmq-0.0.5.tar.gz", "has_sig": false, "md5_digest": "3b113804f4aecf788efea46e27b38bb8", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 26881, "upload_time": "2019-01-17T02:01:36", "upload_time_iso_8601": "2019-01-17T02:01:36.897817Z", "url": "https://files.pythonhosted.org/packages/83/7f/5e10b63451a36de67dd9b3e12cb3bdb25a1ece87afa9bfd43b68ad0367cf/py_rmq-0.0.5.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3b113804f4aecf788efea46e27b38bb8", "sha256": "d3a54eebb3b3c99eaf6ba3c379c8606638289a5d97fa9e2b33ef6d3f5c5f4771"}, "downloads": -1, "filename": "py_rmq-0.0.5.tar.gz", "has_sig": false, "md5_digest": "3b113804f4aecf788efea46e27b38bb8", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6.0", "size": 26881, "upload_time": "2019-01-17T02:01:36", "upload_time_iso_8601": "2019-01-17T02:01:36.897817Z", "url": "https://files.pythonhosted.org/packages/83/7f/5e10b63451a36de67dd9b3e12cb3bdb25a1ece87afa9bfd43b68ad0367cf/py_rmq-0.0.5.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:57:45 2020"}