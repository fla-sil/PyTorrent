{"info": {"author": "Tobias Klausmann", "author_email": "klausman@schwarzvogel.de", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: GNU General Public License v2 (GPLv2)", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "# Lib_users\n\nLib_users is a Python script that goes through `/proc/*/maps` and finds all\ncases of libraries being mapped but marked as deleted. It then extracts the\nprograms name and arguments from `/proc/<pid>/cmdline`. This information is\npresented to the user so that those processes can be restarted.\n\nThe reason to do this is that after an update, you might end up with processes\nthat run for a long time and still use old libraries. In some cases this might\nbe a security problem, as the library may be vulnerable. The script displays\nall the distinct argument lists of processes that have deleted files mapped.\nIn essence, you get a list of processes and their PIDs. The reason why not\njust the first element of the argument list is presented is that for scripts,\nthis will always be the interpreter name (i.e. `perl`, `python` etc.) which is\nnot useful by itself.\n\nThe script cleans up the list from `/proc/<pid>/maps` to not display false\npositives - some programs have a pseudo file called `/SYSxxxx` mapped which\nobviously is not a library that was updated.\n\nAs of v0.10, there is a companion to `lib_users`, called `fd_users`. It\nbasically does the same, but for open FDs (`/proc/PID/fd`) that are marked as\ndeleted. The intended use is to spot daemons that have had their log files\ndeleted (or rotated and compressed), but not told to reopen the file.\n\n## Output formats\n\nLib_users supports two output formats/modes, human- and machine-readable:\n\nhuman-readable:\n\n```\n16341 \"supervising syslog-ng\"\n16342 \"/usr/sbin/syslog-ng\"\n27550 \"/usr/sbin/exim -bd -q15m\"\n12451,16244,16249,16252,16253,16254,26931,28912,29631,8810,894 \"/usr/sbin/apache2 -D DEFAULT_VHOST -D INFO -D LANGUAGE -D DAV -D SVN -D MAILMAN -D PHP5 -D USERDIR -D SVN_AUTHZ -D SUEXEC -D SSL -D SSL_DEFAULT_VHOST -D AUTH_DIGEST -D PERL -d /usr/lib64/apache2 -f /etc/apache2/httpd.conf -k start\"\n```\n\nHere, the first column is a comma-separated list of PIDs that share the same\ncommand line. The second column is the command line in quotation marks. If the\n-s command line option is used, there will also be information about the names\nof the deleted files in use.\n\nmachine-readable:\n\n```\n16341;/lib64/libpcre.so.0.0.1;supervising syslog-ng\n16342;/lib64/libpcre.so.0.0.1;/usr/sbin/syslog-ng\n27550;/lib64/libpcre.so.0.0.1,/usr/sbin/exim;/usr/sbin/exim -bd -q15m\n12451,16244,16249,16252,16253,16254,26931,28912,29631,8810,894;/lib64/libpcre.so.0.0.1;/usr/sbin/apache2 -D DEFAULT_VHOST -D INFO -D LANGUAGE -D DAV -D SVN -D MAILMAN -D PHP5 -D USERDIR -D SVN_AUTHZ -D SUEXEC -D SSL -D SSL_DEFAULT_VHOST -D AUTH_DIGEST -D PERL -d /usr/lib64/apache2 -f /etc/apache2/httpd.conf -k start\n```\n\nWith the -m command line parameter changes to this form:\n`<list of PIDs>;<list of deleted mapped files>;<command line>`\n\nThe lists are made up of comma-separated values. There are no provisions taken\nfor the case of one of the libraries contain a \",\". The command line is also\nnot altered in any way. This may be fixed in a future version.\n\n## Dependencies\n\nThe script requires Python 2.7 or higher and should work with Python 3. It only\nuses modules from Pythons standard library, so apart from a Python\ninstallation, there are no external dependencies.\n\nIf you want to run the test suite easily, install the Nose Python testing\nframework. This is not needed for day-to-day operations. Running the tests with\nPython 2.7 also requires the backported mock submodule of unittest\n(https://github.com/jaraco/backports.unittest_mock)\n\n## Limitations\n\nThe program quite probably only works on Linux (or, at least, only on systems\nthat have the same maps file structure as a Linux system).\n\nIf the script is not run as root, it can not display all processes on the\nsystem that use deleted libs. In the spirit of graceful degradation, it will\nthen only display the information for processes it has access to. Usually this\nis the list of processes owned by the user that runs lib_users. It will also\noutput a warning to stderr that it could not read all map files.\n\nThe `-S` command line switch relies on systemdctl and its output. Therefore, it\nmay break if the command is renamed or its output changes significantly. Note\nthat the output it produces is advisory and entirely reliant on systemd.\n\n## False positives\n\nSome programs open temporary files and immediately delete them. This is done\nso they don't leave those files behind after a crash. As a consequence,\nlib_users may report these programs. A notable example are programs that use\nliborc, the Oil Runtime Compiler. Here's an example, the media player\nquodlibet:\n\n```\n$ lib_users \n2753 \"/usr/bin/python2.7 /usr/bin/quodlibet\"\n$ grep deleted /proc/2753/maps \n7f409dd0b000-7f409dd1b000 rw-s 00000000 08:01 1179661 /tmp/orcexec.sqa9cE (deleted)\n```\n\nThe file `/tmp/orcexec.sqa9cE` is output from the aforementioned compiler. These\nprocesses/files can be safely ignored. In fact, restarting quodlibet will just\nresult in a different liborc tempfile show up as deleted.\n\nUsing the -s command line option will show you which deleted files are in use,\nso you decide whether the listed process is a false positive.\n\nStarting with lib_users 0.8, the `-i` and `-I` command line options can be used to\nsupply additional to-be-ignored patterns and static strings.\n\n## License\n\nThis program is released under the GPL-2, which is included in distributions\nof this script as the file COPYING. If you want to use it for something that\nis incompatible with the GPL-2, feel free to contact me; I'm sure we can work\nsomething out.\n\n## Contact & Contributions\n\nIf you want to contact me, my email address is `klausman-lu@schwarzvogel.de.`\nPatches and bug reports (or feature requests, even) are of course welcome.\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/klausman/lib_users", "keywords": "", "license": "GPL-2.0", "maintainer": "", "maintainer_email": "", "name": "lib-users", "package_url": "https://pypi.org/project/lib-users/", "platform": "", "project_url": "https://pypi.org/project/lib-users/", "project_urls": {"Homepage": "https://github.com/klausman/lib_users", "Repository": "https://github.com/klausman/lib_users"}, "release_url": "https://pypi.org/project/lib-users/0.14/", "requires_dist": null, "requires_python": ">=3.6,<4.0", "summary": "Checks /proc for libraries and files being mapped/open but marked as deleted", "version": "0.14", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Lib_users</h1>\n<p>Lib_users is a Python script that goes through <code>/proc/*/maps</code> and finds all\ncases of libraries being mapped but marked as deleted. It then extracts the\nprograms name and arguments from <code>/proc/&lt;pid&gt;/cmdline</code>. This information is\npresented to the user so that those processes can be restarted.</p>\n<p>The reason to do this is that after an update, you might end up with processes\nthat run for a long time and still use old libraries. In some cases this might\nbe a security problem, as the library may be vulnerable. The script displays\nall the distinct argument lists of processes that have deleted files mapped.\nIn essence, you get a list of processes and their PIDs. The reason why not\njust the first element of the argument list is presented is that for scripts,\nthis will always be the interpreter name (i.e. <code>perl</code>, <code>python</code> etc.) which is\nnot useful by itself.</p>\n<p>The script cleans up the list from <code>/proc/&lt;pid&gt;/maps</code> to not display false\npositives - some programs have a pseudo file called <code>/SYSxxxx</code> mapped which\nobviously is not a library that was updated.</p>\n<p>As of v0.10, there is a companion to <code>lib_users</code>, called <code>fd_users</code>. It\nbasically does the same, but for open FDs (<code>/proc/PID/fd</code>) that are marked as\ndeleted. The intended use is to spot daemons that have had their log files\ndeleted (or rotated and compressed), but not told to reopen the file.</p>\n<h2>Output formats</h2>\n<p>Lib_users supports two output formats/modes, human- and machine-readable:</p>\n<p>human-readable:</p>\n<pre><code>16341 \"supervising syslog-ng\"\n16342 \"/usr/sbin/syslog-ng\"\n27550 \"/usr/sbin/exim -bd -q15m\"\n12451,16244,16249,16252,16253,16254,26931,28912,29631,8810,894 \"/usr/sbin/apache2 -D DEFAULT_VHOST -D INFO -D LANGUAGE -D DAV -D SVN -D MAILMAN -D PHP5 -D USERDIR -D SVN_AUTHZ -D SUEXEC -D SSL -D SSL_DEFAULT_VHOST -D AUTH_DIGEST -D PERL -d /usr/lib64/apache2 -f /etc/apache2/httpd.conf -k start\"\n</code></pre>\n<p>Here, the first column is a comma-separated list of PIDs that share the same\ncommand line. The second column is the command line in quotation marks. If the\n-s command line option is used, there will also be information about the names\nof the deleted files in use.</p>\n<p>machine-readable:</p>\n<pre><code>16341;/lib64/libpcre.so.0.0.1;supervising syslog-ng\n16342;/lib64/libpcre.so.0.0.1;/usr/sbin/syslog-ng\n27550;/lib64/libpcre.so.0.0.1,/usr/sbin/exim;/usr/sbin/exim -bd -q15m\n12451,16244,16249,16252,16253,16254,26931,28912,29631,8810,894;/lib64/libpcre.so.0.0.1;/usr/sbin/apache2 -D DEFAULT_VHOST -D INFO -D LANGUAGE -D DAV -D SVN -D MAILMAN -D PHP5 -D USERDIR -D SVN_AUTHZ -D SUEXEC -D SSL -D SSL_DEFAULT_VHOST -D AUTH_DIGEST -D PERL -d /usr/lib64/apache2 -f /etc/apache2/httpd.conf -k start\n</code></pre>\n<p>With the -m command line parameter changes to this form:\n<code>&lt;list of PIDs&gt;;&lt;list of deleted mapped files&gt;;&lt;command line&gt;</code></p>\n<p>The lists are made up of comma-separated values. There are no provisions taken\nfor the case of one of the libraries contain a \",\". The command line is also\nnot altered in any way. This may be fixed in a future version.</p>\n<h2>Dependencies</h2>\n<p>The script requires Python 2.7 or higher and should work with Python 3. It only\nuses modules from Pythons standard library, so apart from a Python\ninstallation, there are no external dependencies.</p>\n<p>If you want to run the test suite easily, install the Nose Python testing\nframework. This is not needed for day-to-day operations. Running the tests with\nPython 2.7 also requires the backported mock submodule of unittest\n(<a href=\"https://github.com/jaraco/backports.unittest_mock\" rel=\"nofollow\">https://github.com/jaraco/backports.unittest_mock</a>)</p>\n<h2>Limitations</h2>\n<p>The program quite probably only works on Linux (or, at least, only on systems\nthat have the same maps file structure as a Linux system).</p>\n<p>If the script is not run as root, it can not display all processes on the\nsystem that use deleted libs. In the spirit of graceful degradation, it will\nthen only display the information for processes it has access to. Usually this\nis the list of processes owned by the user that runs lib_users. It will also\noutput a warning to stderr that it could not read all map files.</p>\n<p>The <code>-S</code> command line switch relies on systemdctl and its output. Therefore, it\nmay break if the command is renamed or its output changes significantly. Note\nthat the output it produces is advisory and entirely reliant on systemd.</p>\n<h2>False positives</h2>\n<p>Some programs open temporary files and immediately delete them. This is done\nso they don't leave those files behind after a crash. As a consequence,\nlib_users may report these programs. A notable example are programs that use\nliborc, the Oil Runtime Compiler. Here's an example, the media player\nquodlibet:</p>\n<pre><code>$ lib_users \n2753 \"/usr/bin/python2.7 /usr/bin/quodlibet\"\n$ grep deleted /proc/2753/maps \n7f409dd0b000-7f409dd1b000 rw-s 00000000 08:01 1179661 /tmp/orcexec.sqa9cE (deleted)\n</code></pre>\n<p>The file <code>/tmp/orcexec.sqa9cE</code> is output from the aforementioned compiler. These\nprocesses/files can be safely ignored. In fact, restarting quodlibet will just\nresult in a different liborc tempfile show up as deleted.</p>\n<p>Using the -s command line option will show you which deleted files are in use,\nso you decide whether the listed process is a false positive.</p>\n<p>Starting with lib_users 0.8, the <code>-i</code> and <code>-I</code> command line options can be used to\nsupply additional to-be-ignored patterns and static strings.</p>\n<h2>License</h2>\n<p>This program is released under the GPL-2, which is included in distributions\nof this script as the file COPYING. If you want to use it for something that\nis incompatible with the GPL-2, feel free to contact me; I'm sure we can work\nsomething out.</p>\n<h2>Contact &amp; Contributions</h2>\n<p>If you want to contact me, my email address is <code>klausman-lu@schwarzvogel.de.</code>\nPatches and bug reports (or feature requests, even) are of course welcome.</p>\n\n          </div>"}, "last_serial": 6656062, "releases": {"0.10": [{"comment_text": "", "digests": {"md5": "bda1abc5a94531c22554e2cf41cc0546", "sha256": "ae2c987a3eef43eabf8182e84658539a63e7aaff2287c6421774037a0b6bad6c"}, "downloads": -1, "filename": "lib_users-0.10.tar.gz", "has_sig": false, "md5_digest": "bda1abc5a94531c22554e2cf41cc0546", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5842, "upload_time": "2018-09-13T10:16:18", "upload_time_iso_8601": "2018-09-13T10:16:18.948969Z", "url": "https://files.pythonhosted.org/packages/c7/97/a1f019280e299949f5902ea83a2cbe364df034c13d5e184558cdb024147c/lib_users-0.10.tar.gz", "yanked": false}], "0.12": [{"comment_text": "", "digests": {"md5": "93d606d44e1c0eddcac8ffb4c204ae9a", "sha256": "7232880a3ef425d4cbe945ef7fe753df727cbd767277edd1c4f57ec5c10e7a85"}, "downloads": -1, "filename": "lib_users-0.12.tar.gz", "has_sig": false, "md5_digest": "93d606d44e1c0eddcac8ffb4c204ae9a", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 5879, "upload_time": "2018-10-16T10:11:16", "upload_time_iso_8601": "2018-10-16T10:11:16.269155Z", "url": "https://files.pythonhosted.org/packages/d5/cc/92a1cf3ec3d0affe0f8fd43b7932a57078b57eac57a2b4f71ddd743ffd7f/lib_users-0.12.tar.gz", "yanked": false}], "0.14": [{"comment_text": "", "digests": {"md5": "d94d31517b0c5f68e7b1fd60360c03c8", "sha256": "189c57342cd2075c8c613a1b88deab90602243e1aa2128046318857b76dbe46c"}, "downloads": -1, "filename": "lib_users-0.14-py3-none-any.whl", "has_sig": false, "md5_digest": "d94d31517b0c5f68e7b1fd60360c03c8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5520, "upload_time": "2020-02-18T21:07:37", "upload_time_iso_8601": "2020-02-18T21:07:37.812718Z", "url": "https://files.pythonhosted.org/packages/3f/f4/d101f74f7bc26cabff6b2933dcd68890675452b29017b4588bd98ee70e06/lib_users-0.14-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "00e8abd2edecdbef31ce14ab517441c5", "sha256": "709fa1e2c80f33993a91e39f45ecc6fcd986a960159de7ec751a4cdd8ddd1766"}, "downloads": -1, "filename": "lib_users-0.14.tar.gz", "has_sig": false, "md5_digest": "00e8abd2edecdbef31ce14ab517441c5", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5690, "upload_time": "2020-02-18T21:07:39", "upload_time_iso_8601": "2020-02-18T21:07:39.409625Z", "url": "https://files.pythonhosted.org/packages/83/8a/796df59830b947626d48d478993cf9f554ab915aa7d58de08eb9912017ca/lib_users-0.14.tar.gz", "yanked": false}], "0.14b0": [{"comment_text": "", "digests": {"md5": "3e79af2c9d2d382f25212921126bcd7b", "sha256": "97a302fb0ea88400b1de4f6d8db4c6cabe8e0d42392e468bd19ae93c1d09f576"}, "downloads": -1, "filename": "lib_users-0.14b0-py3-none-any.whl", "has_sig": false, "md5_digest": "3e79af2c9d2d382f25212921126bcd7b", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5533, "upload_time": "2020-02-18T21:00:35", "upload_time_iso_8601": "2020-02-18T21:00:35.202232Z", "url": "https://files.pythonhosted.org/packages/4c/90/497ce0b92166b6a9c3feafb1f723fc218c0bdd9d8178157c32eb43b4ea78/lib_users-0.14b0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "263fcd2fb74a88062ab5d960af3c4a5d", "sha256": "247eaa85c63dca8f34ab441065d7d22be05b8f5375bb05b1d507cd74fdc76fef"}, "downloads": -1, "filename": "lib_users-0.14b0.tar.gz", "has_sig": false, "md5_digest": "263fcd2fb74a88062ab5d960af3c4a5d", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5691, "upload_time": "2020-02-18T21:00:36", "upload_time_iso_8601": "2020-02-18T21:00:36.823784Z", "url": "https://files.pythonhosted.org/packages/30/fa/4fe588bf13210ef1d5194bc827c96651969845d838c04372a1730570a73f/lib_users-0.14b0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "d94d31517b0c5f68e7b1fd60360c03c8", "sha256": "189c57342cd2075c8c613a1b88deab90602243e1aa2128046318857b76dbe46c"}, "downloads": -1, "filename": "lib_users-0.14-py3-none-any.whl", "has_sig": false, "md5_digest": "d94d31517b0c5f68e7b1fd60360c03c8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5520, "upload_time": "2020-02-18T21:07:37", "upload_time_iso_8601": "2020-02-18T21:07:37.812718Z", "url": "https://files.pythonhosted.org/packages/3f/f4/d101f74f7bc26cabff6b2933dcd68890675452b29017b4588bd98ee70e06/lib_users-0.14-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "00e8abd2edecdbef31ce14ab517441c5", "sha256": "709fa1e2c80f33993a91e39f45ecc6fcd986a960159de7ec751a4cdd8ddd1766"}, "downloads": -1, "filename": "lib_users-0.14.tar.gz", "has_sig": false, "md5_digest": "00e8abd2edecdbef31ce14ab517441c5", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5690, "upload_time": "2020-02-18T21:07:39", "upload_time_iso_8601": "2020-02-18T21:07:39.409625Z", "url": "https://files.pythonhosted.org/packages/83/8a/796df59830b947626d48d478993cf9f554ab915aa7d58de08eb9912017ca/lib_users-0.14.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:46:13 2020"}