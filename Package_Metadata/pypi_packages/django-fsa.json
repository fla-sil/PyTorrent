{"info": {"author": "Antoine Fontaine", "author_email": "antoine.fontaine@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Environment :: Web Environment", "Framework :: Django", "Framework :: Django :: 1.11", "Framework :: Django :: 2.0", "Framework :: Django :: 2.1", "Framework :: Django :: 2.2", "Framework :: Django :: 3.0", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Software Development :: Libraries :: Python Modules"], "description": "Django friendly finite state machine support\n============================================\n\nThis is a friendly fork which aims to ensure that the tests are passing with\nthe new python and django versions, the original django-fsm was written by\nMikhail Podgurskiy (kmmbvnr@gmail.com), https://github.com/viewflow/django-fsm\n\n|Build Status| |Pypi Status|\n\ndjango-fsm adds simple declarative states management for django models.\n\nIf you need parallel task execution, view and background task code reuse\nover different flows - check my new project django-viewflow:\n\nhttps://github.com/viewflow/viewflow\n\n\nInstead of adding some state field to a django model, and managing its\nvalues by hand, you could use FSMState field and mark model methods with\nthe ``transition`` decorator. Your method could contain the side-effects\nof the state change.\n\nNice introduction is available here:\nhttps://gist.github.com/Nagyman/9502133\n\nYou may also take a look at django-fsm-admin project containing a mixin\nand template tags to integrate django-fsm state transitions into the\ndjango admin.\n\nhttps://github.com/gadventures/django-fsm-admin\n\nTransition logging support could be achived with help of django-fsm-log\npackage\n\nhttps://github.com/gizmag/django-fsm-log\n\nFSM really helps to structure the code, especially when a new developer\ncomes to the project. FSM is most effective when you use it for some\nsequential steps.\n\n\nInstallation\n------------\n\n.. code:: bash\n\n    $ pip install django-fsm\n\nOr, for the latest git version\n\n.. code:: bash\n\n    $ pip install -e git://github.com/kmmbvnr/django-fsm.git#egg=django-fsm\n\nThe library has full Python 3 support\n\nUsage\n-----\n\nAdd FSMState field to your model\n\n.. code:: python\n\n    from django_fsm import FSMField, transition\n\n    class BlogPost(models.Model):\n        state = FSMField(default='new')\n\nUse the ``transition`` decorator to annotate model methods\n\n.. code:: python\n\n    @transition(field=state, source='new', target='published')\n    def publish(self):\n        \"\"\"\n        This function may contain side-effects,\n        like updating caches, notifying users, etc.\n        The return value will be discarded.\n        \"\"\"\n\n``source`` parameter accepts a list of states, or an individual state.\nYou can use ``*`` for source, to allow switching to ``target`` from any\nstate. The ``field`` parameter accepts both a string attribute name or an\nactual field instance.\n\nIf calling publish() succeeds without raising an exception, the state\nfield will be changed, but not written to the database.\n\n.. code:: python\n\n    from django_fsm import can_proceed\n\n    def publish_view(request, post_id):\n        post = get_object__or_404(BlogPost, pk=post_id)\n        if not can_proceed(post.publish):\n            raise PermissionDenied\n\n        post.publish()\n        post.save()\n        return redirect('/')\n\nIf some conditions are required to be met before changing the state, use\nthe ``conditions`` argument to ``transition``. ``conditions`` must be a\nlist of functions taking one argument, the model instance. The function\nmust return either ``True`` or ``False`` or a value that evaluates to\n``True`` or ``False``. If all functions return ``True``, all conditions\nare considered to be met and the transition is allowed to happen. If one\nof the functions returns ``False``, the transition will not happen.\nThese functions should not have any side effects.\n\nYou can use ordinary functions\n\n.. code:: python\n\n    def can_publish(instance):\n        # No publishing after 17 hours\n        if datetime.datetime.now().hour > 17:\n            return False\n        return True\n\nOr model methods\n\n.. code:: python\n\n    def can_destroy(self):\n        return self.is_under_investigation()\n\nUse the conditions like this:\n\n.. code:: python\n\n    @transition(field=state, source='new', target='published', conditions=[can_publish])\n    def publish(self):\n        \"\"\"\n        Side effects galore\n        \"\"\"\n\n    @transition(field=state, source='*', target='destroyed', conditions=[can_destroy])\n    def destroy(self):\n        \"\"\"\n        Side effects galore\n        \"\"\"\n\nYou could instantiate a field with protected=True option, that prevents\ndirect state field modification.\n\n.. code:: python\n\n    class BlogPost(models.Model):\n        state = FSMField(default='new', protected=True)\n\n    model = BlogPost()\n    model.state = 'invalid' # Raises AttributeError\n\nNote that calling\n`refresh_from_db <https://docs.djangoproject.com/en/1.8/ref/models/instances/#django.db.models.Model.refresh_from_db>`_\non a model instance with a protected FSMField will cause an exception.\n\n`target`\n~~~~~~~~\n\n`target` state parameter could point to a specific state or `django_fsm.State` implementation\n\n.. code:: python\n          \n    from django_fsm import FSMField, transition, RETURN_VALUE, GET_STATE\n    @transition(field=state,\n                source='*',\n                target=RETURN_VALUE('for_moderators', 'published'))\n    def publish(self, is_public=False):\n        return 'for_moderators' if is_public else 'published'\n\n    @transition(\n        field=state,\n        source='for_moderators',\n        target=GET_STATE(\n            lambda self, allowed: 'published' if allowed else 'rejected',\n            states=['published', 'rejected']))\n    def moderate(self, allowed):\n        self.allowed=allowed\n\n\n``custom`` properties\n~~~~~~~~~~~~~~~~~~~~~\n\nCustom properties can be added by providing a dictionary to the\n``custom`` keyword on the ``transition`` decorator.\n\n.. code:: python\n\n    @transition(field=state,\n                source='*',\n                target='onhold',\n                custom=dict(verbose='Hold for legal reasons'))\n    def legal_hold(self):\n        \"\"\"\n        Side effects galore\n        \"\"\"\n\n``on_error`` state\n~~~~~~~~~~~~~~~~~~\n\nIn case of transition method would raise exception, you can provide\nspecific target state\n\n.. code:: python\n\n    @transition(field=state, source='new', target='published', on_error='failed')\n    def publish(self):\n       \"\"\"\n       Some exception could happen here\n       \"\"\"\n\n``state_choices``\n~~~~~~~~~~~~~~~~~\n\nInstead of passing two elements list ``choices`` you could use three\nelements ``state_choices``, the last element states for string reference\nto model proxy class.\n\nBase class instance would be dynamically changed to corresponding Proxy\nclass instance, depending on the state. Even for queryset results, you\nwill get Proxy class instances, even if QuerySet executed on base class.\n\nCheck the `test\ncase <https://github.com/kmmbvnr/django-fsm/blob/master/tests/testapp/tests/test_state_transitions.py>`__\nfor example usage. Or read about `implementation\ninternals <http://schinckel.net/2013/06/13/django-proxy-model-state-machine/>`__\n\nPermissions\n~~~~~~~~~~~\n\nIt is common to have permissions attached to each model transition.\n``django-fsm`` handles this with ``permission`` keyword on the\n``transition`` decorator. ``permission`` accepts a permission string, or\ncallable that expects ``instance`` and ``user`` arguments and returns\nTrue if user can perform the transition.\n\n.. code:: python\n\n    @transition(field=state, source='*', target='publish',\n                permission=lambda instance, user: not user.has_perm('myapp.can_make_mistakes'))\n    def publish(self):\n        pass\n\n    @transition(field=state, source='*', target='publish',\n                permission='myapp.can_remove_post')\n    def remove(self):\n        pass\n\nYou can check permission with ``has_transition_permission`` method\n\n.. code:: python\n\n    from django_fsm import has_transition_perm\n    def publish_view(request, post_id):\n        post = get_object_or_404(BlogPost, pk=post_id)\n        if not has_transition_perm(post.publish, request.user):\n            raise PermissionDenied\n\n        post.publish()\n        post.save()\n        return redirect('/')\n\nModel methods\n~~~~~~~~~~~~~\n\n``get_all_FIELD_transitions`` Enumerates all declared transitions\n\n``get_available_FIELD_transitions`` Returns all transitions data\navailable in current state\n\n``get_available_user_FIELD_transitions`` Enumerates all transitions data\navailable in current state for provided user\n\nForeign Key constraints support\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nIf you store the states in the db table you could use FSMKeyField to\nensure Foreign Key database integrity.\n\nIn your model :\n\n.. code:: python\n\n    class DbState(models.Model):\n        id = models.CharField(primary_key=True, max_length=50)\n        label = models.CharField(max_length=255)\n\n        def __unicode__(self):\n            return self.label\n\n\n    class BlogPost(models.Model):\n        state = FSMKeyField(DbState, default='new')\n\n        @transition(field=state, source='new', target='published')\n        def publish(self):\n            pass\n\nIn your fixtures/initial\\_data.json :\n\n.. code:: json\n\n    [\n        {\n            \"pk\": \"new\",\n            \"model\": \"myapp.dbstate\",\n            \"fields\": {\n                \"label\": \"_NEW_\"\n            }\n        },\n        {\n            \"pk\": \"published\",\n            \"model\": \"myapp.dbstate\",\n            \"fields\": {\n                \"label\": \"_PUBLISHED_\"\n            }\n        }\n    ]\n\nNote : source and target parameters in @transition decorator use pk\nvalues of DBState model as names, even if field \"real\" name is used,\nwithout \\_id postfix, as field parameter.\n\nInteger Field support\n~~~~~~~~~~~~~~~~~~~~~\n\nYou can also use ``FSMIntegerField``. This is handy when you want to use\nenum style constants.\n\n.. code:: python\n\n    class BlogPostStateEnum(object):\n        NEW = 10\n        PUBLISHED = 20\n        HIDDEN = 30\n\n    class BlogPostWithIntegerField(models.Model):\n        state = FSMIntegerField(default=BlogPostStateEnum.NEW)\n\n        @transition(field=state, source=BlogPostStateEnum.NEW, target=BlogPostStateEnum.PUBLISHED)\n        def publish(self):\n            pass\n\nSignals\n~~~~~~~\n\n``django_fsm.signals.pre_transition`` and\n``django_fsm.signals.post_transition`` are called before and after\nallowed transition. No signals on invalid transition are called.\n\nArguments sent with these signals:\n\n**sender** The model class.\n\n**instance** The actual instance being proceed\n\n**name** Transition name\n\n**source** Source model state\n\n**target** Target model state\n\nOptimistic locking\n------------------\n\n``django-fsm`` provides optimistic locking mixin, to avoid concurrent\nmodel state changes. If model state was changed in database\n``django_fsm.ConcurrentTransition`` exception would be raised on\nmodel.save()\n\n.. code:: python\n\n    from django_fsm import FSMField, ConcurrentTransitionMixin\n\n    class BlogPost(ConcurrentTransitionMixin, models.Model):\n        state = FSMField(default='new')\n\nFor guaranteed protection against race conditions caused by concurrently\nexecuted transitions, make sure:\n\n- Your transitions do not have any side effects except for changes in the database,\n- You always run the save() method on the object within ``django.db.transaction.atomic()`` block.\n\nFollowing these recommendations, you can rely on\nConcurrentTransitionMixin to cause a rollback of all the changes that\nhave been executed in an inconsistent (out of sync) state, thus\npractically negating their effect.\n\nDrawing transitions\n-------------------\n\nRenders a graphical overview of your models states transitions\n\nYou need ``pip install graphviz>=0.4`` library and add ``django_fsm`` to\nyour ``INSTALLED_APPS``:\n\n.. code:: python\n\n    INSTALLED_APPS = (\n        ...\n        'django_fsm',\n        ...\n    )\n\n.. code:: bash\n\n    # Create a dot file\n    $ ./manage.py graph_transitions > transitions.dot\n\n    # Create a PNG image file only for specific model\n    $ ./manage.py graph_transitions -o blog_transitions.png myapp.Blog\n\n.. |Build Status| image:: https://travis-ci.org/MDziwny/django-fsm.svg?branch=develop\n   :target: https://travis-ci.org/MDziwny/django-fsm\n.. |Pypi Status| image:: https://badge.fury.io/py/django-fsa.svg\n   :target: https://badge.fury.io/py/django-fsa\n\nChangelog\n=========\n\ndjango-fsm 2.8.0 2019-12-08\n---------------------------\n\n- Add compatibility tests with Django 3.0\n- Remove the dependency with django-guardians in the tests\n- change some django deprecated functions\n\n\ndjango-fsm 2.7.2 2019-05-01\n---------------------------\n\n- Add compatibility test with python 3.8\n- Add compatibility test with Django 2.2\n  - Refactor the models in tests, a migration\n\ndjango-fsm 2.7.1 2019-03-04\n---------------------------\n\n- Delivery on Pypi\n\ndjango-fsm 2.7.0 2018-12-14\n---------------------------\n\n- Fix the travis tests\n- Add compatibility test with python 3.7, remove 2.6 and 3.3\n- Add compatibility test with Django 2.0 and 2.1, remove 1.6, 1.8, 1.9 and 1.10\n\ndjango-fsm 2.6.0 2017-06-08\n---------------------------\n\n- Fix django 1.11 compatibility\n- Fix TypeError in `graph_transitions` command when using django's lazy translations\n\n\ndjango-fsm 2.5.0 2017-03-04\n---------------------------\n\n- graph_transition command fix for django 1.10\n- graph_transition command supports GET_STATE targets\n- signal data extended with method args/kwargs and field\n- sets allowed to be passed to the transition decorator\n\n\ndjango-fsm 2.4.0 2016-05-14\n---------------------------\n\n- graph_transition commnad now works with multiple  FSM's per model\n- Add ability to set target state from transition return value or callable\n\n\ndjango-fsm 2.3.0 2015-10-15\n---------------------------\n\n- Add source state shortcut '+' to specify transitions from all states except the target\n- Add object-level permission checks\n- Fix translated labels for graph of FSMIntegerField\n- Fix multiple signals for several transition decorators\n\n\ndjango-fsm 2.2.1 2015-04-27\n---------------------------\n\n- Improved exception message for unmet transition conditions.\n- Don't send post transition signal in case of no state changes on\n  exception\n- Allow empty string as correct state value\n- Improved graphviz fsm visualisation\n- Clean django 1.8 warnings\n\ndjango-fsm 2.2.0 2014-09-03\n---------------------------\n\n- Support for `class\n  substitution <http://schinckel.net/2013/06/13/django-proxy-model-state-machine/>`__\n  to proxy classes depending on the state\n- Added ConcurrentTransitionMixin with optimistic locking support\n- Default db\\_index=True for FSMIntegerField removed\n- Graph transition code migrated to new graphviz library with python 3\n  support\n- Ability to change state on transition exception\n\ndjango-fsm 2.1.0 2014-05-15\n---------------------------\n\n- Support for attaching permission checks on model transitions\n\ndjango-fsm 2.0.0 2014-03-15\n---------------------------\n\n- Backward incompatible release\n- All public code import moved directly to django\\_fsm package\n- Correct support for several @transitions decorator with different\n  source states and conditions on same method\n- save parameter from transition decorator removed\n- get\\_available\\_FIELD\\_transitions return Transition data object\n  instead of tuple\n- Models got get\\_available\\_FIELD\\_transitions, even if field\n  specified as string reference\n- New get\\_all\\_FIELD\\_transitions method contributed to class\n\ndjango-fsm 1.6.0 2014-03-15\n---------------------------\n\n- FSMIntegerField and FSMKeyField support\n\ndjango-fsm 1.5.1 2014-01-04\n---------------------------\n\n- Ad-hoc support for state fields from proxy and inherited models\n\ndjango-fsm 1.5.0 2013-09-17\n---------------------------\n\n- Python 3 compatibility\n\ndjango-fsm 1.4.0 2011-12-21\n---------------------------\n\n- Add graph\\_transition command for drawing state transition picture\n\ndjango-fsm 1.3.0 2011-07-28\n---------------------------\n\n- Add direct field modification protection\n\ndjango-fsm 1.2.0 2011-03-23\n---------------------------\n\n- Add pre\\_transition and post\\_transition signals\n\ndjango-fsm 1.1.0 2011-02-22\n---------------------------\n\n- Add support for transition conditions\n- Allow multiple FSMField in one model\n- Contribute get\\_available\\_FIELD\\_transitions for model class\n\ndjango-fsm 1.0.0 2010-10-12\n---------------------------\n\n- Initial public release\n\ncopyright (c) 2010 Mikhail Podgurskiy\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.", "description_content_type": "text/x-rst", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "http://github.com/mdziwny/django-fsm", "keywords": "django", "license": "MIT License", "maintainer": "", "maintainer_email": "", "name": "django-fsa", "package_url": "https://pypi.org/project/django-fsa/", "platform": "any", "project_url": "https://pypi.org/project/django-fsa/", "project_urls": {"Homepage": "http://github.com/mdziwny/django-fsm"}, "release_url": "https://pypi.org/project/django-fsa/2.8.0/", "requires_dist": null, "requires_python": "", "summary": "Django friendly finite state machine support, forked from django-fsm", "version": "2.8.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <div id=\"django-friendly-finite-state-machine-support\">\n<h2>Django friendly finite state machine support</h2>\n<p>This is a friendly fork which aims to ensure that the tests are passing with\nthe new python and django versions, the original django-fsm was written by\nMikhail Podgurskiy (<a href=\"mailto:kmmbvnr%40gmail.com\">kmmbvnr<span>@</span>gmail<span>.</span>com</a>), <a href=\"https://github.com/viewflow/django-fsm\" rel=\"nofollow\">https://github.com/viewflow/django-fsm</a></p>\n<p><a href=\"https://travis-ci.org/MDziwny/django-fsm\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/e3499d525896c0d8269dd08488d2080ec8f21457/68747470733a2f2f7472617669732d63692e6f72672f4d447a69776e792f646a616e676f2d66736d2e7376673f6272616e63683d646576656c6f70\"></a> <a href=\"https://badge.fury.io/py/django-fsa\" rel=\"nofollow\"><img alt=\"Pypi Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b643090d03bc870c01251932d72d856a8ba25684/68747470733a2f2f62616467652e667572792e696f2f70792f646a616e676f2d6673612e737667\"></a></p>\n<p>django-fsm adds simple declarative states management for django models.</p>\n<p>If you need parallel task execution, view and background task code reuse\nover different flows - check my new project django-viewflow:</p>\n<p><a href=\"https://github.com/viewflow/viewflow\" rel=\"nofollow\">https://github.com/viewflow/viewflow</a></p>\n<p>Instead of adding some state field to a django model, and managing its\nvalues by hand, you could use FSMState field and mark model methods with\nthe <tt>transition</tt> decorator. Your method could contain the side-effects\nof the state change.</p>\n<p>Nice introduction is available here:\n<a href=\"https://gist.github.com/Nagyman/9502133\" rel=\"nofollow\">https://gist.github.com/Nagyman/9502133</a></p>\n<p>You may also take a look at django-fsm-admin project containing a mixin\nand template tags to integrate django-fsm state transitions into the\ndjango admin.</p>\n<p><a href=\"https://github.com/gadventures/django-fsm-admin\" rel=\"nofollow\">https://github.com/gadventures/django-fsm-admin</a></p>\n<p>Transition logging support could be achived with help of django-fsm-log\npackage</p>\n<p><a href=\"https://github.com/gizmag/django-fsm-log\" rel=\"nofollow\">https://github.com/gizmag/django-fsm-log</a></p>\n<p>FSM really helps to structure the code, especially when a new developer\ncomes to the project. FSM is most effective when you use it for some\nsequential steps.</p>\n<div id=\"installation\">\n<h3>Installation</h3>\n<pre>$ pip install django-fsm\n</pre>\n<p>Or, for the latest git version</p>\n<pre>$ pip install -e git://github.com/kmmbvnr/django-fsm.git#egg<span class=\"o\">=</span>django-fsm\n</pre>\n<p>The library has full Python 3 support</p>\n</div>\n<div id=\"usage\">\n<h3>Usage</h3>\n<p>Add FSMState field to your model</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_fsm</span> <span class=\"kn\">import</span> <span class=\"n\">FSMField</span><span class=\"p\">,</span> <span class=\"n\">transition</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">BlogPost</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">FSMField</span><span class=\"p\">(</span><span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">)</span>\n</pre>\n<p>Use the <tt>transition</tt> decorator to annotate model methods</p>\n<pre><span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'published'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"\n    This function may contain side-effects,\n    like updating caches, notifying users, etc.\n    The return value will be discarded.\n    \"\"\"</span>\n</pre>\n<p><tt>source</tt> parameter accepts a list of states, or an individual state.\nYou can use <tt>*</tt> for source, to allow switching to <tt>target</tt> from any\nstate. The <tt>field</tt> parameter accepts both a string attribute name or an\nactual field instance.</p>\n<p>If calling publish() succeeds without raising an exception, the state\nfield will be changed, but not written to the database.</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_fsm</span> <span class=\"kn\">import</span> <span class=\"n\">can_proceed</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">publish_view</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">post_id</span><span class=\"p\">):</span>\n    <span class=\"n\">post</span> <span class=\"o\">=</span> <span class=\"n\">get_object__or_404</span><span class=\"p\">(</span><span class=\"n\">BlogPost</span><span class=\"p\">,</span> <span class=\"n\">pk</span><span class=\"o\">=</span><span class=\"n\">post_id</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">can_proceed</span><span class=\"p\">(</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">PermissionDenied</span>\n\n    <span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">()</span>\n    <span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">redirect</span><span class=\"p\">(</span><span class=\"s1\">'/'</span><span class=\"p\">)</span>\n</pre>\n<p>If some conditions are required to be met before changing the state, use\nthe <tt>conditions</tt> argument to <tt>transition</tt>. <tt>conditions</tt> must be a\nlist of functions taking one argument, the model instance. The function\nmust return either <tt>True</tt> or <tt>False</tt> or a value that evaluates to\n<tt>True</tt> or <tt>False</tt>. If all functions return <tt>True</tt>, all conditions\nare considered to be met and the transition is allowed to happen. If one\nof the functions returns <tt>False</tt>, the transition will not happen.\nThese functions should not have any side effects.</p>\n<p>You can use ordinary functions</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">can_publish</span><span class=\"p\">(</span><span class=\"n\">instance</span><span class=\"p\">):</span>\n    <span class=\"c1\"># No publishing after 17 hours</span>\n    <span class=\"k\">if</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">now</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">hour</span> <span class=\"o\">&gt;</span> <span class=\"mi\">17</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"kc\">False</span>\n    <span class=\"k\">return</span> <span class=\"kc\">True</span>\n</pre>\n<p>Or model methods</p>\n<pre><span class=\"k\">def</span> <span class=\"nf\">can_destroy</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">is_under_investigation</span><span class=\"p\">()</span>\n</pre>\n<p>Use the conditions like this:</p>\n<pre><span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'published'</span><span class=\"p\">,</span> <span class=\"n\">conditions</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">can_publish</span><span class=\"p\">])</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"\n    Side effects galore\n    \"\"\"</span>\n\n<span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'*'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'destroyed'</span><span class=\"p\">,</span> <span class=\"n\">conditions</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">can_destroy</span><span class=\"p\">])</span>\n<span class=\"k\">def</span> <span class=\"nf\">destroy</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"\n    Side effects galore\n    \"\"\"</span>\n</pre>\n<p>You could instantiate a field with protected=True option, that prevents\ndirect state field modification.</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">BlogPost</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">FSMField</span><span class=\"p\">(</span><span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">protected</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">BlogPost</span><span class=\"p\">()</span>\n<span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"s1\">'invalid'</span> <span class=\"c1\"># Raises AttributeError</span>\n</pre>\n<p>Note that calling\n<a href=\"https://docs.djangoproject.com/en/1.8/ref/models/instances/#django.db.models.Model.refresh_from_db\" rel=\"nofollow\">refresh_from_db</a>\non a model instance with a protected FSMField will cause an exception.</p>\n<div id=\"target\">\n<h4><cite>target</cite></h4>\n<p><cite>target</cite> state parameter could point to a specific state or <cite>django_fsm.State</cite> implementation</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_fsm</span> <span class=\"kn\">import</span> <span class=\"n\">FSMField</span><span class=\"p\">,</span> <span class=\"n\">transition</span><span class=\"p\">,</span> <span class=\"n\">RETURN_VALUE</span><span class=\"p\">,</span> <span class=\"n\">GET_STATE</span>\n<span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span>\n            <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'*'</span><span class=\"p\">,</span>\n            <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">RETURN_VALUE</span><span class=\"p\">(</span><span class=\"s1\">'for_moderators'</span><span class=\"p\">,</span> <span class=\"s1\">'published'</span><span class=\"p\">))</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">is_public</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"s1\">'for_moderators'</span> <span class=\"k\">if</span> <span class=\"n\">is_public</span> <span class=\"k\">else</span> <span class=\"s1\">'published'</span>\n\n<span class=\"nd\">@transition</span><span class=\"p\">(</span>\n    <span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span>\n    <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'for_moderators'</span><span class=\"p\">,</span>\n    <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">GET_STATE</span><span class=\"p\">(</span>\n        <span class=\"k\">lambda</span> <span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">allowed</span><span class=\"p\">:</span> <span class=\"s1\">'published'</span> <span class=\"k\">if</span> <span class=\"n\">allowed</span> <span class=\"k\">else</span> <span class=\"s1\">'rejected'</span><span class=\"p\">,</span>\n        <span class=\"n\">states</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">'published'</span><span class=\"p\">,</span> <span class=\"s1\">'rejected'</span><span class=\"p\">]))</span>\n<span class=\"k\">def</span> <span class=\"nf\">moderate</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">allowed</span><span class=\"p\">):</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">allowed</span><span class=\"o\">=</span><span class=\"n\">allowed</span>\n</pre>\n</div>\n<div id=\"custom-properties\">\n<h4><tt>custom</tt> properties</h4>\n<p>Custom properties can be added by providing a dictionary to the\n<tt>custom</tt> keyword on the <tt>transition</tt> decorator.</p>\n<pre><span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span>\n            <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'*'</span><span class=\"p\">,</span>\n            <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'onhold'</span><span class=\"p\">,</span>\n            <span class=\"n\">custom</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"s1\">'Hold for legal reasons'</span><span class=\"p\">))</span>\n<span class=\"k\">def</span> <span class=\"nf\">legal_hold</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"\n    Side effects galore\n    \"\"\"</span>\n</pre>\n</div>\n<div id=\"on-error-state\">\n<h4><tt>on_error</tt> state</h4>\n<p>In case of transition method would raise exception, you can provide\nspecific target state</p>\n<pre><span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'published'</span><span class=\"p\">,</span> <span class=\"n\">on_error</span><span class=\"o\">=</span><span class=\"s1\">'failed'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n   <span class=\"sd\">\"\"\"\n   Some exception could happen here\n   \"\"\"</span>\n</pre>\n</div>\n<div id=\"state-choices\">\n<h4><tt>state_choices</tt></h4>\n<p>Instead of passing two elements list <tt>choices</tt> you could use three\nelements <tt>state_choices</tt>, the last element states for string reference\nto model proxy class.</p>\n<p>Base class instance would be dynamically changed to corresponding Proxy\nclass instance, depending on the state. Even for queryset results, you\nwill get Proxy class instances, even if QuerySet executed on base class.</p>\n<p>Check the <a href=\"https://github.com/kmmbvnr/django-fsm/blob/master/tests/testapp/tests/test_state_transitions.py\" rel=\"nofollow\">test\ncase</a>\nfor example usage. Or read about <a href=\"http://schinckel.net/2013/06/13/django-proxy-model-state-machine/\" rel=\"nofollow\">implementation\ninternals</a></p>\n</div>\n<div id=\"permissions\">\n<h4>Permissions</h4>\n<p>It is common to have permissions attached to each model transition.\n<tt><span class=\"pre\">django-fsm</span></tt> handles this with <tt>permission</tt> keyword on the\n<tt>transition</tt> decorator. <tt>permission</tt> accepts a permission string, or\ncallable that expects <tt>instance</tt> and <tt>user</tt> arguments and returns\nTrue if user can perform the transition.</p>\n<pre><span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'*'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'publish'</span><span class=\"p\">,</span>\n            <span class=\"n\">permission</span><span class=\"o\">=</span><span class=\"k\">lambda</span> <span class=\"n\">instance</span><span class=\"p\">,</span> <span class=\"n\">user</span><span class=\"p\">:</span> <span class=\"ow\">not</span> <span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">has_perm</span><span class=\"p\">(</span><span class=\"s1\">'myapp.can_make_mistakes'</span><span class=\"p\">))</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"k\">pass</span>\n\n<span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'*'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'publish'</span><span class=\"p\">,</span>\n            <span class=\"n\">permission</span><span class=\"o\">=</span><span class=\"s1\">'myapp.can_remove_post'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">remove</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"k\">pass</span>\n</pre>\n<p>You can check permission with <tt>has_transition_permission</tt> method</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_fsm</span> <span class=\"kn\">import</span> <span class=\"n\">has_transition_perm</span>\n<span class=\"k\">def</span> <span class=\"nf\">publish_view</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">post_id</span><span class=\"p\">):</span>\n    <span class=\"n\">post</span> <span class=\"o\">=</span> <span class=\"n\">get_object_or_404</span><span class=\"p\">(</span><span class=\"n\">BlogPost</span><span class=\"p\">,</span> <span class=\"n\">pk</span><span class=\"o\">=</span><span class=\"n\">post_id</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">has_transition_perm</span><span class=\"p\">(</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">user</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">PermissionDenied</span>\n\n    <span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">()</span>\n    <span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">redirect</span><span class=\"p\">(</span><span class=\"s1\">'/'</span><span class=\"p\">)</span>\n</pre>\n</div>\n<div id=\"model-methods\">\n<h4>Model methods</h4>\n<p><tt>get_all_FIELD_transitions</tt> Enumerates all declared transitions</p>\n<p><tt>get_available_FIELD_transitions</tt> Returns all transitions data\navailable in current state</p>\n<p><tt>get_available_user_FIELD_transitions</tt> Enumerates all transitions data\navailable in current state for provided user</p>\n</div>\n<div id=\"foreign-key-constraints-support\">\n<h4>Foreign Key constraints support</h4>\n<p>If you store the states in the db table you could use FSMKeyField to\nensure Foreign Key database integrity.</p>\n<p>In your model :</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">DbState</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"nb\">id</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">primary_key</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n    <span class=\"n\">label</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">255</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">__unicode__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">label</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">BlogPost</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">FSMKeyField</span><span class=\"p\">(</span><span class=\"n\">DbState</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">'published'</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">pass</span>\n</pre>\n<p>In your fixtures/initial_data.json :</p>\n<pre><span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n        <span class=\"nt\">\"pk\"</span><span class=\"p\">:</span> <span class=\"s2\">\"new\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"model\"</span><span class=\"p\">:</span> <span class=\"s2\">\"myapp.dbstate\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"fields\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"label\"</span><span class=\"p\">:</span> <span class=\"s2\">\"_NEW_\"</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">},</span>\n    <span class=\"p\">{</span>\n        <span class=\"nt\">\"pk\"</span><span class=\"p\">:</span> <span class=\"s2\">\"published\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"model\"</span><span class=\"p\">:</span> <span class=\"s2\">\"myapp.dbstate\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"fields\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"label\"</span><span class=\"p\">:</span> <span class=\"s2\">\"_PUBLISHED_\"</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">]</span>\n</pre>\n<p>Note : source and target parameters in @transition decorator use pk\nvalues of DBState model as names, even if field \u201creal\u201d name is used,\nwithout _id postfix, as field parameter.</p>\n</div>\n<div id=\"integer-field-support\">\n<h4>Integer Field support</h4>\n<p>You can also use <tt>FSMIntegerField</tt>. This is handy when you want to use\nenum style constants.</p>\n<pre><span class=\"k\">class</span> <span class=\"nc\">BlogPostStateEnum</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"n\">NEW</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>\n    <span class=\"n\">PUBLISHED</span> <span class=\"o\">=</span> <span class=\"mi\">20</span>\n    <span class=\"n\">HIDDEN</span> <span class=\"o\">=</span> <span class=\"mi\">30</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">BlogPostWithIntegerField</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">FSMIntegerField</span><span class=\"p\">(</span><span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">BlogPostStateEnum</span><span class=\"o\">.</span><span class=\"n\">NEW</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@transition</span><span class=\"p\">(</span><span class=\"n\">field</span><span class=\"o\">=</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">BlogPostStateEnum</span><span class=\"o\">.</span><span class=\"n\">NEW</span><span class=\"p\">,</span> <span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">BlogPostStateEnum</span><span class=\"o\">.</span><span class=\"n\">PUBLISHED</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">publish</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">pass</span>\n</pre>\n</div>\n<div id=\"signals\">\n<h4>Signals</h4>\n<p><tt>django_fsm.signals.pre_transition</tt> and\n<tt>django_fsm.signals.post_transition</tt> are called before and after\nallowed transition. No signals on invalid transition are called.</p>\n<p>Arguments sent with these signals:</p>\n<p><strong>sender</strong> The model class.</p>\n<p><strong>instance</strong> The actual instance being proceed</p>\n<p><strong>name</strong> Transition name</p>\n<p><strong>source</strong> Source model state</p>\n<p><strong>target</strong> Target model state</p>\n</div>\n</div>\n<div id=\"optimistic-locking\">\n<h3>Optimistic locking</h3>\n<p><tt><span class=\"pre\">django-fsm</span></tt> provides optimistic locking mixin, to avoid concurrent\nmodel state changes. If model state was changed in database\n<tt>django_fsm.ConcurrentTransition</tt> exception would be raised on\nmodel.save()</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django_fsm</span> <span class=\"kn\">import</span> <span class=\"n\">FSMField</span><span class=\"p\">,</span> <span class=\"n\">ConcurrentTransitionMixin</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">BlogPost</span><span class=\"p\">(</span><span class=\"n\">ConcurrentTransitionMixin</span><span class=\"p\">,</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">FSMField</span><span class=\"p\">(</span><span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">'new'</span><span class=\"p\">)</span>\n</pre>\n<p>For guaranteed protection against race conditions caused by concurrently\nexecuted transitions, make sure:</p>\n<ul>\n<li>Your transitions do not have any side effects except for changes in the database,</li>\n<li>You always run the save() method on the object within <tt>django.db.transaction.atomic()</tt> block.</li>\n</ul>\n<p>Following these recommendations, you can rely on\nConcurrentTransitionMixin to cause a rollback of all the changes that\nhave been executed in an inconsistent (out of sync) state, thus\npractically negating their effect.</p>\n</div>\n<div id=\"drawing-transitions\">\n<h3>Drawing transitions</h3>\n<p>Renders a graphical overview of your models states transitions</p>\n<p>You need <tt>pip install <span class=\"pre\">graphviz&gt;=0.4</span></tt> library and add <tt>django_fsm</tt> to\nyour <tt>INSTALLED_APPS</tt>:</p>\n<pre><span class=\"n\">INSTALLED_APPS</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n    <span class=\"o\">...</span>\n    <span class=\"s1\">'django_fsm'</span><span class=\"p\">,</span>\n    <span class=\"o\">...</span>\n<span class=\"p\">)</span>\n</pre>\n<pre><span class=\"c1\"># Create a dot file\n</span>$ ./manage.py graph_transitions &gt; transitions.dot\n\n<span class=\"c1\"># Create a PNG image file only for specific model\n</span>$ ./manage.py graph_transitions -o blog_transitions.png myapp.Blog\n</pre>\n</div>\n</div>\n<div id=\"changelog\">\n<h2>Changelog</h2>\n<div id=\"django-fsm-2-8-0-2019-12-08\">\n<h3>django-fsm 2.8.0 2019-12-08</h3>\n<ul>\n<li>Add compatibility tests with Django 3.0</li>\n<li>Remove the dependency with django-guardians in the tests</li>\n<li>change some django deprecated functions</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-7-2-2019-05-01\">\n<h3>django-fsm 2.7.2 2019-05-01</h3>\n<ul>\n<li>Add compatibility test with python 3.8</li>\n<li>Add compatibility test with Django 2.2\n- Refactor the models in tests, a migration</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-7-1-2019-03-04\">\n<h3>django-fsm 2.7.1 2019-03-04</h3>\n<ul>\n<li>Delivery on Pypi</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-7-0-2018-12-14\">\n<h3>django-fsm 2.7.0 2018-12-14</h3>\n<ul>\n<li>Fix the travis tests</li>\n<li>Add compatibility test with python 3.7, remove 2.6 and 3.3</li>\n<li>Add compatibility test with Django 2.0 and 2.1, remove 1.6, 1.8, 1.9 and 1.10</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-6-0-2017-06-08\">\n<h3>django-fsm 2.6.0 2017-06-08</h3>\n<ul>\n<li>Fix django 1.11 compatibility</li>\n<li>Fix TypeError in <cite>graph_transitions</cite> command when using django\u2019s lazy translations</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-5-0-2017-03-04\">\n<h3>django-fsm 2.5.0 2017-03-04</h3>\n<ul>\n<li>graph_transition command fix for django 1.10</li>\n<li>graph_transition command supports GET_STATE targets</li>\n<li>signal data extended with method args/kwargs and field</li>\n<li>sets allowed to be passed to the transition decorator</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-4-0-2016-05-14\">\n<h3>django-fsm 2.4.0 2016-05-14</h3>\n<ul>\n<li>graph_transition commnad now works with multiple  FSM\u2019s per model</li>\n<li>Add ability to set target state from transition return value or callable</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-3-0-2015-10-15\">\n<h3>django-fsm 2.3.0 2015-10-15</h3>\n<ul>\n<li>Add source state shortcut \u2018+\u2019 to specify transitions from all states except the target</li>\n<li>Add object-level permission checks</li>\n<li>Fix translated labels for graph of FSMIntegerField</li>\n<li>Fix multiple signals for several transition decorators</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-2-1-2015-04-27\">\n<h3>django-fsm 2.2.1 2015-04-27</h3>\n<ul>\n<li>Improved exception message for unmet transition conditions.</li>\n<li>Don\u2019t send post transition signal in case of no state changes on\nexception</li>\n<li>Allow empty string as correct state value</li>\n<li>Improved graphviz fsm visualisation</li>\n<li>Clean django 1.8 warnings</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-2-0-2014-09-03\">\n<h3>django-fsm 2.2.0 2014-09-03</h3>\n<ul>\n<li>Support for <a href=\"http://schinckel.net/2013/06/13/django-proxy-model-state-machine/\" rel=\"nofollow\">class\nsubstitution</a>\nto proxy classes depending on the state</li>\n<li>Added ConcurrentTransitionMixin with optimistic locking support</li>\n<li>Default db_index=True for FSMIntegerField removed</li>\n<li>Graph transition code migrated to new graphviz library with python 3\nsupport</li>\n<li>Ability to change state on transition exception</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-1-0-2014-05-15\">\n<h3>django-fsm 2.1.0 2014-05-15</h3>\n<ul>\n<li>Support for attaching permission checks on model transitions</li>\n</ul>\n</div>\n<div id=\"django-fsm-2-0-0-2014-03-15\">\n<h3>django-fsm 2.0.0 2014-03-15</h3>\n<ul>\n<li>Backward incompatible release</li>\n<li>All public code import moved directly to django_fsm package</li>\n<li>Correct support for several @transitions decorator with different\nsource states and conditions on same method</li>\n<li>save parameter from transition decorator removed</li>\n<li>get_available_FIELD_transitions return Transition data object\ninstead of tuple</li>\n<li>Models got get_available_FIELD_transitions, even if field\nspecified as string reference</li>\n<li>New get_all_FIELD_transitions method contributed to class</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-6-0-2014-03-15\">\n<h3>django-fsm 1.6.0 2014-03-15</h3>\n<ul>\n<li>FSMIntegerField and FSMKeyField support</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-5-1-2014-01-04\">\n<h3>django-fsm 1.5.1 2014-01-04</h3>\n<ul>\n<li>Ad-hoc support for state fields from proxy and inherited models</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-5-0-2013-09-17\">\n<h3>django-fsm 1.5.0 2013-09-17</h3>\n<ul>\n<li>Python 3 compatibility</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-4-0-2011-12-21\">\n<h3>django-fsm 1.4.0 2011-12-21</h3>\n<ul>\n<li>Add graph_transition command for drawing state transition picture</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-3-0-2011-07-28\">\n<h3>django-fsm 1.3.0 2011-07-28</h3>\n<ul>\n<li>Add direct field modification protection</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-2-0-2011-03-23\">\n<h3>django-fsm 1.2.0 2011-03-23</h3>\n<ul>\n<li>Add pre_transition and post_transition signals</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-1-0-2011-02-22\">\n<h3>django-fsm 1.1.0 2011-02-22</h3>\n<ul>\n<li>Add support for transition conditions</li>\n<li>Allow multiple FSMField in one model</li>\n<li>Contribute get_available_FIELD_transitions for model class</li>\n</ul>\n</div>\n<div id=\"django-fsm-1-0-0-2010-10-12\">\n<h3>django-fsm 1.0.0 2010-10-12</h3>\n<ul>\n<li>Initial public release</li>\n</ul>\n<p>copyright (c) 2010 Mikhail Podgurskiy</p>\n<p>Permission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \u201cSoftware\u201d), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:</p>\n<p>The above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.</p>\n<p>THE SOFTWARE IS PROVIDED \u201cAS IS\u201d, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.</p>\n</div>\n</div>\n\n          </div>"}, "last_serial": 6262748, "releases": {"2.7.1": [{"comment_text": "", "digests": {"md5": "759d2146775052f88faf038073f19634", "sha256": "d8f7656f8e05145e164fa9b5269bc3f14fb17ecff5afc0b68a317dc22d56284c"}, "downloads": -1, "filename": "django-fsa-2.7.1.tar.gz", "has_sig": false, "md5_digest": "759d2146775052f88faf038073f19634", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13930, "upload_time": "2019-03-04T23:05:46", "upload_time_iso_8601": "2019-03-04T23:05:46.485096Z", "url": "https://files.pythonhosted.org/packages/bb/31/5c064a20ffbb83cde56c7a20312fa9529a2d67beec45fb20ca48fdab1312/django-fsa-2.7.1.tar.gz", "yanked": false}], "2.7.2": [{"comment_text": "", "digests": {"md5": "b01de2918dba518d3870e6b95f68ea55", "sha256": "94e221390d97b23b3e19ac5661b57f05c03c3f21121e5f8e3cf11f07bc483b4f"}, "downloads": -1, "filename": "django-fsa-2.7.2.tar.gz", "has_sig": false, "md5_digest": "b01de2918dba518d3870e6b95f68ea55", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13697, "upload_time": "2019-05-01T17:22:40", "upload_time_iso_8601": "2019-05-01T17:22:40.098538Z", "url": "https://files.pythonhosted.org/packages/36/61/455f16618bc6db4bbeed3ea36aad5809e280dbded569c425da22f2772342/django-fsa-2.7.2.tar.gz", "yanked": false}], "2.8.0": [{"comment_text": "", "digests": {"md5": "01871ab9f30a46bcc262433751f190d2", "sha256": "95470576398491bbac22f0ed1fd735b8d3fbd0e3151b741bb6b509cb3eaf6005"}, "downloads": -1, "filename": "django-fsa-2.8.0.tar.gz", "has_sig": false, "md5_digest": "01871ab9f30a46bcc262433751f190d2", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13844, "upload_time": "2019-12-08T17:18:14", "upload_time_iso_8601": "2019-12-08T17:18:14.716556Z", "url": "https://files.pythonhosted.org/packages/65/79/948ea30e170af6f7bc3fcd1529878dc93e9c434debadab46c01b5d78b5dc/django-fsa-2.8.0.tar.gz", "yanked": false}], "2.8.0.dev0": [{"comment_text": "", "digests": {"md5": "8526c943d86fc06ac2ce4499fbf25988", "sha256": "0cadfaa71170e9fddea64db3e893a31268a68bbd4f056cd38d1b6c57f8825d6c"}, "downloads": -1, "filename": "django-fsa-2.8.0.dev0.tar.gz", "has_sig": false, "md5_digest": "8526c943d86fc06ac2ce4499fbf25988", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13855, "upload_time": "2019-10-29T21:01:02", "upload_time_iso_8601": "2019-10-29T21:01:02.552403Z", "url": "https://files.pythonhosted.org/packages/c1/70/cc93e3a3e1d45cace6c002630b2d2574ff5d1e1599d956ef542f0a11688c/django-fsa-2.8.0.dev0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "01871ab9f30a46bcc262433751f190d2", "sha256": "95470576398491bbac22f0ed1fd735b8d3fbd0e3151b741bb6b509cb3eaf6005"}, "downloads": -1, "filename": "django-fsa-2.8.0.tar.gz", "has_sig": false, "md5_digest": "01871ab9f30a46bcc262433751f190d2", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 13844, "upload_time": "2019-12-08T17:18:14", "upload_time_iso_8601": "2019-12-08T17:18:14.716556Z", "url": "https://files.pythonhosted.org/packages/65/79/948ea30e170af6f7bc3fcd1529878dc93e9c434debadab46c01b5d78b5dc/django-fsa-2.8.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:35:58 2020"}