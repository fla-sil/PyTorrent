{"info": {"author": "Jakub Lipi\u0144ski", "author_email": "jakub@cellular-genomics.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: Apache Software License", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Topic :: Scientific/Engineering :: Bio-Informatics"], "description": "# Detect Frequently Interacting REgions (FIREs) in Python\n\n[![PyPI](https://img.shields.io/pypi/v/FIREcaller.svg)](https://pypi.python.org/pypi/FIREcaller)\n\nThe project is a port of [the R package for detecting frequently interacting regions (FIREs) from Hi-C data](https://github.com/yycunc/FIREcaller) to Python. FIRE is described in [A Compendium of Chromatin Contact Maps Reveal Spatially Active Regions in the Human Genome](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5478386/) paper.\n\n## Command line usage\n\nInstall the package:\n```\npython3 -m pip install FIREcaller\n```\n\nDownload [some HiC experiment results](https://data.4dnucleome.org/browse/?experiments_in_set.biosample.biosource.individual.organism.name=human&experiments_in_set.experiment_type.display_title=in+situ+Hi-C&experimentset_type=replicate&type=ExperimentSetReplicate) from the 4D Nucleome database. Choose Contact Matrix (.mcool) as a file type.\n\nDownload the mappability file from [Yunjiang's website](http://enhancer.sdsc.edu/yunjiang/resources/genomic_features/). Ensure the genomic assembly and the bin size matches your HiC files. Add header line `chr start end F GC M` if missing.\n\nPerform FIRE calling:\n```\nFIREcaller \\\n  --cooler_filenames 4DNFIT5YVTLO.mcool \\\n  --cooler_filenames 4DNFIJTOIGOI.mcool \\\n  --mappability_filename F_GC_M_Hind3_10Kb_el.GRCh38.txt \\\n  --bin_size 10000 \\\n  --output_filename fires.csv\n```\n\nThe output file will consist of the genomic regions and their corresponding FIRE scores and log p-values for each HiC file:\n```\nchr start end F GC M 0_count_neig 1_count_neig 0_fire 1_fire 0_logpvalue 1_logpvalue\nchr1 1970000 1980000 2000 0.5175 1.0000 5365 2376 0.9515 0.8702 0.5861 0.4317\nchr1 2020000 2030000 3000 0.6287 0.9907 4305 2005 0.5806 0.5831 0.1128 0.1144\nchr1 2060000 2070000 4000 0.4770 0.9210 4029 2171 0.6880 0.8678 0.1954 0.4277\n(...)\n```\n\n`{n}_fire` column stores the FIIRE score for the n-th cooler file provided as `--cooler_filenames` argument\n\n`{n}_logpvalue` column stores the log p-value for the n-th cooler file provided as `--cooler_filenames` argument\n\n## Python usage\n\nUse the `FIREcaller.calc_fires()` function to perform FIRE calling from your Python program:\n\n`calc_fires(mappability_filename, cooler_filenames, bin_size, neighborhood_region, perc_threshold=.25, avg_mappability_threshold=0.9)`\n\n`mappability_filename : str` - Path to mappability file\n\n`cooler_filenames : str` -  List of paths to HiC experiment results in cooler format\n\n`bin_size : int` - Bin size\n\n`neighborhood_region : int` - Size of neighbor region\n\n`perc_threshold : float` - Maximum ratio of \"bad\" neighbors allowed\n\n`avg_mappability_threshold : float` - Minimum mappability allowed        \n\nThe function returns the Pandas DataFrame matrix.\n\n## Verification\n\nIn order to compare the results derived from this project with the ones obtained from the [FIREcaller R package](https://github.com/yycunc/FIREcaller/) please follow the steps described in the [`README.md`](https://github.com/yycunc/FIREcaller/blob/master/README.md) file to produce the `FIRE_ANALYSIS_40KB.txt` file.\n\nNow download and uncompress the [Hippo_Hi-C_inputs_chr1_22.tar.gz](https://yunliweb.its.unc.edu/FIREcaller/example/HiC_input_for_FIREcaller/Hippo_Hi-C_inputs_chr1_22.tar.gz) and [F_GC_M_HindIII_40KB_hg19.txt.gz](https://yunliweb.its.unc.edu/FIREcaller/example/HiC_input_for_FIREcaller/F_GC_M_HindIII_40KB_hg19.txt.gz) files.\n\nConvert the HiC files to get the `hippo.mcool` cooler file using the `scripts/build_hippo_cool.py` python script:\n\n```\npython scripts/build_hippo_cool.py\n```\n\nRun the FIRE calling:\n```\nFIREcaller \\\n  --cooler_filename hippo.mcool \\\n  --mappability_filename F_GC_M_HindIII_40KB_hg19.txt \\\n  --bin_size 40000 \\\n  --output_filename hippo_fires.csv\n```\n\nCompare the `FIRE_ANALYSIS_40KB.txt` and `fires.csv` files.\n\n## TODO:\n\n- [ ] Add option to remove the MHC regions\n- [ ] Calculate the Super FIREs\n- [x] Convert the script into the Python package\n\nLet me know if you need any of the above and I'll be happy to implement it. I also accept PRs and comments. Enjoy.\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/cellular-genomics/python-FIREcaller", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "FIREcaller", "package_url": "https://pypi.org/project/FIREcaller/", "platform": "", "project_url": "https://pypi.org/project/FIREcaller/", "project_urls": {"Homepage": "https://github.com/cellular-genomics/python-FIREcaller"}, "release_url": "https://pypi.org/project/FIREcaller/1.0.0/", "requires_dist": ["cooler (>=0.8.7)", "pandas (>=1.0.1)", "statsmodels (>=0.11.0)", "dask (>=2.10.1)", "fsspec (>=0.6.2)", "tables (>=3.6.1)"], "requires_python": ">=3.6", "summary": "Python library for detecting Frequently Interacting REgions (FIREs) from Hi-C data", "version": "1.0.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Detect Frequently Interacting REgions (FIREs) in Python</h1>\n<p><a href=\"https://pypi.python.org/pypi/FIREcaller\" rel=\"nofollow\"><img alt=\"PyPI\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/40a600961a012a846e6b13a73bb868f6c9f497ee/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f4649524563616c6c65722e737667\"></a></p>\n<p>The project is a port of <a href=\"https://github.com/yycunc/FIREcaller\" rel=\"nofollow\">the R package for detecting frequently interacting regions (FIREs) from Hi-C data</a> to Python. FIRE is described in <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5478386/\" rel=\"nofollow\">A Compendium of Chromatin Contact Maps Reveal Spatially Active Regions in the Human Genome</a> paper.</p>\n<h2>Command line usage</h2>\n<p>Install the package:</p>\n<pre><code>python3 -m pip install FIREcaller\n</code></pre>\n<p>Download <a href=\"https://data.4dnucleome.org/browse/?experiments_in_set.biosample.biosource.individual.organism.name=human&amp;experiments_in_set.experiment_type.display_title=in+situ+Hi-C&amp;experimentset_type=replicate&amp;type=ExperimentSetReplicate\" rel=\"nofollow\">some HiC experiment results</a> from the 4D Nucleome database. Choose Contact Matrix (.mcool) as a file type.</p>\n<p>Download the mappability file from <a href=\"http://enhancer.sdsc.edu/yunjiang/resources/genomic_features/\" rel=\"nofollow\">Yunjiang's website</a>. Ensure the genomic assembly and the bin size matches your HiC files. Add header line <code>chr start end F GC M</code> if missing.</p>\n<p>Perform FIRE calling:</p>\n<pre><code>FIREcaller \\\n  --cooler_filenames 4DNFIT5YVTLO.mcool \\\n  --cooler_filenames 4DNFIJTOIGOI.mcool \\\n  --mappability_filename F_GC_M_Hind3_10Kb_el.GRCh38.txt \\\n  --bin_size 10000 \\\n  --output_filename fires.csv\n</code></pre>\n<p>The output file will consist of the genomic regions and their corresponding FIRE scores and log p-values for each HiC file:</p>\n<pre><code>chr start end F GC M 0_count_neig 1_count_neig 0_fire 1_fire 0_logpvalue 1_logpvalue\nchr1 1970000 1980000 2000 0.5175 1.0000 5365 2376 0.9515 0.8702 0.5861 0.4317\nchr1 2020000 2030000 3000 0.6287 0.9907 4305 2005 0.5806 0.5831 0.1128 0.1144\nchr1 2060000 2070000 4000 0.4770 0.9210 4029 2171 0.6880 0.8678 0.1954 0.4277\n(...)\n</code></pre>\n<p><code>{n}_fire</code> column stores the FIIRE score for the n-th cooler file provided as <code>--cooler_filenames</code> argument</p>\n<p><code>{n}_logpvalue</code> column stores the log p-value for the n-th cooler file provided as <code>--cooler_filenames</code> argument</p>\n<h2>Python usage</h2>\n<p>Use the <code>FIREcaller.calc_fires()</code> function to perform FIRE calling from your Python program:</p>\n<p><code>calc_fires(mappability_filename, cooler_filenames, bin_size, neighborhood_region, perc_threshold=.25, avg_mappability_threshold=0.9)</code></p>\n<p><code>mappability_filename : str</code> - Path to mappability file</p>\n<p><code>cooler_filenames : str</code> -  List of paths to HiC experiment results in cooler format</p>\n<p><code>bin_size : int</code> - Bin size</p>\n<p><code>neighborhood_region : int</code> - Size of neighbor region</p>\n<p><code>perc_threshold : float</code> - Maximum ratio of \"bad\" neighbors allowed</p>\n<p><code>avg_mappability_threshold : float</code> - Minimum mappability allowed</p>\n<p>The function returns the Pandas DataFrame matrix.</p>\n<h2>Verification</h2>\n<p>In order to compare the results derived from this project with the ones obtained from the <a href=\"https://github.com/yycunc/FIREcaller/\" rel=\"nofollow\">FIREcaller R package</a> please follow the steps described in the <a href=\"https://github.com/yycunc/FIREcaller/blob/master/README.md\" rel=\"nofollow\"><code>README.md</code></a> file to produce the <code>FIRE_ANALYSIS_40KB.txt</code> file.</p>\n<p>Now download and uncompress the <a href=\"https://yunliweb.its.unc.edu/FIREcaller/example/HiC_input_for_FIREcaller/Hippo_Hi-C_inputs_chr1_22.tar.gz\" rel=\"nofollow\">Hippo_Hi-C_inputs_chr1_22.tar.gz</a> and <a href=\"https://yunliweb.its.unc.edu/FIREcaller/example/HiC_input_for_FIREcaller/F_GC_M_HindIII_40KB_hg19.txt.gz\" rel=\"nofollow\">F_GC_M_HindIII_40KB_hg19.txt.gz</a> files.</p>\n<p>Convert the HiC files to get the <code>hippo.mcool</code> cooler file using the <code>scripts/build_hippo_cool.py</code> python script:</p>\n<pre><code>python scripts/build_hippo_cool.py\n</code></pre>\n<p>Run the FIRE calling:</p>\n<pre><code>FIREcaller \\\n  --cooler_filename hippo.mcool \\\n  --mappability_filename F_GC_M_HindIII_40KB_hg19.txt \\\n  --bin_size 40000 \\\n  --output_filename hippo_fires.csv\n</code></pre>\n<p>Compare the <code>FIRE_ANALYSIS_40KB.txt</code> and <code>fires.csv</code> files.</p>\n<h2>TODO:</h2>\n<ul>\n<li>[ ] Add option to remove the MHC regions</li>\n<li>[ ] Calculate the Super FIREs</li>\n<li>[x] Convert the script into the Python package</li>\n</ul>\n<p>Let me know if you need any of the above and I'll be happy to implement it. I also accept PRs and comments. Enjoy.</p>\n\n          </div>"}, "last_serial": 6729123, "releases": {"1.0.0": [{"comment_text": "", "digests": {"md5": "f8de41f7a6e90ce5a806f3f648b564f0", "sha256": "716c5113f7d16a762df5d9582577fe1bbb770f83278e885a37de980f25ce67dc"}, "downloads": -1, "filename": "FIREcaller-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "f8de41f7a6e90ce5a806f3f648b564f0", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 10878, "upload_time": "2020-03-01T17:06:28", "upload_time_iso_8601": "2020-03-01T17:06:28.647083Z", "url": "https://files.pythonhosted.org/packages/da/cf/0169d3c879bc5d189373fec6791417c9c64bb9d1a15a71a0469ed5f19bf2/FIREcaller-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "88810494c5f742ab0575dfbc0720bab8", "sha256": "070b1a93318ec4cd633d6ffcd4e2a3402b453aef8138f1a477d9d6d2e15f138e"}, "downloads": -1, "filename": "FIREcaller-1.0.0.tar.gz", "has_sig": false, "md5_digest": "88810494c5f742ab0575dfbc0720bab8", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6171, "upload_time": "2020-03-01T17:06:30", "upload_time_iso_8601": "2020-03-01T17:06:30.910010Z", "url": "https://files.pythonhosted.org/packages/32/f4/42292deadc0fb36e21232f932ca97871dcaf5fe88423165c85dc72582116/FIREcaller-1.0.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "f8de41f7a6e90ce5a806f3f648b564f0", "sha256": "716c5113f7d16a762df5d9582577fe1bbb770f83278e885a37de980f25ce67dc"}, "downloads": -1, "filename": "FIREcaller-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "f8de41f7a6e90ce5a806f3f648b564f0", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 10878, "upload_time": "2020-03-01T17:06:28", "upload_time_iso_8601": "2020-03-01T17:06:28.647083Z", "url": "https://files.pythonhosted.org/packages/da/cf/0169d3c879bc5d189373fec6791417c9c64bb9d1a15a71a0469ed5f19bf2/FIREcaller-1.0.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "88810494c5f742ab0575dfbc0720bab8", "sha256": "070b1a93318ec4cd633d6ffcd4e2a3402b453aef8138f1a477d9d6d2e15f138e"}, "downloads": -1, "filename": "FIREcaller-1.0.0.tar.gz", "has_sig": false, "md5_digest": "88810494c5f742ab0575dfbc0720bab8", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6171, "upload_time": "2020-03-01T17:06:30", "upload_time_iso_8601": "2020-03-01T17:06:30.910010Z", "url": "https://files.pythonhosted.org/packages/32/f4/42292deadc0fb36e21232f932ca97871dcaf5fe88423165c85dc72582116/FIREcaller-1.0.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:42:14 2020"}