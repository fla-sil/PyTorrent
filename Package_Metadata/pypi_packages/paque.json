{"info": {"author": "Ruben Berenguel", "author_email": "ruben+poetry@mostlymaths.net", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "# Paque `\u00af\\_(\u30c4)_/\u00af`\n\n[![PyPI version](https://badge.fury.io/py/paque.svg)](https://badge.fury.io/py/paque)\n\n<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-refresh-toc -->\n\n- [Installation](#installation)\n    - [Tab completion](#tab-completion)\n- [Why?](#why)\n- [What?](#what)\n- [How?](#how)\n- [FAQ](#faq)\n    - [Why YAML and not FOOML?](#why-yaml-and-not-fooml)\n    - [Is this production ready?](#is-this-production-ready)\n    - [What's with the name?](#whats-with-the-name)\n    - [Contributing](#contributing)\n- [Future development](#future-development)\n\n<!-- markdown-toc end -->\n\nPaque simplifies running simple workflows you want to run. It offers a few\nfeatures of `make`, but removing most of its power. It runs on a `paquefile` or\n`paquefile.yaml` (or just pass the name of the file). You can see a simple\n[example in the root folder](paquefile.yaml).\n\nIt supports Python 3.6.5+ (for no particular reason aside from being my default,\nit should work just fine on any relatively recent Python 3)\n\n## Installation\n\nIt should be enough to run\n\n```bash\npip install paque\n```\n\nand then \n\n```bash\npaque taskname  # If you have a paquefile or paquefile.yaml file\n```\n\n### Tab completion\n\nThis is a reminder to myself to implement tab completion (at lest for ZSH, since\nI have done that before)\n\n## Why?\n\nI had a series of `Dockerfile` I wanted to build sequentially, and run some\ncommands. It wasn't a right fit for docker-compose, so I wrote a makefile\n([here](https://github.com/rberenguel/spark_hadoop_kudu/blob/master/makefile)).\nThe result was excellent, BUT if you want to add logging, or any kind of\ninformation you need to start resorting to \"makefile hacks\" (like passing\nvariables down the dependency stack, or accessing subpaths of requirements...)\nthat didn't feel right.\n\nSo, I decided to write this.\n\n## What?\n\nYou define your tasks in a YAML file with specific syntax, of the form:\n\n```yaml\ntaskname:\n  - run: \"what it runs\"\n  - message: \"what it logs\"\n  - depends:\n      - task_it_depends_1\n      - task_it_depends_2\n  - sleep: integer\n\notherwise:\n  - run:\n      - \"You can run several commands\"\n      - \"Passing them as an array\"\n  - message:\n      - \"Likewise for logging\"\n      - \"Yes.\"\n```\n\nYou can also use arguments, multiple arguments, and conditions\n\n```yaml\ntaskname:\n  - run: \"{something} {folder}\"\n  - message: \"This does {something} on {folder}\"\n  - condition: \"do-if-bash-says-this-is-0\"\n\nmain:\n  - depends:\n      - taskname folder:/Users/foo/ something:rmdir\n```\n\nFor now you can't have spaces in arguments. Sorry. Also, there is no way at the\nmoment to pass arguments from the command line to tasks, this will be coming\nsoon.\n\nFor usage, you would just \n\n```bash\npaque taskname\n```\n\n## How?\n\nYAML (following the rules above) is converted into a dictionary of task names\nand [Tasks](paque/task.py) by a [Parser](paque/parser.py). Then a simple\ndepth-first-search [planner](paque/planner.py) finds an execution that satisfies\nall dependencies and transitive dependencies (with arguments) of `taskname`.\nFinally, the plan is passed to an [executor](paque/executor.py) that offloads it\nto the shell (or just logs it).\n\n## FAQ\n\n### Why YAML and not FOOML?\n\nI find YAML pretty readable and writable, as long as you restrict what you can\ndo. Since there is no nesting here, you can't shoot yourself in the foot with\nYAML. If you really can't stand YAML, you have two options\n\n- Use [dhall](https://github.com/dhall-lang/dhall-lang) and convert from dhall to YAML (_recommended_)\n- Write a [parser](paque/parser.py) for your favourite markup\n\n### Is this production ready?\n\nWell\u2026 `\u00af\\_(\u30c4)_/\u00af` I'm pretty sure there is an issue with argument replacement\nin a corner case, but I can't put my finger on which. For simple use cases, this\nshould be safe. Since there is no branching, there is not much that can go wrong\nthough.\n\n### What's with the name?\n\nFor one, it's `python+make=pake`, but it was taken (I should have checked\nbefore), so left it at `paque`. It's also a form of \"pa' qu\u00e9\", an Spanish slang\nfor \"para qu\u00e9\". I.e. _what for?_ `\u00af\\_(\u30c4)_/\u00af`\n\n### Contributing\n\nI'm happy to receive PRs, so don't be shy. Also let me know if you used it, that\ncould be fun. As you see from the root folder, you will need to use\n[poetry](https://github.com/python-poetry/poetry)\n\n## Future development\n\nI will keep using it, so any bugs I find will be fixed. Likewise, I will keep\nimproving it, although the current version is \"almost enough\". Currently on the\n\"roadmap\" I have:\n\n- Fix dry-run display of run when it is multiline\n- Generate a graphviz plot of the plan(s). This was one of the motivations to\n  write my own thingy, after all\n- Better tests: I wrote the ones I have with a combination of TDD and \"let's\n  test and print\". I want less tests of happy paths and more tests of corner\n  cases\n- Custom exceptions, right now it's just \"raise that\"\n- Automatically convert paquefile.dhall into a YAML paquefile (this was supposed\n  to be in this version but I got lazy)\n- ~Have a nicer CLI (probably using [cleo](https://github.com/sdispater/cleo))~\n  Moved to using [click](https://click.palletsprojects.com/en/7.x/), after the\n  great experience with [motllo](https://github.com/rberenguel/motllo)\n- Possibly, running tasks in parallel (this is a hard one given how the planner\n  works, so probably won't)\n- ~Conditionals?~ Available as optional tasks. The condition is _on what is\n  run_, assumes that the task _has run_ if condition is _false_. So, **a false\n  condition does not stop execution of the rest of the plan**\n- Fixing the bug that is likely there in argument substitution (_note_: I have\n  been using `paque` quite regularly in other projects and I have still not hit\n  it)\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/rberenguel/paque", "keywords": "", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "paque", "package_url": "https://pypi.org/project/paque/", "platform": "", "project_url": "https://pypi.org/project/paque/", "project_urls": {"Homepage": "https://github.com/rberenguel/paque", "Repository": "https://github.com/rberenguel/paque"}, "release_url": "https://pypi.org/project/paque/0.1.1/", "requires_dist": ["pyyaml (>=5.3,<6.0)", "cleo (>=0.8.0,<0.9.0)", "colorlog (>=4.1.0,<5.0.0)", "click (>=7.1.2,<8.0.0)"], "requires_python": ">=3.6,<4.0", "summary": "paque simplifies running simple workflows you want to run. It offers a few features of `make`, but removing most of its power", "version": "0.1.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Paque <code>\u00af\\_(\u30c4)_/\u00af</code></h1>\n<p><a href=\"https://badge.fury.io/py/paque\" rel=\"nofollow\"><img alt=\"PyPI version\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c95d8b2f9b1b063c8a164f01b5cc782708ba68b7/68747470733a2f2f62616467652e667572792e696f2f70792f70617175652e737667\"></a></p>\n\n<ul>\n<li><a href=\"#installation\" rel=\"nofollow\">Installation</a>\n<ul>\n<li><a href=\"#tab-completion\" rel=\"nofollow\">Tab completion</a></li>\n</ul>\n</li>\n<li><a href=\"#why\" rel=\"nofollow\">Why?</a></li>\n<li><a href=\"#what\" rel=\"nofollow\">What?</a></li>\n<li><a href=\"#how\" rel=\"nofollow\">How?</a></li>\n<li><a href=\"#faq\" rel=\"nofollow\">FAQ</a>\n<ul>\n<li><a href=\"#why-yaml-and-not-fooml\" rel=\"nofollow\">Why YAML and not FOOML?</a></li>\n<li><a href=\"#is-this-production-ready\" rel=\"nofollow\">Is this production ready?</a></li>\n<li><a href=\"#whats-with-the-name\" rel=\"nofollow\">What's with the name?</a></li>\n<li><a href=\"#contributing\" rel=\"nofollow\">Contributing</a></li>\n</ul>\n</li>\n<li><a href=\"#future-development\" rel=\"nofollow\">Future development</a></li>\n</ul>\n\n<p>Paque simplifies running simple workflows you want to run. It offers a few\nfeatures of <code>make</code>, but removing most of its power. It runs on a <code>paquefile</code> or\n<code>paquefile.yaml</code> (or just pass the name of the file). You can see a simple\n<a href=\"paquefile.yaml\" rel=\"nofollow\">example in the root folder</a>.</p>\n<p>It supports Python 3.6.5+ (for no particular reason aside from being my default,\nit should work just fine on any relatively recent Python 3)</p>\n<h2>Installation</h2>\n<p>It should be enough to run</p>\n<pre>pip install paque\n</pre>\n<p>and then</p>\n<pre>paque taskname  <span class=\"c1\"># If you have a paquefile or paquefile.yaml file</span>\n</pre>\n<h3>Tab completion</h3>\n<p>This is a reminder to myself to implement tab completion (at lest for ZSH, since\nI have done that before)</p>\n<h2>Why?</h2>\n<p>I had a series of <code>Dockerfile</code> I wanted to build sequentially, and run some\ncommands. It wasn't a right fit for docker-compose, so I wrote a makefile\n(<a href=\"https://github.com/rberenguel/spark_hadoop_kudu/blob/master/makefile\" rel=\"nofollow\">here</a>).\nThe result was excellent, BUT if you want to add logging, or any kind of\ninformation you need to start resorting to \"makefile hacks\" (like passing\nvariables down the dependency stack, or accessing subpaths of requirements...)\nthat didn't feel right.</p>\n<p>So, I decided to write this.</p>\n<h2>What?</h2>\n<p>You define your tasks in a YAML file with specific syntax, of the form:</p>\n<pre><span class=\"nt\">taskname</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">run</span><span class=\"p\">:</span> <span class=\"s\">\"what</span><span class=\"nv\"> </span><span class=\"s\">it</span><span class=\"nv\"> </span><span class=\"s\">runs\"</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">message</span><span class=\"p\">:</span> <span class=\"s\">\"what</span><span class=\"nv\"> </span><span class=\"s\">it</span><span class=\"nv\"> </span><span class=\"s\">logs\"</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">depends</span><span class=\"p\">:</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"l l-Scalar l-Scalar-Plain\">task_it_depends_1</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"l l-Scalar l-Scalar-Plain\">task_it_depends_2</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">sleep</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">integer</span>\n\n<span class=\"nt\">otherwise</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">run</span><span class=\"p\">:</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"s\">\"You</span><span class=\"nv\"> </span><span class=\"s\">can</span><span class=\"nv\"> </span><span class=\"s\">run</span><span class=\"nv\"> </span><span class=\"s\">several</span><span class=\"nv\"> </span><span class=\"s\">commands\"</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"s\">\"Passing</span><span class=\"nv\"> </span><span class=\"s\">them</span><span class=\"nv\"> </span><span class=\"s\">as</span><span class=\"nv\"> </span><span class=\"s\">an</span><span class=\"nv\"> </span><span class=\"s\">array\"</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">message</span><span class=\"p\">:</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"s\">\"Likewise</span><span class=\"nv\"> </span><span class=\"s\">for</span><span class=\"nv\"> </span><span class=\"s\">logging\"</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"s\">\"Yes.\"</span>\n</pre>\n<p>You can also use arguments, multiple arguments, and conditions</p>\n<pre><span class=\"nt\">taskname</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">run</span><span class=\"p\">:</span> <span class=\"s\">\"{something}</span><span class=\"nv\"> </span><span class=\"s\">{folder}\"</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">message</span><span class=\"p\">:</span> <span class=\"s\">\"This</span><span class=\"nv\"> </span><span class=\"s\">does</span><span class=\"nv\"> </span><span class=\"s\">{something}</span><span class=\"nv\"> </span><span class=\"s\">on</span><span class=\"nv\"> </span><span class=\"s\">{folder}\"</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">condition</span><span class=\"p\">:</span> <span class=\"s\">\"do-if-bash-says-this-is-0\"</span>\n\n<span class=\"nt\">main</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">depends</span><span class=\"p\">:</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"l l-Scalar l-Scalar-Plain\">taskname folder:/Users/foo/ something:rmdir</span>\n</pre>\n<p>For now you can't have spaces in arguments. Sorry. Also, there is no way at the\nmoment to pass arguments from the command line to tasks, this will be coming\nsoon.</p>\n<p>For usage, you would just</p>\n<pre>paque taskname\n</pre>\n<h2>How?</h2>\n<p>YAML (following the rules above) is converted into a dictionary of task names\nand <a href=\"paque/task.py\" rel=\"nofollow\">Tasks</a> by a <a href=\"paque/parser.py\" rel=\"nofollow\">Parser</a>. Then a simple\ndepth-first-search <a href=\"paque/planner.py\" rel=\"nofollow\">planner</a> finds an execution that satisfies\nall dependencies and transitive dependencies (with arguments) of <code>taskname</code>.\nFinally, the plan is passed to an <a href=\"paque/executor.py\" rel=\"nofollow\">executor</a> that offloads it\nto the shell (or just logs it).</p>\n<h2>FAQ</h2>\n<h3>Why YAML and not FOOML?</h3>\n<p>I find YAML pretty readable and writable, as long as you restrict what you can\ndo. Since there is no nesting here, you can't shoot yourself in the foot with\nYAML. If you really can't stand YAML, you have two options</p>\n<ul>\n<li>Use <a href=\"https://github.com/dhall-lang/dhall-lang\" rel=\"nofollow\">dhall</a> and convert from dhall to YAML (<em>recommended</em>)</li>\n<li>Write a <a href=\"paque/parser.py\" rel=\"nofollow\">parser</a> for your favourite markup</li>\n</ul>\n<h3>Is this production ready?</h3>\n<p>Well\u2026 <code>\u00af\\_(\u30c4)_/\u00af</code> I'm pretty sure there is an issue with argument replacement\nin a corner case, but I can't put my finger on which. For simple use cases, this\nshould be safe. Since there is no branching, there is not much that can go wrong\nthough.</p>\n<h3>What's with the name?</h3>\n<p>For one, it's <code>python+make=pake</code>, but it was taken (I should have checked\nbefore), so left it at <code>paque</code>. It's also a form of \"pa' qu\u00e9\", an Spanish slang\nfor \"para qu\u00e9\". I.e. <em>what for?</em> <code>\u00af\\_(\u30c4)_/\u00af</code></p>\n<h3>Contributing</h3>\n<p>I'm happy to receive PRs, so don't be shy. Also let me know if you used it, that\ncould be fun. As you see from the root folder, you will need to use\n<a href=\"https://github.com/python-poetry/poetry\" rel=\"nofollow\">poetry</a></p>\n<h2>Future development</h2>\n<p>I will keep using it, so any bugs I find will be fixed. Likewise, I will keep\nimproving it, although the current version is \"almost enough\". Currently on the\n\"roadmap\" I have:</p>\n<ul>\n<li>Fix dry-run display of run when it is multiline</li>\n<li>Generate a graphviz plot of the plan(s). This was one of the motivations to\nwrite my own thingy, after all</li>\n<li>Better tests: I wrote the ones I have with a combination of TDD and \"let's\ntest and print\". I want less tests of happy paths and more tests of corner\ncases</li>\n<li>Custom exceptions, right now it's just \"raise that\"</li>\n<li>Automatically convert paquefile.dhall into a YAML paquefile (this was supposed\nto be in this version but I got lazy)</li>\n<li><del>Have a nicer CLI (probably using <a href=\"https://github.com/sdispater/cleo\" rel=\"nofollow\">cleo</a>)</del>\nMoved to using <a href=\"https://click.palletsprojects.com/en/7.x/\" rel=\"nofollow\">click</a>, after the\ngreat experience with <a href=\"https://github.com/rberenguel/motllo\" rel=\"nofollow\">motllo</a></li>\n<li>Possibly, running tasks in parallel (this is a hard one given how the planner\nworks, so probably won't)</li>\n<li><del>Conditionals?</del> Available as optional tasks. The condition is <em>on what is\nrun</em>, assumes that the task <em>has run</em> if condition is <em>false</em>. So, <strong>a false\ncondition does not stop execution of the rest of the plan</strong></li>\n<li>Fixing the bug that is likely there in argument substitution (<em>note</em>: I have\nbeen using <code>paque</code> quite regularly in other projects and I have still not hit\nit)</li>\n</ul>\n\n          </div>"}, "last_serial": 7182791, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "8f451c605436fbc222ec4850e44e4858", "sha256": "0783b5f4e63c6e4704f296eb999b2b8d7ec3be4921dd5210667639889f9a1231"}, "downloads": -1, "filename": "paque-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "8f451c605436fbc222ec4850e44e4858", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 9732, "upload_time": "2020-04-12T15:21:58", "upload_time_iso_8601": "2020-04-12T15:21:58.492117Z", "url": "https://files.pythonhosted.org/packages/57/34/2988e1763ad77fa1b53c122dfac8910a66bba793b87c666c5f05e2c09b76/paque-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "2142b98a4bd1d15a1000c52853356903", "sha256": "d02983178a8ef48db12ecf26349a8838f708eabb1b59579ea6bdde68deb3d587"}, "downloads": -1, "filename": "paque-0.1.0.tar.gz", "has_sig": false, "md5_digest": "2142b98a4bd1d15a1000c52853356903", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 11160, "upload_time": "2020-04-12T15:22:00", "upload_time_iso_8601": "2020-04-12T15:22:00.886034Z", "url": "https://files.pythonhosted.org/packages/f6/68/68f797e263c4b42260e1bb00f6955c823a229adcb3122204213636953061/paque-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "f12a295d28c609aeff2a511a63d3c674", "sha256": "a63ed52b522663b2ce2ac48064af2036bed82d602ab901bb9a1b3fdb321310ce"}, "downloads": -1, "filename": "paque-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "f12a295d28c609aeff2a511a63d3c674", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 10437, "upload_time": "2020-05-06T20:03:05", "upload_time_iso_8601": "2020-05-06T20:03:05.184565Z", "url": "https://files.pythonhosted.org/packages/c4/f6/fee8d6e9028a10ff7e54154b8af01d47be25f1a6ece7532deee5a7feea63/paque-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "890512d1596cb71411e104292be980ca", "sha256": "9141e91f33217681099f0ab7e67c27f22a785ad191028cdeae220f82e96d91b8"}, "downloads": -1, "filename": "paque-0.1.1.tar.gz", "has_sig": false, "md5_digest": "890512d1596cb71411e104292be980ca", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 11990, "upload_time": "2020-05-06T20:03:06", "upload_time_iso_8601": "2020-05-06T20:03:06.669757Z", "url": "https://files.pythonhosted.org/packages/d4/76/6f32a2477950ef32bb8a0015dd63218122a6d7834c9c906e6ab3cf0e5067/paque-0.1.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "f12a295d28c609aeff2a511a63d3c674", "sha256": "a63ed52b522663b2ce2ac48064af2036bed82d602ab901bb9a1b3fdb321310ce"}, "downloads": -1, "filename": "paque-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "f12a295d28c609aeff2a511a63d3c674", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 10437, "upload_time": "2020-05-06T20:03:05", "upload_time_iso_8601": "2020-05-06T20:03:05.184565Z", "url": "https://files.pythonhosted.org/packages/c4/f6/fee8d6e9028a10ff7e54154b8af01d47be25f1a6ece7532deee5a7feea63/paque-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "890512d1596cb71411e104292be980ca", "sha256": "9141e91f33217681099f0ab7e67c27f22a785ad191028cdeae220f82e96d91b8"}, "downloads": -1, "filename": "paque-0.1.1.tar.gz", "has_sig": false, "md5_digest": "890512d1596cb71411e104292be980ca", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 11990, "upload_time": "2020-05-06T20:03:06", "upload_time_iso_8601": "2020-05-06T20:03:06.669757Z", "url": "https://files.pythonhosted.org/packages/d4/76/6f32a2477950ef32bb8a0015dd63218122a6d7834c9c906e6ab3cf0e5067/paque-0.1.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 02:58:42 2020"}