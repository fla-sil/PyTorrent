{"info": {"author": "HaiFeng", "author_email": "haifengat@vip.qq.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7"], "description": "# \u4f01\u4e1a\u5fae\u4fe1\u63a5\u53e3\n\n### \u9879\u76ee\u4ecb\u7ecd\n\u5c01\u88c5\u4f01\u4e1a\u5fae\u4fe1\u63a5\u53e3,\u53d1\u9001\u6d88\u606f.\n\n\n### \u5b89\u88c5\u6559\u7a0b\n\n` pip install work_weixin `\n\n### \u4f7f\u7528\u8bf4\u660e\n\n#### config.yml\n```yaml\n---\n# \u90e8\u95e8ID\nagentid: 10222222\n# \u94a5\u5319\nsecret: Zjxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n# \u4f01\u4e1aid\ncorpid: wxxxxxxxxxxxxxxxx\n```\n\n#### main.py\n\n```python\n\nfrom work_weixin import Client\nimport getpass\nimport yaml\nimport os\n\nif __name__ == '__main__':\n    cfg_yml = yaml.load(open('./config.yml', 'r', encoding='utf-8'))\n    if 'corpid' in cfg_yml:\n        corpid = cfg_yml['corpid']\n    else:\n        corpid = input('\u8bf7\u8f93\u5165\u4f01\u4e1aID: ')\n    if 'secret' in cfg_yml:\n        secret = cfg_yml['secret']\n    else:\n        secret = getpass.getpass('\u8bf7\u8f93\u5165\u5b89\u5168\u7801: ')\n    if 'agentid' in cfg_yml:\n        agentid = cfg_yml['agentid']\n    else:\n        agentid = input('\u8bf7\u8f93\u5165\u7ec4\u7ec7\u4ee3\u7801: ')\n    client = Client(corpid, secret, agentid)\n    print(client.access_token)\n    print(client.departments)\n    print(client.users)\n    partid = list(client.departments.keys())[0]\n    msg = f\"hello everyone in department of {client.departments[partid]['name']}\"\n    rtn = client.send_text_toparty(partid, msg)\n    print(rtn['errmsg'])\n\n    # rtn = client.upload_tmp(r'C:\\Users\\haifeng\\tmp.jpg')\n    # rtn = client.send_img(toparty=partid, media_id=rtn['media_id'])\n    print(print(rtn['errmsg']))\n\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/haifengat/work_weixin", "keywords": "", "license": "MIT License", "maintainer": "", "maintainer_email": "", "name": "work-weixin", "package_url": "https://pypi.org/project/work-weixin/", "platform": "any", "project_url": "https://pypi.org/project/work-weixin/", "project_urls": {"Homepage": "https://github.com/haifengat/work_weixin"}, "release_url": "https://pypi.org/project/work-weixin/0.0.2.2/", "requires_dist": null, "requires_python": ">=3.4.0", "summary": "\u4f01\u4e1a\u5fae\u4fe1\u5f00\u53d1\u63a5\u53e3", "version": "0.0.2.2", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>\u4f01\u4e1a\u5fae\u4fe1\u63a5\u53e3</h1>\n<h3>\u9879\u76ee\u4ecb\u7ecd</h3>\n<p>\u5c01\u88c5\u4f01\u4e1a\u5fae\u4fe1\u63a5\u53e3,\u53d1\u9001\u6d88\u606f.</p>\n<h3>\u5b89\u88c5\u6559\u7a0b</h3>\n<p><code>pip install work_weixin</code></p>\n<h3>\u4f7f\u7528\u8bf4\u660e</h3>\n<h4>config.yml</h4>\n<pre><span class=\"nn\">---</span>\n<span class=\"c1\"># \u90e8\u95e8ID</span>\n<span class=\"nt\">agentid</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">10222222</span>\n<span class=\"c1\"># \u94a5\u5319</span>\n<span class=\"nt\">secret</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Zjxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>\n<span class=\"c1\"># \u4f01\u4e1aid</span>\n<span class=\"nt\">corpid</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">wxxxxxxxxxxxxxxxx</span>\n</pre>\n<h4>main.py</h4>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">work_weixin</span> <span class=\"kn\">import</span> <span class=\"n\">Client</span>\n<span class=\"kn\">import</span> <span class=\"nn\">getpass</span>\n<span class=\"kn\">import</span> <span class=\"nn\">yaml</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"n\">cfg_yml</span> <span class=\"o\">=</span> <span class=\"n\">yaml</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">'./config.yml'</span><span class=\"p\">,</span> <span class=\"s1\">'r'</span><span class=\"p\">,</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s1\">'utf-8'</span><span class=\"p\">))</span>\n    <span class=\"k\">if</span> <span class=\"s1\">'corpid'</span> <span class=\"ow\">in</span> <span class=\"n\">cfg_yml</span><span class=\"p\">:</span>\n        <span class=\"n\">corpid</span> <span class=\"o\">=</span> <span class=\"n\">cfg_yml</span><span class=\"p\">[</span><span class=\"s1\">'corpid'</span><span class=\"p\">]</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">corpid</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'\u8bf7\u8f93\u5165\u4f01\u4e1aID: '</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"s1\">'secret'</span> <span class=\"ow\">in</span> <span class=\"n\">cfg_yml</span><span class=\"p\">:</span>\n        <span class=\"n\">secret</span> <span class=\"o\">=</span> <span class=\"n\">cfg_yml</span><span class=\"p\">[</span><span class=\"s1\">'secret'</span><span class=\"p\">]</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">secret</span> <span class=\"o\">=</span> <span class=\"n\">getpass</span><span class=\"o\">.</span><span class=\"n\">getpass</span><span class=\"p\">(</span><span class=\"s1\">'\u8bf7\u8f93\u5165\u5b89\u5168\u7801: '</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"s1\">'agentid'</span> <span class=\"ow\">in</span> <span class=\"n\">cfg_yml</span><span class=\"p\">:</span>\n        <span class=\"n\">agentid</span> <span class=\"o\">=</span> <span class=\"n\">cfg_yml</span><span class=\"p\">[</span><span class=\"s1\">'agentid'</span><span class=\"p\">]</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">agentid</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"s1\">'\u8bf7\u8f93\u5165\u7ec4\u7ec7\u4ee3\u7801: '</span><span class=\"p\">)</span>\n    <span class=\"n\">client</span> <span class=\"o\">=</span> <span class=\"n\">Client</span><span class=\"p\">(</span><span class=\"n\">corpid</span><span class=\"p\">,</span> <span class=\"n\">secret</span><span class=\"p\">,</span> <span class=\"n\">agentid</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">access_token</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">departments</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">users</span><span class=\"p\">)</span>\n    <span class=\"n\">partid</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">departments</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">())[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">\"hello everyone in department of </span><span class=\"si\">{</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">departments</span><span class=\"p\">[</span><span class=\"n\">partid</span><span class=\"p\">][</span><span class=\"s1\">'name'</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"s2\">\"</span>\n    <span class=\"n\">rtn</span> <span class=\"o\">=</span> <span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">send_text_toparty</span><span class=\"p\">(</span><span class=\"n\">partid</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">rtn</span><span class=\"p\">[</span><span class=\"s1\">'errmsg'</span><span class=\"p\">])</span>\n\n    <span class=\"c1\"># rtn = client.upload_tmp(r'C:\\Users\\haifeng\\tmp.jpg')</span>\n    <span class=\"c1\"># rtn = client.send_img(toparty=partid, media_id=rtn['media_id'])</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">rtn</span><span class=\"p\">[</span><span class=\"s1\">'errmsg'</span><span class=\"p\">]))</span>\n</pre>\n\n          </div>"}, "last_serial": 4693058, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "b38f5127cd08d5d7dc16f0f9f75159eb", "sha256": "dfc9c8abc37e6c096fdd841529695f5dc88c77b70d675f30d06eef4ae55bfc81"}, "downloads": -1, "filename": "work_weixin-0.0.1.tar.gz", "has_sig": false, "md5_digest": "b38f5127cd08d5d7dc16f0f9f75159eb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4.0", "size": 9933, "upload_time": "2018-11-28T07:16:05", "upload_time_iso_8601": "2018-11-28T07:16:05.877867Z", "url": "https://files.pythonhosted.org/packages/43/a4/1fd4c9fbe6ea984e725de5ce8a2803232a714261f343fd6428c3ce09ec4b/work_weixin-0.0.1.tar.gz", "yanked": false}], "0.0.2": [{"comment_text": "", "digests": {"md5": "c42ec8d90381ff26a1763bfabf36040c", "sha256": "d4dc878d13c3c6fb5097de0d18937b7017081d05f1315e49c6a75e2b3558b2ef"}, "downloads": -1, "filename": "work_weixin-0.0.2.tar.gz", "has_sig": false, "md5_digest": "c42ec8d90381ff26a1763bfabf36040c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4.0", "size": 9924, "upload_time": "2018-11-28T07:18:20", "upload_time_iso_8601": "2018-11-28T07:18:20.828557Z", "url": "https://files.pythonhosted.org/packages/eb/ee/5b551d6a8f190b4ad73e3638496269103d51842a1bd8c13b1d0c861bab81/work_weixin-0.0.2.tar.gz", "yanked": false}], "0.0.2.1": [{"comment_text": "", "digests": {"md5": "ac10bedde7d6fe93943dacf380cd0ef6", "sha256": "439c7720666ff7dd072ab0252d10850fa8749e6d91ff9cbf3bd722a9c46daa6e"}, "downloads": -1, "filename": "work_weixin-0.0.2.1.tar.gz", "has_sig": false, "md5_digest": "ac10bedde7d6fe93943dacf380cd0ef6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4.0", "size": 9937, "upload_time": "2018-11-30T00:38:37", "upload_time_iso_8601": "2018-11-30T00:38:37.420232Z", "url": "https://files.pythonhosted.org/packages/53/99/25e27d274c36198b6612274d49318105b50d85f6c972f2a26cde44e39f0a/work_weixin-0.0.2.1.tar.gz", "yanked": false}], "0.0.2.2": [{"comment_text": "", "digests": {"md5": "c327ee699e9ace38c93b6ba0849f6433", "sha256": "c72a856f3626187b3087a5ea4c45092b25665cb1c17d5cb15ef0d575fc5240e6"}, "downloads": -1, "filename": "work_weixin-0.0.2.2.tar.gz", "has_sig": false, "md5_digest": "c327ee699e9ace38c93b6ba0849f6433", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4.0", "size": 10173, "upload_time": "2019-01-14T07:42:50", "upload_time_iso_8601": "2019-01-14T07:42:50.934946Z", "url": "https://files.pythonhosted.org/packages/da/ca/c46780f8803ab8ac9f0264a6fb3be03981df91a79ee713c7178c4c2b7ec8/work_weixin-0.0.2.2.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "c327ee699e9ace38c93b6ba0849f6433", "sha256": "c72a856f3626187b3087a5ea4c45092b25665cb1c17d5cb15ef0d575fc5240e6"}, "downloads": -1, "filename": "work_weixin-0.0.2.2.tar.gz", "has_sig": false, "md5_digest": "c327ee699e9ace38c93b6ba0849f6433", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4.0", "size": 10173, "upload_time": "2019-01-14T07:42:50", "upload_time_iso_8601": "2019-01-14T07:42:50.934946Z", "url": "https://files.pythonhosted.org/packages/da/ca/c46780f8803ab8ac9f0264a6fb3be03981df91a79ee713c7178c4c2b7ec8/work_weixin-0.0.2.2.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:27:48 2020"}