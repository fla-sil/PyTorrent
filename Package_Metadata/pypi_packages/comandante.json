{"info": {"author": "Stepan Anokhin", "author_email": "stepan.anokhin@gmail.com", "bugtrack_url": null, "classifiers": ["Intended Audience :: Developers", "Intended Audience :: System Administrators", "License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Topic :: Software Development :: Libraries"], "description": "\n<p align=\"center\">\n    <img src=\"https://raw.githubusercontent.com/stepan-anokhin/comandante/master/logo.png\" width=\"500\" alt=\"Comandante Logo\">\n</p>\n\nComandante is a toolkit for building command-line interfaces in Python.\n\n[![Build Status](https://travis-ci.org/stepan-anokhin/comandante.svg?branch=master)](https://travis-ci.org/stepan-anokhin/comandante)\n[![Coverage Status](https://coveralls.io/repos/github/stepan-anokhin/comandante/badge.svg?branch=master)](https://coveralls.io/github/stepan-anokhin/comandante?branch=master)\n[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/stepan-anokhin/comandante/blob/master/LICENSE)\n\n## Table of Contents\n- [Installation](#installation)\n- [Getting Started](#getting-started)\n  - [Example](#Example)\n  - [Just a Normal Classes and Methods!](#just-a-normal-classes-and-methods)\n- [Options](#options)\n  - [Command Options](#command-options)\n  - [Class Options](#class-options)\n- [Subcommands](#subcommands)\n- [Arguments](#arguments)\n  - [Type Library](#type-library)\n  - [Python 2](#python-2)\n- [Printing Help](#printing-help)\n- [Error Handling](#error-handling)\n- [Testing Your CLI](#testing-your-cli)\n\n## Installation\n\nTo get the latest release simply install it with a `pip`:\n\n```shell\npip3 install --upgrade comandante\n```\n\n## Getting Started\n\nSome command-line interfaces (like `pip`, `git`, `go`, etc.) \nhave a rich hierarchy of subcommands. Each subcommand may have\nits own set of arguments and options. Consider for example \n`git commit`, `git remote add <repo>`, `git remote rename <old> <new>`\netc. *Comandante* is a Python library that makes building\nrich command-line interfaces (CLI) in Python extremely simple \nand straightforward. \n\n### Example\nHere is a simple example:\n```python\n#!/usr/bin/env python3\nimport sys, comandante as cli\n\n# Define a new CLI handler as a `cli.Handler` subclass\nclass CliTool(cli.Handler):\n\n    # define CLI commands as methods decorated with `@cli.command()` \n    @cli.command()\n    def repeat(self, message, times: int):\n        for i in range(times):\n            print(message)\n\n    @cli.command() \n    def sum(self, a: int, b: int):\n        result = a + b\n        print(result)\n        return result\n\n# Then simply pass command-line arguments to the CliTool#invoke\nCliTool().invoke(sys.argv[1:])\n```\n\nThat's it! \n\nTo execute `repeat` command simply run `./tool repeat` with its required arguments:\n```shell\n$ ./tool repeat \"Hello world\" 2\nHello world\nHello world\n```\n\nThe same goes for any defined command-methods: \n```shell\n$ ./tool sum 21 21\n42\n```\nSo in other words to create a command-line interface you simply:\n * define a normal Python class (inherited from the `comandante.Handler`)\n * equip your class methods with a minimal amount of metadata (via decorators)\n * call `invoke(sys.argv[1:])` method on your class instance\n * **comandante** will inspect metadata and decide how to parse \n command-line arguments and which method to call.  \n\n\n### Just a Normal Classes and Methods\nNo surprises! Handlers and commands are just a normal classes and methods.\n\n## Options\nCommand options are declared with `@comandante.option(...)` decorator. \n\nEach command-method receives options as `**kwargs` parameters (if present). \n\nEach command-method has a convenience method `Command#options(kwargs)` to \nmerge default values with specified command-line options.\n\n### Command Options\n\nExample below demonstrates how to define command option:\n\n```python\n#!/usr/bin/env python3\nimport sys, comandante as cli\n\n\nclass DatabaseCli(cli.Handler):\n\n    @cli.option(name='force', short='f', type=bool, default=False)\n    @cli.command()\n    def drop(self, database_name, **specified_options):\n        # merge specified options with default values\n        options = self.drop.options(specified_options)\n\n        # merged options provides attribute-like element access\n        if options.force or self.confirm():\n            print(\"Database '{name}' was deleted\".format(name=database_name))\n        else: \n            print(\"Aborted\")\n\n    @staticmethod        \n    def confirm():\n        question = 'Are you sure? [y/N]: '\n        value = input(question).lower()\n        while value not in ['', 'n', 'y']:\n            print(\"Please answer 'y' or 'n'\")\n            value = input(question)\n        return value == 'y'\n\n\ndatabase_cli = DatabaseCli()\ndatabase_cli.invoke(sys.argv[1:])\n```\nThen in shell:\n```shell\n$ ./database drop production\nAre you sure? [y/N]: y\nDatabase 'production' was deleted\n```\nThe following two examples are identical:\n```shell\n$ ./database drop -f production\nDatabase 'production' was deleted\n```\n```shell\n$ ./database drop --force production\nDatabase 'production' was deleted\n```\n\n### Class Options\n\nOptions could be declared on handler itself with `Handler#declare_option` method. \n\nOptions declared on handler will be declared on each of its command and subcommand recursively. \n```python\n#!/usr/bin/env python3\nimport sys, comandante as cli\n\nclass CliTool(cli.Handler):\n    def __init__(self):\n        super().__init__()\n\n        # define options\n        self.declare_option('verbose', 'v', bool, False)\n\n    @cli.command()\n    def first(self, **specified_options):\n        if 'verbose' in specified_options:\n            print(\"Hello from the first!\")\n\n    @cli.command()\n    def second(self, **specified_options):\n        if 'verbose' in specified_options:\n            print(\"Hello from the second!\")\n\n\ntool = CliTool()\ntool.invoke(sys.argv[1:])\n```\nThen in shell:\n```shell\n$ ./tool first --verbose\nHello from the first!\n```\n```shell\n$ ./tool second -v\nHello from the second!\n```\n\n## Subcommands\n\nAs your CLI becomes more complex and harder to maintain, you might want to \nhave commands that have its own set of commands handled by separate class. \nIn Comandante to compose handlers into hierarchy you may simply \nuse `Handler#declare_command` method. \n\nHere is a simple example:\n```python\n#!/usr/bin/env python3\n\nimport sys, comandante as cli\n\nclass Remote(cli.Handler):\n    @cli.command()\n    def add(self, name, uri):\n        print(\"Adding repository\", name, uri)\n\n    @cli.command()\n    def rename(self, old, new):\n        print(\"Renaming repository\", old, new) \n\nclass Git(cli.Handler):\n    def __init__(self):\n        super().__init__() \n\n        # define subcommands\n        self.declare_command(name='remote', handler=Remote())\n\n    @cli.option('message', 'm', str, '')\n    @cli.command()\n    def commit(self, **specified_options):\n        options = self.commit.options(specified_options)\n        print(\"Committing changes with message '{}'\".format(options.message))\n\ngit = Git()\ngit.invoke(sys.argv[1:])\n```\n\nThen in shell\n```shell\n$ ./git commit -m \"Initial commit\"\nCommitting changes with message 'Initial commit' \n```\n```shell\n$ ./git remote add origin git@github.com:stepan-anokhin/comandante.git\nAdding repository origin git@github.com:stepan-anokhin/comandante.git\n```\n```shell\n$ ./git remote rename origin destination\nRenaming repository origin destination\n```\n## Arguments\n\nIn python3 command argument types are declared using annotations:\n```python\nimport comandante as cli\n\nclass CliTool(cli.Handler):\n\n    @cli.command()\n    def do_something(self, a: int, b: float, c: str):\n        print(a + b, c)\n```\nType could be any callable. This callable will be simply called with \na command-line string as the only argument. A result will be passed\nto the *command-method* as argument. The same is true for option types. \n\nThe only exception is `bool` arguments and options. Bool option doesn't \nreceive any value, if specified it is considered to be `True` otherwise \ndefault value is used. \n\nIf no argument type is specified, then `str` is assumed by default. \nType's `__name__` attribute is used in automatic help output to \nrepresent argument/option type. \n\nComandante honors default argument values and varargs:\n```python\n#!/usr/bin/env python3\nimport sys, comandante as cli\n\nclass CliTool(cli.Handler):\n\n    @cli.command()\n    def sum(self, *values: int):\n        print(sum(values))\n\n    @cli.command()\n    def repeat(self, message, times: int = 2):\n        for i in range(times):\n            print(message)\n\nCliTool().invoke(sys.argv[1:])\n```\n```shell\n$ ./tool sum 1 2 3 4 5\n15\n```\n```shell\n$ ./tool repeat \"Hello world!\"\nHello world!\nHello world!\n```\n### Type Library\n\nComandante also provides several higher-order types:\n * `comandante.types.choice` - to make sure argument value is one of the specified options\n * `comandante.types.listof` - to parse comma-separated lists (e.g. `listof(int)` will parse `\"1,2,3,4\"` into `[1, 2, 3, 4]`)\n\nYou may take a look into the\n[comandante.types](https://github.com/stepan-anokhin/comandante/blob/master/comandante/types.py)\nto get some additional insights.  \n\n### Python 2\n\nPython 2 doesn't support parameter annotations. \nTo specify argument types use `@comandante.signature()`\n```python\nimport comandante as cli\n\nclass CliTool(cli.Handler):\n\n    @cli.signature(a=int, b=float)\n    @cli.command()\n    def do_something(self, a, b, c):\n        print(a + b, c)\n```\n\n## Printing Help\n\nComandante provides predefined `help` command for you which will print\nformatted help information to the stdout. Command and handler descriptions\nare taken from the corresponding docstrings. \n\nExample:\n```python\nimport sys\nimport comandante as cli\n\n\nclass Git(cli.Handler):\n    \"\"\"The stupid content tracker.\n\n    Git is a fast, scalable, distributed revision control system with\n    an unusually *rich command* set that provides both high-level operations\n    and full access to internals.\n\n    See *gittutorial*(7) to get started, then see *giteveryday*(7) for a useful\n    minimum set of commands. The *Git User\u2019s Manual*[1] has a more in-depth\n    introduction.\n    \"\"\"\n\n    @cli.option(name='message', short='m', type=str, default='', descr=\"\"\"\n    Use the given <msg> as the commit message. If multiple *-m* options are \n    given, their values are concatenated as separate paragraphs.\n    \"\"\")\n    @cli.command()\n    def commit(self):\n        \"\"\"Record changes to the repository\n\n        Create a new commit containing the current contents\n        of the index and the given log message describing\n        the changes. The new commit is a direct child of HEAD,\n        usually the tip of the current branch, and the branch\n        is updated to point to it (unless no branch is associated\n        with the working tree, in which case HEAD is \"detached\"\n        as described in *git-checkout*(1)).\n        \"\"\"\n        print(\"Committing...\")\n\n    @cli.command()\n    def clone(self, repository, directory=None):\n        \"\"\"Clone a repository into a new directory\n\n        Clones a repository into a newly created directory, creates\n        remote-tracking branches for each branch in the cloned\n        repository (visible using git branch *-r*), and creates and\n        checks out an initial branch that is forked from the cloned\n        repository\u2019s currently active branch.\n        \"\"\"\n        print(\"Cloning...\")\n\nGit().invoke(sys.argv[1:])\n``` \n`./git` output:\n<p align=\"left\">\n    <img src=\"https://raw.githubusercontent.com/stepan-anokhin/comandante/master/docs/images/help_git.png\" alt=\"git\">\n</p>\n\n`./git help clone` output:\n<p align=\"left\">\n    <img src=\"https://raw.githubusercontent.com/stepan-anokhin/comandante/master/docs/images/help_clone.png\" alt=\"git help clone\">\n</p>\n\n`./git help commit` output:\n<p align=\"left\">\n    <img src=\"https://raw.githubusercontent.com/stepan-anokhin/comandante/master/docs/images/help_commit.png\" alt=\"git help commit\">\n</p>\n\n\n## Error Handling\n\nSuccessful calls to `Handler#invoke` and `Command#invoke` methods return \nthe same value as the corresponding *command-method*. \n\nBy design Comandante doesn't hide any exceptions raised in the course of \n`invoke` call. The only special case is subclasses of \n`comandnate.errors.CliSyntaxException` which results in help printing \nbefore being re-raised.\n\nSo it is up to the caller to decide how to handle exceptions. \n\nA reasonable error handling may look like this:\n```python\nimport sys, logging, comandante as cli\n\n# ... initialize handler and logger ... \n\ntry: \n    handler.invoke(sys.argv[1:])\nexcept cli.errors.CliSyntaxException:\n    sys.exit(1)\nexcept:\n    logger.exception('Unexpected exception')\n    sys.exit(1)\n\n```  \n\n## Testing Your CLI\n\nHandlers and commands could be tested just like \n[any other](#just-a-normal-classes-and-methods) classes and methods. \n\nExample cli:\n```python\nimport comandante as cli\n\n\nclass DatabaseCli(cli.Handler):\n    def __init__(self, database):\n        super().__init__()\n        self._database = database\n\n    @cli.option('force', 'f', bool, False)\n    @cli.command()\n    def drop(self, database_name, **specified_options):\n        options = self.drop.options(specified_options)\n        if options.force or self.confirm():\n            self._database.drop(database_name)\n\n    def confirm(self):\n        question = 'Are you sure? [y/N]: '\n        value = input(question).lower()\n        while value not in ['', 'n', 'y']:\n            print(\"Please answer 'y' or 'n'\")\n            value = input(question)\n        return value == 'y'\n\n``` \nExample tests:\n```python\nfrom unittest import TestCase\nfrom unittest.mock import MagicMock as Mock\n\n\nclass DatabaseCliTests(TestCase):\n    def test_forced_database_drop(self):\n        fake_database = Mock()\n        database_cli = DatabaseCli(database=fake_database)\n\n        database_cli.drop('production', force=True)\n\n        fake_database.drop.assert_called_with('production')\n\n    def test_database_drop(self):\n        fake_database = Mock()\n        database_cli = DatabaseCli(database=fake_database)\n        database_cli.confirm = Mock(return_value=True)  # confirm\n\n        database_cli.drop('production')\n\n        fake_database.drop.assert_called_with('production')\n\n    def test_rejected_database_drop(self):\n        fake_database = Mock()\n        database_cli = DatabaseCli(database=fake_database)\n        database_cli.confirm = Mock(return_value=False)  # reject\n\n        database_cli.drop('production')\n\n        fake_database.drop.assert_not_called()\n```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/stepan-anokhin/comandante", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "comandante", "package_url": "https://pypi.org/project/comandante/", "platform": "", "project_url": "https://pypi.org/project/comandante/", "project_urls": {"Homepage": "https://github.com/stepan-anokhin/comandante"}, "release_url": "https://pypi.org/project/comandante/0.0.3/", "requires_dist": null, "requires_python": ">=2.7", "summary": "A toolkit for building command-line interfaces", "version": "0.0.3", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p align=\"center\">\n    <img alt=\"Comandante Logo\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/f207f68c0f6c94a7790775480f0f578e4b38c1cc/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652f6d61737465722f6c6f676f2e706e67\" width=\"500\">\n</p>\n<p>Comandante is a toolkit for building command-line interfaces in Python.</p>\n<p><a href=\"https://travis-ci.org/stepan-anokhin/comandante\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b4d57c7dcc3dc936af9664d4994de72b846ae70f/68747470733a2f2f7472617669732d63692e6f72672f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://coveralls.io/github/stepan-anokhin/comandante?branch=master\" rel=\"nofollow\"><img alt=\"Coverage Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/a5d58a2539e69d9c13d850b548d34fce8c06893f/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652f62616467652e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://github.com/stepan-anokhin/comandante/blob/master/LICENSE\" rel=\"nofollow\"><img alt=\"License: MIT\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/4150014b4dfdd7b565fa18de88e9bb1b8ccd7c08/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d626c75652e737667\"></a></p>\n<h2>Table of Contents</h2>\n<ul>\n<li><a href=\"#installation\" rel=\"nofollow\">Installation</a></li>\n<li><a href=\"#getting-started\" rel=\"nofollow\">Getting Started</a>\n<ul>\n<li><a href=\"#Example\" rel=\"nofollow\">Example</a></li>\n<li><a href=\"#just-a-normal-classes-and-methods\" rel=\"nofollow\">Just a Normal Classes and Methods!</a></li>\n</ul>\n</li>\n<li><a href=\"#options\" rel=\"nofollow\">Options</a>\n<ul>\n<li><a href=\"#command-options\" rel=\"nofollow\">Command Options</a></li>\n<li><a href=\"#class-options\" rel=\"nofollow\">Class Options</a></li>\n</ul>\n</li>\n<li><a href=\"#subcommands\" rel=\"nofollow\">Subcommands</a></li>\n<li><a href=\"#arguments\" rel=\"nofollow\">Arguments</a>\n<ul>\n<li><a href=\"#type-library\" rel=\"nofollow\">Type Library</a></li>\n<li><a href=\"#python-2\" rel=\"nofollow\">Python 2</a></li>\n</ul>\n</li>\n<li><a href=\"#printing-help\" rel=\"nofollow\">Printing Help</a></li>\n<li><a href=\"#error-handling\" rel=\"nofollow\">Error Handling</a></li>\n<li><a href=\"#testing-your-cli\" rel=\"nofollow\">Testing Your CLI</a></li>\n</ul>\n<h2>Installation</h2>\n<p>To get the latest release simply install it with a <code>pip</code>:</p>\n<pre>pip3 install --upgrade comandante\n</pre>\n<h2>Getting Started</h2>\n<p>Some command-line interfaces (like <code>pip</code>, <code>git</code>, <code>go</code>, etc.)\nhave a rich hierarchy of subcommands. Each subcommand may have\nits own set of arguments and options. Consider for example\n<code>git commit</code>, <code>git remote add &lt;repo&gt;</code>, <code>git remote rename &lt;old&gt; &lt;new&gt;</code>\netc. <em>Comandante</em> is a Python library that makes building\nrich command-line interfaces (CLI) in Python extremely simple\nand straightforward.</p>\n<h3>Example</h3>\n<p>Here is a simple example:</p>\n<pre><span class=\"ch\">#!/usr/bin/env python3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"c1\"># Define a new CLI handler as a `cli.Handler` subclass</span>\n<span class=\"k\">class</span> <span class=\"nc\">CliTool</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n\n    <span class=\"c1\"># define CLI commands as methods decorated with `@cli.command()` </span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">repeat</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">times</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">):</span>\n        <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">times</span><span class=\"p\">):</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span> \n    <span class=\"k\">def</span> <span class=\"nf\">sum</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">):</span>\n        <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">a</span> <span class=\"o\">+</span> <span class=\"n\">b</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">result</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">result</span>\n\n<span class=\"c1\"># Then simply pass command-line arguments to the CliTool#invoke</span>\n<span class=\"n\">CliTool</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<p>That's it!</p>\n<p>To execute <code>repeat</code> command simply run <code>./tool repeat</code> with its required arguments:</p>\n<pre>$ ./tool repeat <span class=\"s2\">\"Hello world\"</span> <span class=\"m\">2</span>\nHello world\nHello world\n</pre>\n<p>The same goes for any defined command-methods:</p>\n<pre>$ ./tool sum <span class=\"m\">21</span> <span class=\"m\">21</span>\n<span class=\"m\">42</span>\n</pre>\n<p>So in other words to create a command-line interface you simply:</p>\n<ul>\n<li>define a normal Python class (inherited from the <code>comandante.Handler</code>)</li>\n<li>equip your class methods with a minimal amount of metadata (via decorators)</li>\n<li>call <code>invoke(sys.argv[1:])</code> method on your class instance</li>\n<li><strong>comandante</strong> will inspect metadata and decide how to parse\ncommand-line arguments and which method to call.</li>\n</ul>\n<h3>Just a Normal Classes and Methods</h3>\n<p>No surprises! Handlers and commands are just a normal classes and methods.</p>\n<h2>Options</h2>\n<p>Command options are declared with <code>@comandante.option(...)</code> decorator.</p>\n<p>Each command-method receives options as <code>**kwargs</code> parameters (if present).</p>\n<p>Each command-method has a convenience method <code>Command#options(kwargs)</code> to\nmerge default values with specified command-line options.</p>\n<h3>Command Options</h3>\n<p>Example below demonstrates how to define command option:</p>\n<pre><span class=\"ch\">#!/usr/bin/env python3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DatabaseCli</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">option</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'force'</span><span class=\"p\">,</span> <span class=\"n\">short</span><span class=\"o\">=</span><span class=\"s1\">'f'</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">drop</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">database_name</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">specified_options</span><span class=\"p\">):</span>\n        <span class=\"c1\"># merge specified options with default values</span>\n        <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"o\">.</span><span class=\"n\">options</span><span class=\"p\">(</span><span class=\"n\">specified_options</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># merged options provides attribute-like element access</span>\n        <span class=\"k\">if</span> <span class=\"n\">options</span><span class=\"o\">.</span><span class=\"n\">force</span> <span class=\"ow\">or</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">confirm</span><span class=\"p\">():</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Database '</span><span class=\"si\">{name}</span><span class=\"s2\">' was deleted\"</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">database_name</span><span class=\"p\">))</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span> \n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Aborted\"</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>        \n    <span class=\"k\">def</span> <span class=\"nf\">confirm</span><span class=\"p\">():</span>\n        <span class=\"n\">question</span> <span class=\"o\">=</span> <span class=\"s1\">'Are you sure? [y/N]: '</span>\n        <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"n\">question</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span>\n        <span class=\"k\">while</span> <span class=\"n\">value</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"p\">[</span><span class=\"s1\">''</span><span class=\"p\">,</span> <span class=\"s1\">'n'</span><span class=\"p\">,</span> <span class=\"s1\">'y'</span><span class=\"p\">]:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Please answer 'y' or 'n'\"</span><span class=\"p\">)</span>\n            <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"n\">question</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">value</span> <span class=\"o\">==</span> <span class=\"s1\">'y'</span>\n\n\n<span class=\"n\">database_cli</span> <span class=\"o\">=</span> <span class=\"n\">DatabaseCli</span><span class=\"p\">()</span>\n<span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<p>Then in shell:</p>\n<pre>$ ./database drop production\nAre you sure? <span class=\"o\">[</span>y/N<span class=\"o\">]</span>: y\nDatabase <span class=\"s1\">'production'</span> was deleted\n</pre>\n<p>The following two examples are identical:</p>\n<pre>$ ./database drop -f production\nDatabase <span class=\"s1\">'production'</span> was deleted\n</pre>\n<pre>$ ./database drop --force production\nDatabase <span class=\"s1\">'production'</span> was deleted\n</pre>\n<h3>Class Options</h3>\n<p>Options could be declared on handler itself with <code>Handler#declare_option</code> method.</p>\n<p>Options declared on handler will be declared on each of its command and subcommand recursively.</p>\n<pre><span class=\"ch\">#!/usr/bin/env python3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">CliTool</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">()</span>\n\n        <span class=\"c1\"># define options</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">declare_option</span><span class=\"p\">(</span><span class=\"s1\">'verbose'</span><span class=\"p\">,</span> <span class=\"s1\">'v'</span><span class=\"p\">,</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">first</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">specified_options</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"s1\">'verbose'</span> <span class=\"ow\">in</span> <span class=\"n\">specified_options</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Hello from the first!\"</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">second</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">specified_options</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"s1\">'verbose'</span> <span class=\"ow\">in</span> <span class=\"n\">specified_options</span><span class=\"p\">:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Hello from the second!\"</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">tool</span> <span class=\"o\">=</span> <span class=\"n\">CliTool</span><span class=\"p\">()</span>\n<span class=\"n\">tool</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<p>Then in shell:</p>\n<pre>$ ./tool first --verbose\nHello from the first!\n</pre>\n<pre>$ ./tool second -v\nHello from the second!\n</pre>\n<h2>Subcommands</h2>\n<p>As your CLI becomes more complex and harder to maintain, you might want to\nhave commands that have its own set of commands handled by separate class.\nIn Comandante to compose handlers into hierarchy you may simply\nuse <code>Handler#declare_command</code> method.</p>\n<p>Here is a simple example:</p>\n<pre><span class=\"ch\">#!/usr/bin/env python3</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">Remote</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">add</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">uri</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Adding repository\"</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">uri</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">rename</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">old</span><span class=\"p\">,</span> <span class=\"n\">new</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Renaming repository\"</span><span class=\"p\">,</span> <span class=\"n\">old</span><span class=\"p\">,</span> <span class=\"n\">new</span><span class=\"p\">)</span> \n\n<span class=\"k\">class</span> <span class=\"nc\">Git</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">()</span> \n\n        <span class=\"c1\"># define subcommands</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">declare_command</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'remote'</span><span class=\"p\">,</span> <span class=\"n\">handler</span><span class=\"o\">=</span><span class=\"n\">Remote</span><span class=\"p\">())</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">option</span><span class=\"p\">(</span><span class=\"s1\">'message'</span><span class=\"p\">,</span> <span class=\"s1\">'m'</span><span class=\"p\">,</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"s1\">''</span><span class=\"p\">)</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">commit</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">specified_options</span><span class=\"p\">):</span>\n        <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">commit</span><span class=\"o\">.</span><span class=\"n\">options</span><span class=\"p\">(</span><span class=\"n\">specified_options</span><span class=\"p\">)</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Committing changes with message '</span><span class=\"si\">{}</span><span class=\"s2\">'\"</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">options</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"p\">))</span>\n\n<span class=\"n\">git</span> <span class=\"o\">=</span> <span class=\"n\">Git</span><span class=\"p\">()</span>\n<span class=\"n\">git</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<p>Then in shell</p>\n<pre>$ ./git commit -m <span class=\"s2\">\"Initial commit\"</span>\nCommitting changes with message <span class=\"s1\">'Initial commit'</span> \n</pre>\n<pre>$ ./git remote add origin git@github.com:stepan-anokhin/comandante.git\nAdding repository origin git@github.com:stepan-anokhin/comandante.git\n</pre>\n<pre>$ ./git remote rename origin destination\nRenaming repository origin destination\n</pre>\n<h2>Arguments</h2>\n<p>In python3 command argument types are declared using annotations:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">CliTool</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">do_something</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">:</span> <span class=\"nb\">float</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"o\">+</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n</pre>\n<p>Type could be any callable. This callable will be simply called with\na command-line string as the only argument. A result will be passed\nto the <em>command-method</em> as argument. The same is true for option types.</p>\n<p>The only exception is <code>bool</code> arguments and options. Bool option doesn't\nreceive any value, if specified it is considered to be <code>True</code> otherwise\ndefault value is used.</p>\n<p>If no argument type is specified, then <code>str</code> is assumed by default.\nType's <code>__name__</code> attribute is used in automatic help output to\nrepresent argument/option type.</p>\n<p>Comandante honors default argument values and varargs:</p>\n<pre><span class=\"ch\">#!/usr/bin/env python3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">CliTool</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">sum</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">values</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">values</span><span class=\"p\">))</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">repeat</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">times</span><span class=\"p\">:</span> <span class=\"nb\">int</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">):</span>\n        <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">times</span><span class=\"p\">):</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n\n<span class=\"n\">CliTool</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<pre>$ ./tool sum <span class=\"m\">1</span> <span class=\"m\">2</span> <span class=\"m\">3</span> <span class=\"m\">4</span> <span class=\"m\">5</span>\n<span class=\"m\">15</span>\n</pre>\n<pre>$ ./tool repeat <span class=\"s2\">\"Hello world!\"</span>\nHello world!\nHello world!\n</pre>\n<h3>Type Library</h3>\n<p>Comandante also provides several higher-order types:</p>\n<ul>\n<li><code>comandante.types.choice</code> - to make sure argument value is one of the specified options</li>\n<li><code>comandante.types.listof</code> - to parse comma-separated lists (e.g. <code>listof(int)</code> will parse <code>\"1,2,3,4\"</code> into <code>[1, 2, 3, 4]</code>)</li>\n</ul>\n<p>You may take a look into the\n<a href=\"https://github.com/stepan-anokhin/comandante/blob/master/comandante/types.py\" rel=\"nofollow\">comandante.types</a>\nto get some additional insights.</p>\n<h3>Python 2</h3>\n<p>Python 2 doesn't support parameter annotations.\nTo specify argument types use <code>@comandante.signature()</code></p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">CliTool</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">signature</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"o\">=</span><span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"o\">=</span><span class=\"nb\">float</span><span class=\"p\">)</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">do_something</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"p\">):</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"o\">+</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n</pre>\n<h2>Printing Help</h2>\n<p>Comandante provides predefined <code>help</code> command for you which will print\nformatted help information to the stdout. Command and handler descriptions\nare taken from the corresponding docstrings.</p>\n<p>Example:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n<span class=\"kn\">import</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Git</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"The stupid content tracker.</span>\n\n<span class=\"sd\">    Git is a fast, scalable, distributed revision control system with</span>\n<span class=\"sd\">    an unusually *rich command* set that provides both high-level operations</span>\n<span class=\"sd\">    and full access to internals.</span>\n\n<span class=\"sd\">    See *gittutorial*(7) to get started, then see *giteveryday*(7) for a useful</span>\n<span class=\"sd\">    minimum set of commands. The *Git User\u2019s Manual*[1] has a more in-depth</span>\n<span class=\"sd\">    introduction.</span>\n<span class=\"sd\">    \"\"\"</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">option</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'message'</span><span class=\"p\">,</span> <span class=\"n\">short</span><span class=\"o\">=</span><span class=\"s1\">'m'</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">''</span><span class=\"p\">,</span> <span class=\"n\">descr</span><span class=\"o\">=</span><span class=\"s2\">\"\"\"</span>\n<span class=\"s2\">    Use the given &lt;msg&gt; as the commit message. If multiple *-m* options are </span>\n<span class=\"s2\">    given, their values are concatenated as separate paragraphs.</span>\n<span class=\"s2\">    \"\"\"</span><span class=\"p\">)</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">commit</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Record changes to the repository</span>\n\n<span class=\"sd\">        Create a new commit containing the current contents</span>\n<span class=\"sd\">        of the index and the given log message describing</span>\n<span class=\"sd\">        the changes. The new commit is a direct child of HEAD,</span>\n<span class=\"sd\">        usually the tip of the current branch, and the branch</span>\n<span class=\"sd\">        is updated to point to it (unless no branch is associated</span>\n<span class=\"sd\">        with the working tree, in which case HEAD is \"detached\"</span>\n<span class=\"sd\">        as described in *git-checkout*(1)).</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Committing...\"</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">clone</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">repository</span><span class=\"p\">,</span> <span class=\"n\">directory</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Clone a repository into a new directory</span>\n\n<span class=\"sd\">        Clones a repository into a newly created directory, creates</span>\n<span class=\"sd\">        remote-tracking branches for each branch in the cloned</span>\n<span class=\"sd\">        repository (visible using git branch *-r*), and creates and</span>\n<span class=\"sd\">        checks out an initial branch that is forked from the cloned</span>\n<span class=\"sd\">        repository\u2019s currently active branch.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Cloning...\"</span><span class=\"p\">)</span>\n\n<span class=\"n\">Git</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n</pre>\n<p><code>./git</code> output:</p>\n<p align=\"left\">\n    <img alt=\"git\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/33314787493437a4caa5405dcd74a048e5ad2cdc/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652f6d61737465722f646f63732f696d616765732f68656c705f6769742e706e67\">\n</p>\n<p><code>./git help clone</code> output:</p>\n<p align=\"left\">\n    <img alt=\"git help clone\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b88e2b4437ce3b5172f48cc200b13ea2730865fa/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652f6d61737465722f646f63732f696d616765732f68656c705f636c6f6e652e706e67\">\n</p>\n<p><code>./git help commit</code> output:</p>\n<p align=\"left\">\n    <img alt=\"git help commit\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/3624446626c0c4691c9db3ba9b4f1823996be044/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f73746570616e2d616e6f6b68696e2f636f6d616e64616e74652f6d61737465722f646f63732f696d616765732f68656c705f636f6d6d69742e706e67\">\n</p>\n<h2>Error Handling</h2>\n<p>Successful calls to <code>Handler#invoke</code> and <code>Command#invoke</code> methods return\nthe same value as the corresponding <em>command-method</em>.</p>\n<p>By design Comandante doesn't hide any exceptions raised in the course of\n<code>invoke</code> call. The only special case is subclasses of\n<code>comandnate.errors.CliSyntaxException</code> which results in help printing\nbefore being re-raised.</p>\n<p>So it is up to the caller to decide how to handle exceptions.</p>\n<p>A reasonable error handling may look like this:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">sys</span><span class=\"o\">,</span> <span class=\"nn\">logging</span><span class=\"o\">,</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n<span class=\"c1\"># ... initialize handler and logger ... </span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span> \n    <span class=\"n\">handler</span><span class=\"o\">.</span><span class=\"n\">invoke</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n<span class=\"k\">except</span> <span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"o\">.</span><span class=\"n\">CliSyntaxException</span><span class=\"p\">:</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"k\">except</span><span class=\"p\">:</span>\n    <span class=\"n\">logger</span><span class=\"o\">.</span><span class=\"n\">exception</span><span class=\"p\">(</span><span class=\"s1\">'Unexpected exception'</span><span class=\"p\">)</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre>\n<h2>Testing Your CLI</h2>\n<p>Handlers and commands could be tested just like\n<a href=\"#just-a-normal-classes-and-methods\" rel=\"nofollow\">any other</a> classes and methods.</p>\n<p>Example cli:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">comandante</span> <span class=\"k\">as</span> <span class=\"nn\">cli</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DatabaseCli</span><span class=\"p\">(</span><span class=\"n\">cli</span><span class=\"o\">.</span><span class=\"n\">Handler</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">database</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_database</span> <span class=\"o\">=</span> <span class=\"n\">database</span>\n\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">option</span><span class=\"p\">(</span><span class=\"s1\">'force'</span><span class=\"p\">,</span> <span class=\"s1\">'f'</span><span class=\"p\">,</span> <span class=\"nb\">bool</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">)</span>\n    <span class=\"nd\">@cli</span><span class=\"o\">.</span><span class=\"n\">command</span><span class=\"p\">()</span>\n    <span class=\"k\">def</span> <span class=\"nf\">drop</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">database_name</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">specified_options</span><span class=\"p\">):</span>\n        <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"o\">.</span><span class=\"n\">options</span><span class=\"p\">(</span><span class=\"n\">specified_options</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">options</span><span class=\"o\">.</span><span class=\"n\">force</span> <span class=\"ow\">or</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">confirm</span><span class=\"p\">():</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_database</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"p\">(</span><span class=\"n\">database_name</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">confirm</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">question</span> <span class=\"o\">=</span> <span class=\"s1\">'Are you sure? [y/N]: '</span>\n        <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"n\">question</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span>\n        <span class=\"k\">while</span> <span class=\"n\">value</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"p\">[</span><span class=\"s1\">''</span><span class=\"p\">,</span> <span class=\"s1\">'n'</span><span class=\"p\">,</span> <span class=\"s1\">'y'</span><span class=\"p\">]:</span>\n            <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Please answer 'y' or 'n'\"</span><span class=\"p\">)</span>\n            <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"nb\">input</span><span class=\"p\">(</span><span class=\"n\">question</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">value</span> <span class=\"o\">==</span> <span class=\"s1\">'y'</span>\n</pre>\n<p>Example tests:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">unittest</span> <span class=\"kn\">import</span> <span class=\"n\">TestCase</span>\n<span class=\"kn\">from</span> <span class=\"nn\">unittest.mock</span> <span class=\"kn\">import</span> <span class=\"n\">MagicMock</span> <span class=\"k\">as</span> <span class=\"n\">Mock</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DatabaseCliTests</span><span class=\"p\">(</span><span class=\"n\">TestCase</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">test_forced_database_drop</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">fake_database</span> <span class=\"o\">=</span> <span class=\"n\">Mock</span><span class=\"p\">()</span>\n        <span class=\"n\">database_cli</span> <span class=\"o\">=</span> <span class=\"n\">DatabaseCli</span><span class=\"p\">(</span><span class=\"n\">database</span><span class=\"o\">=</span><span class=\"n\">fake_database</span><span class=\"p\">)</span>\n\n        <span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"p\">(</span><span class=\"s1\">'production'</span><span class=\"p\">,</span> <span class=\"n\">force</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n        <span class=\"n\">fake_database</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"o\">.</span><span class=\"n\">assert_called_with</span><span class=\"p\">(</span><span class=\"s1\">'production'</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">test_database_drop</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">fake_database</span> <span class=\"o\">=</span> <span class=\"n\">Mock</span><span class=\"p\">()</span>\n        <span class=\"n\">database_cli</span> <span class=\"o\">=</span> <span class=\"n\">DatabaseCli</span><span class=\"p\">(</span><span class=\"n\">database</span><span class=\"o\">=</span><span class=\"n\">fake_database</span><span class=\"p\">)</span>\n        <span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">confirm</span> <span class=\"o\">=</span> <span class=\"n\">Mock</span><span class=\"p\">(</span><span class=\"n\">return_value</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>  <span class=\"c1\"># confirm</span>\n\n        <span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"p\">(</span><span class=\"s1\">'production'</span><span class=\"p\">)</span>\n\n        <span class=\"n\">fake_database</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"o\">.</span><span class=\"n\">assert_called_with</span><span class=\"p\">(</span><span class=\"s1\">'production'</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">test_rejected_database_drop</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">fake_database</span> <span class=\"o\">=</span> <span class=\"n\">Mock</span><span class=\"p\">()</span>\n        <span class=\"n\">database_cli</span> <span class=\"o\">=</span> <span class=\"n\">DatabaseCli</span><span class=\"p\">(</span><span class=\"n\">database</span><span class=\"o\">=</span><span class=\"n\">fake_database</span><span class=\"p\">)</span>\n        <span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">confirm</span> <span class=\"o\">=</span> <span class=\"n\">Mock</span><span class=\"p\">(</span><span class=\"n\">return_value</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>  <span class=\"c1\"># reject</span>\n\n        <span class=\"n\">database_cli</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"p\">(</span><span class=\"s1\">'production'</span><span class=\"p\">)</span>\n\n        <span class=\"n\">fake_database</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"o\">.</span><span class=\"n\">assert_not_called</span><span class=\"p\">()</span>\n</pre>\n\n          </div>"}, "last_serial": 5963892, "releases": {"0.0.3": [{"comment_text": "", "digests": {"md5": "3442ab62adc3765faa004e6cf57bc04d", "sha256": "662392fa2a872e8f72831a41e9600d738d0ed49475e509578a07489999b683a5"}, "downloads": -1, "filename": "comandante-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "3442ab62adc3765faa004e6cf57bc04d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=2.7", "size": 25330, "upload_time": "2019-10-12T10:51:24", "upload_time_iso_8601": "2019-10-12T10:51:24.878787Z", "url": "https://files.pythonhosted.org/packages/da/ad/1b93710a37204e9e7ee52292477d04c17fa7d9b795a5c6b02243bf47c70d/comandante-0.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "cbdfe366c28393ca746596e42baad075", "sha256": "cf279c36c70053360acc6b12cfec5b18d03beb6c1fb7f6ab219f037103495298"}, "downloads": -1, "filename": "comandante-0.0.3.tar.gz", "has_sig": false, "md5_digest": "cbdfe366c28393ca746596e42baad075", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7", "size": 19348, "upload_time": "2019-10-12T10:51:26", "upload_time_iso_8601": "2019-10-12T10:51:26.793961Z", "url": "https://files.pythonhosted.org/packages/27/0f/3dd4a6968af46413dfb2b044d55fa7b20ce89ec1b4d3f790ab9eeee517b8/comandante-0.0.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "3442ab62adc3765faa004e6cf57bc04d", "sha256": "662392fa2a872e8f72831a41e9600d738d0ed49475e509578a07489999b683a5"}, "downloads": -1, "filename": "comandante-0.0.3-py3-none-any.whl", "has_sig": false, "md5_digest": "3442ab62adc3765faa004e6cf57bc04d", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=2.7", "size": 25330, "upload_time": "2019-10-12T10:51:24", "upload_time_iso_8601": "2019-10-12T10:51:24.878787Z", "url": "https://files.pythonhosted.org/packages/da/ad/1b93710a37204e9e7ee52292477d04c17fa7d9b795a5c6b02243bf47c70d/comandante-0.0.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "cbdfe366c28393ca746596e42baad075", "sha256": "cf279c36c70053360acc6b12cfec5b18d03beb6c1fb7f6ab219f037103495298"}, "downloads": -1, "filename": "comandante-0.0.3.tar.gz", "has_sig": false, "md5_digest": "cbdfe366c28393ca746596e42baad075", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7", "size": 19348, "upload_time": "2019-10-12T10:51:26", "upload_time_iso_8601": "2019-10-12T10:51:26.793961Z", "url": "https://files.pythonhosted.org/packages/27/0f/3dd4a6968af46413dfb2b044d55fa7b20ce89ec1b4d3f790ab9eeee517b8/comandante-0.0.3.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:44:30 2020"}