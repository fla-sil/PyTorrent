{"info": {"author": "", "author_email": "", "bugtrack_url": null, "classifiers": [], "description": "[![License](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/joshloyal/dynetlsm/blob/master/LICENSE)\n[![Travis](https://travis-ci.com/joshloyal/dynetlsm.svg?token=gTKqq3zSsip89mhYVQPZ&branch=master)](https://travis-ci.com/joshloyal/dynetlsm)\n[![AppVeyor](https://ci.appveyor.com/api/projects/status/github/joshloyal/dynetlsm)](https://ci.appveyor.com/project/joshloyal/dynetlsm/history)\n\n# DynetLSM: latent space models for dynamic networks\n\n*Author: [Joshua D. Loyal](https://joshloyal.github.io/)*\n\nThis package provides an interface for learning and inference in latent\nspace models for dynamic networks. Inference is performed using\nblocked Metropolis-Hastings within Gibbs sampling.\n\nThe primary method implemented in this package is the hierarchical Dirichlet\nprocess latent postilion clustering model (HDP-LPCM) described in\n\"A Bayesian nonparametric latent space approach to modeling evolving communities in\ndynamic networks\" (Link: [arXiv:2003.07404](https://arxiv.org/abs/2003.07404)).\n\nBibTeX reference to cite, if you use this package:\n```bibtex\n@article{loyal2020hdplpcm,\n    title = {A Bayesian nonparametric latent space approach to modeling evolving communities in dynamic networks},\n    author = {Loyal, Joshua Daniel and Chen, Yuguo},\n    journal = {arXiv preprint arXiv:2003.07404},\n    year = {2020},\n}\n```\n\nDependencies\n------------\nDynetLSM requires:\n\n- Python (>= 3.7)\n\nand the requirements highlighted in [requirements.txt](requirements.txt).\n\nInstallation\n------------\nYou need a working installation of numpy and scipy to install DynetLSM. If you have a working installation of numpy and scipy, the easiest way to install dynetlsm is using ``pip``:\n\n```\npip install -U dynetlsm\n```\n\nIf you prefer, you can clone the repository and run the setup.py file. Use the following commands to get the copy from GitHub and install all the dependencies:\n\n```\ngit clone https://github.com/joshloyal/dynetlsm.git\ncd dynetlsm\npip install .\n```\n\nOr install using pip and GitHub:\n\n```\npip install -U git+https://github.com/joshloyal/dynetlsm.git\n```\n\nBackground\n----------\n\n### Latent Space Models\n\n#### Static Networks\nLatent space models (LSMs) are a powerful approach to modeling network data. One is often interested in inferring properties of nodes in a network based on their connectivity patterns. Originally proposed by Hoff et al. (2002)<sup>[[1]](#References)</sup>, LSMs learn a latent embedding for each node that captures the similarity between them. This package focuses on embeddings within a Euclidean space so that the log-odds of forming an edge between two nodes is inversely proportional to the distance between their latent positions. In other words, nodes that are close together in the latent space are more likely to form a connection in the observed network. The generative model is as follows:\n\n1. For each node, sample a node's latent position from a Gaussian distribution:\n\n<p align=\"center\">\n<img src=\"/images/static_lsm_prior.png\" alt=\"latent positions prior\" width=\"200\">\n</p>\n\n2. For each edge, sample a connection from a Bernoulli distribution:\n\n<p align=\"center\">\n<img src=\"/images/static_lsm.png\" alt=\"static lsm\" width=\"400\">\n</p>\n\n#### Dynamic Networks\nFor dynamic (time-varying) networks, one is also interested in determining how properties of the nodes change over time. LSMs can also accomplish this task. Sarkar and Moore (2005)<sup>[[2]](#References)</sup> and Sewell and Chen (2015)<sup>[[3]](#References)</sup> proposed propagating the latent positions through time with a Gaussian random-walk Markovian process. Based on these latent positions, the edges in the network form in the same way as the static case. The generative process is as follows:\n\n1. For `t = 1`, sample a node's initial latent position from a Gaussian distribution:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_lsm_initial.png\" alt=\"lsm initial position prior\" width=\"200\">\n</p>\n\n2. For `t = 2, ..., T`, a node's latent position follows a Gaussian random walk:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_lsm_rw.png\" alt=\"lsm dynamic random walk\" width=\"200\">\n\n\n3. For each edge, sample a connection from a Bernoulli distribution:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_lsm.png\" alt=\"dynamic lsm\" width=\"400\">\n</p>\n\n\n### Latent Position Clustering Models\n\n\n#### Static Networks\nDetermining the high-level community structure of a network is another important task in network analysis. Community structure was incorporated into LSMs by Handcock et al. (2007)<sup>[[4]](#References)</sup> with their latent position clustering model (LPCM). Intuitively, the LPCM posits that communities are the result of clustering within the latent space. This clustering is incorporated in the LSM framework by assuming the latent positions are drawn from a Gaussian mixture model, i.e,\n\n<p align=\"center\">\n<img src=\"/images/lpcm.png\" alt=\"latent position clustering model\" width=\"225\">\n</p>\n\nThe LPCM relates the latent positions to the probability of forming an edge in the same way as the original LSM. In practice, one interprets nodes that share the same mixture component as belonging to the same community.\n\n#### Dynamic Networks\nInferring a network's community structure is especially difficult for dynamic networks because the number of communities may change over time. If one assumes that the number of communities is fixed, then the model of Sewell and Chen (2017)<sup>[[5]](#References)</sup> is able to infer a dynamic network's community structure by propagating each node's mixture assignment through time with a autoregressive hidden Markov model (AR-HMM). However, the assumption of a static number of communities is at odds with many real-world dynamic networks. It is often the case that the number of communities evolves over time.\n\nTo solve the problem of inferring evolving community structures in dynamic networks, Loyal and Chen (2020)<sup>[[6]](#References)</sup> proposed using a sticky hierarchical Dirichlet process hidden Markov model (HDP-HMM) with time-inhomogeneous transition probabilities in conjunction with the LPCM . For this reason, the model is called the hierarchical Dirichlet process latent position clustering model (HDP-LPCM). Under the HDP-LPCM, a node's latent community label propagate through time according to iid HDP-HMMs. Unlike previous models, this allows the HDP-LPCM to create and delete communities over-time as well as infer the number of the communities from the data. The generative model is as follows:\n\n1. Draw the time-varying transition probabilities from a sticky-HDP:\n\n<p align=\"center\">\n<img src=\"/images/hdp.png\" alt=\"sticky-hdp prior\" width=\"500\">\n</p>\n\n2. For `t = 1, ..., T`, propagate a node's latent community label through time according to an HMM:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_label.png\" alt=\"latent label hmm\" width=\"150\">\n</p>\n\n3. For `t = 1`, sample a node's initial latent position from its assigned Gaussian mixture component:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_lpcm_initial.png\" alt=\"hdp-lpcm initial positions\" width=\"225\">\n</p>\n\n4. For `t = 2, ..., T`, sample a node's latent position as a mixture between its previous position and its assigned Gaussian mixture component:\n\n<p align=\"center\">\n<img src=\"/images/dynamic_lpcm_rw.png\" alt=\"hdp-lpcm mixture random walk\" width=\"400\">\n</p>\n\n5. For each edge, sample a connection from a Bernoulli distribution\n:\n<p align=\"center\">\n<img src=\"/images/dynamic_lsm.png\" alt=\"hdp-lpcm\" width=\"400\">\n</p>\n\n\nExample\n-------\nDynetLSM exposes two classes for working with latent space models for dynamic networks:\n\n* `DynamicNetworkLSM`:  Interface for learning the LSM in Sewell and Chen (2015)<sup>[[3]](#References)</sup>,\n* `DynamicNetworkHDPLPCM`: Interface for learning the HDP-LPCM in Loyal and Chen (2020)<sup>[[6]](#References)</sup>.\n\nTo understand the merits of both approaches, we provide an example using a synthetic dynamic network which contains two communities at `t = 1` and four communities at `t = 2`. We can generate the data as follows:\n```python\nfrom dynetlsm.datasets import simple_splitting_dynamic_network\n\n# Y : ndarray, shape (2, 50, 50)\n#   The adjacency matrices at each time point\n# labels : ndarray, shape  (2, 50)\n#   The true community labels of the nodes at each time point.\nY, labels = simple_splitting_dynamic_network(n_nodes=50, n_time_steps=2)\n```\n\nTo fit a dynamic LSM with a 2-dimensional latent space, we initialize the sampler and call `fit`:\n```python\nfrom dynetlsm import DynamicNetworkLSM\n\nlsm = DynamicNetworkLSM(n_iter=5000, burn=2500, tune=2500,\n                        n_features=2, random_state=42)\nlsm.fit(Y)\n```\n\nTo assess the convergence of the algorithm, we visualize the traces:\n```python\nfrom dynetlsm.plots import plot_traces\n\nplot_traces(lsm)\n```\n\n<p align=\"center\">\n<img src=\"/images/lsm_traces.png\" alt=\"Traces of the LSM model\" width=\"400\">\n</p>\n\nWe can then visualize the latent space embeddings:\n```python\nimport matplotlib.pyplot as plt\n\nfrom dynetlsm.plots import plot_latent_space\n\n\naxes = plt.subplots(ncols=2, nrows=1, figsize=(10, 6))\nfor t, ax in enumerate(axes.flat):\n    plot_latent_space(lsm, t=t, connectionstyle=None, number_nodes=False,\n                      linewidth=0.1, node_size=200, border=0.2, ax=ax)\n```\n\n<p align=\"center\">\n<img src=\"/images/lsm_latent_space.png\" alt=\"Latent Space of the LSM model\" width=\"400\">\n</p>\n\nAlthough the LSM's embedding places nodes that share many connections close together, the true community structure of the network is not apparent. This is easily remedied by applying the HDP-LPCM. As before, we initialize the model and call `fit`:\n```python\n\nfrom dynetlsm import DynamicNetworkHDPLPCM\n\nlpcm = DynamicNetworkHDPLPCM(n_iter=5000, burn=2500, tune=2500,\n                             n_features=2, n_components=10, random_state=42)\nlpcm.fit(Y)\n```\n\nOnce again, we assess the convergence of the algorithm by visualizing the traces:\n```python\nfrom dynetlsm.plots import plot_traces\n\nplot_traces(lpcm)\n```\n\n<p align=\"center\">\n<img src=\"/images/hdp_lpcm_traces.png\" alt=\"Traces of the HDP-LPCM\" width=\"400\">\n</p>\n\nWe can then visualize the latent space embeddings as well as the components of the inferred Gaussian mixture:\n```python\nimport matplotlib.pyplot as plt\n\nfrom dynetlsm.plots import plot_latent_space\n\n\nfig, axes = plt.subplots(ncols=2, nrows=1, figsize=(10, 6))\nfor t, ax in enumerate(axes.flat):\n    plot_latent_space(lpcm, t=t, connectionstyle=None,\n                      number_nodes=False, border=1.2, linewidth=0.2,\n                      center_size=100, node_size=100, ax=ax)\n```\n\n<p align=\"center\">\n<img src=\"/images/hdp_lpcm_latent_space.png\" alt=\"Latent Space of the HDP-LPCM\" width=\"500\">\n</p>\nThe HDP-LPCM infers an embedding that makes the community structure of the network apparent. Furthermore, the HDP-LPCM correctly infers that the two communities split off into four communities at the second time point. To better visualize this behavior, one can display an alluvial diagram of the label assignments over time:\n\n```python\nfrom dynetlsm.plots import alluvial_plot\n\nalluvial_plot(lpcm.z_)\n```\n\n<p align=\"center\">\n<img src=\"/images/alluvial_diagram.png\" alt=\"Alluvial Diagram of the HDP-LPCM\" width=\"300\">\n</p>\n\nFrom this diagram, one can see that group 1 primarily splits off into group 3, while group 2 primarily splits off into group 4.\n\nSimulation Studies and Real-Data Applications\n---------------------------------------------\nThis package includes the simulation studies and real-data applications found in Loyal and Chen (2020)<sup>[[6]](#References)</sup>:\n\n* A synthetic dynamic network with a time-homogeneous community structure: ([here](/examples/homogeneous_simulation.py)).\n* A synthetic dynamic network with a time-inhomogeneous community structure: ([here](/examples/inhomogeneous_simulation.py)).\n* Sampson's monastery network: ([here](/examples/sampson_monks.py)).\n* A dynamic network constructed from international military alliances during the first three decades of the Cold War (1950 - 1979): ([here](/examples/military_alliances.py)).\n* A dynamic network constructed from character interactions in the first four seasons of the Game of Thrones television series: ([here](/examples/GoT.py)).\n\nWe also provide a few [jupyter notebooks](/notebooks) that demonstrate the use of this package.\n\nReferences\n----------\n\n[1]: Hoff, P. D., Raftery, A. E., and Handcock, M. S. (2002). Latent space approaches to social network analysis. *Journal of the American Statistical Association*, 97(460):1090-1098.\n\n[2]: Sarkar, P. and Moore, A. W. (2006). Dynamic social network analysis using latent space models. pages 1145-1152.\n\n[3]: Sewell, D. K. and Chen, Y. (2015). Latent space models for dynamic networks. *Journal of the American Statistical Association*, 110(512):1646-1657.\n\n[4]: Handcock, M. S., Raftery, A. E., and Tantrum, J. M. (2007). Model-based clustering of social networks. *Journal of the Royal Statistical Society A*, 170(2):301-354.\n\n[5]: Sewell, D. K. and Chen, Y. (2017). Latent space approaches to community detection in dynamic networks. *Bayesian Analysis*, 12(2):351-377.\n\n[6]: Loyal, J. D. and Chen, Y. (2020). A Bayesian nonparametric latent space approach to modeling evolving communities in dynamic networks. arXiv preprint arXiv:2003.07404.\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "https://pypi.org/project/dynetlsm/#files", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://joshloyal.github.io/dynetlsm", "keywords": "", "license": "MIT", "maintainer": "Joshua D. Loyal", "maintainer_email": "jloyal25@gmail.com", "name": "dynetlsm", "package_url": "https://pypi.org/project/dynetlsm/", "platform": "", "project_url": "https://pypi.org/project/dynetlsm/", "project_urls": {"Download": "https://pypi.org/project/dynetlsm/#files", "Homepage": "https://joshloyal.github.io/dynetlsm"}, "release_url": "https://pypi.org/project/dynetlsm/0.1.0/", "requires_dist": ["cython", "scipy", "numpy", "scikit-learn", "tqdm", "networkx", "pandas", "plac", "joblib", "matplotlib", "seaborn", "arviz", "pyvis", "statsmodels", "pytest ; extra == 'test'", "pytest-pep8 ; extra == 'test'", "pytest-cov ; extra == 'test'"], "requires_python": "", "summary": "dynetlsm", "version": "0.1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <p><a href=\"https://github.com/joshloyal/dynetlsm/blob/master/LICENSE\" rel=\"nofollow\"><img alt=\"License\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/4150014b4dfdd7b565fa18de88e9bb1b8ccd7c08/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d626c75652e737667\"></a>\n<a href=\"https://travis-ci.com/joshloyal/dynetlsm\" rel=\"nofollow\"><img alt=\"Travis\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/de21dbd87a2528af6bb91a15dd93a61ea3e7ede6/68747470733a2f2f7472617669732d63692e636f6d2f6a6f73686c6f79616c2f64796e65746c736d2e7376673f746f6b656e3d67544b7171337a5373697038396d68595651505a266272616e63683d6d6173746572\"></a>\n<a href=\"https://ci.appveyor.com/project/joshloyal/dynetlsm/history\" rel=\"nofollow\"><img alt=\"AppVeyor\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/d608dd007b011d70dd7c33b288deb6a1d32a7ab5/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f6a6f73686c6f79616c2f64796e65746c736d\"></a></p>\n<h1>DynetLSM: latent space models for dynamic networks</h1>\n<p><em>Author: <a href=\"https://joshloyal.github.io/\" rel=\"nofollow\">Joshua D. Loyal</a></em></p>\n<p>This package provides an interface for learning and inference in latent\nspace models for dynamic networks. Inference is performed using\nblocked Metropolis-Hastings within Gibbs sampling.</p>\n<p>The primary method implemented in this package is the hierarchical Dirichlet\nprocess latent postilion clustering model (HDP-LPCM) described in\n\"A Bayesian nonparametric latent space approach to modeling evolving communities in\ndynamic networks\" (Link: <a href=\"https://arxiv.org/abs/2003.07404\" rel=\"nofollow\">arXiv:2003.07404</a>).</p>\n<p>BibTeX reference to cite, if you use this package:</p>\n<pre><span class=\"nc\">@article</span><span class=\"p\">{</span><span class=\"nl\">loyal2020hdplpcm</span><span class=\"p\">,</span>\n    <span class=\"na\">title</span> <span class=\"p\">=</span> <span class=\"s\">{A Bayesian nonparametric latent space approach to modeling evolving communities in dynamic networks}</span><span class=\"p\">,</span>\n    <span class=\"na\">author</span> <span class=\"p\">=</span> <span class=\"s\">{Loyal, Joshua Daniel and Chen, Yuguo}</span><span class=\"p\">,</span>\n    <span class=\"na\">journal</span> <span class=\"p\">=</span> <span class=\"s\">{arXiv preprint arXiv:2003.07404}</span><span class=\"p\">,</span>\n    <span class=\"na\">year</span> <span class=\"p\">=</span> <span class=\"s\">{2020}</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n</pre>\n<h2>Dependencies</h2>\n<p>DynetLSM requires:</p>\n<ul>\n<li>Python (&gt;= 3.7)</li>\n</ul>\n<p>and the requirements highlighted in <a href=\"requirements.txt\" rel=\"nofollow\">requirements.txt</a>.</p>\n<h2>Installation</h2>\n<p>You need a working installation of numpy and scipy to install DynetLSM. If you have a working installation of numpy and scipy, the easiest way to install dynetlsm is using <code>pip</code>:</p>\n<pre><code>pip install -U dynetlsm\n</code></pre>\n<p>If you prefer, you can clone the repository and run the setup.py file. Use the following commands to get the copy from GitHub and install all the dependencies:</p>\n<pre><code>git clone https://github.com/joshloyal/dynetlsm.git\ncd dynetlsm\npip install .\n</code></pre>\n<p>Or install using pip and GitHub:</p>\n<pre><code>pip install -U git+https://github.com/joshloyal/dynetlsm.git\n</code></pre>\n<h2>Background</h2>\n<h3>Latent Space Models</h3>\n<h4>Static Networks</h4>\n<p>Latent space models (LSMs) are a powerful approach to modeling network data. One is often interested in inferring properties of nodes in a network based on their connectivity patterns. Originally proposed by Hoff et al. (2002)<sup><a href=\"#References\" rel=\"nofollow\">[1]</a></sup>, LSMs learn a latent embedding for each node that captures the similarity between them. This package focuses on embeddings within a Euclidean space so that the log-odds of forming an edge between two nodes is inversely proportional to the distance between their latent positions. In other words, nodes that are close together in the latent space are more likely to form a connection in the observed network. The generative model is as follows:</p>\n<ol>\n<li>For each node, sample a node's latent position from a Gaussian distribution:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"latent positions prior\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/0b1d0deafdfa83ac6c31ec50b9c157d1dff881eb/2f696d616765732f7374617469635f6c736d5f7072696f722e706e67\" width=\"200\">\n</p>\n<ol>\n<li>For each edge, sample a connection from a Bernoulli distribution:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"static lsm\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c1636cc56e516f426adcdb110ccd636ea1ec0b3c/2f696d616765732f7374617469635f6c736d2e706e67\" width=\"400\">\n</p>\n<h4>Dynamic Networks</h4>\n<p>For dynamic (time-varying) networks, one is also interested in determining how properties of the nodes change over time. LSMs can also accomplish this task. Sarkar and Moore (2005)<sup><a href=\"#References\" rel=\"nofollow\">[2]</a></sup> and Sewell and Chen (2015)<sup><a href=\"#References\" rel=\"nofollow\">[3]</a></sup> proposed propagating the latent positions through time with a Gaussian random-walk Markovian process. Based on these latent positions, the edges in the network form in the same way as the static case. The generative process is as follows:</p>\n<ol>\n<li>For <code>t = 1</code>, sample a node's initial latent position from a Gaussian distribution:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"lsm initial position prior\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c9e4f07af3774a01aff55d477b4ee0657105727d/2f696d616765732f64796e616d69635f6c736d5f696e697469616c2e706e67\" width=\"200\">\n</p>\n<ol>\n<li>For <code>t = 2, ..., T</code>, a node's latent position follows a Gaussian random walk:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"lsm dynamic random walk\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/465912896ae75107323499eb2e4bfe0493e20c0e/2f696d616765732f64796e616d69635f6c736d5f72772e706e67\" width=\"200\">\n</p><ol>\n<li>For each edge, sample a connection from a Bernoulli distribution:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"dynamic lsm\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/5f52ca9ac7a0f07018b0cdb0d61b06628e32ea54/2f696d616765732f64796e616d69635f6c736d2e706e67\" width=\"400\">\n</p>\n<h3>Latent Position Clustering Models</h3>\n<h4>Static Networks</h4>\n<p>Determining the high-level community structure of a network is another important task in network analysis. Community structure was incorporated into LSMs by Handcock et al. (2007)<sup><a href=\"#References\" rel=\"nofollow\">[4]</a></sup> with their latent position clustering model (LPCM). Intuitively, the LPCM posits that communities are the result of clustering within the latent space. This clustering is incorporated in the LSM framework by assuming the latent positions are drawn from a Gaussian mixture model, i.e,</p>\n<p align=\"center\">\n<img alt=\"latent position clustering model\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/39384052f40a8cc7b438b81946f88d21f674ee57/2f696d616765732f6c70636d2e706e67\" width=\"225\">\n</p>\n<p>The LPCM relates the latent positions to the probability of forming an edge in the same way as the original LSM. In practice, one interprets nodes that share the same mixture component as belonging to the same community.</p>\n<h4>Dynamic Networks</h4>\n<p>Inferring a network's community structure is especially difficult for dynamic networks because the number of communities may change over time. If one assumes that the number of communities is fixed, then the model of Sewell and Chen (2017)<sup><a href=\"#References\" rel=\"nofollow\">[5]</a></sup> is able to infer a dynamic network's community structure by propagating each node's mixture assignment through time with a autoregressive hidden Markov model (AR-HMM). However, the assumption of a static number of communities is at odds with many real-world dynamic networks. It is often the case that the number of communities evolves over time.</p>\n<p>To solve the problem of inferring evolving community structures in dynamic networks, Loyal and Chen (2020)<sup><a href=\"#References\" rel=\"nofollow\">[6]</a></sup> proposed using a sticky hierarchical Dirichlet process hidden Markov model (HDP-HMM) with time-inhomogeneous transition probabilities in conjunction with the LPCM . For this reason, the model is called the hierarchical Dirichlet process latent position clustering model (HDP-LPCM). Under the HDP-LPCM, a node's latent community label propagate through time according to iid HDP-HMMs. Unlike previous models, this allows the HDP-LPCM to create and delete communities over-time as well as infer the number of the communities from the data. The generative model is as follows:</p>\n<ol>\n<li>Draw the time-varying transition probabilities from a sticky-HDP:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"sticky-hdp prior\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/b32969a84bede29b85b75081e8febc50eb0e9d69/2f696d616765732f6864702e706e67\" width=\"500\">\n</p>\n<ol>\n<li>For <code>t = 1, ..., T</code>, propagate a node's latent community label through time according to an HMM:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"latent label hmm\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/67d4ed6804c8e100b098aa9b40cf0d7a8f12e8f4/2f696d616765732f64796e616d69635f6c6162656c2e706e67\" width=\"150\">\n</p>\n<ol>\n<li>For <code>t = 1</code>, sample a node's initial latent position from its assigned Gaussian mixture component:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"hdp-lpcm initial positions\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/93a33deff4c60d92c541c25ba513600363f0e7e4/2f696d616765732f64796e616d69635f6c70636d5f696e697469616c2e706e67\" width=\"225\">\n</p>\n<ol>\n<li>For <code>t = 2, ..., T</code>, sample a node's latent position as a mixture between its previous position and its assigned Gaussian mixture component:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"hdp-lpcm mixture random walk\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/ae460cfcf5a5e492aec7be8b13298ec51671f914/2f696d616765732f64796e616d69635f6c70636d5f72772e706e67\" width=\"400\">\n</p>\n<ol>\n<li>For each edge, sample a connection from a Bernoulli distribution\n:</li>\n</ol>\n<p align=\"center\">\n<img alt=\"hdp-lpcm\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/5f52ca9ac7a0f07018b0cdb0d61b06628e32ea54/2f696d616765732f64796e616d69635f6c736d2e706e67\" width=\"400\">\n</p>\n<h2>Example</h2>\n<p>DynetLSM exposes two classes for working with latent space models for dynamic networks:</p>\n<ul>\n<li><code>DynamicNetworkLSM</code>:  Interface for learning the LSM in Sewell and Chen (2015)<sup><a href=\"#References\" rel=\"nofollow\">[3]</a></sup>,</li>\n<li><code>DynamicNetworkHDPLPCM</code>: Interface for learning the HDP-LPCM in Loyal and Chen (2020)<sup><a href=\"#References\" rel=\"nofollow\">[6]</a></sup>.</li>\n</ul>\n<p>To understand the merits of both approaches, we provide an example using a synthetic dynamic network which contains two communities at <code>t = 1</code> and four communities at <code>t = 2</code>. We can generate the data as follows:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.datasets</span> <span class=\"kn\">import</span> <span class=\"n\">simple_splitting_dynamic_network</span>\n\n<span class=\"c1\"># Y : ndarray, shape (2, 50, 50)</span>\n<span class=\"c1\">#   The adjacency matrices at each time point</span>\n<span class=\"c1\"># labels : ndarray, shape  (2, 50)</span>\n<span class=\"c1\">#   The true community labels of the nodes at each time point.</span>\n<span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"n\">simple_splitting_dynamic_network</span><span class=\"p\">(</span><span class=\"n\">n_nodes</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"n\">n_time_steps</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n</pre>\n<p>To fit a dynamic LSM with a 2-dimensional latent space, we initialize the sampler and call <code>fit</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm</span> <span class=\"kn\">import</span> <span class=\"n\">DynamicNetworkLSM</span>\n\n<span class=\"n\">lsm</span> <span class=\"o\">=</span> <span class=\"n\">DynamicNetworkLSM</span><span class=\"p\">(</span><span class=\"n\">n_iter</span><span class=\"o\">=</span><span class=\"mi\">5000</span><span class=\"p\">,</span> <span class=\"n\">burn</span><span class=\"o\">=</span><span class=\"mi\">2500</span><span class=\"p\">,</span> <span class=\"n\">tune</span><span class=\"o\">=</span><span class=\"mi\">2500</span><span class=\"p\">,</span>\n                        <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">lsm</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">)</span>\n</pre>\n<p>To assess the convergence of the algorithm, we visualize the traces:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.plots</span> <span class=\"kn\">import</span> <span class=\"n\">plot_traces</span>\n\n<span class=\"n\">plot_traces</span><span class=\"p\">(</span><span class=\"n\">lsm</span><span class=\"p\">)</span>\n</pre>\n<p align=\"center\">\n<img alt=\"Traces of the LSM model\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/7dd4c341628e364911e1f6d3c74f2b44691fc99c/2f696d616765732f6c736d5f7472616365732e706e67\" width=\"400\">\n</p>\n<p>We can then visualize the latent space embeddings:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.plots</span> <span class=\"kn\">import</span> <span class=\"n\">plot_latent_space</span>\n\n\n<span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">ncols</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">nrows</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"k\">for</span> <span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">axes</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">):</span>\n    <span class=\"n\">plot_latent_space</span><span class=\"p\">(</span><span class=\"n\">lsm</span><span class=\"p\">,</span> <span class=\"n\">t</span><span class=\"o\">=</span><span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">connectionstyle</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">number_nodes</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                      <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"n\">node_size</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"n\">border</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n</pre>\n<p align=\"center\">\n<img alt=\"Latent Space of the LSM model\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/9427b7cde90d6d52ade1b0911da504a3c3bd5f48/2f696d616765732f6c736d5f6c6174656e745f73706163652e706e67\" width=\"400\">\n</p>\n<p>Although the LSM's embedding places nodes that share many connections close together, the true community structure of the network is not apparent. This is easily remedied by applying the HDP-LPCM. As before, we initialize the model and call <code>fit</code>:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm</span> <span class=\"kn\">import</span> <span class=\"n\">DynamicNetworkHDPLPCM</span>\n\n<span class=\"n\">lpcm</span> <span class=\"o\">=</span> <span class=\"n\">DynamicNetworkHDPLPCM</span><span class=\"p\">(</span><span class=\"n\">n_iter</span><span class=\"o\">=</span><span class=\"mi\">5000</span><span class=\"p\">,</span> <span class=\"n\">burn</span><span class=\"o\">=</span><span class=\"mi\">2500</span><span class=\"p\">,</span> <span class=\"n\">tune</span><span class=\"o\">=</span><span class=\"mi\">2500</span><span class=\"p\">,</span>\n                             <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">n_components</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">lpcm</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">)</span>\n</pre>\n<p>Once again, we assess the convergence of the algorithm by visualizing the traces:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.plots</span> <span class=\"kn\">import</span> <span class=\"n\">plot_traces</span>\n\n<span class=\"n\">plot_traces</span><span class=\"p\">(</span><span class=\"n\">lpcm</span><span class=\"p\">)</span>\n</pre>\n<p align=\"center\">\n<img alt=\"Traces of the HDP-LPCM\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/86f33b46ee57c79f12bbe0ef7fd99d136fa6299f/2f696d616765732f6864705f6c70636d5f7472616365732e706e67\" width=\"400\">\n</p>\n<p>We can then visualize the latent space embeddings as well as the components of the inferred Gaussian mixture:</p>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.plots</span> <span class=\"kn\">import</span> <span class=\"n\">plot_latent_space</span>\n\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">ncols</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">nrows</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"k\">for</span> <span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">axes</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">):</span>\n    <span class=\"n\">plot_latent_space</span><span class=\"p\">(</span><span class=\"n\">lpcm</span><span class=\"p\">,</span> <span class=\"n\">t</span><span class=\"o\">=</span><span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">connectionstyle</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n                      <span class=\"n\">number_nodes</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">border</span><span class=\"o\">=</span><span class=\"mf\">1.2</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">,</span>\n                      <span class=\"n\">center_size</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">node_size</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">ax</span><span class=\"p\">)</span>\n</pre>\n<p align=\"center\">\n<img alt=\"Latent Space of the HDP-LPCM\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/a3b9ce56c9fb3327ef415f4ad79a990a2daf2936/2f696d616765732f6864705f6c70636d5f6c6174656e745f73706163652e706e67\" width=\"500\">\n</p>\nThe HDP-LPCM infers an embedding that makes the community structure of the network apparent. Furthermore, the HDP-LPCM correctly infers that the two communities split off into four communities at the second time point. To better visualize this behavior, one can display an alluvial diagram of the label assignments over time:\n<pre><span class=\"kn\">from</span> <span class=\"nn\">dynetlsm.plots</span> <span class=\"kn\">import</span> <span class=\"n\">alluvial_plot</span>\n\n<span class=\"n\">alluvial_plot</span><span class=\"p\">(</span><span class=\"n\">lpcm</span><span class=\"o\">.</span><span class=\"n\">z_</span><span class=\"p\">)</span>\n</pre>\n<p align=\"center\">\n<img alt=\"Alluvial Diagram of the HDP-LPCM\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/03603db53ef691da834f28641d7d77fa36ed5e68/2f696d616765732f616c6c757669616c5f6469616772616d2e706e67\" width=\"300\">\n</p>\n<p>From this diagram, one can see that group 1 primarily splits off into group 3, while group 2 primarily splits off into group 4.</p>\n<h2>Simulation Studies and Real-Data Applications</h2>\n<p>This package includes the simulation studies and real-data applications found in Loyal and Chen (2020)<sup><a href=\"#References\" rel=\"nofollow\">[6]</a></sup>:</p>\n<ul>\n<li>A synthetic dynamic network with a time-homogeneous community structure: (<a href=\"/examples/homogeneous_simulation.py\" rel=\"nofollow\">here</a>).</li>\n<li>A synthetic dynamic network with a time-inhomogeneous community structure: (<a href=\"/examples/inhomogeneous_simulation.py\" rel=\"nofollow\">here</a>).</li>\n<li>Sampson's monastery network: (<a href=\"/examples/sampson_monks.py\" rel=\"nofollow\">here</a>).</li>\n<li>A dynamic network constructed from international military alliances during the first three decades of the Cold War (1950 - 1979): (<a href=\"/examples/military_alliances.py\" rel=\"nofollow\">here</a>).</li>\n<li>A dynamic network constructed from character interactions in the first four seasons of the Game of Thrones television series: (<a href=\"/examples/GoT.py\" rel=\"nofollow\">here</a>).</li>\n</ul>\n<p>We also provide a few <a href=\"/notebooks\" rel=\"nofollow\">jupyter notebooks</a> that demonstrate the use of this package.</p>\n<h2>References</h2>\n<p>[1]: Hoff, P. D., Raftery, A. E., and Handcock, M. S. (2002). Latent space approaches to social network analysis. <em>Journal of the American Statistical Association</em>, 97(460):1090-1098.</p>\n<p>[2]: Sarkar, P. and Moore, A. W. (2006). Dynamic social network analysis using latent space models. pages 1145-1152.</p>\n<p>[3]: Sewell, D. K. and Chen, Y. (2015). Latent space models for dynamic networks. <em>Journal of the American Statistical Association</em>, 110(512):1646-1657.</p>\n<p>[4]: Handcock, M. S., Raftery, A. E., and Tantrum, J. M. (2007). Model-based clustering of social networks. <em>Journal of the Royal Statistical Society A</em>, 170(2):301-354.</p>\n<p>[5]: Sewell, D. K. and Chen, Y. (2017). Latent space approaches to community detection in dynamic networks. <em>Bayesian Analysis</em>, 12(2):351-377.</p>\n<p>[6]: Loyal, J. D. and Chen, Y. (2020). A Bayesian nonparametric latent space approach to modeling evolving communities in dynamic networks. arXiv preprint arXiv:2003.07404.</p>\n\n          </div>"}, "last_serial": 6996139, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "b7229cb5e0a0ec90846e28123958b8c2", "sha256": "6cc3765da368bff85a7f96b384477c6bb8ce91deeac3f387112964b5466fa446"}, "downloads": -1, "filename": "dynetlsm-0.1.0-cp37-cp37m-macosx_10_12_x86_64.whl", "has_sig": false, "md5_digest": "b7229cb5e0a0ec90846e28123958b8c2", "packagetype": "bdist_wheel", "python_version": "cp37", "requires_python": null, "size": 969416, "upload_time": "2020-04-10T20:04:07", "upload_time_iso_8601": "2020-04-10T20:04:07.424115Z", "url": "https://files.pythonhosted.org/packages/a4/80/cac57e4ebaa732eba16543c0221837c8fab8f658a44838c2d312e6d02bd6/dynetlsm-0.1.0-cp37-cp37m-macosx_10_12_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "71a8b1344846601972ea2718ff2617ab", "sha256": "c8ea182e794774f6f1e922e4b1b3906f9817c2c73c47e0ae11460d93f506f01d"}, "downloads": -1, "filename": "dynetlsm-0.1.0.tar.gz", "has_sig": false, "md5_digest": "71a8b1344846601972ea2718ff2617ab", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 675891, "upload_time": "2020-04-10T20:04:10", "upload_time_iso_8601": "2020-04-10T20:04:10.610538Z", "url": "https://files.pythonhosted.org/packages/84/14/b80ec7a4e4557d6c4a3d39d73fe2193609c41036d8e617d8ec070597fbb1/dynetlsm-0.1.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "b7229cb5e0a0ec90846e28123958b8c2", "sha256": "6cc3765da368bff85a7f96b384477c6bb8ce91deeac3f387112964b5466fa446"}, "downloads": -1, "filename": "dynetlsm-0.1.0-cp37-cp37m-macosx_10_12_x86_64.whl", "has_sig": false, "md5_digest": "b7229cb5e0a0ec90846e28123958b8c2", "packagetype": "bdist_wheel", "python_version": "cp37", "requires_python": null, "size": 969416, "upload_time": "2020-04-10T20:04:07", "upload_time_iso_8601": "2020-04-10T20:04:07.424115Z", "url": "https://files.pythonhosted.org/packages/a4/80/cac57e4ebaa732eba16543c0221837c8fab8f658a44838c2d312e6d02bd6/dynetlsm-0.1.0-cp37-cp37m-macosx_10_12_x86_64.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "71a8b1344846601972ea2718ff2617ab", "sha256": "c8ea182e794774f6f1e922e4b1b3906f9817c2c73c47e0ae11460d93f506f01d"}, "downloads": -1, "filename": "dynetlsm-0.1.0.tar.gz", "has_sig": false, "md5_digest": "71a8b1344846601972ea2718ff2617ab", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 675891, "upload_time": "2020-04-10T20:04:10", "upload_time_iso_8601": "2020-04-10T20:04:10.610538Z", "url": "https://files.pythonhosted.org/packages/84/14/b80ec7a4e4557d6c4a3d39d73fe2193609c41036d8e617d8ec070597fbb1/dynetlsm-0.1.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:48:38 2020"}