{"info": {"author": "BestDoctor", "author_email": "s.butkin@bestdoctor.ru", "bugtrack_url": null, "classifiers": ["Environment :: Console", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Software Development :: Libraries :: Python Modules", "Topic :: Software Development :: Quality Assurance"], "description": "# Vuakhter\n\n[![Build Status](https://travis-ci.org/best-doctor/vuakhter.svg?branch=master)](https://travis-ci.org/best-doctor/vuakhter)\n[![Maintainability](https://api.codeclimate.com/v1/badges/127bff178b6e355fc24c/maintainability)](https://codeclimate.com/github/best-doctor/vuakhter/maintainability)\n[![Test Coverage](https://api.codeclimate.com/v1/badges/127bff178b6e355fc24c/test_coverage)](https://codeclimate.com/github/best-doctor/vuakhter/test_coverage)\n\nVuakhter is validation tool to test API to conform our\n[API guide](https://github.com/best-doctor/guides/blob/master/guides/api_guide.md).\nBut it can be used to generate statistics of web-application by its logs.\n\n## Principles of work\n\nVuakhter scans access log for specified period, filters log entries by path prefixes\nand passes each entry for statistics generation.\n\nBase class `AccessLog` returns an iterator of log entries. Class `ElasticAccessLog`\nscans elastic indices for log entries.\n\n`StatisticsMetrics` gets `AccessEntry` records and forms array of statistics data.\n`StatisticsMetrics.report() -> str` returns statistics report for the metrics.\n\n`HttpAnalyzer` uses `access_log: AccessLog` and array of `StatisticsMetrics`.\n\nOnly one metric `SchemaValidatorCounter` is passing to `HttpAnalyzer` in main script\n`vuakhter`. It uses `request_log: RequestLog` to validate API responses.\n\nClass `ElasticRequestLog: RequestLog` scans elastic indices requests by request_id\n and returns array of `RequestEntry`. `SchemaValidatorCounter` checks all responses\n bodies and counts valid API calls.\n\n## Installation\n\n```bash\npip install vuakhter\n```\n\n## Usage\n\n```\nvuakhter [--es-user ES_USER] [--es-pass ES_PASS] [--es-host ES_HOST] [--es-port ES_PORT\n[--start-date START_DATE] [--end-date END_DATE] prefixes [prefixes ...]\n```\n\nBy default end_date is current date and time if not specified. And start_date\ndefaults to day ago end_date.\n\nAll connection parameters may be specified in .env file.\n\n```\nES_USER=elastic ES_PASS=pasword ES_HOST=localhost vuakhter /api/\n\n```\n\n### Using in code\n\n```python\nimport datetime\n\nfrom elasticsearch import Elasticsearch\n\nfrom vuakhter.analyzer import HttpAnalyzer\nfrom vuakhter.kibana.access_log import ElasticAccessLog\nfrom vuakhter.metrics.counters import ComplexCounter\n\n\nelastic = Elasticsearch()\naccess_log = ElasticAccessLog(index_pattern='filebeat-*', client=elastic)\n\nhttp_analyzer = HttpAnalyzer(access_log=access_log)\nhttp_analyzer.add_metrics(ComplexCounter())\n\nend_date = datetime.datetime.now()\nstart_date = end_date - datetime.timedelta(days=1)\n\nhttp_analyzer.analyze(start_date, end_date)\n\nfor metric in http_analyzer.metrics:\n    metric.finalize()\n    print(metric.report())\n```\n\n## Contributing\n\nWe would love you to contribute to our project. It's simple:\n\n- Create an issue with bug you found or proposal you have.\n  Wait for approve from maintainer.\n- Create a pull request. Make sure all checks are green.\n- Fix review comments if any.\n- Be awesome.\n\nHere are useful tips:\n\n- You can run all checks and tests with `make check`. Please do it\n  before TravisCI does.\n- We use\n  [BestDoctor python styleguide](https://github.com/best-doctor/guides/blob/master/guides/python_styleguide.md).\n  Sorry, styleguide is available only in Russian for now.\n- We respect [Django CoC](https://www.djangoproject.com/conduct/).\n  Make soft, not bullshit.", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "", "keywords": "kibana statistics", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "vuakhter", "package_url": "https://pypi.org/project/vuakhter/", "platform": "", "project_url": "https://pypi.org/project/vuakhter/", "project_urls": null, "release_url": "https://pypi.org/project/vuakhter/0.0.1/", "requires_dist": null, "requires_python": "", "summary": "Package to count usage statistics from ELK logs.", "version": "0.0.1", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Vuakhter</h1>\n<p><a href=\"https://travis-ci.org/best-doctor/vuakhter\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/a8c2cea443607d428d63f703801663c0535506cd/68747470733a2f2f7472617669732d63692e6f72672f626573742d646f63746f722f7675616b687465722e7376673f6272616e63683d6d6173746572\"></a>\n<a href=\"https://codeclimate.com/github/best-doctor/vuakhter/maintainability\" rel=\"nofollow\"><img alt=\"Maintainability\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/c5a80e8cd28d237d4e3df6e471ae17998af7fc80/68747470733a2f2f6170692e636f6465636c696d6174652e636f6d2f76312f6261646765732f31323762666631373862366533353566633234632f6d61696e7461696e6162696c697479\"></a>\n<a href=\"https://codeclimate.com/github/best-doctor/vuakhter/test_coverage\" rel=\"nofollow\"><img alt=\"Test Coverage\" src=\"https://warehouse-camo.ingress.cmh1.psfhosted.org/991aa6cd8910c5d8b3d338a0233bb2d17ae0f8b6/68747470733a2f2f6170692e636f6465636c696d6174652e636f6d2f76312f6261646765732f31323762666631373862366533353566633234632f746573745f636f766572616765\"></a></p>\n<p>Vuakhter is validation tool to test API to conform our\n<a href=\"https://github.com/best-doctor/guides/blob/master/guides/api_guide.md\" rel=\"nofollow\">API guide</a>.\nBut it can be used to generate statistics of web-application by its logs.</p>\n<h2>Principles of work</h2>\n<p>Vuakhter scans access log for specified period, filters log entries by path prefixes\nand passes each entry for statistics generation.</p>\n<p>Base class <code>AccessLog</code> returns an iterator of log entries. Class <code>ElasticAccessLog</code>\nscans elastic indices for log entries.</p>\n<p><code>StatisticsMetrics</code> gets <code>AccessEntry</code> records and forms array of statistics data.\n<code>StatisticsMetrics.report() -&gt; str</code> returns statistics report for the metrics.</p>\n<p><code>HttpAnalyzer</code> uses <code>access_log: AccessLog</code> and array of <code>StatisticsMetrics</code>.</p>\n<p>Only one metric <code>SchemaValidatorCounter</code> is passing to <code>HttpAnalyzer</code> in main script\n<code>vuakhter</code>. It uses <code>request_log: RequestLog</code> to validate API responses.</p>\n<p>Class <code>ElasticRequestLog: RequestLog</code> scans elastic indices requests by request_id\nand returns array of <code>RequestEntry</code>. <code>SchemaValidatorCounter</code> checks all responses\nbodies and counts valid API calls.</p>\n<h2>Installation</h2>\n<pre>pip install vuakhter\n</pre>\n<h2>Usage</h2>\n<pre><code>vuakhter [--es-user ES_USER] [--es-pass ES_PASS] [--es-host ES_HOST] [--es-port ES_PORT\n[--start-date START_DATE] [--end-date END_DATE] prefixes [prefixes ...]\n</code></pre>\n<p>By default end_date is current date and time if not specified. And start_date\ndefaults to day ago end_date.</p>\n<p>All connection parameters may be specified in .env file.</p>\n<pre><code>ES_USER=elastic ES_PASS=pasword ES_HOST=localhost vuakhter /api/\n\n</code></pre>\n<h3>Using in code</h3>\n<pre><span class=\"kn\">import</span> <span class=\"nn\">datetime</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">elasticsearch</span> <span class=\"kn\">import</span> <span class=\"n\">Elasticsearch</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">vuakhter.analyzer</span> <span class=\"kn\">import</span> <span class=\"n\">HttpAnalyzer</span>\n<span class=\"kn\">from</span> <span class=\"nn\">vuakhter.kibana.access_log</span> <span class=\"kn\">import</span> <span class=\"n\">ElasticAccessLog</span>\n<span class=\"kn\">from</span> <span class=\"nn\">vuakhter.metrics.counters</span> <span class=\"kn\">import</span> <span class=\"n\">ComplexCounter</span>\n\n\n<span class=\"n\">elastic</span> <span class=\"o\">=</span> <span class=\"n\">Elasticsearch</span><span class=\"p\">()</span>\n<span class=\"n\">access_log</span> <span class=\"o\">=</span> <span class=\"n\">ElasticAccessLog</span><span class=\"p\">(</span><span class=\"n\">index_pattern</span><span class=\"o\">=</span><span class=\"s1\">'filebeat-*'</span><span class=\"p\">,</span> <span class=\"n\">client</span><span class=\"o\">=</span><span class=\"n\">elastic</span><span class=\"p\">)</span>\n\n<span class=\"n\">http_analyzer</span> <span class=\"o\">=</span> <span class=\"n\">HttpAnalyzer</span><span class=\"p\">(</span><span class=\"n\">access_log</span><span class=\"o\">=</span><span class=\"n\">access_log</span><span class=\"p\">)</span>\n<span class=\"n\">http_analyzer</span><span class=\"o\">.</span><span class=\"n\">add_metrics</span><span class=\"p\">(</span><span class=\"n\">ComplexCounter</span><span class=\"p\">())</span>\n\n<span class=\"n\">end_date</span> <span class=\"o\">=</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">now</span><span class=\"p\">()</span>\n<span class=\"n\">start_date</span> <span class=\"o\">=</span> <span class=\"n\">end_date</span> <span class=\"o\">-</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">timedelta</span><span class=\"p\">(</span><span class=\"n\">days</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"n\">http_analyzer</span><span class=\"o\">.</span><span class=\"n\">analyze</span><span class=\"p\">(</span><span class=\"n\">start_date</span><span class=\"p\">,</span> <span class=\"n\">end_date</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">metric</span> <span class=\"ow\">in</span> <span class=\"n\">http_analyzer</span><span class=\"o\">.</span><span class=\"n\">metrics</span><span class=\"p\">:</span>\n    <span class=\"n\">metric</span><span class=\"o\">.</span><span class=\"n\">finalize</span><span class=\"p\">()</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">metric</span><span class=\"o\">.</span><span class=\"n\">report</span><span class=\"p\">())</span>\n</pre>\n<h2>Contributing</h2>\n<p>We would love you to contribute to our project. It's simple:</p>\n<ul>\n<li>Create an issue with bug you found or proposal you have.\nWait for approve from maintainer.</li>\n<li>Create a pull request. Make sure all checks are green.</li>\n<li>Fix review comments if any.</li>\n<li>Be awesome.</li>\n</ul>\n<p>Here are useful tips:</p>\n<ul>\n<li>You can run all checks and tests with <code>make check</code>. Please do it\nbefore TravisCI does.</li>\n<li>We use\n<a href=\"https://github.com/best-doctor/guides/blob/master/guides/python_styleguide.md\" rel=\"nofollow\">BestDoctor python styleguide</a>.\nSorry, styleguide is available only in Russian for now.</li>\n<li>We respect <a href=\"https://www.djangoproject.com/conduct/\" rel=\"nofollow\">Django CoC</a>.\nMake soft, not bullshit.</li>\n</ul>\n\n          </div>"}, "last_serial": 7158543, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "d8f81805aa897298433a2fe5d85a1dd6", "sha256": "9d2154ab82d1a4fc775eab372b3991c74f3ea1050d49177c9c2d65ac8343ba63"}, "downloads": -1, "filename": "vuakhter-0.0.1.tar.gz", "has_sig": false, "md5_digest": "d8f81805aa897298433a2fe5d85a1dd6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 10614, "upload_time": "2020-05-03T17:18:42", "upload_time_iso_8601": "2020-05-03T17:18:42.654816Z", "url": "https://files.pythonhosted.org/packages/db/33/058e1df67cd029ff9c4181e54dd38e5844db3712b9f87444f11c473de67b/vuakhter-0.0.1.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "d8f81805aa897298433a2fe5d85a1dd6", "sha256": "9d2154ab82d1a4fc775eab372b3991c74f3ea1050d49177c9c2d65ac8343ba63"}, "downloads": -1, "filename": "vuakhter-0.0.1.tar.gz", "has_sig": false, "md5_digest": "d8f81805aa897298433a2fe5d85a1dd6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 10614, "upload_time": "2020-05-03T17:18:42", "upload_time_iso_8601": "2020-05-03T17:18:42.654816Z", "url": "https://files.pythonhosted.org/packages/db/33/058e1df67cd029ff9c4181e54dd38e5844db3712b9f87444f11c473de67b/vuakhter-0.0.1.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:33:40 2020"}