{"info": {"author": "R\u00e9my Sanchez", "author_email": "remy.sanchez@with-madrid.com", "bugtrack_url": null, "classifiers": ["License :: Other/Proprietary License", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8"], "description": "Django Wools\n============\n\nDjango tools from WITH.\n\nThat's a collection of things that we at [WITH](https://with-madrid.com/) got\ntired of copy/pasting in every project.\n\n## Install\n\n```\npip install django_wools\n```\n\n## Included Wools\n\n### Storage\n\n#### `django_wools.storage.GzipManifestStaticFilesStorage`\n\nThat's a sub-class of the \n[ManifestStaticFilesStorage](https://docs.djangoproject.com/en/3.0/ref/contrib/staticfiles/#manifeststaticfilesstorage)\nbut that makes sure that along with all the files comes a `.gz` version which\nis easy to pick up for nginx (or other static files server).\n\n### Middlewares\n\n#### `django_wools.middlewares.NowMiddleware`\n\nSuppose that you have a content that is available up until a given date. When\nthe date is passed then everything related to this content expires. However,\nin order to do this, you're probably going to make several request, possibly in\nloosely connected parts of your code. In those cases, when looking at the time,\nthe clock will show different value as the time passes between calls. It means\nthat you could very well end up with one half of your code considering that the\nobject is still valid but the other half that it expired.\n\nIn order to prevent this, the simplest is to consider that the time is fixed\nand that the code executes instantly at the moment of the request. The goal\nof this middleware is to save the current time at each request and then to\nprovide an easy way to get the current time through the request.\n\nIf the middleware is activated, you should be able to get the time like this:\n\n```python\nfrom time import sleep\nfrom django.shortcuts import render\n\ndef my_view(request):\n    print(f\"Now is {request.now()}\")\n    sleep(42)\n    print(f\"Now is still {request.now()}\")\n\n    return render(request, \"something.html\", {\"now\": request.now()})\n```\n\n#### `django_wools.middlewares.SlowMiddleware`\n\nWhen developing a SPA or hybrid app, you want to make sure that the app is\nstructurally ready to handle load times from the server, even if the connection\nis a bit shaky. Also, you want to make sure that not too many requests are\nsent.\n\nIn order for you to fully realize how slow your website is going to be on a bad\nconnection, th e SlowMiddleware will automatically add a delay before replying\nto each request.\n\nAdd this to your `settings.py`\n\n```python\nMIDDLEWARE = [\n    # ...\n    \"django_wools.middlewares.SlowMiddleware\",\n]\n\nSLOW_MIDDLEWARE_LATENCY = 1 if DEBUG else 0\n```\n\nBy doing this, your requests will be added a 1s delay if the `DEBUG` mode is\nenabled.\n\n### Database\n\n#### `django_wools.db.require_lock`\n\nProvides a way to explicitly generate a PostgreSQL lock on a table.\n\nBy example:\n\n```python\nfrom django.db.transaction import atomic\nfrom django_wools.db import require_lock\n\nfrom my_app.models import MyModel\n\n\n@atomic\n@require_lock(MyModel, 'ACCESS EXCLUSIVE')\ndef myview(request):\n    # do stuff here\n```\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/WithIO/django-wools", "keywords": "", "license": "WTFPL", "maintainer": "", "maintainer_email": "", "name": "django-wools", "package_url": "https://pypi.org/project/django-wools/", "platform": "", "project_url": "https://pypi.org/project/django-wools/", "project_urls": {"Homepage": "https://github.com/WithIO/django-wools", "Repository": "https://github.com/WithIO/django-wools"}, "release_url": "https://pypi.org/project/django-wools/0.1.3/", "requires_dist": ["zopflipy (>1.1)", "psutil (>2.0.0)", "tqdm (>3.0.0)", "django (>1.7.0)"], "requires_python": ">=3.6,<4.0", "summary": "Django tools from WITH", "version": "0.1.3", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>Django Wools</h1>\n<p>Django tools from WITH.</p>\n<p>That's a collection of things that we at <a href=\"https://with-madrid.com/\" rel=\"nofollow\">WITH</a> got\ntired of copy/pasting in every project.</p>\n<h2>Install</h2>\n<pre><code>pip install django_wools\n</code></pre>\n<h2>Included Wools</h2>\n<h3>Storage</h3>\n<h4><code>django_wools.storage.GzipManifestStaticFilesStorage</code></h4>\n<p>That's a sub-class of the\n<a href=\"https://docs.djangoproject.com/en/3.0/ref/contrib/staticfiles/#manifeststaticfilesstorage\" rel=\"nofollow\">ManifestStaticFilesStorage</a>\nbut that makes sure that along with all the files comes a <code>.gz</code> version which\nis easy to pick up for nginx (or other static files server).</p>\n<h3>Middlewares</h3>\n<h4><code>django_wools.middlewares.NowMiddleware</code></h4>\n<p>Suppose that you have a content that is available up until a given date. When\nthe date is passed then everything related to this content expires. However,\nin order to do this, you're probably going to make several request, possibly in\nloosely connected parts of your code. In those cases, when looking at the time,\nthe clock will show different value as the time passes between calls. It means\nthat you could very well end up with one half of your code considering that the\nobject is still valid but the other half that it expired.</p>\n<p>In order to prevent this, the simplest is to consider that the time is fixed\nand that the code executes instantly at the moment of the request. The goal\nof this middleware is to save the current time at each request and then to\nprovide an easy way to get the current time through the request.</p>\n<p>If the middleware is activated, you should be able to get the time like this:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">time</span> <span class=\"kn\">import</span> <span class=\"n\">sleep</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.shortcuts</span> <span class=\"kn\">import</span> <span class=\"n\">render</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">my_view</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Now is </span><span class=\"si\">{</span><span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">now</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n    <span class=\"n\">sleep</span><span class=\"p\">(</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">\"Now is still </span><span class=\"si\">{</span><span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">now</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">render</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"s2\">\"something.html\"</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"s2\">\"now\"</span><span class=\"p\">:</span> <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">now</span><span class=\"p\">()})</span>\n</pre>\n<h4><code>django_wools.middlewares.SlowMiddleware</code></h4>\n<p>When developing a SPA or hybrid app, you want to make sure that the app is\nstructurally ready to handle load times from the server, even if the connection\nis a bit shaky. Also, you want to make sure that not too many requests are\nsent.</p>\n<p>In order for you to fully realize how slow your website is going to be on a bad\nconnection, th e SlowMiddleware will automatically add a delay before replying\nto each request.</p>\n<p>Add this to your <code>settings.py</code></p>\n<pre><span class=\"n\">MIDDLEWARE</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"s2\">\"django_wools.middlewares.SlowMiddleware\"</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">SLOW_MIDDLEWARE_LATENCY</span> <span class=\"o\">=</span> <span class=\"mi\">1</span> <span class=\"k\">if</span> <span class=\"n\">DEBUG</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n</pre>\n<p>By doing this, your requests will be added a 1s delay if the <code>DEBUG</code> mode is\nenabled.</p>\n<h3>Database</h3>\n<h4><code>django_wools.db.require_lock</code></h4>\n<p>Provides a way to explicitly generate a PostgreSQL lock on a table.</p>\n<p>By example:</p>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">django.db.transaction</span> <span class=\"kn\">import</span> <span class=\"n\">atomic</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django_wools.db</span> <span class=\"kn\">import</span> <span class=\"n\">require_lock</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">my_app.models</span> <span class=\"kn\">import</span> <span class=\"n\">MyModel</span>\n\n\n<span class=\"nd\">@atomic</span>\n<span class=\"nd\">@require_lock</span><span class=\"p\">(</span><span class=\"n\">MyModel</span><span class=\"p\">,</span> <span class=\"s1\">'ACCESS EXCLUSIVE'</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">myview</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"c1\"># do stuff here</span>\n</pre>\n\n          </div>"}, "last_serial": 7156044, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "1035cae9bccebecc02583a66f5c53e74", "sha256": "2dca90e6750b746813bfa15bddbd92f25d51a59939c76a13ddf36a473d2b0cc9"}, "downloads": -1, "filename": "django_wools-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "1035cae9bccebecc02583a66f5c53e74", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 4029, "upload_time": "2020-04-29T12:54:42", "upload_time_iso_8601": "2020-04-29T12:54:42.120052Z", "url": "https://files.pythonhosted.org/packages/0c/20/60dfba90b4cba21dd892ef62e4dd7ea301dabc0585b73298cd2c97df7b8a/django_wools-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "726ddd2fcf98ac760b7dcd5810343937", "sha256": "1bcbb1f3b5a72c069614405515aaa15bd7dbbf66355c48eda86db5fa85eb51cc"}, "downloads": -1, "filename": "django_wools-0.1.0.tar.gz", "has_sig": false, "md5_digest": "726ddd2fcf98ac760b7dcd5810343937", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 3857, "upload_time": "2020-04-29T12:54:44", "upload_time_iso_8601": "2020-04-29T12:54:44.286481Z", "url": "https://files.pythonhosted.org/packages/59/23/9929b637220d18361add4805ec371c9b1487471309a30ebc12ebcb29af30/django_wools-0.1.0.tar.gz", "yanked": false}], "0.1.1": [{"comment_text": "", "digests": {"md5": "e598888c53f8752a75a2da8eaa098edb", "sha256": "59b6d4fadfad5359dd63ab897e118643cb05255d97ac1ef93720ddd9c72edfaf"}, "downloads": -1, "filename": "django_wools-0.1.1-py3-none-any.whl", "has_sig": false, "md5_digest": "e598888c53f8752a75a2da8eaa098edb", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 4867, "upload_time": "2020-05-01T11:02:02", "upload_time_iso_8601": "2020-05-01T11:02:02.214715Z", "url": "https://files.pythonhosted.org/packages/e9/cd/1cf31cb4ced3848b119cec81f3bc4e712d156995989f8c4428d37fa1c10b/django_wools-0.1.1-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "5303bfb00ca4dc61b2d0bf3051f1ef44", "sha256": "766baacef0037210e8cb4e848b9a41942bac70823ebd1a41ab49bf73245fd5de"}, "downloads": -1, "filename": "django_wools-0.1.1.tar.gz", "has_sig": false, "md5_digest": "5303bfb00ca4dc61b2d0bf3051f1ef44", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 4526, "upload_time": "2020-05-01T11:02:03", "upload_time_iso_8601": "2020-05-01T11:02:03.178833Z", "url": "https://files.pythonhosted.org/packages/e9/7d/f1a88a5c11747236d9d74e7b5a72b639e59b25d8d6127648ed889e62c640/django_wools-0.1.1.tar.gz", "yanked": false}], "0.1.2": [{"comment_text": "", "digests": {"md5": "4f8b4b98fd825d8a9fe16cf9d136c24c", "sha256": "a4fa1e577d199ca68081c89c6c437b914419fdd1a318693994731712cf7ecd19"}, "downloads": -1, "filename": "django_wools-0.1.2-py3-none-any.whl", "has_sig": false, "md5_digest": "4f8b4b98fd825d8a9fe16cf9d136c24c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 5381, "upload_time": "2020-05-02T11:57:23", "upload_time_iso_8601": "2020-05-02T11:57:23.382635Z", "url": "https://files.pythonhosted.org/packages/65/51/890ec13b7445bcdfe99b9792b1b02f997019dc91338fe53cf5a456fd471e/django_wools-0.1.2-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "fd8f969baee2c339ebe374658ce3b49c", "sha256": "e18a9fe103750dc8acd32d66854a8e763427a46e06260e1370f75d5e07232b8a"}, "downloads": -1, "filename": "django_wools-0.1.2.tar.gz", "has_sig": false, "md5_digest": "fd8f969baee2c339ebe374658ce3b49c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5142, "upload_time": "2020-05-02T11:57:24", "upload_time_iso_8601": "2020-05-02T11:57:24.634091Z", "url": "https://files.pythonhosted.org/packages/e0/ba/fc6f8accb4352b6ebfe4719b6e8abc413a04d7101f739355eb1fce4549ce/django_wools-0.1.2.tar.gz", "yanked": false}], "0.1.3": [{"comment_text": "", "digests": {"md5": "8d21b4ca24a36dac78d3ba463f2b07d4", "sha256": "a10fe6be25219ad50db7b1c533da22c30251f12f9a94b71327bfb61aff81f6e7"}, "downloads": -1, "filename": "django_wools-0.1.3-py3-none-any.whl", "has_sig": false, "md5_digest": "8d21b4ca24a36dac78d3ba463f2b07d4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 6133, "upload_time": "2020-05-03T10:56:50", "upload_time_iso_8601": "2020-05-03T10:56:50.070348Z", "url": "https://files.pythonhosted.org/packages/92/8b/bd1d9d9af88698f2e10d0dafa1e21b537607e62f442aa9c6df30dfd99b39/django_wools-0.1.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "aad8c5a7ccf570263fbda37813eff60b", "sha256": "518860d332c5aca084d8265b9d32ffb6d846c9fddddf3ce7aec37eb3fd84a926"}, "downloads": -1, "filename": "django_wools-0.1.3.tar.gz", "has_sig": false, "md5_digest": "aad8c5a7ccf570263fbda37813eff60b", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5680, "upload_time": "2020-05-03T10:56:51", "upload_time_iso_8601": "2020-05-03T10:56:51.397136Z", "url": "https://files.pythonhosted.org/packages/95/2c/c89a8913410d3001e445e1b638094ec0389682df49137c296a7067959f44/django_wools-0.1.3.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "8d21b4ca24a36dac78d3ba463f2b07d4", "sha256": "a10fe6be25219ad50db7b1c533da22c30251f12f9a94b71327bfb61aff81f6e7"}, "downloads": -1, "filename": "django_wools-0.1.3-py3-none-any.whl", "has_sig": false, "md5_digest": "8d21b4ca24a36dac78d3ba463f2b07d4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6,<4.0", "size": 6133, "upload_time": "2020-05-03T10:56:50", "upload_time_iso_8601": "2020-05-03T10:56:50.070348Z", "url": "https://files.pythonhosted.org/packages/92/8b/bd1d9d9af88698f2e10d0dafa1e21b537607e62f442aa9c6df30dfd99b39/django_wools-0.1.3-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "aad8c5a7ccf570263fbda37813eff60b", "sha256": "518860d332c5aca084d8265b9d32ffb6d846c9fddddf3ce7aec37eb3fd84a926"}, "downloads": -1, "filename": "django_wools-0.1.3.tar.gz", "has_sig": false, "md5_digest": "aad8c5a7ccf570263fbda37813eff60b", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6,<4.0", "size": 5680, "upload_time": "2020-05-03T10:56:51", "upload_time_iso_8601": "2020-05-03T10:56:51.397136Z", "url": "https://files.pythonhosted.org/packages/95/2c/c89a8913410d3001e445e1b638094ec0389682df49137c296a7067959f44/django_wools-0.1.3.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:51:51 2020"}