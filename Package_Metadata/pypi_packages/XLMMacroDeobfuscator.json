{"info": {"author": "Amirreza Niakanlahiji", "author_email": "aniak2@uis.edu", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: Developers", "Intended Audience :: Information Technology", "Intended Audience :: Science/Research", "Intended Audience :: System Administrators", "License :: OSI Approved :: Apache Software License", "Natural Language :: English", "Operating System :: OS Independent", "Programming Language :: Python", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Security", "Topic :: Software Development :: Libraries :: Python Modules"], "description": "# XLMMacroDeobfuscator\nXLMMacroDeobfuscator can be used to decode obfuscated XLM macros (also known as Excel 4.0 macros). It utilizes an internal XLM emulator to interpret the macros, without fully performing the code.\n\nIt supports both xls, xlsm, and xlsb formats. \n\nIt uses [pyxlsb2](https://github.com/DissectMalware/pyxlsb2) and its own parser to extract cells and other information from xlsb and xlsm files. However, it relies on MS Excel to extract such information. As such, you need to have MS Excel on the machine if you want to process xls files.\n\nNote: Processing xlsm and xlsb files are much faster than xls files (in two orders of magnitude)\n\nSoon, an xls parser will be included to make it independent of MS Excel\n\nWARNING: tmp\\tmp.zip contains real malicious excel documents (password: infected). Please only run them in a testing environment.\n\nYou can also find XLM grammar in xlm-macro.lark\n\n# Running the script\nTo run the script \n\n```\npython  deobfuscator.py --file document.xlsm\n```\n\n# Usage\n\n```\nusage: deobfuscator.py [-h] [-f FILE] [-n] [-x] [-s]\n\noptional arguments:\n  -h, --help              show this help message and exit\n  -f FILE, --file FILE    The path of a XLSM file\n  -n, --noninteractive    Disable interactive shell\n  -x, --extract-only      Only extract cells without any emulation\n  -s, --start-with-shell  Open an XLM shell before interpreting the macros in\n                          the input\n```\n\n# Prerequisit\nTo parse xlsb file, XLMMacroObfuscator relies on [pyxlsb2](https://github.com/DissectMalware/pyxlsb2). To install the pyxlsb2 library:\n\n```\npip install -U pyxlsb2\n```\n\nIt also requires Microsoft Excel in order to process XLS files. However, if only XLSM or XLSB files are being processed, MS Excel is not needed.\n\n\\* This code is heavily under development. Expect to see radical changes in the code.\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/DissectMalware/XLMMacroDeobfuscator", "keywords": "", "license": "Apache License 2.0", "maintainer": "", "maintainer_email": "", "name": "XLMMacroDeobfuscator", "package_url": "https://pypi.org/project/XLMMacroDeobfuscator/", "platform": "", "project_url": "https://pypi.org/project/XLMMacroDeobfuscator/", "project_urls": {"Homepage": "https://github.com/DissectMalware/XLMMacroDeobfuscator"}, "release_url": "https://pypi.org/project/XLMMacroDeobfuscator/0.1.0/", "requires_dist": ["pyxlsb2", "lark-parser", "pywin32"], "requires_python": ">=3.4", "summary": "XLMMacroDeobfuscator is an XLM Emulation engine written in Python 3, designed toanalyze and deobfuscate malicious XLM macros, also known as Excel 4.0 macros,contined in MS Excel files (XLS, XLSM, and XLSB).", "version": "0.1.0", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>XLMMacroDeobfuscator</h1>\n<p>XLMMacroDeobfuscator can be used to decode obfuscated XLM macros (also known as Excel 4.0 macros). It utilizes an internal XLM emulator to interpret the macros, without fully performing the code.</p>\n<p>It supports both xls, xlsm, and xlsb formats.</p>\n<p>It uses <a href=\"https://github.com/DissectMalware/pyxlsb2\" rel=\"nofollow\">pyxlsb2</a> and its own parser to extract cells and other information from xlsb and xlsm files. However, it relies on MS Excel to extract such information. As such, you need to have MS Excel on the machine if you want to process xls files.</p>\n<p>Note: Processing xlsm and xlsb files are much faster than xls files (in two orders of magnitude)</p>\n<p>Soon, an xls parser will be included to make it independent of MS Excel</p>\n<p>WARNING: tmp\\tmp.zip contains real malicious excel documents (password: infected). Please only run them in a testing environment.</p>\n<p>You can also find XLM grammar in xlm-macro.lark</p>\n<h1>Running the script</h1>\n<p>To run the script</p>\n<pre><code>python  deobfuscator.py --file document.xlsm\n</code></pre>\n<h1>Usage</h1>\n<pre><code>usage: deobfuscator.py [-h] [-f FILE] [-n] [-x] [-s]\n\noptional arguments:\n  -h, --help              show this help message and exit\n  -f FILE, --file FILE    The path of a XLSM file\n  -n, --noninteractive    Disable interactive shell\n  -x, --extract-only      Only extract cells without any emulation\n  -s, --start-with-shell  Open an XLM shell before interpreting the macros in\n                          the input\n</code></pre>\n<h1>Prerequisit</h1>\n<p>To parse xlsb file, XLMMacroObfuscator relies on <a href=\"https://github.com/DissectMalware/pyxlsb2\" rel=\"nofollow\">pyxlsb2</a>. To install the pyxlsb2 library:</p>\n<pre><code>pip install -U pyxlsb2\n</code></pre>\n<p>It also requires Microsoft Excel in order to process XLS files. However, if only XLSM or XLSB files are being processed, MS Excel is not needed.</p>\n<p>* This code is heavily under development. Expect to see radical changes in the code.</p>\n\n          </div>"}, "last_serial": 7153619, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "8f5a2e180f36fa791dcdf41b099a2e01", "sha256": "0a509392aec4a980de66dd56d0a19032b44e4c9ba272b90c4e30d61660c8325a"}, "downloads": -1, "filename": "XLMMacroDeobfuscator-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "8f5a2e180f36fa791dcdf41b099a2e01", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 19938, "upload_time": "2020-05-02T21:44:16", "upload_time_iso_8601": "2020-05-02T21:44:16.555153Z", "url": "https://files.pythonhosted.org/packages/b8/bd/481a7cc8b17bf713a2572fa952c4beb063234fee40f76a9fd35824d2b017/XLMMacroDeobfuscator-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "fc537a87a8212d6352a9dcd005655a43", "sha256": "c45fc4cf33b4ed974f9ae6a21170f795ef5e4720d7a43a78a07797d8a1b677b7"}, "downloads": -1, "filename": "XLMMacroDeobfuscator-0.1.0.tar.gz", "has_sig": false, "md5_digest": "fc537a87a8212d6352a9dcd005655a43", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 13366, "upload_time": "2020-05-02T21:44:18", "upload_time_iso_8601": "2020-05-02T21:44:18.405467Z", "url": "https://files.pythonhosted.org/packages/16/83/80e1fe8eb34124284efb8aed8701e51938cbb22ea4bfe58fbaf079cdc45f/XLMMacroDeobfuscator-0.1.0.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "8f5a2e180f36fa791dcdf41b099a2e01", "sha256": "0a509392aec4a980de66dd56d0a19032b44e4c9ba272b90c4e30d61660c8325a"}, "downloads": -1, "filename": "XLMMacroDeobfuscator-0.1.0-py3-none-any.whl", "has_sig": false, "md5_digest": "8f5a2e180f36fa791dcdf41b099a2e01", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.4", "size": 19938, "upload_time": "2020-05-02T21:44:16", "upload_time_iso_8601": "2020-05-02T21:44:16.555153Z", "url": "https://files.pythonhosted.org/packages/b8/bd/481a7cc8b17bf713a2572fa952c4beb063234fee40f76a9fd35824d2b017/XLMMacroDeobfuscator-0.1.0-py3-none-any.whl", "yanked": false}, {"comment_text": "", "digests": {"md5": "fc537a87a8212d6352a9dcd005655a43", "sha256": "c45fc4cf33b4ed974f9ae6a21170f795ef5e4720d7a43a78a07797d8a1b677b7"}, "downloads": -1, "filename": "XLMMacroDeobfuscator-0.1.0.tar.gz", "has_sig": false, "md5_digest": "fc537a87a8212d6352a9dcd005655a43", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.4", "size": 13366, "upload_time": "2020-05-02T21:44:18", "upload_time_iso_8601": "2020-05-02T21:44:18.405467Z", "url": "https://files.pythonhosted.org/packages/16/83/80e1fe8eb34124284efb8aed8701e51938cbb22ea4bfe58fbaf079cdc45f/XLMMacroDeobfuscator-0.1.0.tar.gz", "yanked": false}], "timestamp": "Fri May  8 03:25:18 2020"}