{"info": {"author": "Damien \"dee\" Coureau", "author_email": "kabaret-dev@googlegroups.com", "bugtrack_url": null, "classifiers": ["Development Status :: 4 - Beta", "Intended Audience :: Developers", "License :: OSI Approved :: GNU Lesser General Public License v3 or later (LGPLv3+)", "Operating System :: Microsoft :: Windows :: Windows 10", "Programming Language :: Python :: 3.7", "Topic :: System :: Shells"], "description": "# kabaret.subprocess_manager\n\nSubprocess Manager for Kabaret.\n\nProvides an Actor, Views and Flow Objects to manage collections of  environment + command-lines, as well as running & controling them.\n\n\n# Synopsis \n\n### Runners\n\nYou implement your `Runners` by subclassing `kabaret.subprocess_manager.runner_factory.Runner`. *Runners* have a name, some tags, a liste of supported versions, an icon, etc...\n\nAt runtime, you add your *Runners* to a `Factory`. A *Factory* has a name, can lookup *Runners* based on name and tags, etc...\nYou will probably have several factories.\n\n### SubprocessManager Actor\n\nIn order to use them, you will *Add* them to the `SubprocessManager` Actor. There is 2 places where you may want to do it:\n\n- In your Session, when creating the Action. This is nice for generic stuff (explorer, shell, text editors, ...) \n- In your Flow, when a project is instaciated. This is nice for production specific tools where the environment and the version are precisely defined (scene editing, baking, render, ...)\n \n### LaunchToolBar and SubprocessView\n\nIf you add the LaunchToolBar to your *Session*, you will be able to run your Runner by clicking on the toolbar buttons.\n\nThose run take no parameters.\n\nIf you add the SubprocessView (and it get implemented some day), you will see a list of process you ran, with their outputs, and you will have opportinities to remove/kill/rerun...\n\n### Flow RunAction \n\nA big majority of your Runner will be ran from your flows though. \n\nThe `kabaret.subprocess_manager.flow.RunAction` Action will let the user trigger your Runners with the usual `flow.Action` fonctionnalities.\n\nBy using the *RunAction*, you will be able to access your flow to configure your *Runners* runs. For example using project settings to get the project resolution and frame rate...\n\n\n# Usage:\n\n## Define your process Runners:\n```\nfrom kabaret.subprocess_manager.runner_factory import Runner\n\nclass MyStuffToRun(Runner):\n\n    ICON = ('icons.gui', 'team-lead')\n    TAGS = ['Team', 'Lead', 'Blah']\n\n    def supported_versions(self):\n        return ['v1', 'v2]\n\n    def executable(self):\n        return '/path/to/{}/executable'.format(self.version)\n\n    def argv(self):\n        index = 'https://blah.blu.tv'\n        if self.version == 'v2':\n            index = 'https://blah2022.blu.tv'\n\n        argv = ['--user', current_user, '--index', index]\n\n        # To allow configured run, you must\n        # use self.extra_argv:\n        return argv+self.extra_argv\n\n    def env(self):\n        env = os.environ.copy()\n        env['MY_STUFF_CONFIGVAR] = 'my_stuff_config_value'\n\n        # To allow configured run, you must\n        # use self.extra_argv:\n        env.update(self.extra_env)\n\n        return env\n\n```\nThere are more tunning options, like terminal hidding etc... \n\nEverything is procedural (method call, no static/declarative thingy) so you're in full control ;)\n\nIf you want the Runner icon or tags to depend on the date or the current user your can override the classmethods `runner_icon()` and `runner_tags()`\n\n\n## Configure your Session:\n\nIn your session class, add the `SubprocessView` and the `LaunchToolBar` to\nthe registered view types.\n\n```\nclass MySession(gui.KabaretStandaloneGUISession):\n\n    def register_view_types(self):\n        super(MySession, self).register_view_types()\n\n        type_name = self.register_view_type(SubprocessView)\n        self.add_view(type_name, hidden=True)\n\n        type_name = self.register_view_type(LauncherToolBar)\n        self.add_view(\n            type_name, hidden=False, \n            area=QtCore.Qt.RightToolBarArea\n        )\n```\n\nIn the `_create_actors()` method, you will create the `SubprocessManager` Actor and configure it with your generic runners:\n\n```\n    def _create_actors(self):\n        # Add the Actor to the session:\n        subprocess_manager = SubprocessManager(self)\n\n        # Create your factory:\n        site_factory = factories.create_new_factory('Studio Tools')\n\n        # Ensure your Runners are known there:\n        site_factory.ensure_runner_type(my_runners.Blender)\n        site_factory.ensure_runner_type(my_runners.Godot)\n        site_factory.ensure_runner_type(my_runners.Krita)\n\n        # Register your factory to the Actor:\n        subprocess_manager.ensure_factory(site_factory)\n\n```\n\nNow you have an awesome toolbar with buttons to launch each \nversion of the runner you registered \\o/\n(They appear grouped by the first tag of each Runner)\n\n## Configure your Project\n\nSome *Runner*s will be specific to flow type.\nFor example, not all pipelines will supported USDView...\n\nSo you need to define Runners inside your flow and have them show up in the toolbar only if you entered a project using this flow.\n\nOne way to do so is to use your Project's `_fill_ui()` as a trigger for installation:\n\n```\nclass MyProject(flow.Object):\n\n    episodes = flow.Child(Episodes).ui(show_filter=True)\n    admin = flow.Child(Admin)\n\n    _RUNNERS_FACTORY = None\n\n    def ensure_runners_loaded(self):\n        session = self.root().session()\n        subprocess_manager = session.get_actor('SubprocessManager')\n\n        if self._RUNNERS_FACTORY is None:\n            self._RUNNERS_FACTORY = subprocess_manager.create_new_factory(\n                'Best Pipeline Eva'\n            )\n            self._RUNNERS_FACTORY.ensure_runner_type(\n                my_runners.USDView,\n                my_runners.USDBlast,\n            )\n        subprocess_manager.ensure_factory(self._RUNNERS_FACTORY)\n\n    def _fill_ui(self, ui):\n        # We can't setup runner in the constructor because\n        # it needs access to self.session() which is set\n        # *after* constructor :/\n        # So we set them up the first time the project is displayed:\n        if self._RUNNERS_FACTORY is None:\n            self.ensure_runners_loaded()\n\n\n``` \n\n## Run Subprocesses from the Flow\n\nThis is the most important since running stuff within \na context is what we want 90% of time :p\n\nIn order to use your Runners from the flow and to have them use\nsome values from your flow (filename, env var, flag, etc...), you\nwill use the Action `kabaret.subprocess_manager.flow.RunAction`:\n\nHere we define a RunAction that uses the parent's `filename` Param as a command line argument to a `TextEdit` runner:\n```\nclass EditAction(RunAction):\n\n    _scene = flow.Parent()\n\n    def runner_name_and_tags(self):\n        # Specifying None for tags means 'accept all'\n        return 'TextEdit', None\n\n    def needs_dialog(self):\n        return False\n\n    def extra_argv(self):\n        # All strings returned here will be\n        # appended to the runner command line:\n        return [self._scene_.filename.get()]\n``` \n\nYou can also provide `extra_env`, let the user select the version\nof the runner, etc... \n\nYou can ask for more examples and support in the kabaret discord:\n    https://www.kabaretstudio.com/support\n\nHappy Running ! :)", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://gitlab.com/kabaretstudio/kabaret.subprocess_manager", "keywords": "kabaret vfx animation pipeline dataflow workflow subprocess", "license": "LGPLv3+", "maintainer": "", "maintainer_email": "", "name": "kabaret.subprocess-manager", "package_url": "https://pypi.org/project/kabaret.subprocess-manager/", "platform": "", "project_url": "https://pypi.org/project/kabaret.subprocess-manager/", "project_urls": {"Homepage": "https://gitlab.com/kabaretstudio/kabaret.subprocess_manager"}, "release_url": "https://pypi.org/project/kabaret.subprocess-manager/1.0.7/", "requires_dist": null, "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "summary": "Subprocess Management extension for the Kabaret framework", "version": "1.0.7", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>kabaret.subprocess_manager</h1>\n<p>Subprocess Manager for Kabaret.</p>\n<p>Provides an Actor, Views and Flow Objects to manage collections of  environment + command-lines, as well as running &amp; controling them.</p>\n<h1>Synopsis</h1>\n<h3>Runners</h3>\n<p>You implement your <code>Runners</code> by subclassing <code>kabaret.subprocess_manager.runner_factory.Runner</code>. <em>Runners</em> have a name, some tags, a liste of supported versions, an icon, etc...</p>\n<p>At runtime, you add your <em>Runners</em> to a <code>Factory</code>. A <em>Factory</em> has a name, can lookup <em>Runners</em> based on name and tags, etc...\nYou will probably have several factories.</p>\n<h3>SubprocessManager Actor</h3>\n<p>In order to use them, you will <em>Add</em> them to the <code>SubprocessManager</code> Actor. There is 2 places where you may want to do it:</p>\n<ul>\n<li>In your Session, when creating the Action. This is nice for generic stuff (explorer, shell, text editors, ...)</li>\n<li>In your Flow, when a project is instaciated. This is nice for production specific tools where the environment and the version are precisely defined (scene editing, baking, render, ...)</li>\n</ul>\n<h3>LaunchToolBar and SubprocessView</h3>\n<p>If you add the LaunchToolBar to your <em>Session</em>, you will be able to run your Runner by clicking on the toolbar buttons.</p>\n<p>Those run take no parameters.</p>\n<p>If you add the SubprocessView (and it get implemented some day), you will see a list of process you ran, with their outputs, and you will have opportinities to remove/kill/rerun...</p>\n<h3>Flow RunAction</h3>\n<p>A big majority of your Runner will be ran from your flows though.</p>\n<p>The <code>kabaret.subprocess_manager.flow.RunAction</code> Action will let the user trigger your Runners with the usual <code>flow.Action</code> fonctionnalities.</p>\n<p>By using the <em>RunAction</em>, you will be able to access your flow to configure your <em>Runners</em> runs. For example using project settings to get the project resolution and frame rate...</p>\n<h1>Usage:</h1>\n<h2>Define your process Runners:</h2>\n<pre><code>from kabaret.subprocess_manager.runner_factory import Runner\n\nclass MyStuffToRun(Runner):\n\n    ICON = ('icons.gui', 'team-lead')\n    TAGS = ['Team', 'Lead', 'Blah']\n\n    def supported_versions(self):\n        return ['v1', 'v2]\n\n    def executable(self):\n        return '/path/to/{}/executable'.format(self.version)\n\n    def argv(self):\n        index = 'https://blah.blu.tv'\n        if self.version == 'v2':\n            index = 'https://blah2022.blu.tv'\n\n        argv = ['--user', current_user, '--index', index]\n\n        # To allow configured run, you must\n        # use self.extra_argv:\n        return argv+self.extra_argv\n\n    def env(self):\n        env = os.environ.copy()\n        env['MY_STUFF_CONFIGVAR] = 'my_stuff_config_value'\n\n        # To allow configured run, you must\n        # use self.extra_argv:\n        env.update(self.extra_env)\n\n        return env\n\n</code></pre>\n<p>There are more tunning options, like terminal hidding etc...</p>\n<p>Everything is procedural (method call, no static/declarative thingy) so you're in full control ;)</p>\n<p>If you want the Runner icon or tags to depend on the date or the current user your can override the classmethods <code>runner_icon()</code> and <code>runner_tags()</code></p>\n<h2>Configure your Session:</h2>\n<p>In your session class, add the <code>SubprocessView</code> and the <code>LaunchToolBar</code> to\nthe registered view types.</p>\n<pre><code>class MySession(gui.KabaretStandaloneGUISession):\n\n    def register_view_types(self):\n        super(MySession, self).register_view_types()\n\n        type_name = self.register_view_type(SubprocessView)\n        self.add_view(type_name, hidden=True)\n\n        type_name = self.register_view_type(LauncherToolBar)\n        self.add_view(\n            type_name, hidden=False, \n            area=QtCore.Qt.RightToolBarArea\n        )\n</code></pre>\n<p>In the <code>_create_actors()</code> method, you will create the <code>SubprocessManager</code> Actor and configure it with your generic runners:</p>\n<pre><code>    def _create_actors(self):\n        # Add the Actor to the session:\n        subprocess_manager = SubprocessManager(self)\n\n        # Create your factory:\n        site_factory = factories.create_new_factory('Studio Tools')\n\n        # Ensure your Runners are known there:\n        site_factory.ensure_runner_type(my_runners.Blender)\n        site_factory.ensure_runner_type(my_runners.Godot)\n        site_factory.ensure_runner_type(my_runners.Krita)\n\n        # Register your factory to the Actor:\n        subprocess_manager.ensure_factory(site_factory)\n\n</code></pre>\n<p>Now you have an awesome toolbar with buttons to launch each\nversion of the runner you registered \\o/\n(They appear grouped by the first tag of each Runner)</p>\n<h2>Configure your Project</h2>\n<p>Some <em>Runner</em>s will be specific to flow type.\nFor example, not all pipelines will supported USDView...</p>\n<p>So you need to define Runners inside your flow and have them show up in the toolbar only if you entered a project using this flow.</p>\n<p>One way to do so is to use your Project's <code>_fill_ui()</code> as a trigger for installation:</p>\n<pre><code>class MyProject(flow.Object):\n\n    episodes = flow.Child(Episodes).ui(show_filter=True)\n    admin = flow.Child(Admin)\n\n    _RUNNERS_FACTORY = None\n\n    def ensure_runners_loaded(self):\n        session = self.root().session()\n        subprocess_manager = session.get_actor('SubprocessManager')\n\n        if self._RUNNERS_FACTORY is None:\n            self._RUNNERS_FACTORY = subprocess_manager.create_new_factory(\n                'Best Pipeline Eva'\n            )\n            self._RUNNERS_FACTORY.ensure_runner_type(\n                my_runners.USDView,\n                my_runners.USDBlast,\n            )\n        subprocess_manager.ensure_factory(self._RUNNERS_FACTORY)\n\n    def _fill_ui(self, ui):\n        # We can't setup runner in the constructor because\n        # it needs access to self.session() which is set\n        # *after* constructor :/\n        # So we set them up the first time the project is displayed:\n        if self._RUNNERS_FACTORY is None:\n            self.ensure_runners_loaded()\n\n\n</code></pre>\n<h2>Run Subprocesses from the Flow</h2>\n<p>This is the most important since running stuff within\na context is what we want 90% of time :p</p>\n<p>In order to use your Runners from the flow and to have them use\nsome values from your flow (filename, env var, flag, etc...), you\nwill use the Action <code>kabaret.subprocess_manager.flow.RunAction</code>:</p>\n<p>Here we define a RunAction that uses the parent's <code>filename</code> Param as a command line argument to a <code>TextEdit</code> runner:</p>\n<pre><code>class EditAction(RunAction):\n\n    _scene = flow.Parent()\n\n    def runner_name_and_tags(self):\n        # Specifying None for tags means 'accept all'\n        return 'TextEdit', None\n\n    def needs_dialog(self):\n        return False\n\n    def extra_argv(self):\n        # All strings returned here will be\n        # appended to the runner command line:\n        return [self._scene_.filename.get()]\n</code></pre>\n<p>You can also provide <code>extra_env</code>, let the user select the version\nof the runner, etc...</p>\n<p>You can ask for more examples and support in the kabaret discord:\n<a href=\"https://www.kabaretstudio.com/support\" rel=\"nofollow\">https://www.kabaretstudio.com/support</a></p>\n<p>Happy Running ! :)</p>\n\n          </div>"}, "last_serial": 6862036, "releases": {"0.0.1": [{"comment_text": "", "digests": {"md5": "e6739c6921a3a41419c5bd9deb983111", "sha256": "bc77823c89a4e6da9fc3dfd6a37546763d035f9e1c1b5b15cf1af94e0e26a8f5"}, "downloads": -1, "filename": "kabaret.subprocess_manager-0.0.1.tar.gz", "has_sig": false, "md5_digest": "e6739c6921a3a41419c5bd9deb983111", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 6187, "upload_time": "2020-01-26T20:53:00", "upload_time_iso_8601": "2020-01-26T20:53:00.799380Z", "url": "https://files.pythonhosted.org/packages/e3/58/68fe0bb94f4cab4c09c3d9a7fb9477953c8ad5de6d59760f0125117cc0d0/kabaret.subprocess_manager-0.0.1.tar.gz", "yanked": false}], "0.0.3": [{"comment_text": "", "digests": {"md5": "3c06521074163eef9043108a778fdceb", "sha256": "f953d538077ab17bf01622ded077e297b4447ae4f06eb21383e2b875d6bbd8fb"}, "downloads": -1, "filename": "kabaret.subprocess_manager-0.0.3.tar.gz", "has_sig": false, "md5_digest": "3c06521074163eef9043108a778fdceb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 10659, "upload_time": "2020-01-26T21:46:36", "upload_time_iso_8601": "2020-01-26T21:46:36.019026Z", "url": "https://files.pythonhosted.org/packages/63/8e/73aa79376db9a7e6874c329b414d16eb0ea95e6c7b906be67fe183100fe1/kabaret.subprocess_manager-0.0.3.tar.gz", "yanked": false}], "1.0.1": [{"comment_text": "", "digests": {"md5": "e3f01db14afd629b763f15b0b504c0ad", "sha256": "a7049735605bf21d3ac2855ec9d701616f67947d5fa932db8eb7e0694129c380"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.1.tar.gz", "has_sig": false, "md5_digest": "e3f01db14afd629b763f15b0b504c0ad", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 13450, "upload_time": "2020-01-29T21:01:52", "upload_time_iso_8601": "2020-01-29T21:01:52.790966Z", "url": "https://files.pythonhosted.org/packages/35/e9/6fe1a00bda0a650be646c6ef13bbc44219d0ce27e9189b1f641aa7c522ba/kabaret.subprocess_manager-1.0.1.tar.gz", "yanked": false}], "1.0.2": [{"comment_text": "", "digests": {"md5": "4fbdb083d1fdfbf882caee5d8522adbe", "sha256": "93d371f6fc93dc01d3d29382f6a28fe69aef8976fe6527056a7b1e68a21a8f5c"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.2.tar.gz", "has_sig": false, "md5_digest": "4fbdb083d1fdfbf882caee5d8522adbe", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 13444, "upload_time": "2020-01-31T20:53:45", "upload_time_iso_8601": "2020-01-31T20:53:45.862348Z", "url": "https://files.pythonhosted.org/packages/fd/36/ffbbb09e4e2b5b88bda918e704519d7c0cc7ec72bcadf215f2a0b7869e37/kabaret.subprocess_manager-1.0.2.tar.gz", "yanked": false}], "1.0.3": [{"comment_text": "", "digests": {"md5": "3ca3f5950a20bf09b0c9fe24246a914a", "sha256": "a997a6be0176a02051d35ed44e958b4278ad769002483604c1654872323a4797"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.3.tar.gz", "has_sig": false, "md5_digest": "3ca3f5950a20bf09b0c9fe24246a914a", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 29531, "upload_time": "2020-02-03T14:04:54", "upload_time_iso_8601": "2020-02-03T14:04:54.140852Z", "url": "https://files.pythonhosted.org/packages/01/ba/be58b626875052b9d572f5842ddb460bff5aa7943df037a443ab98cefa51/kabaret.subprocess_manager-1.0.3.tar.gz", "yanked": false}], "1.0.5": [{"comment_text": "", "digests": {"md5": "ef5270b85fbaee4ce54d7fe4e32f6fbe", "sha256": "1ed80e998b465a6e3ed933a93a8a4feff88eced4cd4fba985622f4d86603f361"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.5.tar.gz", "has_sig": false, "md5_digest": "ef5270b85fbaee4ce54d7fe4e32f6fbe", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 30059, "upload_time": "2020-02-03T16:38:25", "upload_time_iso_8601": "2020-02-03T16:38:25.153258Z", "url": "https://files.pythonhosted.org/packages/66/96/56f4d5974516e461482f0092c6fefa4a5c78ab0709574b14f794d2f13b35/kabaret.subprocess_manager-1.0.5.tar.gz", "yanked": false}], "1.0.7": [{"comment_text": "", "digests": {"md5": "2c13d7d06bebe43831f648088459c50c", "sha256": "d37d531c532f3f84c8dcdc0f179be4a488b6677a85040fb96c0c625464e1b14a"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.7.tar.gz", "has_sig": false, "md5_digest": "2c13d7d06bebe43831f648088459c50c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 30065, "upload_time": "2020-03-22T22:24:01", "upload_time_iso_8601": "2020-03-22T22:24:01.998834Z", "url": "https://files.pythonhosted.org/packages/55/38/801d19baa4dd8a52b46a60503c47291ef2c91ecd63894e64fdfaaba0971a/kabaret.subprocess_manager-1.0.7.tar.gz", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "2c13d7d06bebe43831f648088459c50c", "sha256": "d37d531c532f3f84c8dcdc0f179be4a488b6677a85040fb96c0c625464e1b14a"}, "downloads": -1, "filename": "kabaret.subprocess_manager-1.0.7.tar.gz", "has_sig": false, "md5_digest": "2c13d7d06bebe43831f648088459c50c", "packagetype": "sdist", "python_version": "source", "requires_python": ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*", "size": 30065, "upload_time": "2020-03-22T22:24:01", "upload_time_iso_8601": "2020-03-22T22:24:01.998834Z", "url": "https://files.pythonhosted.org/packages/55/38/801d19baa4dd8a52b46a60503c47291ef2c91ecd63894e64fdfaaba0971a/kabaret.subprocess_manager-1.0.7.tar.gz", "yanked": false}], "timestamp": "Fri May  8 00:50:53 2020"}