{"info": {"author": "Hydrospheredata", "author_email": "info@hydrosphere.io", "bugtrack_url": null, "classifiers": ["Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# hydro-serving-integrations\n\nThis repository contains implementations of integrations with AWS Sagemaker.\n\n## Installation \n\n```sh\n$ pip install hydro-integrations\n```\n\n## Before you start\n\nThe following rights are required for deploying traffic-shadowing stack.\n\n```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:GetRole\",\n                \"iam:CreateRole\",\n                \"iam:DeleteRole\",\n                \"iam:GetRolePolicy\",\n                \"iam:PutRolePolicy\",\n                \"iam:DeleteRolePolicy\",\n                \"iam:PassRole\",\n                \"lambda:CreateFunction\",\n                \"lambda:DeleteFunction\",\n                \"lambda:InvokeFunction\",\n                \"lambda:ListVersionsByFunction\",\n                \"lambda:GetFunctionConfiguration\",\n                \"lambda:PutFunctionConcurrency\",\n                \"lambda:AddPermission\",\n                \"lambda:RemovePermission\"\n                \"lambda:PublishVersion\",\n                \"cloudformation:DescribeStacks\",\n                \"cloudformation:DescribeStackEvents\",\n                \"cloudformation:CreateStack\",\n                \"cloudformation:DeleteStack\",\n            ],\n            \"Resource\": [\n                \"arn:aws:iam:::role/*\",\n                \"arn:aws:cloudformation:::stack/*/*\",\n                \"arn:aws:lambda:::function:*\"\n            ]\n        },\n        {\n            \"Sid\": \"VisualEditor1\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:PutBucketNotification\",\n                \"s3:CreateBucket\",\n                \"s3:DeleteBucket\"\n                \"s3:GetBucketLocation\",\n                \"s3:GetBucketNotification\",\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n## Usage\n\n```python\nfrom hydro_integrations.aws.sagemaker import TrafficShadowing\nfrom sagemaker.model import Model\nfrom sagemaker.model_monitor.data_capture_config import DataCaptureConfig\n\n# Create Sagemaker Model \nmodel = Model(...)\n\n# Define data capture config\ndata_capture_config = DataCaptureConfig(\n    enable_capture=True,\n    sampling_percentage=100,\n    destination_s3_uri=\"s3://bucket/data/captured\"\n)\n\n# Deploy Sagemaker model with the specified \n# data capture config\npredictor = model.deploy(\n    initial_instance_count=1,\n    instance_type='ml.m4.xlarge',\n    endpoint_name='model-shadowing-example',\n    data_capture_config=data_capture_config\n)\n\n# Deploy TrafficShadowing CloudFormation stack. \nshadowing = TrafficShadowing(\n    hydrosphere_endpoint=\"https://<hydrosphere>\", \n    s3_data_training_uri=\"s3://bucket/data/training\",\n    data_capture_config=data_capture_config,\n)\nshadowing.deploy()\n```\n\n## How it works\n\nOnce you've enabled data capturing on your AWS Sagemaker Endpoint, you can deploy TrafficShadowing CloudFormation stack, which contains AWS Lambda function responsible for shadowing traffic from configured S3 bucket to Hydrosphere for analysis.\n\n**Note**, by default `destination_s3_uri` parameter, specified in the `DataCaptureConfig`, represents a prefix where your requests will be stored. In the example above, we've deployed a model with the endpoint name `model-shadowing-example`. This means that all requests collected from that model endpoint will be placed under `s3://bucket/data/captured/model-shadowing-example` path. Lambda function, deployed as part of the `TrafficShadowing` stack, expects that training data is organized in the same way, i.e., data used for training the `model-shadowing-example` model is placed under `s3://bucket/data/training/model-shadowing-example` path. Lambda function then finds the biggest `.csv` file under that directory and uploads it to the Hydrosphere platform for building profiles for your model.\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://hydrosphere.io/", "keywords": "hydrosphere hydro serving monitoring sagemaker integrations", "license": "", "maintainer": "", "maintainer_email": "", "name": "hydro-integrations", "package_url": "https://pypi.org/project/hydro-integrations/", "platform": "", "project_url": "https://pypi.org/project/hydro-integrations/", "project_urls": {"Homepage": "https://hydrosphere.io/"}, "release_url": "https://pypi.org/project/hydro-integrations/2.3.0.dev2/", "requires_dist": ["boto3 (>=1.12.30)", "sagemaker (>=1.52.1)"], "requires_python": ">=3.6", "summary": "HydroSDK integrations", "version": "2.3.0.dev2", "yanked": false, "html_description": "<div class=\"project-description\">\n            <h1>hydro-serving-integrations</h1>\n<p>This repository contains implementations of integrations with AWS Sagemaker.</p>\n<h2>Installation</h2>\n<pre>$ pip install hydro-integrations\n</pre>\n<h2>Before you start</h2>\n<p>The following rights are required for deploying traffic-shadowing stack.</p>\n<pre><span class=\"p\">{</span>\n    <span class=\"nt\">\"Version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2012-10-17\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"Statement\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n            <span class=\"nt\">\"Sid\"</span><span class=\"p\">:</span> <span class=\"s2\">\"VisualEditor0\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"Effect\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Allow\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"Action\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"s2\">\"iam:GetRole\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:CreateRole\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:DeleteRole\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:GetRolePolicy\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:PutRolePolicy\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:DeleteRolePolicy\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"iam:PassRole\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:CreateFunction\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:DeleteFunction\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:InvokeFunction\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:ListVersionsByFunction\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:GetFunctionConfiguration\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:PutFunctionConcurrency\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:AddPermission\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"lambda:RemovePermission\"</span>\n                <span class=\"s2\">\"lambda:PublishVersion\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"cloudformation:DescribeStacks\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"cloudformation:DescribeStackEvents\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"cloudformation:CreateStack\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"cloudformation:DeleteStack\"</span><span class=\"p\">,</span>\n            <span class=\"p\">],</span>\n            <span class=\"nt\">\"Resource\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"s2\">\"arn:aws:iam:::role/*\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"arn:aws:cloudformation:::stack/*/*\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"arn:aws:lambda:::function:*\"</span>\n            <span class=\"p\">]</span>\n        <span class=\"p\">},</span>\n        <span class=\"p\">{</span>\n            <span class=\"nt\">\"Sid\"</span><span class=\"p\">:</span> <span class=\"s2\">\"VisualEditor1\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"Effect\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Allow\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"Action\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"s2\">\"s3:PutBucketNotification\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"s3:CreateBucket\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"s3:DeleteBucket\"</span>\n                <span class=\"s2\">\"s3:GetBucketLocation\"</span><span class=\"p\">,</span>\n                <span class=\"s2\">\"s3:GetBucketNotification\"</span><span class=\"p\">,</span>\n            <span class=\"p\">],</span>\n            <span class=\"nt\">\"Resource\"</span><span class=\"p\">:</span> <span class=\"s2\">\"*\"</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre>\n<h2>Usage</h2>\n<pre><span class=\"kn\">from</span> <span class=\"nn\">hydro_integrations.aws.sagemaker</span> <span class=\"kn\">import</span> <span class=\"n\">TrafficShadowing</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sagemaker.model</span> <span class=\"kn\">import</span> <span class=\"n\">Model</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sagemaker.model_monitor.data_capture_config</span> <span class=\"kn\">import</span> <span class=\"n\">DataCaptureConfig</span>\n\n<span class=\"c1\"># Create Sagemaker Model </span>\n<span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">Model</span><span class=\"p\">(</span><span class=\"o\">...</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Define data capture config</span>\n<span class=\"n\">data_capture_config</span> <span class=\"o\">=</span> <span class=\"n\">DataCaptureConfig</span><span class=\"p\">(</span>\n    <span class=\"n\">enable_capture</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n    <span class=\"n\">sampling_percentage</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span>\n    <span class=\"n\">destination_s3_uri</span><span class=\"o\">=</span><span class=\"s2\">\"s3://bucket/data/captured\"</span>\n<span class=\"p\">)</span>\n\n<span class=\"c1\"># Deploy Sagemaker model with the specified </span>\n<span class=\"c1\"># data capture config</span>\n<span class=\"n\">predictor</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">deploy</span><span class=\"p\">(</span>\n    <span class=\"n\">initial_instance_count</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span>\n    <span class=\"n\">instance_type</span><span class=\"o\">=</span><span class=\"s1\">'ml.m4.xlarge'</span><span class=\"p\">,</span>\n    <span class=\"n\">endpoint_name</span><span class=\"o\">=</span><span class=\"s1\">'model-shadowing-example'</span><span class=\"p\">,</span>\n    <span class=\"n\">data_capture_config</span><span class=\"o\">=</span><span class=\"n\">data_capture_config</span>\n<span class=\"p\">)</span>\n\n<span class=\"c1\"># Deploy TrafficShadowing CloudFormation stack. </span>\n<span class=\"n\">shadowing</span> <span class=\"o\">=</span> <span class=\"n\">TrafficShadowing</span><span class=\"p\">(</span>\n    <span class=\"n\">hydrosphere_endpoint</span><span class=\"o\">=</span><span class=\"s2\">\"https://&lt;hydrosphere&gt;\"</span><span class=\"p\">,</span> \n    <span class=\"n\">s3_data_training_uri</span><span class=\"o\">=</span><span class=\"s2\">\"s3://bucket/data/training\"</span><span class=\"p\">,</span>\n    <span class=\"n\">data_capture_config</span><span class=\"o\">=</span><span class=\"n\">data_capture_config</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"n\">shadowing</span><span class=\"o\">.</span><span class=\"n\">deploy</span><span class=\"p\">()</span>\n</pre>\n<h2>How it works</h2>\n<p>Once you've enabled data capturing on your AWS Sagemaker Endpoint, you can deploy TrafficShadowing CloudFormation stack, which contains AWS Lambda function responsible for shadowing traffic from configured S3 bucket to Hydrosphere for analysis.</p>\n<p><strong>Note</strong>, by default <code>destination_s3_uri</code> parameter, specified in the <code>DataCaptureConfig</code>, represents a prefix where your requests will be stored. In the example above, we've deployed a model with the endpoint name <code>model-shadowing-example</code>. This means that all requests collected from that model endpoint will be placed under <code>s3://bucket/data/captured/model-shadowing-example</code> path. Lambda function, deployed as part of the <code>TrafficShadowing</code> stack, expects that training data is organized in the same way, i.e., data used for training the <code>model-shadowing-example</code> model is placed under <code>s3://bucket/data/training/model-shadowing-example</code> path. Lambda function then finds the biggest <code>.csv</code> file under that directory and uploads it to the Hydrosphere platform for building profiles for your model.</p>\n\n          </div>"}, "last_serial": 7119531, "releases": {"2.3.0.dev0": [{"comment_text": "", "digests": {"md5": "810d8f500d7239572f590b60c2fe94fc", "sha256": "40817638ffa2ed11f449f1ac55b01e8bd61df0c3c6ef445fe26a7d52675302c1"}, "downloads": -1, "filename": "hydro_integrations-2.3.0.dev0-py3-none-any.whl", "has_sig": false, "md5_digest": "810d8f500d7239572f590b60c2fe94fc", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 14786, "upload_time": "2020-04-23T11:14:55", "upload_time_iso_8601": "2020-04-23T11:14:55.058259Z", "url": "https://files.pythonhosted.org/packages/40/44/68eb628e28d446e991c51d824055d345613ec99b308d4f0da70a0ecc1cce/hydro_integrations-2.3.0.dev0-py3-none-any.whl", "yanked": false}], "2.3.0.dev1": [{"comment_text": "", "digests": {"md5": "6974a67873e7edb789aa0dc7a2a2ebf9", "sha256": "d30b9ecb98a8a7e9a0a860d4e718b2c65561a180689c8f257fc73ded36783031"}, "downloads": -1, "filename": "hydro_integrations-2.3.0.dev1-py3-none-any.whl", "has_sig": false, "md5_digest": "6974a67873e7edb789aa0dc7a2a2ebf9", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 14786, "upload_time": "2020-04-23T11:26:17", "upload_time_iso_8601": "2020-04-23T11:26:17.528096Z", "url": "https://files.pythonhosted.org/packages/9c/18/36aff63058f49af725d929dcad1f3c0de332f05fcbc49bfa4e15b4821cc5/hydro_integrations-2.3.0.dev1-py3-none-any.whl", "yanked": false}], "2.3.0.dev2": [{"comment_text": "", "digests": {"md5": "c4b5c4deb8d6b1bc42dc3e3451752649", "sha256": "23ef9fe5f0876b925cb5245be68a8dab653181abd1d992900fdb7deea1d88e2f"}, "downloads": -1, "filename": "hydro_integrations-2.3.0.dev2-py3-none-any.whl", "has_sig": false, "md5_digest": "c4b5c4deb8d6b1bc42dc3e3451752649", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 11741, "upload_time": "2020-04-28T12:02:39", "upload_time_iso_8601": "2020-04-28T12:02:39.093962Z", "url": "https://files.pythonhosted.org/packages/3d/c0/738a068e98af2f2405adc06957fec02e30bd4719a8e1b128bcc11744968d/hydro_integrations-2.3.0.dev2-py3-none-any.whl", "yanked": false}]}, "urls": [{"comment_text": "", "digests": {"md5": "c4b5c4deb8d6b1bc42dc3e3451752649", "sha256": "23ef9fe5f0876b925cb5245be68a8dab653181abd1d992900fdb7deea1d88e2f"}, "downloads": -1, "filename": "hydro_integrations-2.3.0.dev2-py3-none-any.whl", "has_sig": false, "md5_digest": "c4b5c4deb8d6b1bc42dc3e3451752649", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 11741, "upload_time": "2020-04-28T12:02:39", "upload_time_iso_8601": "2020-04-28T12:02:39.093962Z", "url": "https://files.pythonhosted.org/packages/3d/c0/738a068e98af2f2405adc06957fec02e30bd4719a8e1b128bcc11744968d/hydro_integrations-2.3.0.dev2-py3-none-any.whl", "yanked": false}], "timestamp": "Fri May  8 00:49:38 2020"}